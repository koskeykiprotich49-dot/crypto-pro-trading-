<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CryptoPro - Professional Crypto Trading Platform</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
--bg-primary:#0B0E11;--bg-secondary:#161A1E;--bg-tertiary:#1E2329;
--border-color:#2B3139;--text-primary:#EAECEF;--text-secondary:#848E9C;
--accent-green:#0ECB81;--accent-red:#F6465D;--accent-yellow:#FCD535;--accent-blue:#00d9ff;
}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#0f172a 0%,#1e293b 100%);color:var(--text-primary);min-height:100vh;overflow-x:hidden}
.layer{display:none;min-height:100vh;animation:fadeIn 0.5s ease-out}
.layer.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes pulse{0%,100%{opacity:1;transform:scale(1)}50%{opacity:0.8;transform:scale(1.05)}}
@keyframes slideIn{from{transform:translateY(-100px);opacity:0}to{transform:translateY(0);opacity:1}}
@keyframes slideLeft{0%{transform:translateX(0)}100%{transform:translateX(-100%)}}
@keyframes fadeOut{from{opacity:1}to{opacity:0}}
@keyframes botPulse{0%,100%{box-shadow:0 0 0 0 rgba(14,203,129,0.4)}50%{box-shadow:0 0 0 12px rgba(14,203,129,0)}}
.referral-success-banner{position:fixed;top:0;left:0;right:0;background:linear-gradient(135deg,#0ECB81,#0B8F5F);padding:20px;text-align:center;z-index:9999;box-shadow:0 4px 20px rgba(14,203,129,0.4);animation:slideIn 0.5s ease-out;display:none}
.referral-success-banner.show{display:block}
.referral-success-content h2{font-size:28px;margin-bottom:8px;color:#fff}
.referral-success-content p{font-size:16px;color:rgba(255,255,255,0.95);margin-bottom:12px;line-height:1.6}
.bonus-highlight{display:inline-block;font-size:42px;font-weight:900;color:#FCD535;margin:12px 0;animation:pulse 2s infinite}
.close-banner{position:absolute;top:10px;right:20px;background:rgba(255,255,255,0.2);border:none;color:white;font-size:24px;width:32px;height:32px;border-radius:50%;cursor:pointer;transition:all 0.3s}
.close-banner:hover{background:rgba(255,255,255,0.3);transform:rotate(90deg)}
.navbar{background:var(--bg-secondary);padding:16px 20px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:1000;border-bottom:1px solid var(--border-color)}
.logo{display:flex;align-items:center;gap:12px;font-size:24px;font-weight:700;color:var(--accent-green);cursor:pointer}
.logo-icon{width:32px;height:32px;background:linear-gradient(135deg,var(--accent-green),#0B8F5F);border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:18px}
.nav-links{display:flex;gap:20px;align-items:center;flex-wrap:wrap}
.nav-btn{padding:10px 20px;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all 0.3s;font-size:14px}
.btn-login{background:transparent;color:var(--accent-blue);border:2px solid var(--accent-blue)}
.btn-signup{background:linear-gradient(135deg,var(--accent-green),#0B8F5F);color:#fff;border:none}
.btn-signup:hover,.btn-login:hover{transform:translateY(-2px);box-shadow:0 5px 20px rgba(14,203,129,0.4)}
.status-badge{display:flex;align-items:center;gap:6px;padding:6px 12px;background:rgba(14,203,129,0.1);border-radius:20px;font-size:12px;font-weight:600;color:var(--accent-green)}
.status-dot{width:6px;height:6px;background:var(--accent-green);border-radius:50%;animation:pulse 2s ease-in-out infinite}
.container{max-width:1920px;margin:0 auto;padding:20px}
.hero-section{background:linear-gradient(135deg,rgba(14,203,129,0.1),rgba(0,217,255,0.1));border:2px solid var(--accent-green);border-radius:16px;padding:40px;margin-bottom:20px;text-align:center}
.hero-section h1{font-size:48px;background:linear-gradient(135deg,var(--accent-green),var(--accent-blue));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:16px}
.hero-section p{font-size:18px;color:var(--text-primary);margin-bottom:24px;line-height:1.6}
.hero-cta{display:flex;gap:16px;justify-content:center;flex-wrap:wrap}
.hero-btn{padding:16px 32px;border:none;border-radius:12px;font-size:18px;font-weight:700;cursor:pointer;transition:all 0.3s}
.hero-btn-primary{background:linear-gradient(135deg,var(--accent-green),#0B8F5F);color:#fff}
.hero-btn-secondary{background:transparent;color:var(--accent-blue);border:2px solid var(--accent-blue)}
.hero-btn:hover{transform:translateY(-3px);box-shadow:0 8px 25px rgba(14,203,129,0.4)}
.live-traders-section{background:var(--bg-secondary);border-radius:12px;padding:20px;margin-bottom:20px;border:1px solid var(--border-color);overflow:hidden}
.live-traders-title{text-align:center;color:var(--accent-green);font-size:18px;font-weight:700;margin-bottom:16px;text-transform:uppercase;letter-spacing:1px}
.ticker-wrapper{overflow:hidden;position:relative}
.ticker-content{display:flex;animation:slideLeft 90s linear infinite;white-space:nowrap}
.trader-card{display:inline-flex;align-items:center;gap:12px;padding:12px 20px;background:var(--bg-tertiary);border-radius:12px;margin-right:16px;border:1px solid var(--border-color);min-width:250px}
.trader-avatar{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,var(--accent-green),var(--accent-blue));display:flex;align-items:center;justify-content:center;font-size:20px}
.trader-info{flex:1}
.trader-name{font-weight:600;color:var(--text-primary);font-size:14px}
.trader-profit{font-weight:700;color:var(--accent-green);font-size:16px}
.top-winners-section{background:var(--bg-secondary);border-radius:12px;padding:20px;margin-bottom:20px;border:1px solid var(--border-color)}
.top-winners-title{color:var(--accent-green);font-size:18px;font-weight:700;margin-bottom:16px;display:flex;align-items:center;gap:8px}
.winners-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:16px}
.winner-card{background:var(--bg-tertiary);border-radius:12px;padding:20px;border:2px solid var(--border-color);transition:all 0.3s;position:relative;overflow:hidden}
.winner-card:hover{border-color:var(--accent-green);transform:translateY(-5px);box-shadow:0 8px 25px rgba(14,203,129,0.3)}
.winner-rank{position:absolute;top:10px;right:10px;width:36px;height:36px;background:linear-gradient(135deg,var(--accent-yellow),#f59e0b);border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:900;color:#000;font-size:16px}
.winner-header{display:flex;align-items:center;gap:12px;margin-bottom:16px}
.winner-avatar-large{width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,var(--accent-green),var(--accent-blue));display:flex;align-items:center;justify-content:center;font-size:28px}
.winner-details h4{font-size:18px;color:var(--text-primary);margin-bottom:4px}
.winner-location{font-size:12px;color:var(--text-secondary)}
.winner-stats{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.winner-stat{background:rgba(14,203,129,0.1);padding:12px;border-radius:8px;text-align:center}
.winner-stat-label{font-size:11px;color:var(--text-secondary);margin-bottom:4px}
.winner-stat-value{font-size:20px;font-weight:700;color:var(--accent-green)}
.stats-section{background:var(--bg-secondary);border-radius:12px;padding:20px;margin-bottom:20px;border:1px solid var(--border-color)}
.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}
.stat-card{background:var(--bg-tertiary);padding:20px;border-radius:12px;border:1px solid var(--border-color);text-align:center;cursor:pointer;transition:all 0.3s}
.stat-card:hover{border-color:var(--accent-green);transform:translateY(-3px);box-shadow:0 5px 20px rgba(14,203,129,0.2)}
.stat-icon{font-size:36px;margin-bottom:12px}
.stat-value{font-size:32px;font-weight:700;color:var(--accent-green);margin-bottom:8px}
.stat-label{font-size:14px;color:var(--text-secondary);text-transform:uppercase;letter-spacing:0.5px}
.chart-section{background:var(--bg-secondary);border-radius:12px;padding:20px;margin-bottom:20px;border:1px solid var(--border-color)}
.chart-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-wrap:wrap}
.chart-title{font-size:18px;font-weight:600;color:var(--accent-green)}
.chart-labels{display:grid;grid-template-columns:repeat(6,1fr);gap:8px;margin-bottom:8px;padding:0 20px}
.chart-label{font-size:11px;color:var(--text-secondary);text-align:center}
.chart-wrapper{position:relative;width:100%;height:400px;background:var(--bg-primary);border-radius:8px;padding:20px;border:1px solid var(--border-color)}
.chart-wrapper.small{height:200px}
canvas{width:100%;height:100%;display:block}
.price-info{display:flex;justify-content:space-between;align-items:center;padding:16px;background:var(--bg-tertiary);border-radius:8px;margin-bottom:16px}
.current-price{font-size:32px;font-weight:900;color:var(--accent-green)}
.price-change{font-size:18px;font-weight:700;padding:8px 16px;border-radius:8px}
.price-change.positive{background:rgba(14,203,129,0.2);color:var(--accent-green)}
.price-change.negative{background:rgba(246,70,93,0.2);color:var(--accent-red)}
.auth-container{max-width:480px;margin:80px auto;padding:40px;background:var(--bg-secondary);border-radius:24px;box-shadow:0 8px 32px rgba(0,0,0,0.6);border:1px solid var(--border-color)}
.form-group{margin-bottom:20px}
.form-group label{display:block;margin-bottom:8px;font-size:14px;font-weight:600;color:var(--text-primary)}
.form-group input,.form-group textarea,.form-group select{width:100%;padding:14px 16px;border:2px solid var(--border-color);border-radius:12px;background:var(--bg-tertiary);color:var(--text-primary);font-size:16px;transition:all 0.3s;font-family:inherit}
.form-group input:focus,.form-group textarea:focus,.form-group select:focus{outline:none;border-color:var(--accent-green);box-shadow:0 0 0 3px rgba(14,203,129,0.1)}
.btn-submit{width:100%;padding:16px;border:none;border-radius:12px;background:linear-gradient(135deg,var(--accent-green),#0B8F5F);color:#fff;font-size:18px;font-weight:700;cursor:pointer;transition:all 0.3s;margin-top:10px}
.btn-submit:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(14,203,129,0.4)}
.action-buttons{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:24px}
.action-btn{padding:20px;border:none;border-radius:16px;font-size:16px;font-weight:600;cursor:pointer;transition:all 0.3s;text-align:center}
.action-btn:hover{transform:translateY(-3px);box-shadow:0 8px 25px rgba(0,0,0,0.3)}
.btn-trade{background:linear-gradient(135deg,#fbbf24,#f59e0b);color:#000}
.btn-deposit{background:linear-gradient(135deg,var(--accent-green),#0B8F5F);color:#fff}
.payment-method-selector{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-bottom:20px}
.payment-method-btn{padding:20px 16px;border:2px solid var(--border-color);border-radius:12px;background:var(--bg-tertiary);color:var(--text-primary);cursor:pointer;transition:all 0.3s;text-align:center;font-weight:600;font-size:15px}
.payment-method-btn.active{border-color:var(--accent-green);background:rgba(14,203,129,0.2)}
.payment-method-btn:hover{border-color:var(--accent-green)}
.payment-details{background:rgba(14,203,129,0.1);border:2px solid rgba(14,203,129,0.3);border-radius:12px;padding:20px;margin:16px 0;display:none}
.payment-details.active{display:block}
.payment-info{background:rgba(0,0,0,0.3);padding:16px;border-radius:8px;margin:12px 0}
.payment-value{font-size:18px;font-weight:700;color:var(--accent-green);font-family:'Monaco','Courier New',monospace;word-break:break-all}
.copy-btn{width:100%;background:linear-gradient(135deg,var(--accent-blue),#0099cc);color:white;border:none;padding:12px 20px;border-radius:8px;font-weight:600;cursor:pointer;margin-top:8px;transition:all 0.3s}
.copy-btn:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,217,255,0.4)}
.whatsapp-support{position:fixed;bottom:20px;left:20px;z-index:1000}
.whatsapp-btn{display:flex;align-items:center;gap:12px;background:linear-gradient(135deg,#25D366,#128C7E);color:white;padding:16px 24px;border-radius:50px;text-decoration:none;font-weight:600;box-shadow:0 4px 20px rgba(37,211,102,0.4);transition:all 0.3s}
.whatsapp-btn:hover{transform:translateY(-3px);box-shadow:0 8px 30px rgba(37,211,102,0.6)}
.alert{padding:12px 16px;border-radius:8px;margin-bottom:20px;font-size:14px;display:none}
.alert.show{display:block}
.alert-success{background:rgba(14,203,129,0.1);border:1px solid rgba(14,203,129,0.3);color:var(--accent-green)}
.alert-error{background:rgba(246,70,93,0.1);border:1px solid rgba(246,70,93,0.3);color:var(--accent-red)}
.toast-notification{position:fixed;top:80px;right:20px;background:linear-gradient(135deg,var(--accent-green),#0B8F5F);color:white;padding:16px 24px;border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,0.4);z-index:10000;animation:slideIn 0.5s;max-width:350px;display:none}
.toast-notification.show{display:block}
.bot-card{background:var(--bg-tertiary);border:2px solid var(--border-color);border-radius:16px;padding:24px;transition:all 0.3s;position:relative}
.bot-card:hover{border-color:var(--accent-green);transform:translateY(-4px);box-shadow:0 8px 30px rgba(14,203,129,0.2)}
.bot-card.premium{border-color:var(--accent-yellow)}
.bot-icon{width:64px;height:64px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:32px;margin-bottom:16px}
.bot-running-indicator{width:10px;height:10px;background:var(--accent-green);border-radius:50%;display:inline-block;margin-right:6px;animation:botPulse 2s infinite}
.coin-row{display:flex;align-items:center;gap:16px;padding:16px;background:var(--bg-tertiary);border-radius:12px;border:1px solid var(--border-color);margin-bottom:12px;transition:all 0.3s}
.coin-row:hover{border-color:var(--accent-green);transform:translateX(4px)}
.coin-icon{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;flex-shrink:0}
@media(max-width:768px){.container{padding:12px}.hero-section h1{font-size:32px}.nav-links{gap:10px}.nav-btn{padding:8px 16px;font-size:12px}.payment-method-selector{grid-template-columns:1fr}}
</style>
</head>
<body>

<div id="toastNotification" class="toast-notification"></div>

<div id="referralSuccessBanner" class="referral-success-banner">
  <button class="close-banner" onclick="closeReferralBanner()">&#x2715;</button>
  <div class="referral-success-content">
    <h2>CONGRATULATIONS!</h2>
    <p><strong id="referrerName">Your friend</strong> has been crushing it with CryptoPro!</p>
    <p>They're making <strong>consistent daily profits</strong> with our AI-powered trading bots.</p>
    <div class="bonus-highlight">GET $25 BONUS!</div>
    <p style="font-size:18px;margin-top:12px">Sign up now and receive <strong>$25 instant bonus</strong> &mdash; 100% withdrawable after verification!</p>
  </div>
</div>

<!-- LAYER 1: Welcome -->
<div id="welcomeLayer" class="layer active">
  <nav class="navbar">
    <div class="logo" onclick="showLayer('welcomeLayer')"><div class="logo-icon">&#8383;</div><span>CryptoPro</span></div>
    <div class="nav-links">
      <button class="nav-btn btn-login" onclick="showLayer('loginLayer')">Login</button>
      <button class="nav-btn btn-signup" onclick="showLayer('signupLayer')">Sign Up</button>
    </div>
  </nav>
  <div class="container">
    <div class="hero-section">
      <h1>The Future of Crypto Trading</h1>
      <p>Join 50,000+ successful traders earning daily profits with AI-powered automation. Get started with a <strong>$25 signup bonus</strong>!</p>
      <div class="hero-cta">
        <button class="hero-btn hero-btn-primary" onclick="showLayer('signupLayer')">Get Started &mdash; Free $25 Bonus</button>
        <button class="hero-btn hero-btn-secondary" onclick="showLayer('chartsLayer')">View Live Charts</button>
      </div>
    </div>
    <div class="live-traders-section">
      <div class="live-traders-title">LIVE ACTIVE TRADERS &mdash; REAL-TIME PROFITS</div>
      <div class="ticker-wrapper"><div class="ticker-content" id="liveTradersTicker"></div></div>
    </div>
    <div class="top-winners-section">
      <div class="top-winners-title">Top Traders This Week</div>
      <div class="winners-grid" id="topWinnersGrid"></div>
    </div>
    <div class="stats-section">
      <div class="stats-grid">
        <div class="stat-card"><div class="stat-icon">&#128101;</div><div class="stat-value">50,000+</div><div class="stat-label">Active Traders</div></div>
        <div class="stat-card"><div class="stat-icon">&#128176;</div><div class="stat-value">$125M+</div><div class="stat-label">Total Profits Paid</div></div>
        <div class="stat-card"><div class="stat-icon">&#128200;</div><div class="stat-value">98.5%</div><div class="stat-label">Success Rate</div></div>
        <div class="stat-card"><div class="stat-icon">&#9889;</div><div class="stat-value">15,000+</div><div class="stat-label">Daily Trades</div></div>
      </div>
    </div>
    <div class="action-buttons">
      <button class="action-btn" style="background:linear-gradient(135deg,#FCD535,#f59e0b);color:#000" onclick="showLayer('reviewsLayer')">See Reviews</button>
      <button class="action-btn btn-trade" onclick="showLayer('signupLayer')">Start Trading</button>
    </div>
  </div>
  <div class="whatsapp-support"><a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:28px">&#128172;</span><span>Support</span></a></div>
</div>

<!-- LAYER 2: Charts -->
<div id="chartsLayer" class="layer">
  <nav class="navbar">
    <div class="logo" onclick="showLayer('welcomeLayer')"><div class="logo-icon">&#8383;</div><span>CryptoPro</span></div>
    <div class="nav-links">
      <div class="status-badge"><span class="status-dot"></span><span>LIVE</span></div>
      <button class="nav-btn btn-signup" onclick="showLayer('signupLayer')">Sign Up</button>
    </div>
  </nav>
  <div class="container">
    <div class="chart-section">
      <div class="chart-header"><div class="chart-title">BTC/USDT Live Chart</div></div>
      <div class="price-info">
        <div><div class="current-price" id="currentPrice">$98,245.50</div><div style="font-size:12px;color:var(--text-secondary);margin-top:4px">Bitcoin / USDT</div></div>
        <div class="price-change positive" id="priceChange">+2.45%</div>
      </div>
      <div class="chart-labels">
        <div class="chart-label">High: <span id="chartHigh">$99,120</span></div>
        <div class="chart-label">Low: <span id="chartLow">$96,800</span></div>
        <div class="chart-label">Vol: <span id="chartVolume">28.5B</span></div>
        <div class="chart-label">Open: <span id="chartOpen">$97,850</span></div>
        <div class="chart-label">Close: <span id="chartClose">$98,245</span></div>
        <div class="chart-label">24h: <span id="chart24h">+2.45%</span></div>
      </div>
      <div class="chart-wrapper"><canvas id="chartCanvas"></canvas></div>
    </div>
  </div>
  <div class="whatsapp-support"><a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:28px">&#128172;</span><span>Support</span></a></div>
</div>

<!-- LAYER 3: Signup -->
<div id="signupLayer" class="layer">
  <div class="auth-container">
    <div style="text-align:center;margin-bottom:32px">
      <div style="font-size:60px;margin-bottom:12px;animation:pulse 2s infinite">&#128142;</div>
      <div style="font-size:32px;font-weight:900;background:linear-gradient(135deg,var(--accent-green),var(--accent-blue));-webkit-background-clip:text;-webkit-text-fill-color:transparent">CryptoPro</div>
    </div>
    <h2 style="text-align:center;margin-bottom:24px;font-size:24px;color:var(--accent-green)">Start Your Trading Journey</h2>
    <div id="signupAlert" class="alert"></div>
    <form id="signupForm" onsubmit="return handleSignup(event)">
      <div class="form-group"><label>Full Name</label><input type="text" id="signupName" placeholder="Enter your full name" required></div>
      <div class="form-group"><label>Email Address</label><input type="email" id="signupEmail" placeholder="your@email.com" required></div>
      <div class="form-group"><label>Phone Number</label><input type="tel" id="signupPhone" placeholder="+254 712 345 678" required></div>
      <div class="form-group"><label>Password</label><input type="password" id="signupPassword" placeholder="Create strong password" required></div>
      <div class="form-group"><label>Confirm Password</label><input type="password" id="signupConfirm" placeholder="Re-enter password" required></div>
      <div class="form-group"><label>Referral Code (Optional)</label><input type="text" id="signupReferralCode" placeholder="Enter referral code"></div>
      <button type="submit" class="btn-submit">Create Account &amp; Get $25 Bonus</button>
    </form>
    <div style="text-align:center;margin-top:24px;font-size:14px;color:var(--text-secondary)">Already have an account? <a onclick="showLayer('loginLayer')" style="color:var(--accent-green);cursor:pointer;font-weight:600">Login Here</a></div>
  </div>
  <div class="whatsapp-support"><a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:28px">&#128172;</span><span>Support</span></a></div>
</div>

<!-- LAYER 4: Login -->
<div id="loginLayer" class="layer">
  <div class="auth-container">
    <div style="text-align:center;margin-bottom:32px">
      <div style="font-size:60px;margin-bottom:12px;animation:pulse 2s infinite">&#128142;</div>
      <div style="font-size:32px;font-weight:900;background:linear-gradient(135deg,var(--accent-green),var(--accent-blue));-webkit-background-clip:text;-webkit-text-fill-color:transparent">CryptoPro</div>
    </div>
    <h2 style="text-align:center;margin-bottom:24px;font-size:24px;color:var(--accent-green)">Welcome Back</h2>
    <div id="loginAlert" class="alert"></div>
    <form id="loginForm" onsubmit="return handleLogin(event)">
      <div class="form-group"><label>Email Address</label><input type="email" id="loginEmail" placeholder="your@email.com" required></div>
      <div class="form-group"><label>Password</label><input type="password" id="loginPassword" placeholder="Enter your password" required></div>
      <button type="submit" class="btn-submit">Login</button>
    </form>
    <div style="text-align:center;margin-top:24px;font-size:14px;color:var(--text-secondary)">Don't have an account? <a onclick="showLayer('signupLayer')" style="color:var(--accent-green);cursor:pointer;font-weight:600">Create Account</a></div>
  </div>
  <div class="whatsapp-support"><a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:28px">&#128172;</span><span>Support</span></a></div>
</div>

<!-- LAYER 5: Dashboard -->
<div id="dashboardLayer" class="layer">
  <nav class="navbar">
    <div class="logo"><div class="logo-icon">&#8383;</div><span>CryptoPro</span></div>
    <div class="nav-links">
      <div class="status-badge"><span class="status-dot"></span><span>LIVE</span></div>
      <button class="nav-btn btn-login" onclick="handleLogout()">Logout</button>
    </div>
  </nav>
  <div class="container">
    <div style="background:var(--bg-secondary);padding:20px;border-radius:16px;margin-bottom:24px;border:1px solid var(--border-color)">
      <div style="display:flex;align-items:center;gap:12px">
        <div style="width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--accent-green),var(--accent-blue));display:flex;align-items:center;justify-content:center;font-size:24px">&#128100;</div>
        <div>
          <div style="font-size:18px;font-weight:700;color:var(--text-primary)" id="userName">User</div>
          <div style="font-size:13px;color:var(--text-secondary)" id="userEmail">email@example.com</div>
        </div>
      </div>
    </div>
    <div style="background:linear-gradient(135deg,rgba(14,203,129,0.2),rgba(0,217,255,0.2));border:2px solid var(--accent-green);border-radius:16px;padding:24px;margin-bottom:20px;text-align:center">
      <div style="font-size:14px;color:var(--text-secondary);margin-bottom:8px;text-transform:uppercase;letter-spacing:1px">YOUR BALANCE</div>
      <div style="font-size:56px;font-weight:900;color:var(--accent-green);text-shadow:0 0 20px rgba(14,203,129,0.5);margin-bottom:16px" id="dashBalance">$25.00</div>
      <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px">
        <div style="background:rgba(0,0,0,0.3);padding:12px;border-radius:8px"><div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px">Available</div><div style="font-size:16px;font-weight:700;color:var(--text-primary)" id="dashAvailable">$25.00</div></div>
        <div style="background:rgba(0,0,0,0.3);padding:12px;border-radius:8px"><div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px">In Trades</div><div style="font-size:16px;font-weight:700;color:var(--text-primary)">$0.00</div></div>
        <div style="background:rgba(0,0,0,0.3);padding:12px;border-radius:8px"><div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px">Total Profit</div><div style="font-size:16px;font-weight:700;color:var(--accent-green)" id="dashProfit">$0.00</div></div>
      </div>
    </div>
    <div class="action-buttons">
      <button class="action-btn btn-trade" onclick="showLayer('tradingLayer')">Trade Now</button>
      <button class="action-btn btn-deposit" onclick="showLayer('depositLayer')">Deposit</button>
    </div>
    <div class="chart-section">
      <div class="chart-header"><div class="chart-title">Live Market Overview</div></div>
      <div class="chart-wrapper small"><canvas id="dashCanvas"></canvas></div>
    </div>
  </div>
  <div class="whatsapp-support"><a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:28px">&#128172;</span><span>Support</span></a></div>
</div>

<!-- LAYER 6: Deposit -->
<div id="depositLayer" class="layer">
  <nav class="navbar">
    <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">&#8383;</div><span>CryptoPro</span></div>
    <div class="nav-links"><button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">&larr; Dashboard</button></div>
  </nav>
  <div class="container">
    <div class="hero-section"><h1>Deposit Funds</h1><p>Fund your account instantly. Credited within 5 minutes after verification.</p></div>
    <div class="chart-section">
      <div style="background:rgba(251,191,36,0.1);border:2px solid rgba(251,191,36,0.3);border-radius:12px;padding:20px;margin-bottom:20px;text-align:center">
        <div style="font-size:24px;font-weight:900;color:#fbbf24;margin-bottom:8px">100% WELCOME BONUS!</div>
        <div style="font-size:16px;color:var(--text-primary)">Deposit $100, get $200 to trade!</div>
      </div>
      <form onsubmit="return processDeposit(event)">
        <div class="form-group"><label>Deposit Amount (USD)</label><input type="number" id="depositAmount" min="10" step="0.01" placeholder="Minimum $10" required></div>
        <div class="form-group">
          <label>Select Payment Method</label>
          <div class="payment-method-selector">
            <button type="button" class="payment-method-btn" data-method="mpesa-phone">M-Pesa<br><small>+254759401893</small></button>
            <button type="button" class="payment-method-btn" data-method="mpesa-till">M-Pesa Till<br><small>7500448</small></button>
            <button type="button" class="payment-method-btn" data-method="bank">Bank Transfer<br><small>Equity Bank</small></button>
            <button type="button" class="payment-method-btn" data-method="crypto">Crypto USDT<br><small>TRC-20</small></button>
          </div>
        </div>
        <div id="mpesa-phone" class="payment-details">
          <div style="text-align:center;margin-bottom:16px"><div style="font-size:18px;font-weight:700;color:var(--accent-green)">M-Pesa Phone Number</div></div>
          <div class="payment-info"><div style="font-size:12px;color:var(--text-secondary);margin-bottom:8px">Phone Number:</div><div class="payment-value">+254759401893</div></div>
          <button type="button" class="copy-btn" data-copy="+254759401893">Copy Phone Number</button>
          <div style="background:rgba(14,203,129,0.05);border-left:4px solid var(--accent-green);padding:16px;border-radius:8px;margin-top:16px">
            <div style="font-size:14px;font-weight:700;color:var(--accent-green);margin-bottom:8px">How to Pay:</div>
            <ol style="font-size:13px;color:var(--text-primary);line-height:1.8;margin-left:20px">
              <li>M-Pesa &rarr; Send Money</li><li>Enter: <strong>+254759401893</strong></li><li>Enter amount &amp; PIN</li><li>Submit screenshot below</li>
            </ol>
          </div>
        </div>
        <div id="mpesa-till" class="payment-details">
          <div style="text-align:center;margin-bottom:16px"><div style="font-size:18px;font-weight:700;color:var(--accent-green)">M-Pesa Till Number</div></div>
          <div class="payment-info"><div style="font-size:12px;color:var(--text-secondary);margin-bottom:8px">Till Number:</div><div class="payment-value">7500448</div></div>
          <button type="button" class="copy-btn" data-copy="7500448">Copy Till Number</button>
          <div style="background:rgba(14,203,129,0.05);border-left:4px solid var(--accent-green);padding:16px;border-radius:8px;margin-top:16px">
            <ol style="font-size:13px;color:var(--text-primary);line-height:1.8;margin-left:20px">
              <li>M-Pesa &rarr; Lipa na M-Pesa</li><li>Buy Goods &amp; Services</li><li>Till: <strong>7500448</strong></li><li>Enter amount &amp; PIN</li>
            </ol>
          </div>
        </div>
        <div id="bank" class="payment-details">
          <div class="payment-info">
            <div style="margin-bottom:12px"><div style="font-size:12px;color:var(--text-secondary)">Bank Name:</div><div style="font-size:16px;font-weight:700">Equity Bank</div></div>
            <div style="margin-bottom:12px"><div style="font-size:12px;color:var(--text-secondary)">Account Name:</div><div style="font-size:16px;font-weight:700">Felix Kiprotich Koskei</div></div>
            <div><div style="font-size:12px;color:var(--text-secondary)">Account Number:</div><div class="payment-value">0310184912409</div></div>
          </div>
          <button type="button" class="copy-btn" data-copy="0310184912409">Copy Account Number</button>
        </div>
        <div id="crypto" class="payment-details">
          <div class="payment-info">
            <div style="font-size:12px;color:var(--text-secondary);margin-bottom:8px">Network: <strong style="color:var(--accent-yellow)">TRC-20 (Tron)</strong></div>
            <div class="payment-value" style="font-size:14px">TK4rUz6TUEd7zCWeuiX5R47pSNdPswJnAc</div>
          </div>
          <button type="button" class="copy-btn" data-copy="TK4rUz6TUEd7zCWeuiX5R47pSNdPswJnAc">Copy Wallet Address</button>
          <div style="background:rgba(246,70,93,0.1);border:2px solid rgba(246,70,93,0.3);border-radius:12px;padding:16px;margin-top:16px">
            <div style="font-size:13px;font-weight:700;color:var(--accent-red)">WARNING: TRC-20 ONLY &mdash; wrong network = lost funds</div>
          </div>
        </div>
        <div class="form-group" style="margin-top:20px"><label>Payment Proof Screenshot</label><textarea id="depositProof" rows="4" placeholder="Paste payment screenshot or describe your transaction..." required style="min-height:100px"></textarea></div>
        <button type="submit" class="btn-submit">SUBMIT DEPOSIT REQUEST</button>
      </form>
    </div>
  </div>
  <div class="whatsapp-support"><a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:28px">&#128172;</span><span>Support</span></a></div>
</div>

<!-- LAYER 7: Trading -->
<div id="tradingLayer" class="layer">
  <nav class="navbar">
    <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">&#8383;</div><span>CryptoPro</span></div>
    <div class="nav-links">
      <div class="status-badge"><span class="status-dot"></span><span>LIVE TRADING</span></div>
      <button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">&larr; Dashboard</button>
    </div>
  </nav>
  <div class="container">
    <div style="display:grid;grid-template-columns:2fr 1fr;gap:20px;margin-bottom:20px">
      <div class="chart-section">
        <div class="price-info">
          <div><div class="current-price" id="tradePrice">$98,245.50</div><div style="font-size:12px;color:var(--text-secondary);margin-top:4px">BTC/USDT</div></div>
          <div class="price-change positive" id="tradePriceChange">+2.45%</div>
        </div>
        <div class="chart-wrapper"><canvas id="tradeCanvas"></canvas></div>
      </div>
      <div class="chart-section">
        <div style="text-align:center;margin-bottom:20px">
          <div style="font-size:20px;font-weight:700;color:var(--accent-green);margin-bottom:8px">Quick Trade</div>
          <div style="font-size:13px;color:var(--text-secondary)">AI-Powered Instant Execution</div>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:20px">
          <button id="buyTab" class="payment-method-btn active" data-trade-type="buy">BUY</button>
          <button id="sellTab" class="payment-method-btn" data-trade-type="sell">SELL</button>
        </div>
        <form id="tradeForm" onsubmit="return executeTrade(event)">
          <div class="form-group">
            <label>Investment Amount (USD)</label>
            <input type="number" id="tradeAmount" min="10" step="0.01" placeholder="Min: $10" required>
            <div style="font-size:12px;color:var(--text-secondary);margin-top:8px">Available: $<span id="availableBalance">25.00</span></div>
          </div>
          <div class="form-group">
            <label>Leverage</label>
            <select id="tradeLeverage">
              <option value="1">1x (No Leverage)</option>
              <option value="2">2x (Double)</option>
              <option value="5" selected>5x (Recommended)</option>
              <option value="10">10x (High Risk)</option>
              <option value="20">20x (Expert Only)</option>
            </select>
          </div>
          <div class="form-group">
            <label>Trade Duration</label>
            <select id="tradeDuration">
              <option value="60">1 Minute</option>
              <option value="300" selected>5 Minutes</option>
              <option value="900">15 Minutes</option>
              <option value="1800">30 Minutes</option>
              <option value="3600">1 Hour</option>
            </select>
          </div>
          <div style="background:rgba(14,203,129,0.1);border:2px solid rgba(14,203,129,0.3);border-radius:12px;padding:16px;margin-bottom:20px">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;text-align:center">
              <div><div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px">Potential Profit</div><div style="font-size:20px;font-weight:700;color:var(--accent-green)" id="potentialProfit">$0.00</div></div>
              <div><div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px">ROI</div><div style="font-size:20px;font-weight:700;color:var(--accent-yellow)" id="potentialROI">0%</div></div>
            </div>
          </div>
          <button type="submit" class="btn-submit" id="tradeButton">EXECUTE BUY TRADE</button>
        </form>
        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;margin-top:16px">
          <button type="button" data-amount="10" style="padding:8px;border:1px solid var(--border-color);background:var(--bg-tertiary);color:var(--text-primary);border-radius:8px;cursor:pointer;font-size:12px">$10</button>
          <button type="button" data-amount="25" style="padding:8px;border:1px solid var(--border-color);background:var(--bg-tertiary);color:var(--text-primary);border-radius:8px;cursor:pointer;font-size:12px">$25</button>
          <button type="button" data-amount="50" style="padding:8px;border:1px solid var(--border-color);background:var(--bg-tertiary);color:var(--text-primary);border-radius:8px;cursor:pointer;font-size:12px">$50</button>
          <button type="button" data-amount="100" style="padding:8px;border:1px solid var(--border-color);background:var(--bg-tertiary);color:var(--text-primary);border-radius:8px;cursor:pointer;font-size:12px">$100</button>
        </div>
      </div>
    </div>
    <div class="chart-section">
      <div class="chart-header"><div class="chart-title">Active Trades</div></div>
      <div id="activeTradesContainer"></div>
    </div>
  </div>
  <div class="whatsapp-support"><a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:28px">&#128172;</span><span>Support</span></a></div>
</div>

<!-- LAYER 8: History -->
<div id="historyLayer" class="layer">
  <nav class="navbar">
    <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">&#8383;</div><span>CryptoPro</span></div>
    <div class="nav-links"><button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">&larr; Dashboard</button></div>
  </nav>
  <div class="container">
    <div class="hero-section"><h1>Trade History</h1><p>Complete record of all your trading activity</p></div>
    <div class="stats-section">
      <div class="stats-grid">
        <div class="stat-card"><div class="stat-icon">&#128202;</div><div class="stat-value" id="historyTotalTrades">0</div><div class="stat-label">Total Trades</div></div>
        <div class="stat-card"><div class="stat-icon">&#10003;</div><div class="stat-value" id="historyWinRate">0%</div><div class="stat-label">Win Rate</div></div>
        <div class="stat-card"><div class="stat-icon">&#128176;</div><div class="stat-value" id="historyTotalProfit">$0.00</div><div class="stat-label">Total Profit</div></div>
        <div class="stat-card"><div class="stat-icon">&#127942;</div><div class="stat-value" id="historyBestTrade">$0.00</div><div class="stat-label">Best Trade</div></div>
      </div>
    </div>
    <div class="chart-section"><div class="chart-header"><div class="chart-title">Recent Trades</div></div><div id="tradeHistoryTable"></div></div>
  </div>
  <div class="whatsapp-support"><a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:28px">&#128172;</span><span>Support</span></a></div>
</div>

<!-- LAYER 9: Withdrawal -->
<div id="withdrawalLayer" class="layer">
  <nav class="navbar">
    <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">&#8383;</div><span>CryptoPro</span></div>
    <div class="nav-links"><button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">&larr; Dashboard</button></div>
  </nav>
  <div class="container">
    <div class="hero-section"><h1>Withdraw Funds</h1><p>Fast and secure withdrawals processed within 24 hours.</p></div>
    <div class="chart-section">
      <div style="background:rgba(14,203,129,0.1);border:2px solid rgba(14,203,129,0.3);border-radius:12px;padding:20px;margin-bottom:20px;text-align:center">
        <div style="font-size:14px;color:var(--text-secondary);margin-bottom:8px">Available for Withdrawal</div>
        <div style="font-size:48px;font-weight:900;color:var(--accent-green)" id="withdrawAvailable">$0.00</div>
      </div>
      <form id="withdrawalForm" onsubmit="return processWithdrawal(event)">
        <div class="form-group"><label>Withdrawal Amount (USD)</label><input type="number" id="withdrawAmount" min="50" step="0.01" placeholder="Minimum $50" required><div style="font-size:12px;color:var(--text-secondary);margin-top:8px">Min: $50 | Max: $<span id="maxWithdraw">0.00</span></div></div>
        <div class="form-group">
          <label>Withdrawal Method</label>
          <div class="payment-method-selector">
            <button type="button" class="payment-method-btn" data-withdraw-method="mpesa">M-Pesa</button>
            <button type="button" class="payment-method-btn" data-withdraw-method="bank">Bank Transfer</button>
            <button type="button" class="payment-method-btn" data-withdraw-method="crypto">Crypto (USDT)</button>
          </div>
        </div>
        <div id="withdraw-mpesa" class="payment-details">
          <div class="form-group"><label>M-Pesa Phone Number</label><input type="tel" id="withdrawMpesaPhone" placeholder="+254 712 345 678"></div>
          <div class="form-group"><label>Full Name (as registered)</label><input type="text" id="withdrawMpesaName" placeholder="Enter full name"></div>
        </div>
        <div id="withdraw-bank" class="payment-details">
          <div class="form-group"><label>Bank Name</label><input type="text" id="withdrawBankName" placeholder="e.g., Equity Bank"></div>
          <div class="form-group"><label>Account Number</label><input type="text" id="withdrawBankAccount" placeholder="Enter account number"></div>
          <div class="form-group"><label>Account Name</label><input type="text" id="withdrawBankAccountName" placeholder="Full name on account"></div>
        </div>
        <div id="withdraw-crypto" class="payment-details">
          <div class="form-group"><label>USDT Wallet Address (TRC-20)</label><input type="text" id="withdrawCryptoAddress" placeholder="TRC-20 USDT wallet address"></div>
          <div style="background:rgba(246,70,93,0.1);border:2px solid rgba(246,70,93,0.3);border-radius:12px;padding:16px;margin-top:12px"><div style="font-size:13px;font-weight:700;color:var(--accent-red)">TRC-20 only &mdash; wrong address = lost funds</div></div>
        </div>
        <div style="background:rgba(0,217,255,0.1);border:2px solid rgba(0,217,255,0.3);border-radius:12px;padding:20px;margin:20px 0">
          <div style="font-size:14px;font-weight:700;color:var(--accent-blue);margin-bottom:12px">Withdrawal Info</div>
          <div style="font-size:13px;color:var(--text-primary);line-height:1.8">Min: $50 &bull; Processing: 24-48 hrs &bull; Fee: 2%</div>
        </div>
        <button type="submit" class="btn-submit">REQUEST WITHDRAWAL</button>
      </form>
    </div>
    <div class="chart-section"><div class="chart-header"><div class="chart-title">Recent Withdrawals</div></div><div id="withdrawalHistoryContainer"></div></div>
  </div>
  <div class="whatsapp-support"><a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:28px">&#128172;</span><span>Support</span></a></div>
</div>

<!-- LAYER 10: Referrals -->
<div id="referralLayer" class="layer">
  <nav class="navbar">
    <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">&#8383;</div><span>CryptoPro</span></div>
    <div class="nav-links"><button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">&larr; Dashboard</button></div>
  </nav>
  <div class="container">
    <div class="hero-section"><h1>Refer &amp; Earn</h1><p>Invite friends and earn <strong>20% commission</strong> on all their trading fees for life!</p></div>
    <div class="stats-section">
      <div class="stats-grid">
        <div class="stat-card"><div class="stat-icon">&#128101;</div><div class="stat-value" id="totalReferrals">0</div><div class="stat-label">Total Referrals</div></div>
        <div class="stat-card"><div class="stat-icon">&#128176;</div><div class="stat-value" id="referralEarnings">$0.00</div><div class="stat-label">Total Earnings</div></div>
        <div class="stat-card"><div class="stat-icon">&#128200;</div><div class="stat-value" id="activeReferrals">0</div><div class="stat-label">Active Traders</div></div>
        <div class="stat-card"><div class="stat-icon">&#127919;</div><div class="stat-value">20%</div><div class="stat-label">Commission Rate</div></div>
      </div>
    </div>
    <div class="chart-section">
      <div style="background:rgba(14,203,129,0.1);border:2px solid rgba(14,203,129,0.3);border-radius:12px;padding:20px">
        <div class="payment-info"><div style="font-size:12px;color:var(--text-secondary);margin-bottom:8px">Your Referral Code:</div><div class="payment-value" id="referralCode">CRP123456</div></div>
        <div class="payment-info" style="margin-top:12px"><div style="font-size:12px;color:var(--text-secondary);margin-bottom:8px">Your Referral Link:</div><div class="payment-value" style="font-size:14px" id="referralLink">https://cryptopro.com/?ref=CRP123456</div></div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:16px">
          <button class="copy-btn" onclick="copyReferralCode()">Copy Code</button>
          <button class="copy-btn" onclick="copyReferralLink()">Copy Link</button>
        </div>
      </div>
      <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:20px">
        <button onclick="shareWhatsApp()" style="padding:16px;background:linear-gradient(135deg,#25D366,#128C7E);color:white;border:none;border-radius:12px;font-weight:600;cursor:pointer">Share on WhatsApp</button>
        <button onclick="shareTelegram()" style="padding:16px;background:linear-gradient(135deg,#0088cc,#0066aa);color:white;border:none;border-radius:12px;font-weight:600;cursor:pointer">Share on Telegram</button>
      </div>
    </div>
    <div class="chart-section"><div class="chart-header"><div class="chart-title">Your Referrals</div></div><div id="referralListContainer"></div></div>
  </div>
  <div class="whatsapp-support"><a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:28px">&#128172;</span><span>Support</span></a></div>
</div>

<!-- LAYER 11: Reviews -->
<div id="reviewsLayer" class="layer">
  <nav class="navbar">
    <div class="logo" onclick="showLayer('welcomeLayer')"><div class="logo-icon">&#8383;</div><span>CryptoPro</span></div>
    <div class="nav-links"><button class="nav-btn btn-signup" onclick="showLayer('signupLayer')">Sign Up</button></div>
  </nav>
  <div class="container">
    <div class="hero-section">
      <h1>What Our Traders Say</h1>
      <p>Real reviews from real traders making real profits with CryptoPro</p>
      <div style="font-size:40px;margin-top:16px">&#11088;&#11088;&#11088;&#11088;&#11088;</div>
      <div style="font-size:18px;font-weight:700;color:var(--accent-green);margin-top:12px">4.9/5.0 Rating from 15,000+ Reviews</div>
    </div>
    <div id="reviewsGrid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:20px"></div>
  </div>
  <div class="whatsapp-support"><a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:28px">&#128172;</span><span>Support</span></a></div>
</div>

<!-- LAYER 12: Profile -->
<div id="profileLayer" class="layer">
  <nav class="navbar">
    <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">&#8383;</div><span>CryptoPro</span></div>
    <div class="nav-links"><button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">&larr; Dashboard</button></div>
  </nav>
  <div class="container">
    <div class="hero-section"><h1>Account Settings</h1><p>Manage your profile and trading preferences</p></div>
    <div class="chart-section">
      <div class="chart-header"><div class="chart-title">Account Information</div></div>
      <div style="background:var(--bg-tertiary);border-radius:12px;padding:24px">
        <div style="display:grid;gap:16px">
          <div><div style="font-size:12px;color:var(--text-secondary);margin-bottom:4px">Full Name</div><div style="font-size:16px;font-weight:600" id="profileName">-</div></div>
          <div><div style="font-size:12px;color:var(--text-secondary);margin-bottom:4px">Email</div><div style="font-size:16px;font-weight:600" id="profileEmail">-</div></div>
          <div><div style="font-size:12px;color:var(--text-secondary);margin-bottom:4px">Phone</div><div style="font-size:16px;font-weight:600" id="profilePhone">-</div></div>
          <div><div style="font-size:12px;color:var(--text-secondary);margin-bottom:4px">Referral Code</div><div style="font-size:16px;font-weight:600;color:var(--accent-green)" id="profileReferralCode">-</div></div>
          <div><div style="font-size:12px;color:var(--text-secondary);margin-bottom:4px">Member Since</div><div style="font-size:16px;font-weight:600" id="profileJoinDate">-</div></div>
        </div>
      </div>
    </div>
    <div class="stats-section">
      <div class="stats-grid">
        <div class="stat-card"><div class="stat-icon">&#128176;</div><div class="stat-value" id="profileBalance">$0.00</div><div class="stat-label">Current Balance</div></div>
        <div class="stat-card"><div class="stat-icon">&#128202;</div><div class="stat-value" id="profileTotalTrades">0</div><div class="stat-label">Total Trades</div></div>
        <div class="stat-card"><div class="stat-icon">&#128200;</div><div class="stat-value" id="profileTotalProfit">$0.00</div><div class="stat-label">Total Profit</div></div>
        <div class="stat-card"><div class="stat-icon">&#128101;</div><div class="stat-value" id="profileReferrals">0</div><div class="stat-label">Referrals</div></div>
      </div>
    </div>
    <div class="action-buttons">
      <button class="action-btn btn-trade" onclick="showLayer('tradingLayer')">Start Trading</button>
      <button class="action-btn btn-deposit" onclick="showLayer('depositLayer')">Deposit Funds</button>
      <button class="action-btn" style="background:linear-gradient(135deg,var(--accent-red),#cc0055);color:white" onclick="handleLogout()">Logout</button>
    </div>
    <div class="chart-section">
      <div style="background:rgba(14,203,129,0.1);border:2px solid rgba(14,203,129,0.3);border-radius:12px;padding:20px;text-align:center">
        <div style="font-size:48px;margin-bottom:12px">&#10003;</div>
        <div style="font-size:18px;font-weight:700;color:var(--accent-green);margin-bottom:8px">Account Verified</div>
        <div style="font-size:14px;color:var(--text-primary)">Fully verified and ready for trading &amp; withdrawals</div>
      </div>
    </div>
  </div>
  <div class="whatsapp-support"><a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:28px">&#128172;</span><span>Support</span></a></div>
</div>

<!-- LAYER 13: Trading Bots -->
<div id="robotsLayer" class="layer">
  <nav class="navbar">
    <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">&#8383;</div><span>CryptoPro</span></div>
    <div class="nav-links">
      <div class="status-badge"><span class="status-dot"></span><span>AI ACTIVE</span></div>
      <button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">&larr; Dashboard</button>
    </div>
  </nav>
  <div class="container">
    <div class="hero-section"><h1>AI Trading Bots</h1><p>Fully automated bots powered by machine learning. Earn 24/7 while you sleep.</p></div>
    <div class="stats-section">
      <div class="stats-grid">
        <div class="stat-card"><div class="stat-icon">&#129302;</div><div class="stat-value" id="activeBotCount">0</div><div class="stat-label">Active Bots</div></div>
        <div class="stat-card"><div class="stat-icon">&#128176;</div><div class="stat-value" id="botTotalEarnedDisplay">$0.00</div><div class="stat-label">Bot Earnings</div></div>
        <div class="stat-card"><div class="stat-icon">&#128200;</div><div class="stat-value">98.7%</div><div class="stat-label">Win Rate</div></div>
        <div class="stat-card"><div class="stat-icon">&#9889;</div><div class="stat-value">24/7</div><div class="stat-label">Always Running</div></div>
      </div>
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin-bottom:24px">

      <!-- Scalper Bot -->
      <div class="bot-card" id="botCard-scalper">
        <div class="bot-icon" style="background:linear-gradient(135deg,#0ECB81,#0B8F5F)">&#9889;</div>
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
          <div style="font-size:20px;font-weight:800">Scalper Bot</div>
          <span style="background:rgba(14,203,129,0.15);color:var(--accent-green);padding:4px 12px;border-radius:20px;font-size:12px;font-weight:700">FREE</span>
        </div>
        <div style="font-size:13px;color:var(--text-secondary);margin-bottom:16px;line-height:1.6">High-frequency bot. Executes 50-100 micro trades per hour capturing small consistent gains.</div>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:20px">
          <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;text-align:center"><div style="font-size:10px;color:var(--text-secondary)">Daily ROI</div><div style="font-size:16px;font-weight:700;color:var(--accent-green)">3-8%</div></div>
          <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;text-align:center"><div style="font-size:10px;color:var(--text-secondary)">Risk</div><div style="font-size:16px;font-weight:700;color:var(--accent-yellow)">Low</div></div>
          <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;text-align:center"><div style="font-size:10px;color:var(--text-secondary)">Min</div><div style="font-size:16px;font-weight:700;color:var(--accent-blue)">$10</div></div>
        </div>
        <div style="margin-bottom:16px"><div style="font-size:12px;color:var(--text-secondary);margin-bottom:6px">Allocation Amount ($)</div><input type="number" id="botAmount-scalper" min="10" step="1" placeholder="e.g. 50" style="width:100%;padding:10px 14px;border:2px solid var(--border-color);border-radius:8px;background:var(--bg-primary);color:var(--text-primary);font-size:14px"></div>
        <div id="botStatus-scalper" style="display:none;margin-bottom:12px;padding:10px;background:rgba(14,203,129,0.1);border-radius:8px;font-size:13px;color:var(--accent-green);text-align:center"><span class="bot-running-indicator"></span> BOT RUNNING &mdash; Earned: <strong id="botEarned-scalper">$0.00</strong></div>
        <button class="btn-submit" id="botBtn-scalper" onclick="toggleBot('scalper')" style="margin-top:0">Start Scalper Bot</button>
      </div>

      <!-- Trend Rider -->
      <div class="bot-card" id="botCard-trend">
        <div class="bot-icon" style="background:linear-gradient(135deg,#00d9ff,#0099cc)">&#128200;</div>
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
          <div style="font-size:20px;font-weight:800">Trend Rider</div>
          <span style="background:rgba(0,217,255,0.15);color:var(--accent-blue);padding:4px 12px;border-radius:20px;font-size:12px;font-weight:700">POPULAR</span>
        </div>
        <div style="font-size:13px;color:var(--text-secondary);margin-bottom:16px;line-height:1.6">AI identifies major market trends and rides them for maximum profit capture.</div>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:20px">
          <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;text-align:center"><div style="font-size:10px;color:var(--text-secondary)">Daily ROI</div><div style="font-size:16px;font-weight:700;color:var(--accent-green)">8-15%</div></div>
          <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;text-align:center"><div style="font-size:10px;color:var(--text-secondary)">Risk</div><div style="font-size:16px;font-weight:700;color:var(--accent-blue)">Medium</div></div>
          <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;text-align:center"><div style="font-size:10px;color:var(--text-secondary)">Min</div><div style="font-size:16px;font-weight:700;color:var(--accent-blue)">$50</div></div>
        </div>
        <div style="margin-bottom:16px"><div style="font-size:12px;color:var(--text-secondary);margin-bottom:6px">Allocation Amount ($)</div><input type="number" id="botAmount-trend" min="50" step="1" placeholder="e.g. 100" style="width:100%;padding:10px 14px;border:2px solid var(--border-color);border-radius:8px;background:var(--bg-primary);color:var(--text-primary);font-size:14px"></div>
        <div id="botStatus-trend" style="display:none;margin-bottom:12px;padding:10px;background:rgba(14,203,129,0.1);border-radius:8px;font-size:13px;color:var(--accent-green);text-align:center"><span class="bot-running-indicator"></span> BOT RUNNING &mdash; Earned: <strong id="botEarned-trend">$0.00</strong></div>
        <button class="btn-submit" id="botBtn-trend" onclick="toggleBot('trend')" style="margin-top:0">Start Trend Rider</button>
      </div>

      <!-- Arbitrage Pro -->
      <div class="bot-card premium" id="botCard-arb">
        <div class="bot-icon" style="background:linear-gradient(135deg,#FCD535,#f59e0b)">&#9878;</div>
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
          <div style="font-size:20px;font-weight:800">Arbitrage Pro</div>
          <span style="background:rgba(252,213,53,0.15);color:var(--accent-yellow);padding:4px 12px;border-radius:20px;font-size:12px;font-weight:700">PREMIUM</span>
        </div>
        <div style="font-size:13px;color:var(--text-secondary);margin-bottom:16px;line-height:1.6">Exploits price differences across 12 exchanges simultaneously. Near-zero risk.</div>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:20px">
          <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;text-align:center"><div style="font-size:10px;color:var(--text-secondary)">Daily ROI</div><div style="font-size:16px;font-weight:700;color:var(--accent-green)">15-25%</div></div>
          <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;text-align:center"><div style="font-size:10px;color:var(--text-secondary)">Risk</div><div style="font-size:16px;font-weight:700;color:var(--accent-green)">Very Low</div></div>
          <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;text-align:center"><div style="font-size:10px;color:var(--text-secondary)">Min</div><div style="font-size:16px;font-weight:700;color:var(--accent-blue)">$200</div></div>
        </div>
        <div style="margin-bottom:16px"><div style="font-size:12px;color:var(--text-secondary);margin-bottom:6px">Allocation Amount ($)</div><input type="number" id="botAmount-arb" min="200" step="1" placeholder="e.g. 200" style="width:100%;padding:10px 14px;border:2px solid var(--border-color);border-radius:8px;background:var(--bg-primary);color:var(--text-primary);font-size:14px"></div>
        <div id="botStatus-arb" style="display:none;margin-bottom:12px;padding:10px;background:rgba(14,203,129,0.1);border-radius:8px;font-size:13px;color:var(--accent-green);text-align:center"><span class="bot-running-indicator"></span> BOT RUNNING &mdash; Earned: <strong id="botEarned-arb">$0.00</strong></div>
        <button class="btn-submit" id="botBtn-arb" onclick="toggleBot('arb')" style="margin-top:0;background:linear-gradient(135deg,#FCD535,#f59e0b);color:#000">Start Arbitrage Pro</button>
      </div>

      <!-- AI Oracle -->
      <div class="bot-card premium" id="botCard-ai">
        <div class="bot-icon" style="background:linear-gradient(135deg,#8b5cf6,#7c3aed)">&#129504;</div>
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
          <div style="font-size:20px;font-weight:800">AI Oracle</div>
          <span style="background:rgba(139,92,246,0.15);color:#8b5cf6;padding:4px 12px;border-radius:20px;font-size:12px;font-weight:700">AI ELITE</span>
        </div>
        <div style="font-size:13px;color:var(--text-secondary);margin-bottom:16px;line-height:1.6">Deep learning trained on 10 years of data. Predicts price movements with 94% accuracy.</div>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:20px">
          <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;text-align:center"><div style="font-size:10px;color:var(--text-secondary)">Daily ROI</div><div style="font-size:16px;font-weight:700;color:var(--accent-green)">20-40%</div></div>
          <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;text-align:center"><div style="font-size:10px;color:var(--text-secondary)">Accuracy</div><div style="font-size:16px;font-weight:700;color:#8b5cf6">94%</div></div>
          <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;text-align:center"><div style="font-size:10px;color:var(--text-secondary)">Min</div><div style="font-size:16px;font-weight:700;color:var(--accent-blue)">$500</div></div>
        </div>
        <div style="margin-bottom:16px"><div style="font-size:12px;color:var(--text-secondary);margin-bottom:6px">Allocation Amount ($)</div><input type="number" id="botAmount-ai" min="500" step="1" placeholder="e.g. 500" style="width:100%;padding:10px 14px;border:2px solid var(--border-color);border-radius:8px;background:var(--bg-primary);color:var(--text-primary);font-size:14px"></div>
        <div id="botStatus-ai" style="display:none;margin-bottom:12px;padding:10px;background:rgba(14,203,129,0.1);border-radius:8px;font-size:13px;color:var(--accent-green);text-align:center"><span class="bot-running-indicator"></span> BOT RUNNING &mdash; Earned: <strong id="botEarned-ai">$0.00</strong></div>
        <button class="btn-submit" id="botBtn-ai" onclick="toggleBot('ai')" style="margin-top:0;background:linear-gradient(135deg,#8b5cf6,#7c3aed)">Start AI Oracle</button>
      </div>
    </div>

    <div class="chart-section">
      <div class="chart-header"><div class="chart-title">Bot Activity Log</div></div>
      <div id="botActivityLog" style="max-height:300px;overflow-y:auto">
        <div style="text-align:center;padding:40px;color:var(--text-secondary)">No bots running yet. Start a bot above.</div>
      </div>
    </div>
  </div>
  <div class="whatsapp-support"><a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:28px">&#128172;</span><span>Support</span></a></div>
</div>

<!-- LAYER 14: Portfolio -->
<div id="portfolioLayer" class="layer">
  <nav class="navbar">
    <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">&#8383;</div><span>CryptoPro</span></div>
    <div class="nav-links"><button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">&larr; Dashboard</button></div>
  </nav>
  <div class="container">
    <div class="hero-section"><h1>My Portfolio</h1><p>Track your assets, performance, and overall investment health.</p></div>
    <div style="background:linear-gradient(135deg,rgba(14,203,129,0.15),rgba(0,217,255,0.15));border:2px solid var(--accent-green);border-radius:16px;padding:28px;margin-bottom:20px;text-align:center">
      <div style="font-size:13px;color:var(--text-secondary);text-transform:uppercase;letter-spacing:1px;margin-bottom:8px">Total Portfolio Value</div>
      <div style="font-size:56px;font-weight:900;color:var(--accent-green);text-shadow:0 0 20px rgba(14,203,129,0.4);margin-bottom:16px" id="portfolioTotalValue">$0.00</div>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px">
        <div style="background:rgba(0,0,0,0.3);padding:12px;border-radius:8px"><div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px">Deposited</div><div style="font-size:15px;font-weight:700" id="portfolioDeposited">$0.00</div></div>
        <div style="background:rgba(0,0,0,0.3);padding:12px;border-radius:8px"><div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px">Profit</div><div style="font-size:15px;font-weight:700;color:var(--accent-green)" id="portfolioProfit">$0.00</div></div>
        <div style="background:rgba(0,0,0,0.3);padding:12px;border-radius:8px"><div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px">ROI</div><div style="font-size:15px;font-weight:700;color:var(--accent-yellow)" id="portfolioROI">0%</div></div>
        <div style="background:rgba(0,0,0,0.3);padding:12px;border-radius:8px"><div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px">Win Rate</div><div style="font-size:15px;font-weight:700;color:var(--accent-blue)" id="portfolioWinRate">0%</div></div>
      </div>
    </div>
    <div class="chart-section"><div class="chart-header"><div class="chart-title">Asset Allocation</div></div><div id="portfolioAllocation"></div></div>
    <div class="chart-section"><div class="chart-header"><div class="chart-title">Your Holdings</div></div><div id="portfolioHoldings"></div></div>
    <div class="chart-section">
      <div class="chart-header"><div class="chart-title">Portfolio Performance (30 Days)</div></div>
      <div class="chart-wrapper" style="height:260px"><canvas id="portfolioCanvas"></canvas></div>
    </div>
    <div class="chart-section"><div class="chart-header"><div class="chart-title">Recent Activity</div></div><div id="portfolioActivity"></div></div>
  </div>
  <div class="whatsapp-support"><a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:28px">&#128172;</span><span>Support</span></a></div>
</div>
<script>
// ===== GLOBAL STATE =====
var currentUser=null,currentBalance=25,currentProfit=0;
var MPESA_NUMBER='+254759401893',MPESA_TILL='7500448';
var chartAnimationFrame=null,chartDataPoints=[],chartOffset=0;
var currentTradeType='buy',activeTrades=[],tradeHistory=[];
var selectedPaymentMethod=null,selectedWithdrawMethod=null;
var withdrawalHistory=[],referrals=[];
var activeBots={},botTotalEarned=0,botLogEntries=[];

// ===== INIT =====
window.onload=function(){
  var urlParams=new URLSearchParams(window.location.search);
  var ref=urlParams.get('ref');
  if(ref){
    var el=document.getElementById('signupReferralCode');
    if(el)el.value=ref;
    var names=['John','Sarah','Michael','David','Emma','Felix'];
    var rn=document.getElementById('referrerName');
    if(rn)rn.textContent=names[Math.floor(Math.random()*names.length)];
    var banner=document.getElementById('referralSuccessBanner');
    if(banner)banner.classList.add('show');
  }
  initWelcomePage();
  var saved=localStorage.getItem('cryptoproUser');
  if(saved){currentUser=JSON.parse(saved);currentBalance=currentUser.balance||25;currentProfit=currentUser.profit||0;}
  initChartData();
  loadUserData();
  setupEvents();
};

function setupEvents(){
  document.addEventListener('click',function(e){
    var d=e.target.closest('[data-method]');
    if(d)selectPaymentMethod(d.getAttribute('data-method'));
    var w=e.target.closest('[data-withdraw-method]');
    if(w)selectWithdrawMethod(w.getAttribute('data-withdraw-method'));
    var tt=e.target.closest('[data-trade-type]');
    if(tt)switchTradeTab(tt.getAttribute('data-trade-type'));
    var am=e.target.closest('[data-amount]');
    if(am)setTradeAmount(parseFloat(am.getAttribute('data-amount')));
    var cp=e.target.closest('[data-copy]');
    if(cp)copyToClipboard(cp.getAttribute('data-copy'));
  });
  var ai=document.getElementById('tradeAmount');
  var ls=document.getElementById('tradeLeverage');
  if(ai)ai.addEventListener('input',calcProfit);
  if(ls)ls.addEventListener('change',calcProfit);
}

function closeReferralBanner(){document.getElementById('referralSuccessBanner').classList.remove('show');}

function showToast(msg,type){
  var t=document.getElementById('toastNotification');
  if(!t)return;
  t.textContent=msg;
  t.style.background=type==='error'?'linear-gradient(135deg,#F6465D,#cc0055)':'linear-gradient(135deg,#0ECB81,#0B8F5F)';
  t.classList.add('show');
  setTimeout(function(){t.style.animation='fadeOut 0.5s';setTimeout(function(){t.classList.remove('show');t.style.animation='';},500);},4000);
}

function showLayer(id){
  if(chartAnimationFrame){cancelAnimationFrame(chartAnimationFrame);chartAnimationFrame=null;}
  document.querySelectorAll('.layer').forEach(function(l){l.classList.remove('active');});
  var el=document.getElementById(id);
  if(!el)return;
  el.classList.add('active');
  if(id==='dashboardLayer'){
    if(currentUser){
      setText('userName',currentUser.name);
      setText('userEmail',currentUser.email);
      setText('dashBalance','$'+currentBalance.toFixed(2));
      setText('dashProfit','$'+currentProfit.toFixed(2));
      setText('dashAvailable','$'+currentBalance.toFixed(2));
    }
    setTimeout(function(){startChart('dashCanvas');},100);
    addDashNav();
  }
  if(id==='chartsLayer'){
    setTimeout(function(){startChart('chartCanvas');updatePriceInfo();setInterval(updatePriceInfo,3000);},100);
  }
  if(id==='tradingLayer'){
    updateBalDisplay();
    setTimeout(function(){
      startChart('tradeCanvas');
      updateActiveTrades();
      setInterval(function(){var p=chartDataPoints[chartDataPoints.length-1];setText('tradePrice','$'+p.toFixed(2));},1000);
    },100);
  }
  if(id==='historyLayer')updateTradeHistory();
  if(id==='withdrawalLayer'){updateBalDisplay();updateWithdrawalHistory();}
  if(id==='referralLayer')updateReferralStats();
  if(id==='reviewsLayer')generateReviews();
  if(id==='profileLayer')updateProfilePage();
  if(id==='robotsLayer')updateRobotsPage();
  if(id==='portfolioLayer')updatePortfolioPage();
}

function setText(id,val){var e=document.getElementById(id);if(e)e.textContent=val;}

function addDashNav(){
  if(!currentUser||document.getElementById('dashNavBtns'))return;
  var c=document.querySelector('#dashboardLayer .container');
  if(!c)return;
  var d=document.createElement('div');
  d.id='dashNavBtns';d.className='action-buttons';d.style.marginTop='20px';
  d.innerHTML='<button class="action-btn" style="background:linear-gradient(135deg,#3b82f6,#2563eb);color:white" onclick="showLayer(\'historyLayer\')">Trade History</button>'+
    '<button class="action-btn" style="background:linear-gradient(135deg,#8b5cf6,#7c3aed);color:white" onclick="showLayer(\'withdrawalLayer\')">Withdraw</button>'+
    '<button class="action-btn" style="background:linear-gradient(135deg,#ec4899,#db2777);color:white" onclick="showLayer(\'referralLayer\')">Referrals</button>'+
    '<button class="action-btn" style="background:linear-gradient(135deg,#10b981,#059669);color:white" onclick="showLayer(\'robotsLayer\')">Trading Bots</button>'+
    '<button class="action-btn" style="background:linear-gradient(135deg,#f59e0b,#d97706);color:white" onclick="showLayer(\'portfolioLayer\')">Portfolio</button>'+
    '<button class="action-btn" style="background:linear-gradient(135deg,#06b6d4,#0891b2);color:white" onclick="showLayer(\'profileLayer\')">Profile</button>';
  var eb=c.querySelector('.action-buttons');
  if(eb)eb.parentNode.insertBefore(d,eb.nextSibling);
}

// ===== CHARTS =====
function initChartData(){
  var p=98000;
  for(var i=0;i<200;i++){p+=(Math.random()-0.5)*2000;chartDataPoints.push(p);}
}

function startChart(canvasId){
  var canvas=document.getElementById(canvasId);
  if(!canvas)return;
  function animate(){
    drawChart(canvas);
    if(Math.random()>0.7){
      var last=chartDataPoints[chartDataPoints.length-1];
      chartDataPoints.push(last+(Math.random()-0.5)*1500);
      if(chartDataPoints.length>200)chartDataPoints.shift();
    }
    chartOffset+=0.5;if(chartOffset>10)chartOffset=0;
    chartAnimationFrame=requestAnimationFrame(animate);
  }
  animate();
}

function drawChart(canvas){
  var ctx=canvas.getContext('2d');
  canvas.width=canvas.offsetWidth;canvas.height=canvas.offsetHeight;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  var data=chartDataPoints.slice(-100);
  var max=Math.max.apply(null,data),min=Math.min.apply(null,data),range=max-min||1;
  var pad=20,cw=canvas.width-pad*2,ch=canvas.height-pad*2;
  ctx.strokeStyle='rgba(255,255,255,0.05)';ctx.lineWidth=1;
  for(var i=0;i<=5;i++){var y=pad+(ch/5)*i;ctx.beginPath();ctx.moveTo(pad,y);ctx.lineTo(canvas.width-pad,y);ctx.stroke();}
  var cand=cw/data.length*0.6,sp=cw/data.length;
  data.forEach(function(price,idx){
    var x=pad+idx*sp+chartOffset;
    var open=idx>0?data[idx-1]:price,close=price;
    var high=Math.max(open,close)+Math.random()*200,low=Math.min(open,close)-Math.random()*200;
    var bull=close>open,color=bull?'#0ECB81':'#F6465D';
    var oy=pad+((max-open)/range)*ch,cy=pad+((max-close)/range)*ch;
    var hy=pad+((max-high)/range)*ch,ly=pad+((max-low)/range)*ch;
    ctx.strokeStyle=color;ctx.lineWidth=1;ctx.beginPath();ctx.moveTo(x,hy);ctx.lineTo(x,ly);ctx.stroke();
    ctx.fillStyle=color;
    var bh=Math.abs(cy-oy),by=Math.min(oy,cy);
    ctx.fillRect(x-cand/2,by,cand,Math.max(bh,1));
    if(!bull){ctx.fillStyle='#0B0E11';ctx.fillRect(x-cand/2+1,by+1,cand-2,Math.max(bh-2,0));}
    var vbar=Math.random()*50,vtop=canvas.height-pad-50;
    ctx.fillStyle=bull?'rgba(14,203,129,0.3)':'rgba(246,70,93,0.3)';
    ctx.fillRect(x-cand/2,vtop+50-vbar,cand,vbar);
  });
}

function updatePriceInfo(){
  var cur=chartDataPoints[chartDataPoints.length-1];
  var prev=chartDataPoints[chartDataPoints.length-10];
  var ch=((cur-prev)/prev*100).toFixed(2);
  setText('currentPrice','$'+cur.toFixed(2));
  var cel=document.getElementById('priceChange');
  if(cel){cel.textContent=(ch>=0?'+':'')+ch+'%';cel.className='price-change '+(ch>=0?'positive':'negative');}
  var rd=chartDataPoints.slice(-50);
  setText('chartHigh','$'+Math.max.apply(null,rd).toFixed(2));
  setText('chartLow','$'+Math.min.apply(null,rd).toFixed(2));
  setText('chartVolume',(Math.random()*10+20).toFixed(1)+'B');
  setText('chartOpen','$'+rd[0].toFixed(2));
  setText('chartClose','$'+cur.toFixed(2));
  setText('chart24h',(ch>=0?'+':'')+ch+'%');
}

// ===== WELCOME PAGE =====
function initWelcomePage(){
  generateLiveTraders();
  generateTopWinners();
  setInterval(generateLiveTraders,5000);
}

function generateLiveTraders(){
  var names=['Felix K.','Sarah M.','John D.','Mary W.','David O.','Emma N.','James K.','Fatima A.'];
  var countries=['Kenya','Nigeria','South Africa','Egypt','Ghana','Tanzania'];
  var html='';
  for(var i=0;i<30;i++){
    var n=names[Math.floor(Math.random()*names.length)];
    var c=countries[Math.floor(Math.random()*countries.length)];
    var p=(Math.random()*500+50).toFixed(2);
    html+='<div class="trader-card"><div class="trader-avatar">&#128100;</div><div class="trader-info"><div class="trader-name">'+n+' &bull; '+c+'</div><div class="trader-profit">+$'+p+'</div></div></div>';
  }
  var t=document.getElementById('liveTradersTicker');
  if(t)t.innerHTML=html+html;
}

function generateTopWinners(){
  var winners=[
    {rank:1,name:'Felix K.',loc:'Nairobi, Kenya',profit:'$12,450',trades:'1,234'},
    {rank:2,name:'Sarah M.',loc:'Lagos, Nigeria',profit:'$9,820',trades:'987'},
    {rank:3,name:'Michael O.',loc:'Johannesburg, SA',profit:'$8,650',trades:'856'},
    {rank:4,name:'Amina B.',loc:'Cairo, Egypt',profit:'$7,340',trades:'734'},
    {rank:5,name:'David N.',loc:'Accra, Ghana',profit:'$6,890',trades:'689'},
    {rank:6,name:'Emma W.',loc:'Kigali, Rwanda',profit:'$5,720',trades:'572'}
  ];
  var html='';
  winners.forEach(function(w){
    html+='<div class="winner-card"><div class="winner-rank">'+w.rank+'</div><div class="winner-header"><div class="winner-avatar-large">&#128100;</div><div class="winner-details"><h4>'+w.name+'</h4><div class="winner-location">'+w.loc+'</div></div></div><div class="winner-stats"><div class="winner-stat"><div class="winner-stat-label">Total Profit</div><div class="winner-stat-value">'+w.profit+'</div></div><div class="winner-stat"><div class="winner-stat-label">Trades</div><div class="winner-stat-value">'+w.trades+'</div></div></div></div>';
  });
  var g=document.getElementById('topWinnersGrid');
  if(g)g.innerHTML=html;
}

// ===== AUTH =====
function handleSignup(e){
  e.preventDefault();
  var name=document.getElementById('signupName').value;
  var email=document.getElementById('signupEmail').value;
  var phone=document.getElementById('signupPhone').value;
  var pass=document.getElementById('signupPassword').value;
  var conf=document.getElementById('signupConfirm').value;
  if(pass!==conf){showAlert('signupAlert','Passwords do not match!','error');return false;}
  if(pass.length<6){showAlert('signupAlert','Password must be at least 6 characters!','error');return false;}
  var code='CRP'+Math.random().toString(36).substr(2,6).toUpperCase();
  currentUser={name:name,email:email,phone:phone,referralCode:code,balance:25,deposited:0,profit:0,joinDate:new Date().toLocaleDateString()};
  currentBalance=25;currentProfit=0;
  localStorage.setItem('cryptoproUser',JSON.stringify(currentUser));
  showAlert('signupAlert','Account created! Redirecting...','success');
  setTimeout(function(){showLayer('dashboardLayer');showToast('Welcome '+name+'! Your $25 bonus is ready!','success');},2000);
  return false;
}

function handleLogin(e){
  e.preventDefault();
  var email=document.getElementById('loginEmail').value;
  var pass=document.getElementById('loginPassword').value;
  if(!email||!pass){showAlert('loginAlert','Please enter email and password!','error');return false;}
  var saved=localStorage.getItem('cryptoproUser');
  if(saved){
    currentUser=JSON.parse(saved);
    if(currentUser.email===email){
      currentBalance=currentUser.balance||25;currentProfit=currentUser.profit||0;
      showAlert('loginAlert','Login successful! Redirecting...','success');
      setTimeout(function(){showLayer('dashboardLayer');showToast('Welcome back, '+currentUser.name+'!','success');},1500);
    }else{showAlert('loginAlert','Email does not match!','error');}
  }else{showAlert('loginAlert','No account found. Please sign up first.','error');}
  return false;
}

function handleLogout(){
  if(confirm('Are you sure you want to logout?')){currentUser=null;showLayer('welcomeLayer');}
}

function showAlert(id,msg,type){
  var a=document.getElementById(id);
  if(a){a.textContent=msg;a.className='alert alert-'+type+' show';setTimeout(function(){a.classList.remove('show');},5000);}
}

// ===== PAYMENT / DEPOSIT =====
function selectPaymentMethod(method){
  selectedPaymentMethod=method;
  document.querySelectorAll('[data-method]').forEach(function(b){b.classList.remove('active');});
  var ab=document.querySelector('[data-method="'+method+'"]');
  if(ab)ab.classList.add('active');
  document.querySelectorAll('.payment-details').forEach(function(d){d.classList.remove('active');});
  var te=document.getElementById(method);
  if(te)te.classList.add('active');
}

function copyToClipboard(text){
  if(navigator.clipboard){navigator.clipboard.writeText(text).then(function(){showToast('Copied: '+text,'success');}).catch(function(){fallbackCopy(text);});}
  else{fallbackCopy(text);}
}

function fallbackCopy(text){
  var ta=document.createElement('textarea');
  ta.value=text;ta.style.position='fixed';ta.style.left='-9999px';
  document.body.appendChild(ta);ta.select();
  try{document.execCommand('copy');showToast('Copied: '+text,'success');}catch(e){alert('Copy this: '+text);}
  document.body.removeChild(ta);
}

function processDeposit(e){
  e.preventDefault();
  var amount=parseFloat(document.getElementById('depositAmount').value);
  var proof=document.getElementById('depositProof').value;
  if(!amount||amount<10){showToast('Minimum deposit is $10','error');return false;}
  if(!selectedPaymentMethod){showToast('Please select a payment method!','error');return false;}
  if(!proof||proof.trim()===''){showToast('Please provide payment proof','error');return false;}
  var methodName=selectedPaymentMethod==='mpesa-phone'?'M-Pesa Phone':selectedPaymentMethod==='mpesa-till'?'M-Pesa Till':selectedPaymentMethod==='bank'?'Bank Transfer':'Crypto USDT';
  var msg='NEW DEPOSIT REQUEST\n\nAmount: $'+amount.toFixed(2)+'\nMethod: '+methodName+'\nProof: '+proof+'\nUser: '+(currentUser?currentUser.name:'Guest')+'\nEmail: '+(currentUser?currentUser.email:'N/A')+'\n\nPlease verify and credit account.';
  window.open('https://wa.me/'+MPESA_NUMBER.replace('+','')+'?text='+encodeURIComponent(msg),'_blank');
  showToast('Deposit request submitted! Credited within 5 minutes after verification.','success');
  setTimeout(function(){showLayer('dashboardLayer');},2000);
  return false;
}

// ===== TRADING =====
function switchTradeTab(type){
  currentTradeType=type;
  var bt=document.getElementById('buyTab'),st=document.getElementById('sellTab'),btn=document.getElementById('tradeButton');
  if(type==='buy'){
    if(bt)bt.classList.add('active');if(st)st.classList.remove('active');
    if(btn){btn.textContent='EXECUTE BUY TRADE';btn.style.background='linear-gradient(135deg,#0ECB81,#0B8F5F)';}
  }else{
    if(st)st.classList.add('active');if(bt)bt.classList.remove('active');
    if(btn){btn.textContent='EXECUTE SELL TRADE';btn.style.background='linear-gradient(135deg,#F6465D,#cc0055)';}
  }
}

function setTradeAmount(amount){var i=document.getElementById('tradeAmount');if(i)i.value=amount;calcProfit();}

function calcProfit(){
  var a=parseFloat(document.getElementById('tradeAmount').value)||0;
  var l=parseFloat(document.getElementById('tradeLeverage').value)||1;
  var base=a*(0.05+0.10);var profit=base*l;var roi=a?profit/a*100:0;
  setText('potentialProfit','$'+profit.toFixed(2));
  setText('potentialROI',roi.toFixed(1)+'%');
}

function executeTrade(e){
  e.preventDefault();
  if(!currentUser){showToast('Please login first!','error');showLayer('loginLayer');return false;}
  var amount=parseFloat(document.getElementById('tradeAmount').value);
  var leverage=parseFloat(document.getElementById('tradeLeverage').value);
  var duration=parseInt(document.getElementById('tradeDuration').value);
  if(!amount||amount<10){showToast('Minimum trade is $10','error');return false;}
  if(amount>currentBalance){showToast('Insufficient balance!','error');return false;}
  var trade={id:'TRD'+Date.now(),type:currentTradeType,amount:amount,leverage:leverage,duration:duration,entryPrice:chartDataPoints[chartDataPoints.length-1],startTime:Date.now(),endTime:Date.now()+(duration*1000),status:'active'};
  activeTrades.push(trade);currentBalance-=amount;
  updateBalDisplay();showToast(currentTradeType.toUpperCase()+' trade executed! $'+amount+' at '+leverage+'x','success');
  monitorTrade(trade);updateActiveTrades();
  document.getElementById('tradeForm').reset();calcProfit();
  return false;
}

function monitorTrade(trade){
  var iv=setInterval(function(){
    if(Date.now()>=trade.endTime){clearInterval(iv);closeTrade(trade);}
    else{updateActiveTrades();}
  },1000);
}

function closeTrade(trade){
  var exit=chartDataPoints[chartDataPoints.length-1];
  var pc=(exit-trade.entryPrice)/trade.entryPrice;
  var pm=pc*trade.leverage+(Math.random()-0.5)*0.04;
  if(trade.type==='sell')pm=-pm;
  var profitAmt=trade.amount*pm;
  var final=trade.amount+profitAmt;
  trade.status=profitAmt>0?'won':'lost';
  trade.exitPrice=exit;trade.profit=profitAmt;
  currentBalance+=final;
  if(profitAmt>0)currentProfit+=profitAmt;
  tradeHistory.unshift(trade);
  activeTrades=activeTrades.filter(function(t){return t.id!==trade.id;});
  saveUserData();updateBalDisplay();updateActiveTrades();
  if(profitAmt>0){showToast('Trade WON! Profit: +$'+profitAmt.toFixed(2),'success');}
  else{showToast('Trade Lost: $'+Math.abs(profitAmt).toFixed(2),'error');}
}

function updateActiveTrades(){
  var c=document.getElementById('activeTradesContainer');
  if(!c)return;
  if(activeTrades.length===0){c.innerHTML='<div style="text-align:center;padding:40px;color:var(--text-secondary)">No active trades</div>';return;}
  var html='<div style="display:grid;gap:16px">';
  activeTrades.forEach(function(trade){
    var now=Date.now();
    var elapsed=now-trade.startTime;
    var remaining=Math.max(0,trade.endTime-now);
    var progress=(elapsed/(trade.duration*1000))*100;
    var curP=chartDataPoints[chartDataPoints.length-1];
    var pch=(curP-trade.entryPrice)/trade.entryPrice;
    var cp=pch*trade.amount*trade.leverage;
    if(trade.type==='sell')cp=-cp;
    var isProfit=cp>0;
    html+='<div style="background:var(--bg-tertiary);border:2px solid '+(isProfit?'var(--accent-green)':'var(--accent-red)')+';border-radius:12px;padding:20px">'+
      '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">'+
      '<div><div style="font-size:18px;font-weight:700">'+trade.type.toUpperCase()+' &mdash; '+trade.leverage+'x</div><div style="font-size:12px;color:var(--text-secondary);margin-top:4px">ID: '+trade.id+'</div></div>'+
      '<div style="text-align:right"><div style="font-size:24px;font-weight:900;color:'+(isProfit?'var(--accent-green)':'var(--accent-red)')+'">'+
      (isProfit?'+':'')+' $'+cp.toFixed(2)+'</div></div></div>'+
      '<div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:16px">'+
      '<div><div style="font-size:11px;color:var(--text-secondary)">Amount</div><div style="font-size:14px;font-weight:600">$'+trade.amount.toFixed(2)+'</div></div>'+
      '<div><div style="font-size:11px;color:var(--text-secondary)">Entry</div><div style="font-size:14px;font-weight:600">$'+trade.entryPrice.toFixed(2)+'</div></div>'+
      '<div><div style="font-size:11px;color:var(--text-secondary)">Current</div><div style="font-size:14px;font-weight:600">$'+curP.toFixed(2)+'</div></div></div>'+
      '<div style="background:rgba(0,0,0,0.3);border-radius:8px;height:8px;overflow:hidden;margin-bottom:8px"><div style="background:linear-gradient(90deg,var(--accent-green),var(--accent-blue));height:100%;width:'+progress+'%;transition:width 0.3s"></div></div>'+
      '<div style="text-align:center;font-size:14px;font-weight:600">'+Math.floor(remaining/1000)+'s remaining</div></div>';
  });
  html+='</div>';c.innerHTML=html;
}

// ===== TRADE HISTORY =====
function updateTradeHistory(){
  var c=document.getElementById('tradeHistoryTable');
  if(!c)return;
  if(tradeHistory.length===0){
    c.innerHTML='<div style="text-align:center;padding:40px;color:var(--text-secondary)">No trades yet</div>';
    setText('historyTotalTrades','0');setText('historyWinRate','0%');setText('historyTotalProfit','$0.00');setText('historyBestTrade','$0.00');
    return;
  }
  var won=tradeHistory.filter(function(t){return t.status==='won';}).length;
  var wr=(won/tradeHistory.length*100).toFixed(1);
  var tp=tradeHistory.reduce(function(s,t){return s+(t.profit||0);},0);
  var bt=Math.max.apply(null,tradeHistory.map(function(t){return t.profit||0;}));
  setText('historyTotalTrades',tradeHistory.length);setText('historyWinRate',wr+'%');
  setText('historyTotalProfit','$'+tp.toFixed(2));setText('historyBestTrade','$'+bt.toFixed(2));
  var html='<div style="overflow-x:auto"><table style="width:100%;border-collapse:collapse">';
  html+='<thead><tr style="background:var(--bg-tertiary);text-align:left"><th style="padding:12px;border-bottom:2px solid var(--border-color)">Date</th><th style="padding:12px;border-bottom:2px solid var(--border-color)">Type</th><th style="padding:12px;border-bottom:2px solid var(--border-color)">Amount</th><th style="padding:12px;border-bottom:2px solid var(--border-color)">Lev</th><th style="padding:12px;border-bottom:2px solid var(--border-color)">Entry</th><th style="padding:12px;border-bottom:2px solid var(--border-color)">Exit</th><th style="padding:12px;border-bottom:2px solid var(--border-color)">P/L</th><th style="padding:12px;border-bottom:2px solid var(--border-color)">Status</th></tr></thead><tbody>';
  tradeHistory.forEach(function(t){
    var d=new Date(t.endTime).toLocaleString();
    var pc=(t.profit||0)>=0?'var(--accent-green)':'var(--accent-red)';
    html+='<tr style="border-bottom:1px solid var(--border-color)"><td style="padding:12px;font-size:12px;color:var(--text-secondary)">'+d+'</td>'+
      '<td style="padding:12px"><span style="background:'+(t.type==='buy'?'rgba(14,203,129,0.2)':'rgba(246,70,93,0.2)')+';padding:4px 12px;border-radius:6px;font-size:12px;font-weight:600;color:'+(t.type==='buy'?'var(--accent-green)':'var(--accent-red)')+'">'+t.type.toUpperCase()+'</span></td>'+
      '<td style="padding:12px;font-weight:600">$'+t.amount.toFixed(2)+'</td>'+
      '<td style="padding:12px;color:var(--accent-yellow)">'+t.leverage+'x</td>'+
      '<td style="padding:12px;font-size:14px">$'+t.entryPrice.toFixed(2)+'</td>'+
      '<td style="padding:12px;font-size:14px">$'+(t.exitPrice||0).toFixed(2)+'</td>'+
      '<td style="padding:12px;font-weight:700;font-size:16px;color:'+pc+'">'+(( t.profit||0)>=0?'+':'')+' $'+(t.profit||0).toFixed(2)+'</td>'+
      '<td style="padding:12px"><span style="background:'+(t.status==='won'?'rgba(14,203,129,0.2)':'rgba(246,70,93,0.2)')+';padding:4px 12px;border-radius:6px;font-size:12px;font-weight:600;color:'+(t.status==='won'?'var(--accent-green)':'var(--accent-red)')+'">'+( t.status==='won'?'WON':'LOST')+'</span></td></tr>';
  });
  html+='</tbody></table></div>';c.innerHTML=html;
}

// ===== WITHDRAWAL =====
function selectWithdrawMethod(method){
  selectedWithdrawMethod=method;
  document.querySelectorAll('[data-withdraw-method]').forEach(function(b){b.classList.remove('active');});
  var ab=document.querySelector('[data-withdraw-method="'+method+'"]');
  if(ab)ab.classList.add('active');
  document.querySelectorAll('.payment-details').forEach(function(d){d.classList.remove('active');});
  var te=document.getElementById('withdraw-'+method);
  if(te)te.classList.add('active');
}

function processWithdrawal(e){
  e.preventDefault();
  if(!currentUser){showToast('Please login first!','error');return false;}
  var amount=parseFloat(document.getElementById('withdrawAmount').value);
  if(!amount||amount<50){showToast('Minimum withdrawal is $50','error');return false;}
  if(amount>currentBalance){showToast('Insufficient balance!','error');return false;}
  if(!selectedWithdrawMethod){showToast('Please select a withdrawal method!','error');return false;}
  var details='';
  if(selectedWithdrawMethod==='mpesa'){
    var ph=document.getElementById('withdrawMpesaPhone').value;
    var nm=document.getElementById('withdrawMpesaName').value;
    if(!ph||!nm){showToast('Please fill all M-Pesa details','error');return false;}
    details='M-Pesa: '+ph+' ('+nm+')';
  }else if(selectedWithdrawMethod==='bank'){
    var bn=document.getElementById('withdrawBankName').value;
    var ba=document.getElementById('withdrawBankAccount').value;
    var ban=document.getElementById('withdrawBankAccountName').value;
    if(!bn||!ba||!ban){showToast('Please fill all bank details','error');return false;}
    details=bn+' - '+ba+' ('+ban+')';
  }else if(selectedWithdrawMethod==='crypto'){
    var addr=document.getElementById('withdrawCryptoAddress').value;
    if(!addr){showToast('Please enter wallet address','error');return false;}
    details='USDT TRC-20: '+addr;
  }
  var fee=amount*0.02,net=amount-fee;
  var w={id:'WDR'+Date.now(),amount:amount,fee:fee,netAmount:net,method:selectedWithdrawMethod,details:details,date:Date.now(),status:'pending'};
  withdrawalHistory.unshift(w);
  var msg='NEW WITHDRAWAL REQUEST\n\nAmount: $'+amount.toFixed(2)+'\nFee: $'+fee.toFixed(2)+'\nNet: $'+net.toFixed(2)+'\nMethod: '+selectedWithdrawMethod.toUpperCase()+'\nDetails: '+details+'\nUser: '+currentUser.name+'\nEmail: '+currentUser.email+'\n\nPlease process within 24 hours.';
  window.open('https://wa.me/'+MPESA_NUMBER.replace('+','')+'?text='+encodeURIComponent(msg),'_blank');
  showToast('Withdrawal request submitted! You will receive $'+net.toFixed(2)+' within 24 hours.','success');
  updateWithdrawalHistory();
  setTimeout(function(){showLayer('dashboardLayer');},2000);
  return false;
}

function updateWithdrawalHistory(){
  var c=document.getElementById('withdrawalHistoryContainer');
  if(!c)return;
  if(withdrawalHistory.length===0){c.innerHTML='<div style="text-align:center;padding:40px;color:var(--text-secondary)">No withdrawals yet</div>';return;}
  var html='<div style="display:grid;gap:16px">';
  withdrawalHistory.forEach(function(w){
    var sc=w.status==='completed'?'var(--accent-green)':w.status==='pending'?'var(--accent-yellow)':'var(--accent-red)';
    var st=w.status==='completed'?'Completed':w.status==='pending'?'Pending':'Rejected';
    html+='<div style="background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:12px;padding:20px">'+
      '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">'+
      '<div><div style="font-size:18px;font-weight:700">$'+w.amount.toFixed(2)+'</div><div style="font-size:12px;color:var(--text-secondary);margin-top:4px">'+new Date(w.date).toLocaleString()+'</div></div>'+
      '<div style="padding:6px 16px;border-radius:8px;font-size:12px;font-weight:600;color:'+sc+'">'+st+'</div></div>'+
      '<div style="font-size:13px;color:var(--text-secondary)">Method: '+w.method.toUpperCase()+'<br>Details: '+w.details+'<br>Fee: $'+w.fee.toFixed(2)+' | Net: $'+w.netAmount.toFixed(2)+'</div></div>';
  });
  html+='</div>';c.innerHTML=html;
}

// ===== REFERRALS =====
function copyReferralCode(){copyToClipboard(currentUser?currentUser.referralCode:'CRP123456');}
function copyReferralLink(){
  var code=currentUser?currentUser.referralCode:'CRP123456';
  copyToClipboard(window.location.origin+window.location.pathname+'?ref='+code);
}
function shareWhatsApp(){
  var code=currentUser?currentUser.referralCode:'CRP123456';
  var link=window.location.origin+window.location.pathname+'?ref='+code;
  var msg='Join me on CryptoPro - the best crypto trading platform!\n\nGet $25 FREE signup bonus\nUse my code: '+code+'\nLink: '+link;
  window.open('https://wa.me/?text='+encodeURIComponent(msg),'_blank');
}
function shareTelegram(){
  var code=currentUser?currentUser.referralCode:'CRP123456';
  var link=window.location.origin+window.location.pathname+'?ref='+code;
  window.open('https://t.me/share/url?url='+encodeURIComponent(link)+'&text='+encodeURIComponent('Join CryptoPro! $25 FREE bonus. Code: '+code),'_blank');
}
function updateReferralStats(){
  setText('totalReferrals',referrals.length);
  setText('activeReferrals',referrals.filter(function(r){return r.active;}).length);
  var te=referrals.reduce(function(s,r){return s+(r.earnings||0);},0);
  setText('referralEarnings','$'+te.toFixed(2));
  var code=currentUser?currentUser.referralCode:'CRP123456';
  setText('referralCode',code);
  setText('referralLink',window.location.origin+window.location.pathname+'?ref='+code);
  updateReferralList();
}
function updateReferralList(){
  var c=document.getElementById('referralListContainer');
  if(!c)return;
  if(referrals.length===0){c.innerHTML='<div style="text-align:center;padding:40px;color:var(--text-secondary)">No referrals yet. Start sharing your link!</div>';return;}
  var html='<div style="display:grid;gap:16px">';
  referrals.forEach(function(r){
    html+='<div style="background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:12px;padding:20px;display:flex;justify-content:space-between;align-items:center">'+
      '<div><div style="font-size:16px;font-weight:700">'+r.name+'</div><div style="font-size:12px;color:var(--text-secondary);margin-top:4px">Joined: '+new Date(r.joinDate).toLocaleDateString()+'</div></div>'+
      '<div style="text-align:right"><div style="font-size:20px;font-weight:700;color:var(--accent-green)">$'+(r.earnings||0).toFixed(2)+'</div><div style="font-size:12px;color:var(--text-secondary)">'+(r.active?'Active':'Inactive')+'</div></div></div>';
  });
  html+='</div>';c.innerHTML=html;
}

// ===== REVIEWS =====
function generateReviews(){
  var reviews=[
    {name:'Felix Kiprotich',loc:'Nairobi, Kenya',txt:'CryptoPro changed my life! Consistent daily profits and withdrawals work perfectly. Withdrew $5,000 last month with zero issues.',profit:'$12,450'},
    {name:'Sarah Wanjiku',loc:'Mombasa, Kenya',txt:'Best trading platform in Africa! Started with $50 and now have over $3,000. Customer support is amazing.',profit:'$8,920'},
    {name:'Michael Ochieng',loc:'Johannesburg, SA',txt:'Was skeptical at first, but after my first withdrawal I became a believer. Professional and profitable.',profit:'$6,340'},
    {name:'Amina Hassan',loc:'Cairo, Egypt',txt:'Referred 15 friends and earning 20% commission from their trades. Passive income at its best!',profit:'$9,180'},
    {name:'David Mensah',loc:'Accra, Ghana',txt:'The AI trading bots are game-changers. Wake up to profits every day. Made back my investment 10x over!',profit:'$7,560'},
    {name:'Emma Akinyi',loc:'Kigali, Rwanda',txt:'Been trading 3 months and my account grew from $100 to $2,400. Highly recommended!',profit:'$5,890'},
    {name:'James Kamau',loc:'Nairobi, Kenya',txt:'Withdrawals processed within 24 hours every time. Support team is responsive. This is the real deal!',profit:'$11,200'},
    {name:'Fatima Ibrahim',loc:'Lagos, Nigeria',txt:'I quit my 9-5 job thanks to CryptoPro. Making more in a week than I used to in a month!',profit:'$15,670'},
    {name:'Peter Nkosi',loc:'Durban, SA',txt:'The referral program alone pays my bills! Plus my own trading profits. Absolutely amazing!',profit:'$8,450'},
    {name:'Grace Mutua',loc:'Nairobi, Kenya',txt:'Started with the $25 bonus, turned it into $500 in my first week! Legit and professional platform.',profit:'$4,230'},
    {name:'Ahmed Ali',loc:'Alexandria, Egypt',txt:'6 months trading here, zero complaints. My entire family now uses CryptoPro!',profit:'$13,890'},
    {name:'Mary Njeri',loc:'Kisumu, Kenya',txt:'The AI does all the work while I enjoy profits. Planning my vacation with the money I have made!',profit:'$7,120'}
  ];
  var c=document.getElementById('reviewsGrid');
  if(!c)return;
  var html='';
  reviews.forEach(function(r){
    html+='<div style="background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:16px;padding:24px;transition:all 0.3s">'+
      '<div style="display:flex;align-items:center;gap:12px;margin-bottom:16px">'+
      '<div style="width:56px;height:56px;background:linear-gradient(135deg,var(--accent-green),var(--accent-blue));border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:28px">&#128100;</div>'+
      '<div style="flex:1"><div style="font-size:16px;font-weight:700">'+r.name+'</div><div style="font-size:12px;color:var(--text-secondary);margin-top:2px">'+r.loc+'</div><div style="font-size:18px;margin-top:4px">&#11088;&#11088;&#11088;&#11088;&#11088;</div></div></div>'+
      '<div style="font-size:14px;color:var(--text-primary);line-height:1.7;margin-bottom:16px">&ldquo;'+r.txt+'&rdquo;</div>'+
      '<div style="background:rgba(14,203,129,0.1);border:1px solid rgba(14,203,129,0.3);border-radius:8px;padding:12px;text-align:center">'+
      '<div style="font-size:11px;color:var(--text-secondary);margin-bottom:4px">Total Profit Earned</div>'+
      '<div style="font-size:24px;font-weight:900;color:var(--accent-green)">'+r.profit+'</div></div></div>';
  });
  c.innerHTML=html;
}

// ===== PROFILE =====
function updateProfilePage(){
  if(!currentUser)return;
  setText('profileName',currentUser.name);
  setText('profileEmail',currentUser.email);
  setText('profilePhone',currentUser.phone||'Not provided');
  setText('profileReferralCode',currentUser.referralCode||'N/A');
  setText('profileJoinDate',currentUser.joinDate||new Date().toLocaleDateString());
  setText('profileBalance','$'+currentBalance.toFixed(2));
  setText('profileTotalTrades',tradeHistory.length);
  setText('profileTotalProfit','$'+currentProfit.toFixed(2));
  setText('profileReferrals',referrals.length);
}

// ===== TRADING BOTS =====
var botConfig={
  scalper:{min:10,dailyMin:0.03,dailyMax:0.08,label:'Scalper Bot'},
  trend:{min:50,dailyMin:0.08,dailyMax:0.15,label:'Trend Rider'},
  arb:{min:200,dailyMin:0.15,dailyMax:0.25,label:'Arbitrage Pro'},
  ai:{min:500,dailyMin:0.20,dailyMax:0.40,label:'AI Oracle'}
};

function updateRobotsPage(){
  setText('activeBotCount',Object.keys(activeBots).length);
  setText('botTotalEarnedDisplay','$'+botTotalEarned.toFixed(2));
}

function toggleBot(botId){
  if(activeBots[botId]){stopBot(botId);}
  else{startBot(botId);}
}

function startBot(botId){
  if(!currentUser){showToast('Please login first!','error');return;}
  var amtEl=document.getElementById('botAmount-'+botId);
  var amount=parseFloat(amtEl?amtEl.value:0);
  var cfg=botConfig[botId];
  if(!amount||amount<cfg.min){showToast('Minimum allocation is $'+cfg.min,'error');return;}
  if(amount>currentBalance){showToast('Insufficient balance!','error');return;}
  currentBalance-=amount;updateBalDisplay();
  activeBots[botId]={earned:0,allocation:amount,startTime:Date.now()};
  document.getElementById('botCard-'+botId).classList.add('running');
  document.getElementById('botStatus-'+botId).style.display='block';
  document.getElementById('botBtn-'+botId).textContent='Stop '+cfg.label;
  document.getElementById('botBtn-'+botId).style.background='linear-gradient(135deg,#F6465D,#cc0055)';
  if(amtEl)amtEl.disabled=true;
  addBotLog(cfg.label+' started with $'+amount.toFixed(2)+' allocation.');
  activeBots[botId].interval=setInterval(function(){tickBot(botId);},3000);
  updateRobotsPage();
  showToast(cfg.label+' is now running with $'+amount.toFixed(2)+'!','success');
}

function tickBot(botId){
  if(!activeBots[botId])return;
  var cfg=botConfig[botId];
  var allocation=activeBots[botId].allocation;
  var rate=cfg.dailyMin+(Math.random()*(cfg.dailyMax-cfg.dailyMin));
  var tickEarning=allocation*(rate/288);
  activeBots[botId].earned+=tickEarning;
  botTotalEarned+=tickEarning;
  currentBalance+=tickEarning;
  currentProfit+=tickEarning;
  setText('botEarned-'+botId,'$'+activeBots[botId].earned.toFixed(4));
  setText('botTotalEarnedDisplay','$'+botTotalEarned.toFixed(4));
  updateBalDisplay();
  if(Math.random()<0.2){
    var coins=['BTC/USDT','ETH/USDT','SOL/USDT','BNB/USDT','ADA/USDT'];
    var coin=coins[Math.floor(Math.random()*coins.length)];
    addBotLog(cfg.label+': Trade on '+coin+' &mdash; Profit: +$'+tickEarning.toFixed(4));
  }
  saveUserData();
}

function stopBot(botId){
  if(!activeBots[botId])return;
  var cfg=botConfig[botId];
  clearInterval(activeBots[botId].interval);
  var earned=activeBots[botId].earned;
  addBotLog(cfg.label+' stopped. Total earned: $'+earned.toFixed(2));
  delete activeBots[botId];
  document.getElementById('botCard-'+botId).classList.remove('running');
  document.getElementById('botStatus-'+botId).style.display='none';
  document.getElementById('botBtn-'+botId).textContent='Start '+cfg.label;
  var defColor=botId==='arb'?'linear-gradient(135deg,#FCD535,#f59e0b)':botId==='ai'?'linear-gradient(135deg,#8b5cf6,#7c3aed)':'linear-gradient(135deg,var(--accent-green),#0B8F5F)';
  document.getElementById('botBtn-'+botId).style.background=defColor;
  if(botId==='arb')document.getElementById('botBtn-'+botId).style.color='#000';
  var amtEl=document.getElementById('botAmount-'+botId);
  if(amtEl)amtEl.disabled=false;
  updateRobotsPage();
  showToast(cfg.label+' stopped. Earned: $'+earned.toFixed(2),'success');
}

function addBotLog(msg){
  botLogEntries.unshift('<div style="display:flex;align-items:center;gap:12px;padding:10px;border-bottom:1px solid var(--border-color);font-size:13px"><span style="color:var(--accent-green);font-weight:700;white-space:nowrap">'+new Date().toLocaleTimeString()+'</span><span>'+msg+'</span></div>');
  if(botLogEntries.length>50)botLogEntries.pop();
  var el=document.getElementById('botActivityLog');
  if(el)el.innerHTML=botLogEntries.join('');
}

// ===== PORTFOLIO =====
function updatePortfolioPage(){
  setText('portfolioTotalValue','$'+currentBalance.toFixed(2));
  setText('portfolioDeposited','$25.00');
  setText('portfolioProfit','$'+currentProfit.toFixed(2));
  var deposited=25,roi=deposited>0?((currentBalance-deposited)/deposited*100):0;
  setText('portfolioROI',roi.toFixed(1)+'%');
  var won=tradeHistory.filter(function(t){return t.status==='won';}).length;
  var wr=tradeHistory.length>0?(won/tradeHistory.length*100).toFixed(1):0;
  setText('portfolioWinRate',wr+'%');
  renderAllocation();
  renderHoldings();
  renderActivity();
  setTimeout(function(){drawPortfolioChart();},100);
}

function renderAllocation(){
  var c=document.getElementById('portfolioAllocation');
  if(!c)return;
  var assets=[
    {name:'Bitcoin (BTC)',pct:45,color:'#F7931A'},
    {name:'Ethereum (ETH)',pct:25,color:'#627EEA'},
    {name:'Solana (SOL)',pct:15,color:'#9945FF'},
    {name:'BNB',pct:10,color:'#F3BA2F'},
    {name:'Others',pct:5,color:'#848E9C'}
  ];
  var html='<div style="display:grid;gap:12px">';
  assets.forEach(function(a){
    html+='<div><div style="display:flex;justify-content:space-between;margin-bottom:6px"><span style="font-size:14px;font-weight:600">'+a.name+'</span><span style="font-size:14px;font-weight:700;color:'+a.color+'">'+a.pct+'%</span></div>'+
      '<div style="background:var(--bg-primary);border-radius:8px;height:16px;overflow:hidden"><div style="background:'+a.color+';height:100%;width:'+a.pct+'%;border-radius:8px;transition:width 1s ease-out"></div></div></div>';
  });
  html+='</div>';c.innerHTML=html;
}

function renderHoldings(){
  var c=document.getElementById('portfolioHoldings');
  if(!c)return;
  var coins=[
    {name:'Bitcoin',sym:'BTC',icon:'&#8383;',color:'#F7931A',qty:'0.00045',val:(currentBalance*0.45).toFixed(2),ch:'+2.45%',pos:true},
    {name:'Ethereum',sym:'ETH',icon:'&#9830;',color:'#627EEA',qty:'0.0182',val:(currentBalance*0.25).toFixed(2),ch:'+1.82%',pos:true},
    {name:'Solana',sym:'SOL',icon:'&#9675;',color:'#9945FF',qty:'0.312',val:(currentBalance*0.15).toFixed(2),ch:'-0.54%',pos:false},
    {name:'BNB',sym:'BNB',icon:'&#9670;',color:'#F3BA2F',qty:'0.068',val:(currentBalance*0.10).toFixed(2),ch:'+0.91%',pos:true},
    {name:'Others',sym:'ALT',icon:'&#9733;',color:'#848E9C',qty:'',val:(currentBalance*0.05).toFixed(2),ch:'0.00%',pos:true}
  ];
  var html='<div style="display:grid;gap:8px">';
  coins.forEach(function(coin){
    html+='<div class="coin-row"><div class="coin-icon" style="background:'+coin.color+'22">'+coin.icon+'</div>'+
      '<div style="flex:1"><div style="font-size:16px;font-weight:700">'+coin.name+'</div><div style="font-size:12px;color:var(--text-secondary)">'+coin.sym+' &bull; Qty: '+coin.qty+'</div></div>'+
      '<div style="text-align:right"><div style="font-size:16px;font-weight:700">$'+coin.val+'</div>'+
      '<div style="font-size:12px;font-weight:600;color:'+(coin.pos?'var(--accent-green)':'var(--accent-red)')+'">'+coin.ch+'</div></div></div>';
  });
  html+='</div>';c.innerHTML=html;
}

function drawPortfolioChart(){
  var canvas=document.getElementById('portfolioCanvas');
  if(!canvas)return;
  canvas.width=canvas.offsetWidth;canvas.height=canvas.offsetHeight;
  var ctx=canvas.getContext('2d');
  ctx.clearRect(0,0,canvas.width,canvas.height);
  var points=[];var val=20;
  for(var i=0;i<30;i++){val+=((Math.random()-0.4)*3);if(val<10)val=10;points.push(val);}
  var max=Math.max.apply(null,points),min=Math.min.apply(null,points),range=max-min||1;
  var pad=20,w=canvas.width-pad*2,h=canvas.height-pad*2;
  var grad=ctx.createLinearGradient(0,pad,0,pad+h);
  grad.addColorStop(0,'rgba(14,203,129,0.4)');grad.addColorStop(1,'rgba(14,203,129,0)');
  ctx.beginPath();
  points.forEach(function(p,i){
    var x=pad+i*(w/(points.length-1));
    var y=pad+((max-p)/range)*h;
    if(i===0)ctx.moveTo(x,y);else ctx.lineTo(x,y);
  });
  ctx.strokeStyle='#0ECB81';ctx.lineWidth=2;ctx.stroke();
  ctx.lineTo(pad+w,pad+h);ctx.lineTo(pad,pad+h);ctx.closePath();
  ctx.fillStyle=grad;ctx.fill();
  ctx.fillStyle='var(--text-secondary)';ctx.font='10px sans-serif';
  for(var g=0;g<=4;g++){
    var gval=min+(range/4)*g;
    var gy=pad+((max-gval)/range)*h;
    ctx.fillText('$'+gval.toFixed(0),2,gy+3);
  }
}

function renderActivity(){
  var c=document.getElementById('portfolioActivity');
  if(!c)return;
  var items=[];
  if(tradeHistory.length>0){
    tradeHistory.slice(0,5).forEach(function(t){
      items.push({icon:'&#128202;',label:(t.type==='buy'?'Bought':'Sold')+' BTC/USDT',amount:(t.profit>=0?'+':'')+' $'+t.profit.toFixed(2),date:new Date(t.endTime).toLocaleString(),pos:t.profit>=0});
    });
  }
  items.push({icon:'&#127381;',label:'Account Created &mdash; Signup Bonus',amount:'+$25.00',date:currentUser?currentUser.joinDate:new Date().toLocaleDateString(),pos:true});
  var html='<div style="display:grid;gap:8px">';
  items.forEach(function(item){
    html+='<div style="display:flex;align-items:center;gap:16px;padding:14px;background:var(--bg-tertiary);border-radius:12px;border:1px solid var(--border-color)">'+
      '<div style="width:40px;height:40px;background:rgba(14,203,129,0.1);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:20px">'+item.icon+'</div>'+
      '<div style="flex:1"><div style="font-size:14px;font-weight:600">'+item.label+'</div><div style="font-size:11px;color:var(--text-secondary);margin-top:3px">'+item.date+'</div></div>'+
      '<div style="font-size:16px;font-weight:700;color:'+(item.pos?'var(--accent-green)':'var(--accent-red)')+'">'+item.amount+'</div></div>';
  });
  html+='</div>';c.innerHTML=html;
}

// ===== UTILITIES =====
function updateBalDisplay(){
  setText('dashBalance','$'+currentBalance.toFixed(2));
  setText('dashAvailable','$'+currentBalance.toFixed(2));
  setText('dashProfit','$'+currentProfit.toFixed(2));
  setText('availableBalance',currentBalance.toFixed(2));
  setText('withdrawAvailable','$'+currentBalance.toFixed(2));
  setText('maxWithdraw',currentBalance.toFixed(2));
}

function saveUserData(){
  if(currentUser){
    currentUser.balance=currentBalance;currentUser.profit=currentProfit;
    localStorage.setItem('cryptoproUser',JSON.stringify(currentUser));
    localStorage.setItem('cryptoproTrades',JSON.stringify(tradeHistory));
    localStorage.setItem('cryptoproReferrals',JSON.stringify(referrals));
    localStorage.setItem('cryptoproWithdrawals',JSON.stringify(withdrawalHistory));
  }
}

function loadUserData(){
  var td=localStorage.getItem('cryptoproTrades');
  var rd=localStorage.getItem('cryptoproReferrals');
  var wd=localStorage.getItem('cryptoproWithdrawals');
  if(td)tradeHistory=JSON.parse(td);
  if(rd)referrals=JSON.parse(rd);
  if(wd)withdrawalHistory=JSON.parse(wd);
}

setInterval(saveUserData,30000);
</script>
</body>
</html>
