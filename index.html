<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoPro - Professional Crypto Trading Platform</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700;900&family=JetBrains+Mono:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-primary: #060B11;
            --bg-secondary: #0D1421;
            --bg-tertiary: #111927;
            --bg-card: #151E2D;
            --border-color: #1E2D42;
            --text-primary: #E8EDF5;
            --text-secondary: #6B7A99;
            --text-muted: #3D4F6B;
            --accent-green: #0ECB81;
            --accent-green-dim: rgba(14,203,129,0.12);
            --accent-red: #F6465D;
            --accent-red-dim: rgba(246,70,93,0.12);
            --accent-yellow: #FCD535;
            --accent-blue: #00B8FF;
            --accent-blue-dim: rgba(0,184,255,0.12);
            --accent-purple: #A855F7;
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image:
                linear-gradient(rgba(14,203,129,0.025) 1px, transparent 1px),
                linear-gradient(90deg, rgba(14,203,129,0.025) 1px, transparent 1px);
            background-size: 44px 44px;
            pointer-events: none;
            z-index: 0;
        }

        .layer { display: none; min-height: 100vh; position: relative; z-index: 1; animation: fadeUp 0.4s ease-out; }
        .layer.active { display: block; }

        @keyframes fadeUp { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0%,100% { opacity:1; transform:scale(1); } 50% { opacity:0.7; transform:scale(1.08); } }
        @keyframes slideLeft { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
        @keyframes slideDown { from { transform: translateY(-100%); opacity:0; } to { transform: translateY(0); opacity:1; } }
        @keyframes slideInRight { from { transform: translateX(120%); opacity:0; } to { transform: translateX(0); opacity:1; } }
        @keyframes slideOutRight { from { transform: translateX(0); opacity:1; } to { transform: translateX(120%); opacity:0; } }
        @keyframes flashGreen { 0%,100% { color: var(--accent-green); } 50% { color: #fff; text-shadow: 0 0 20px var(--accent-green); } }
        @keyframes flashRed { 0%,100% { color: var(--accent-red); } 50% { color: #fff; text-shadow: 0 0 20px var(--accent-red); } }
        @keyframes glow { 0%,100% { box-shadow: 0 0 10px rgba(14,203,129,0.3); } 50% { box-shadow: 0 0 25px rgba(14,203,129,0.7); } }
        @keyframes confettiFall { 0% { transform: translateY(-20px) rotate(0deg); opacity:1; } 100% { transform: translateY(100vh) rotate(720deg); opacity:0; } }
        @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes blink { 0%,100% { opacity:1; } 50% { opacity:0.3; } }
        @keyframes countUp { from { opacity:0; transform:translateY(8px); } to { opacity:1; transform:translateY(0); } }
        @keyframes fadeOut { from { opacity:1; transform:translateY(0); } to { opacity:0; transform:translateY(20px); } }

        .market-ticker-bar { background: var(--bg-secondary); border-bottom: 1px solid var(--border-color); padding: 8px 0; overflow: hidden; position: sticky; top: 0; z-index: 1001; }
        .ticker-track { display: flex; animation: slideLeft 50s linear infinite; white-space: nowrap; width: max-content; }
        .ticker-item { display: inline-flex; align-items: center; gap: 8px; padding: 0 24px; font-family: 'JetBrains Mono', monospace; font-size: 12px; border-right: 1px solid var(--border-color); }
        .ticker-symbol { color: var(--text-secondary); font-weight: 600; }
        .ticker-price { color: var(--text-primary); font-weight: 700; }
        .ticker-change.pos { color: var(--accent-green); }
        .ticker-change.neg { color: var(--accent-red); }

        .navbar { background: rgba(13,20,33,0.97); backdrop-filter: blur(20px); padding: 14px 24px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); position: sticky; top: 33px; z-index: 1000; }
        .logo { display: flex; align-items: center; gap: 10px; font-size: 22px; font-weight: 900; color: var(--accent-green); cursor: pointer; letter-spacing: -0.5px; }
        .logo-icon { width: 36px; height: 36px; background: linear-gradient(135deg, var(--accent-green), #0B8F5F); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; animation: glow 3s ease-in-out infinite; }
        .nav-links { display: flex; gap: 12px; align-items: center; }
        .nav-btn { padding: 9px 20px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 13px; font-family: 'Space Grotesk', sans-serif; transition: all 0.25s; }
        .btn-login { background: transparent; color: var(--accent-blue); border: 1.5px solid var(--accent-blue); }
        .btn-signup { background: linear-gradient(135deg, var(--accent-green), #08A566); color: #000; font-weight: 700; }
        .nav-btn:hover { transform: translateY(-2px); filter: brightness(1.1); }

        .status-badge { display: flex; align-items: center; gap: 6px; padding: 6px 14px; background: var(--accent-green-dim); border: 1px solid rgba(14,203,129,0.3); border-radius: 20px; font-size: 11px; font-weight: 700; color: var(--accent-green); letter-spacing: 1px; }
        .status-dot { width: 6px; height: 6px; background: var(--accent-green); border-radius: 50%; animation: blink 1.5s ease-in-out infinite; }

        .notif-bell { position: relative; cursor: pointer; width: 38px; height: 38px; display: flex; align-items: center; justify-content: center; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 10px; font-size: 18px; transition: all 0.25s; }
        .notif-bell:hover { border-color: var(--accent-green); }
        .notif-count { position: absolute; top: -4px; right: -4px; background: var(--accent-red); color: #fff; font-size: 10px; font-weight: 700; width: 18px; height: 18px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .notif-dropdown { position: absolute; top: 50px; right: 0; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 14px; width: 320px; max-height: 420px; overflow-y: auto; z-index: 9999; display: none; box-shadow: 0 20px 60px rgba(0,0,0,0.6); }
        .notif-dropdown.open { display: block; animation: fadeUp 0.25s ease-out; }
        .notif-header { padding: 16px 20px; font-weight: 700; font-size: 14px; border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; background: var(--bg-card); }
        .notif-item { padding: 14px 20px; border-bottom: 1px solid var(--border-color); cursor: pointer; transition: background 0.2s; }
        .notif-item:hover { background: var(--bg-tertiary); }
        .notif-item-title { font-size: 13px; font-weight: 600; margin-bottom: 3px; }
        .notif-item-desc { font-size: 11px; color: var(--text-secondary); line-height: 1.4; }
        .notif-item-time { font-size: 10px; color: var(--text-muted); margin-top: 4px; }

        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }

        .hero-section { background: linear-gradient(135deg, rgba(14,203,129,0.08) 0%, rgba(0,184,255,0.05) 100%); border: 1px solid rgba(14,203,129,0.2); border-radius: 20px; padding: 48px 40px; margin-bottom: 20px; text-align: center; position: relative; overflow: hidden; }
        .hero-section::before { content: ''; position: absolute; top: -50%; left: 50%; transform: translateX(-50%); width: 600px; height: 300px; background: radial-gradient(ellipse, rgba(14,203,129,0.1) 0%, transparent 70%); pointer-events: none; }
        .hero-section h1 { font-size: 52px; font-weight: 900; background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-blue) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 16px; letter-spacing: -1.5px; line-height: 1.1; }
        .hero-section p { font-size: 17px; color: var(--text-secondary); margin-bottom: 28px; max-width: 600px; margin-left: auto; margin-right: auto; line-height: 1.6; }
        .hero-cta { display: flex; gap: 14px; justify-content: center; flex-wrap: wrap; }
        .hero-btn { padding: 16px 34px; border: none; border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer; font-family: 'Space Grotesk', sans-serif; transition: all 0.3s; letter-spacing: -0.3px; }
        .hero-btn-primary { background: linear-gradient(135deg, var(--accent-green), #08A566); color: #000; }
        .hero-btn-secondary { background: transparent; color: var(--accent-blue); border: 1.5px solid var(--accent-blue); }
        .hero-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(14,203,129,0.3); }

        .bonus-countdown-bar { background: linear-gradient(135deg, rgba(252,213,53,0.1), rgba(252,213,53,0.04)); border: 1px solid rgba(252,213,53,0.3); border-radius: 14px; padding: 16px 24px; margin-bottom: 20px; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 12px; }
        .bonus-countdown-text { font-size: 15px; font-weight: 700; color: var(--accent-yellow); }
        .countdown-timer { display: flex; gap: 8px; align-items: center; }
        .countdown-unit { background: rgba(0,0,0,0.4); border: 1px solid rgba(252,213,53,0.3); border-radius: 8px; padding: 8px 12px; text-align: center; min-width: 54px; }
        .countdown-num { font-family: 'JetBrains Mono', monospace; font-size: 24px; font-weight: 700; color: var(--accent-yellow); display: block; line-height: 1; }
        .countdown-label { font-size: 9px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 1px; }
        .countdown-colon { font-size: 22px; color: var(--accent-yellow); font-weight: 700; animation: blink 1s infinite; }
        .viewing-count { display: inline-flex; align-items: center; gap: 6px; padding: 6px 14px; background: var(--accent-red-dim); border: 1px solid rgba(246,70,93,0.2); border-radius: 20px; font-size: 12px; font-weight: 700; color: var(--accent-red); }

        .section-title { font-size: 13px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; color: var(--accent-green); margin-bottom: 14px; display: flex; align-items: center; gap: 8px; }

        .live-traders-section { background: var(--bg-secondary); border-radius: 14px; padding: 18px 20px; margin-bottom: 20px; border: 1px solid var(--border-color); overflow: hidden; }
        .ticker-wrapper { overflow: hidden; }
        .ticker-content { display: flex; animation: slideLeft 80s linear infinite; white-space: nowrap; width: max-content; }
        .trader-card { display: inline-flex; align-items: center; gap: 10px; padding: 10px 16px; background: var(--bg-card); border-radius: 10px; margin-right: 12px; border: 1px solid var(--border-color); min-width: 220px; }
        .trader-avatar { width: 36px; height: 36px; border-radius: 50%; background: linear-gradient(135deg, var(--accent-green), var(--accent-blue)); display: flex; align-items: center; justify-content: center; font-size: 16px; flex-shrink: 0; }
        .trader-name { font-size: 13px; font-weight: 600; color: var(--text-primary); }
        .trader-profit { font-size: 14px; font-weight: 700; color: var(--accent-green); font-family: 'JetBrains Mono', monospace; }

        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 14px; margin-bottom: 20px; }
        .stat-card { background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 14px; padding: 20px; text-align: center; cursor: pointer; transition: all 0.3s; position: relative; overflow: hidden; }
        .stat-card::before { content: ''; position: absolute; inset: 0; background: linear-gradient(135deg, var(--accent-green-dim), transparent); opacity: 0; transition: opacity 0.3s; }
        .stat-card:hover::before { opacity: 1; }
        .stat-card:hover { border-color: var(--accent-green); transform: translateY(-4px); box-shadow: 0 8px 30px rgba(14,203,129,0.15); }
        .stat-icon { font-size: 30px; margin-bottom: 10px; }
        .stat-value { font-size: 28px; font-weight: 900; color: var(--accent-green); margin-bottom: 4px; font-family: 'JetBrains Mono', monospace; letter-spacing: -1px; animation: countUp 0.6s ease-out; }
        .stat-label { font-size: 11px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 1px; font-weight: 600; }

        .winners-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 14px; margin-bottom: 20px; }
        .winner-card { background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 14px; padding: 20px; transition: all 0.3s; position: relative; overflow: hidden; }
        .winner-card:hover { border-color: var(--accent-green); transform: translateY(-4px); box-shadow: 0 10px 30px rgba(14,203,129,0.15); }
        .winner-rank { position: absolute; top: 12px; right: 12px; width: 32px; height: 32px; background: linear-gradient(135deg, var(--accent-yellow), #f59e0b); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 900; color: #000; font-size: 14px; }
        .winner-header { display: flex; align-items: center; gap: 12px; margin-bottom: 14px; }
        .winner-avatar { width: 52px; height: 52px; border-radius: 50%; background: linear-gradient(135deg, var(--accent-green), var(--accent-blue)); display: flex; align-items: center; justify-content: center; font-size: 24px; flex-shrink: 0; }
        .winner-name { font-size: 16px; font-weight: 700; margin-bottom: 2px; }
        .winner-location { font-size: 11px; color: var(--text-secondary); }
        .winner-join { font-size: 10px; color: var(--text-muted); margin-top: 2px; }
        .winner-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .winner-stat { background: var(--accent-green-dim); border: 1px solid rgba(14,203,129,0.15); padding: 10px; border-radius: 8px; text-align: center; }
        .winner-stat-label { font-size: 10px; color: var(--text-secondary); margin-bottom: 3px; text-transform: uppercase; letter-spacing: 0.5px; }
        .winner-stat-value { font-size: 18px; font-weight: 700; color: var(--accent-green); font-family: 'JetBrains Mono', monospace; }

        .orderbook-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-bottom: 20px; }
        .orderbook-side { background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 14px; padding: 16px; font-family: 'JetBrains Mono', monospace; }
        .orderbook-title { font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 12px; padding-bottom: 10px; border-bottom: 1px solid var(--border-color); }
        .orderbook-header { display: grid; grid-template-columns: 1fr 1fr 1fr; font-size: 10px; color: var(--text-secondary); text-transform: uppercase; margin-bottom: 8px; padding: 0 4px; }
        .orderbook-row { display: grid; grid-template-columns: 1fr 1fr 1fr; font-size: 12px; padding: 5px 4px; border-radius: 4px; cursor: pointer; position: relative; overflow: hidden; margin-bottom: 2px; transition: opacity 0.2s; }
        .orderbook-row:hover { opacity: 0.8; }
        .orderbook-bar { position: absolute; top: 0; bottom: 0; opacity: 0.1; border-radius: 3px; transition: width 0.5s ease; }
        .ask-row .orderbook-bar { background: var(--accent-red); right: 0; }
        .bid-row .orderbook-bar { background: var(--accent-green); left: 0; }
        .ask-price { color: var(--accent-red); font-weight: 600; }
        .bid-price { color: var(--accent-green); font-weight: 600; }
        .ob-amount { color: var(--text-secondary); }
        .ob-total { color: var(--text-muted); }

        .pairs-selector { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 16px; }
        .pair-btn { padding: 8px 16px; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 8px; color: var(--text-secondary); font-size: 13px; font-weight: 600; cursor: pointer; font-family: 'Space Grotesk', sans-serif; transition: all 0.2s; }
        .pair-btn.active, .pair-btn:hover { border-color: var(--accent-green); color: var(--accent-green); background: var(--accent-green-dim); }

        .price-info { display: flex; justify-content: space-between; align-items: center; padding: 16px 20px; background: var(--bg-card); border-radius: 12px; margin-bottom: 14px; border: 1px solid var(--border-color); }
        .current-price { font-size: 34px; font-weight: 900; color: var(--accent-green); font-family: 'JetBrains Mono', monospace; letter-spacing: -1px; transition: all 0.3s; }
        .current-price.flash-up { animation: flashGreen 0.5s ease; }
        .current-price.flash-down { animation: flashRed 0.5s ease; color: var(--accent-red); }
        .price-change { font-size: 15px; font-weight: 700; padding: 8px 16px; border-radius: 8px; font-family: 'JetBrains Mono', monospace; }
        .price-change.positive { background: var(--accent-green-dim); color: var(--accent-green); }
        .price-change.negative { background: var(--accent-red-dim); color: var(--accent-red); }

        .price-stats-bar { display: grid; grid-template-columns: repeat(6,1fr); gap: 8px; margin-bottom: 14px; padding: 12px 16px; background: var(--bg-card); border-radius: 10px; border: 1px solid var(--border-color); }
        .price-stat-item { text-align: center; }
        .price-stat-label { font-size: 10px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 3px; }
        .price-stat-value { font-size: 13px; font-weight: 700; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; }

        .chart-section { background: var(--bg-secondary); border-radius: 14px; padding: 20px; margin-bottom: 20px; border: 1px solid var(--border-color); }
        .chart-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px; flex-wrap: wrap; gap: 10px; }
        .chart-title { font-size: 16px; font-weight: 700; color: var(--accent-green); }
        .tv-chart-container { width: 100%; border-radius: 10px; overflow: hidden; border: 1px solid var(--border-color); }

        .auth-container { max-width: 460px; margin: 60px auto; padding: 40px; background: var(--bg-secondary); border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.5); border: 1px solid var(--border-color); }
        .auth-logo { text-align: center; margin-bottom: 28px; }
        .auth-logo-icon { font-size: 56px; display: block; margin-bottom: 8px; animation: pulse 2.5s infinite; }
        .auth-logo-text { font-size: 28px; font-weight: 900; background: linear-gradient(135deg, var(--accent-green), var(--accent-blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; letter-spacing: -1px; }
        .auth-title { font-size: 22px; font-weight: 700; text-align: center; margin-bottom: 24px; }

        .form-group { margin-bottom: 18px; }
        .form-group label { display: block; margin-bottom: 7px; font-size: 12px; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.8px; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 13px 16px; border: 1.5px solid var(--border-color); border-radius: 10px; background: var(--bg-card); color: var(--text-primary); font-size: 15px; font-family: 'Space Grotesk', sans-serif; transition: all 0.25s; }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: var(--accent-green); box-shadow: 0 0 0 3px rgba(14,203,129,0.1); }
        .form-group select option { background: var(--bg-card); }
        .btn-submit { width: 100%; padding: 15px; border: none; border-radius: 10px; background: linear-gradient(135deg, var(--accent-green), #08A566); color: #000; font-size: 16px; font-weight: 700; font-family: 'Space Grotesk', sans-serif; cursor: pointer; transition: all 0.3s; letter-spacing: -0.3px; }
        .btn-submit:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(14,203,129,0.4); }

        .balance-card { background: linear-gradient(135deg, rgba(14,203,129,0.12) 0%, rgba(0,184,255,0.06) 100%); border: 1px solid rgba(14,203,129,0.25); border-radius: 16px; padding: 24px; margin-bottom: 20px; text-align: center; position: relative; overflow: hidden; }
        .balance-card::before { content: ''; position: absolute; top: -60%; left: 50%; transform: translateX(-50%); width: 300px; height: 200px; background: radial-gradient(ellipse, rgba(14,203,129,0.12) 0%, transparent 70%); }
        .balance-label { font-size: 11px; text-transform: uppercase; letter-spacing: 2px; color: var(--text-secondary); margin-bottom: 8px; font-weight: 700; }
        .balance-amount { font-size: 52px; font-weight: 900; color: var(--accent-green); font-family: 'JetBrains Mono', monospace; letter-spacing: -2px; margin-bottom: 16px; }
        .balance-sub { display: grid; grid-template-columns: repeat(3,1fr); gap: 10px; }
        .balance-sub-item { background: rgba(0,0,0,0.3); padding: 12px; border-radius: 8px; }
        .balance-sub-label { font-size: 10px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px; }
        .balance-sub-value { font-size: 15px; font-weight: 700; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; }

        .action-buttons { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px; margin-bottom: 20px; }
        .action-btn { padding: 18px 16px; border: none; border-radius: 12px; font-size: 14px; font-weight: 700; cursor: pointer; font-family: 'Space Grotesk', sans-serif; transition: all 0.3s; text-align: center; letter-spacing: -0.3px; }
        .action-btn:hover { transform: translateY(-3px); filter: brightness(1.1); box-shadow: 0 8px 20px rgba(0,0,0,0.3); }

        .account-switcher { display: flex; gap: 6px; background: var(--bg-card); padding: 5px; border-radius: 10px; border: 1px solid var(--border-color); }
        .switch-btn { padding: 9px 20px; border: none; border-radius: 7px; font-weight: 700; font-size: 13px; cursor: pointer; font-family: 'Space Grotesk', sans-serif; background: transparent; color: var(--text-secondary); transition: all 0.25s; }
        .switch-btn.active { background: linear-gradient(135deg, var(--accent-green), #08A566); color: #000; }

        .payment-grid { display: grid; grid-template-columns: repeat(2,1fr); gap: 10px; margin-bottom: 18px; }
        .payment-btn { padding: 18px 14px; border: 1.5px solid var(--border-color); border-radius: 10px; background: var(--bg-card); color: var(--text-primary); cursor: pointer; font-family: 'Space Grotesk', sans-serif; font-size: 14px; font-weight: 600; text-align: center; transition: all 0.25s; }
        .payment-btn.active, .payment-btn:hover { border-color: var(--accent-green); background: var(--accent-green-dim); color: var(--accent-green); }
        .payment-details { background: var(--accent-green-dim); border: 1.5px solid rgba(14,203,129,0.25); border-radius: 12px; padding: 20px; margin: 14px 0; display: none; }
        .payment-details.active { display: block; animation: fadeUp 0.3s ease-out; }
        .payment-value { font-family: 'JetBrains Mono', monospace; font-size: 16px; font-weight: 700; color: var(--accent-green); word-break: break-all; background: rgba(0,0,0,0.3); padding: 12px 16px; border-radius: 8px; margin: 10px 0; }
        .copy-btn { width: 100%; background: linear-gradient(135deg, var(--accent-blue), #0088cc); color: #fff; border: none; padding: 11px 18px; border-radius: 8px; font-weight: 700; font-size: 13px; font-family: 'Space Grotesk', sans-serif; cursor: pointer; transition: all 0.25s; }
        .copy-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,184,255,0.4); }

        .how-to-pay { background: rgba(14,203,129,0.05); border-left: 3px solid var(--accent-green); padding: 14px 16px; border-radius: 0 8px 8px 0; margin-top: 14px; }
        .how-to-pay-title { font-size: 13px; font-weight: 700; color: var(--accent-green); margin-bottom: 8px; }
        .how-to-pay ol { margin-left: 18px; font-size: 12px; color: var(--text-primary); line-height: 2; }

        .progress-bar-container { background: var(--bg-card); border: 1px solid rgba(14,203,129,0.2); border-radius: 14px; padding: 20px; margin-bottom: 16px; display: none; }
        .progress-bar-container.show { display: block; animation: fadeUp 0.3s ease-out; }
        .progress-label { font-size: 14px; font-weight: 700; margin-bottom: 12px; color: var(--accent-green); }
        .progress-bar-track { background: var(--bg-tertiary); border-radius: 100px; height: 10px; overflow: hidden; margin-bottom: 8px; }
        .progress-bar-fill { height: 100%; background: linear-gradient(90deg, var(--accent-green), var(--accent-blue)); border-radius: 100px; width: 0%; transition: width 0.6s ease; }
        .progress-text { font-size: 12px; color: var(--text-secondary); font-family: 'JetBrains Mono', monospace; }

        .live-winner-toast { position: fixed; bottom: 90px; right: 20px; background: var(--bg-card); border: 1.5px solid var(--accent-green); border-radius: 14px; padding: 14px 18px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); z-index: 9997; max-width: 280px; display: flex; align-items: center; gap: 12px; animation: slideInRight 0.4s ease-out; }
        .live-winner-toast.hiding { animation: slideOutRight 0.4s ease-in forwards; }
        .winner-toast-avatar { font-size: 30px; flex-shrink: 0; }
        .winner-toast-name { font-size: 13px; font-weight: 700; color: var(--text-primary); }
        .winner-toast-amount { font-size: 16px; font-weight: 900; color: var(--accent-green); font-family: 'JetBrains Mono', monospace; }
        .winner-toast-action { font-size: 11px; color: var(--text-secondary); margin-top: 2px; }

        .toast-notification { position: fixed; top: 80px; right: 20px; background: var(--bg-card); border: 1px solid var(--accent-green); color: var(--text-primary); padding: 16px 22px; border-radius: 14px; box-shadow: 0 10px 40px rgba(0,0,0,0.5); z-index: 10000; max-width: 380px; display: none; white-space: pre-line; font-size: 14px; line-height: 1.6; animation: slideInRight 0.4s ease-out; }
        .toast-notification.show { display: block; }
        .toast-notification.error { border-color: var(--accent-red); }

        .referral-banner { position: fixed; top: 0; left: 0; right: 0; background: linear-gradient(135deg, #0ECB81, #0B8F5F); padding: 20px; text-align: center; z-index: 9999; display: none; animation: slideDown 0.5s ease-out; }
        .referral-banner.show { display: block; }
        .referral-banner h2 { font-size: 24px; color: #fff; font-weight: 900; margin-bottom: 6px; }
        .referral-banner p { font-size: 15px; color: rgba(255,255,255,0.92); line-height: 1.6; }
        .bonus-big { display: inline-block; font-size: 40px; font-weight: 900; color: var(--accent-yellow); animation: pulse 2s infinite; margin: 8px 0; }
        .close-banner { position: absolute; top: 12px; right: 16px; background: rgba(255,255,255,0.2); border: none; color: #fff; font-size: 22px; width: 30px; height: 30px; border-radius: 50%; cursor: pointer; transition: all 0.3s; }
        .close-banner:hover { background: rgba(255,255,255,0.35); transform: rotate(90deg); }

        .ai-assistant-btn { position: fixed; bottom: 90px; right: 20px; z-index: 1000; display: none; }
        .ai-btn-inner { width: 60px; height: 60px; background: linear-gradient(135deg, var(--accent-purple), #7c3aed); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 26px; cursor: pointer; box-shadow: 0 4px 20px rgba(168,85,247,0.5); transition: all 0.3s; border: none; animation: glow 3s ease-in-out infinite; }
        .ai-btn-inner:hover { transform: scale(1.1); }
        .ai-pulse-ring { position: absolute; inset: -4px; border-radius: 50%; border: 2px solid rgba(168,85,247,0.4); animation: rotate 3s linear infinite; pointer-events: none; }
        .ai-chat-panel { position: fixed; bottom: 170px; right: 20px; width: 340px; background: var(--bg-card); border: 1px solid rgba(168,85,247,0.4); border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.6); z-index: 1001; display: none; overflow: hidden; flex-direction: column; }
        .ai-chat-panel.open { display: flex; animation: fadeUp 0.3s ease-out; }
        .ai-chat-header { background: linear-gradient(135deg, rgba(168,85,247,0.2), rgba(168,85,247,0.05)); padding: 16px 20px; border-bottom: 1px solid rgba(168,85,247,0.2); display: flex; align-items: center; gap: 12px; }
        .ai-avatar { width: 40px; height: 40px; background: linear-gradient(135deg, var(--accent-purple), #7c3aed); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; flex-shrink: 0; }
        .ai-name { font-size: 15px; font-weight: 700; }
        .ai-status { font-size: 11px; color: var(--accent-green); display: flex; align-items: center; gap: 4px; margin-top: 2px; }
        .ai-chat-messages { flex: 1; padding: 16px; max-height: 280px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .ai-msg { max-width: 85%; padding: 10px 14px; border-radius: 12px; font-size: 13px; line-height: 1.5; }
        .ai-msg.bot { background: rgba(168,85,247,0.12); border: 1px solid rgba(168,85,247,0.2); align-self: flex-start; border-radius: 4px 12px 12px 12px; }
        .ai-msg.user { background: var(--accent-green-dim); border: 1px solid rgba(14,203,129,0.2); align-self: flex-end; border-radius: 12px 4px 12px 12px; color: var(--accent-green); }
        .ai-typing { display: flex; gap: 4px; padding: 10px 14px; background: rgba(168,85,247,0.12); border-radius: 4px 12px 12px 12px; align-self: flex-start; width: fit-content; }
        .ai-typing span { width: 6px; height: 6px; background: var(--accent-purple); border-radius: 50%; animation: blink 1s infinite; }
        .ai-typing span:nth-child(2) { animation-delay: 0.2s; }
        .ai-typing span:nth-child(3) { animation-delay: 0.4s; }
        .ai-quick-replies { padding: 10px 16px; display: flex; gap: 6px; flex-wrap: wrap; border-top: 1px solid rgba(168,85,247,0.15); }
        .ai-quick-btn { padding: 6px 12px; background: rgba(168,85,247,0.1); border: 1px solid rgba(168,85,247,0.25); border-radius: 20px; color: var(--accent-purple); font-size: 11px; font-weight: 600; cursor: pointer; font-family: 'Space Grotesk', sans-serif; transition: all 0.2s; }
        .ai-quick-btn:hover { background: rgba(168,85,247,0.2); }
        .ai-input-row { padding: 12px 16px; border-top: 1px solid rgba(168,85,247,0.15); display: flex; gap: 8px; }
        .ai-input { flex: 1; padding: 10px 14px; background: var(--bg-tertiary); border: 1px solid rgba(168,85,247,0.25); border-radius: 10px; color: var(--text-primary); font-size: 13px; font-family: 'Space Grotesk', sans-serif; outline: none; }
        .ai-send-btn { width: 38px; height: 38px; background: linear-gradient(135deg, var(--accent-purple), #7c3aed); border: none; border-radius: 10px; color: #fff; font-size: 16px; cursor: pointer; transition: all 0.2s; }
        .ai-send-btn:hover { transform: scale(1.1); }

        .bot-card { background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 14px; padding: 22px; transition: all 0.3s; }
        .bot-card:hover { border-color: var(--accent-green); transform: translateY(-4px); box-shadow: 0 10px 30px rgba(14,203,129,0.15); }

        .active-bot-item { background: rgba(0,0,0,0.3); border-radius: 12px; padding: 18px; margin-bottom: 12px; border: 1px solid var(--border-color); transition: border-color 0.3s; }
        .active-bot-item.running { border-color: rgba(14,203,129,0.3); }
        .active-bot-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px; }
        .active-bot-stats { display: grid; grid-template-columns: repeat(3,1fr); gap: 10px; }
        .active-bot-stat { text-align: center; background: rgba(0,0,0,0.2); padding: 10px; border-radius: 8px; }
        .active-bot-stat-label { font-size: 10px; color: var(--text-secondary); text-transform: uppercase; margin-bottom: 4px; }
        .active-bot-stat-value { font-size: 18px; font-weight: 900; font-family: 'JetBrains Mono', monospace; }

        .history-item { background: var(--bg-card); border-radius: 12px; padding: 18px; margin-bottom: 10px; border: 1px solid var(--border-color); transition: all 0.2s; }
        .history-item:hover { border-color: rgba(14,203,129,0.3); }

        .profile-info-box { background: var(--bg-card); border-radius: 12px; padding: 20px; border: 1px solid var(--border-color); }
        .profile-info-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--border-color); }
        .profile-info-row:last-child { border-bottom: none; }
        .profile-info-label { font-size: 12px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px; font-weight: 600; }
        .profile-info-value { font-size: 15px; font-weight: 700; }
        .verified-badge { display: inline-flex; align-items: center; gap: 4px; padding: 3px 10px; background: var(--accent-green-dim); border: 1px solid rgba(14,203,129,0.3); border-radius: 20px; font-size: 11px; font-weight: 700; color: var(--accent-green); }

        .share-rewards-card { background: linear-gradient(135deg, rgba(252,213,53,0.12), rgba(252,213,53,0.04)); border: 1px solid rgba(252,213,53,0.3); border-radius: 14px; padding: 22px; margin-bottom: 20px; }
        .share-stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; background: rgba(0,0,0,0.3); padding: 18px; border-radius: 10px; margin: 14px 0; }
        .share-stat { text-align: center; }
        .share-stat-label { font-size: 11px; color: var(--text-secondary); margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px; }
        .share-stat-value { font-size: 30px; font-weight: 900; font-family: 'JetBrains Mono', monospace; }

        .whatsapp-support { position: fixed; bottom: 20px; left: 20px; z-index: 1000; }
        .whatsapp-btn { display: flex; align-items: center; gap: 10px; background: linear-gradient(135deg, #25D366, #128C7E); color: #fff; padding: 14px 22px; border-radius: 50px; text-decoration: none; font-weight: 700; font-size: 14px; font-family: 'Space Grotesk', sans-serif; box-shadow: 0 4px 20px rgba(37,211,102,0.4); transition: all 0.3s; }
        .whatsapp-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 30px rgba(37,211,102,0.6); }

        .alert { padding: 11px 15px; border-radius: 8px; margin-bottom: 16px; font-size: 13px; display: none; }
        .alert.show { display: block; animation: fadeUp 0.3s ease-out; }
        .alert-success { background: var(--accent-green-dim); border: 1px solid rgba(14,203,129,0.3); color: var(--accent-green); }
        .alert-error { background: var(--accent-red-dim); border: 1px solid rgba(246,70,93,0.3); color: var(--accent-red); }

        .confetti-piece { position: fixed; z-index: 9999; pointer-events: none; border-radius: 2px; }

        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: var(--bg-primary); }
        ::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }

        .mobile-bottom-nav { display: none; position: fixed; bottom: 0; left: 0; right: 0; background: var(--bg-secondary); border-top: 1px solid var(--border-color); padding: 8px 0; z-index: 999; }
        @media (max-width: 768px) { .mobile-bottom-nav { display: flex; } }
        .mobile-nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 3px; cursor: pointer; padding: 6px 0; transition: all 0.2s; }
        .mobile-nav-item.active .mobile-nav-icon, .mobile-nav-item.active .mobile-nav-label { color: var(--accent-green); }
        .mobile-nav-icon { font-size: 20px; }
        .mobile-nav-label { font-size: 10px; color: var(--text-secondary); font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }

        @media (max-width: 768px) {
            .container { padding: 12px; }
            .hero-section h1 { font-size: 32px; }
            .hero-section { padding: 28px 20px; }
            .orderbook-grid { grid-template-columns: 1fr; }
            .price-stats-bar { grid-template-columns: repeat(3,1fr); }
            .balance-amount { font-size: 38px; }
            .ai-chat-panel { width: calc(100vw - 40px); right: 20px; }
            .market-ticker-bar { display: none; }
            .payment-grid { grid-template-columns: 1fr; }
            .navbar { top: 0; }
        }
    </style>
</head>
<body>

<!-- ===== REFERRAL BANNER ===== -->
<div id="referralSuccessBanner" class="referral-banner">
    <button class="close-banner" onclick="closeReferralBanner()">√ó</button>
    <h2>üéâ CONGRATULATIONS! üéâ</h2>
    <p><strong id="referrerName">Your friend</strong> is crushing it on CryptoPro!</p>
    <div class="bonus-big">GET $25 BONUS!</div>
    <p>‚úÖ Sign up now &nbsp;‚úÖ 100% withdrawable &nbsp;‚úÖ Start earning day one</p>
</div>

<!-- ===== TOAST ===== -->
<div id="toastNotification" class="toast-notification"></div>

<!-- ===== MARKET TICKER BAR ===== -->
<div class="market-ticker-bar">
    <div class="ticker-track" id="marketTickerTrack"></div>
</div>

<!-- ===== AI ASSISTANT BUTTON ===== -->
<div class="ai-assistant-btn" id="aiAssistantBtn">
    <button class="ai-btn-inner" onclick="toggleAIChat()">ü§ñ</button>
    <div class="ai-pulse-ring"></div>
</div>

<!-- ===== AI CHAT PANEL ===== -->
<div class="ai-chat-panel" id="aiChatPanel">
    <div class="ai-chat-header">
        <div class="ai-avatar">ü§ñ</div>
        <div>
            <div class="ai-name">ARIA ‚Äî CryptoPro AI</div>
            <div class="ai-status"><span class="status-dot"></span> Online ‚Ä¢ Always ready</div>
        </div>
        <button onclick="toggleAIChat()" style="margin-left:auto;background:none;border:none;color:var(--text-secondary);font-size:20px;cursor:pointer;line-height:1;">√ó</button>
    </div>
    <div class="ai-chat-messages" id="aiMessages">
        <div class="ai-msg bot">üëã Hi! I'm <strong>ARIA</strong>, your AI trading assistant.<br><br>I can help you with market insights, trading strategies, deposit guides and more. What would you like to know?</div>
    </div>
    <div class="ai-quick-replies">
        <button class="ai-quick-btn" onclick="sendAIQuickReply('Best bot for beginners?')">Best bot?</button>
        <button class="ai-quick-btn" onclick="sendAIQuickReply('How do I deposit?')">How to deposit?</button>
        <button class="ai-quick-btn" onclick="sendAIQuickReply('BTC price prediction?')">BTC outlook?</button>
        <button class="ai-quick-btn" onclick="sendAIQuickReply('How does withdrawal work?')">Withdraw?</button>
        <button class="ai-quick-btn" onclick="sendAIQuickReply('How does referral work?')">Referrals?</button>
    </div>
    <div class="ai-input-row">
        <input type="text" class="ai-input" id="aiInput" placeholder="Ask ARIA anything..." onkeydown="if(event.key==='Enter')sendAIMessage()">
        <button class="ai-send-btn" onclick="sendAIMessage()">‚û§</button>
    </div>
</div>

<!-- ===== WELCOME LAYER ===== -->
<div id="welcomeLayer" class="layer active">
    <nav class="navbar">
        <div class="logo" onclick="showLayer('welcomeLayer')">
            <div class="logo-icon">‚Çø</div>
            CryptoPro
        </div>
        <div class="nav-links">
            <button class="nav-btn btn-login" onclick="showLayer('loginLayer')">Login</button>
            <button class="nav-btn btn-signup" onclick="showLayer('signupLayer')">Sign Up Free</button>
        </div>
    </nav>
    <div class="container">
        <div class="bonus-countdown-bar">
            <div>
                <div class="bonus-countdown-text">üî• 100% Welcome Bonus ‚Äî First Deposit DOUBLED!</div>
                <div style="font-size:12px;color:var(--text-secondary);margin-top:3px;">Limited time offer ‚Äî Don't miss out!</div>
            </div>
            <div class="countdown-timer">
                <div class="countdown-unit"><span class="countdown-num" id="cdHours">23</span><span class="countdown-label">Hours</span></div>
                <span class="countdown-colon">:</span>
                <div class="countdown-unit"><span class="countdown-num" id="cdMins">47</span><span class="countdown-label">Mins</span></div>
                <span class="countdown-colon">:</span>
                <div class="countdown-unit"><span class="countdown-num" id="cdSecs">00</span><span class="countdown-label">Secs</span></div>
            </div>
            <div class="viewing-count">üî¥ <span id="viewingCount">47</span> people viewing</div>
        </div>
        <div class="hero-section">
            <h1>üöÄ The Future of<br>Crypto Trading</h1>
            <p>Join 50,000+ successful traders earning daily profits with AI-powered automation. Get started with a <strong style="color:var(--accent-green);">$25 signup bonus</strong> and experience professional trading today!</p>
            <div class="hero-cta">
                <button class="hero-btn hero-btn-primary" onclick="showLayer('signupLayer')">Get Started ‚Äî Free $25 Bonus</button>
                <button class="hero-btn hero-btn-secondary" onclick="showLayer('chartsLayer')">View Live Charts</button>
            </div>
        </div>
        <div class="live-traders-section">
            <div class="section-title">üî• Live Active Traders ‚Äî Real-Time Profits</div>
            <div class="ticker-wrapper">
                <div class="ticker-content" id="liveTradersTicker"></div>
            </div>
        </div>
        <div class="stats-grid">
            <div class="stat-card"><div class="stat-icon">üë•</div><div class="stat-value" id="statTraders">50,247</div><div class="stat-label">Active Traders</div></div>
            <div class="stat-card"><div class="stat-icon">üí∞</div><div class="stat-value" id="statProfits">$125M+</div><div class="stat-label">Total Profits Paid</div></div>
            <div class="stat-card"><div class="stat-icon">üìà</div><div class="stat-value">98.5%</div><div class="stat-label">Success Rate</div></div>
            <div class="stat-card"><div class="stat-icon">‚ö°</div><div class="stat-value" id="statTrades">15,892</div><div class="stat-label">Daily Trades</div></div>
        </div>
        <div class="chart-section">
            <div class="section-title">üèÜ Top Traders This Week</div>
            <div class="winners-grid" id="topWinnersGrid"></div>
        </div>
        <div class="action-buttons">
            <button class="action-btn" style="background:linear-gradient(135deg,#fbbf24,#f59e0b);color:#000;" onclick="showLayer('reviewsLayer')">‚≠ê See Reviews</button>
            <button class="action-btn" style="background:linear-gradient(135deg,var(--accent-green),#08A566);color:#000;" onclick="showLayer('signupLayer')">üìä Start Trading Now</button>
        </div>
    </div>
    <div class="whatsapp-support">
        <a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:24px;">üí¨</span> Support</a>
    </div>
</div>

<!-- ===== CHARTS LAYER ===== -->
<div id="chartsLayer" class="layer">
    <nav class="navbar">
        <div class="logo" onclick="showLayer('welcomeLayer')"><div class="logo-icon">‚Çø</div>CryptoPro</div>
        <div class="nav-links">
            <div class="status-badge"><span class="status-dot"></span> LIVE</div>
            <button class="nav-btn btn-signup" onclick="showLayer('signupLayer')">Sign Up</button>
        </div>
    </nav>
    <div class="container">
        <div class="pairs-selector" id="chartPairsSelector">
            <button class="pair-btn active" onclick="selectChartPair(this,'BTCUSDT','BTC/USDT','Bitcoin / USDT')">BTC/USDT</button>
            <button class="pair-btn" onclick="selectChartPair(this,'ETHUSDT','ETH/USDT','Ethereum / USDT')">ETH/USDT</button>
            <button class="pair-btn" onclick="selectChartPair(this,'BNBUSDT','BNB/USDT','BNB / USDT')">BNB/USDT</button>
            <button class="pair-btn" onclick="selectChartPair(this,'SOLUSDT','SOL/USDT','Solana / USDT')">SOL/USDT</button>
            <button class="pair-btn" onclick="selectChartPair(this,'ADAUSDT','ADA/USDT','Cardano / USDT')">ADA/USDT</button>
            <button class="pair-btn" onclick="selectChartPair(this,'XRPUSDT','XRP/USDT','Ripple / USDT')">XRP/USDT</button>
        </div>
        <div class="chart-section">
            <div class="chart-header">
                <div class="chart-title">üìà <span id="chartPairLabel">BTC/USDT</span> Live Chart</div>
                <div class="status-badge"><span class="status-dot"></span> LIVE</div>
            </div>
            <div class="price-info">
                <div>
                    <div class="current-price" id="currentPrice">$98,245.50</div>
                    <div style="font-size:12px;color:var(--text-secondary);margin-top:4px;" id="currentPairSub">Bitcoin / USDT</div>
                </div>
                <div class="price-change positive" id="priceChange">+2.45%</div>
            </div>
            <div class="price-stats-bar">
                <div class="price-stat-item"><div class="price-stat-label">24h High</div><div class="price-stat-value" id="chartHigh">$99,120</div></div>
                <div class="price-stat-item"><div class="price-stat-label">24h Low</div><div class="price-stat-value" id="chartLow">$96,800</div></div>
                <div class="price-stat-item"><div class="price-stat-label">Volume</div><div class="price-stat-value" id="chartVolume">28.5B</div></div>
                <div class="price-stat-item"><div class="price-stat-label">Open</div><div class="price-stat-value" id="chartOpen">$97,850</div></div>
                <div class="price-stat-item"><div class="price-stat-label">Close</div><div class="price-stat-value" id="chartClose">$98,245</div></div>
                <div class="price-stat-item"><div class="price-stat-label">24h Change</div><div class="price-stat-value" id="chart24h" style="color:var(--accent-green);">+2.45%</div></div>
            </div>
            <div class="tv-chart-container">
                <div id="tv_chart_main" style="height:500px;"></div>
            </div>
        </div>
    </div>
    <div class="whatsapp-support">
        <a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:24px;">üí¨</span> Support</a>
    </div>
</div>

<!-- ===== SIGNUP LAYER ===== -->
<div id="signupLayer" class="layer">
    <div class="auth-container">
        <div class="auth-logo">
            <span class="auth-logo-icon">üíé</span>
            <div class="auth-logo-text">CryptoPro</div>
        </div>
        <div class="auth-title">Start Your Trading Journey</div>
        <div style="background:var(--accent-green-dim);border:1px solid rgba(14,203,129,0.3);border-radius:10px;padding:12px 16px;margin-bottom:20px;text-align:center;">
            <div style="font-size:14px;font-weight:700;color:var(--accent-green);">üéÅ You'll receive $25 INSTANT BONUS on signup!</div>
        </div>
        <div id="signupAlert" class="alert"></div>
        <form onsubmit="return handleSignup(event)">
            <div class="form-group"><label>Full Name</label><input type="text" id="signupName" placeholder="Enter your full name" required></div>
            <div class="form-group"><label>Email Address</label><input type="email" id="signupEmail" placeholder="your@email.com" required></div>
            <div class="form-group"><label>Phone Number</label><input type="tel" id="signupPhone" placeholder="+254 712 345 678" required></div>
            <div class="form-group"><label>Password</label><input type="password" id="signupPassword" placeholder="Create strong password" required></div>
            <div class="form-group"><label>Confirm Password</label><input type="password" id="signupConfirm" placeholder="Re-enter password" required></div>
            <div class="form-group"><label>Referral Code (Optional)</label><input type="text" id="signupReferralCode" placeholder="Enter referral code if you have one"></div>
            <button type="submit" class="btn-submit">üöÄ Create Account & Get $25 Bonus</button>
        </form>
        <div style="text-align:center;margin-top:20px;font-size:14px;color:var(--text-secondary);">
            Already have an account? <a onclick="showLayer('loginLayer')" style="color:var(--accent-green);cursor:pointer;font-weight:700;">Login Here</a>
        </div>
    </div>
    <div class="whatsapp-support">
        <a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:24px;">üí¨</span> Support</a>
    </div>
</div>

<!-- ===== LOGIN LAYER ===== -->
<div id="loginLayer" class="layer">
    <div class="auth-container">
        <div class="auth-logo">
            <span class="auth-logo-icon">üíé</span>
            <div class="auth-logo-text">CryptoPro</div>
        </div>
        <div class="auth-title">Welcome Back</div>
        <div id="loginAlert" class="alert"></div>
        <form onsubmit="return handleLogin(event)">
            <div class="form-group"><label>Email Address</label><input type="email" id="loginEmail" placeholder="your@email.com" required></div>
            <div class="form-group"><label>Password</label><input type="password" id="loginPassword" placeholder="Enter your password" required></div>
            <button type="submit" class="btn-submit">üîê Login to Account</button>
        </form>
        <div style="text-align:center;margin-top:20px;font-size:14px;color:var(--text-secondary);">
            Don't have an account? <a onclick="showLayer('signupLayer')" style="color:var(--accent-green);cursor:pointer;font-weight:700;">Create Account</a>
        </div>
    </div>
    <div class="whatsapp-support">
        <a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:24px;">üí¨</span> Support</a>
    </div>
</div>

<!-- ===== DASHBOARD LAYER ===== -->
<div id="dashboardLayer" class="layer">
    <nav class="navbar">
        <div class="logo"><div class="logo-icon">‚Çø</div>CryptoPro</div>
        <div class="nav-links">
            <div class="status-badge"><span class="status-dot"></span> LIVE</div>
            <div style="position:relative;" id="notifBellWrapper">
                <div class="notif-bell" onclick="toggleNotifications()">üîî<div class="notif-count" id="notifCount">3</div></div>
                <div class="notif-dropdown" id="notifDropdown">
                    <div class="notif-header">Notifications<span style="font-size:11px;color:var(--accent-green);cursor:pointer;font-weight:600;" onclick="clearNotifications()">Mark all read</span></div>
                    <div id="notifList"></div>
                </div>
            </div>
            <button class="nav-btn btn-login" onclick="handleLogout()">Logout</button>
        </div>
    </nav>
    <div class="container">
        <div style="background:var(--bg-secondary);padding:18px 20px;border-radius:14px;margin-bottom:18px;border:1px solid var(--border-color);display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:14px;">
            <div style="display:flex;align-items:center;gap:12px;">
                <div style="width:50px;height:50px;border-radius:50%;background:linear-gradient(135deg,var(--accent-green),var(--accent-blue));display:flex;align-items:center;justify-content:center;font-size:24px;flex-shrink:0;">üë§</div>
                <div>
                    <div style="font-size:18px;font-weight:700;" id="userName">User</div>
                    <div style="font-size:12px;color:var(--text-secondary);" id="userEmail">email@example.com</div>
                    <div class="verified-badge" style="margin-top:5px;">‚úì Verified Trader</div>
                </div>
            </div>
            <div class="account-switcher">
                <button class="switch-btn active" id="switchToDemo" onclick="switchAccount('demo')">üìä DEMO</button>
                <button class="switch-btn" id="switchToReal" onclick="switchAccount('real')">üíé REAL</button>
            </div>
        </div>
        <div id="accountModeIndicator" style="margin-bottom:16px;"></div>
        <div class="balance-card">
            <div class="balance-label"><span id="accountTypeLabel">DEMO</span> Account Balance</div>
            <div class="balance-amount" id="dashBalance">$25.00</div>
            <div class="balance-sub">
                <div class="balance-sub-item"><div class="balance-sub-label">Available</div><div class="balance-sub-value" id="dashAvailable">$25.00</div></div>
                <div class="balance-sub-item"><div class="balance-sub-label">In Trades</div><div class="balance-sub-value" id="dashInTrades">$0.00</div></div>
                <div class="balance-sub-item"><div class="balance-sub-label">Total Profit</div><div class="balance-sub-value" style="color:var(--accent-green);" id="dashProfit">$0.00</div></div>
            </div>
        </div>
        <div class="action-buttons">
            <button class="action-btn" style="background:linear-gradient(135deg,#fbbf24,#f59e0b);color:#000;" onclick="showLayer('tradingLayer')">‚ö° Trade Now</button>
            <button class="action-btn" style="background:linear-gradient(135deg,var(--accent-green),#08A566);color:#000;" onclick="showLayer('depositLayer')">üí∞ Deposit</button>
            <button class="action-btn" style="background:linear-gradient(135deg,#10b981,#059669);color:#fff;" onclick="showLayer('botsLayer')">ü§ñ AI Bots</button>
        </div>
        <div class="chart-section">
            <div class="chart-header">
                <div class="chart-title">üìà Live Market Overview</div>
                <div class="status-badge"><span class="status-dot"></span> LIVE</div>
            </div>
            <div class="tv-chart-container"><div id="tv_chart_dash" style="height:280px;"></div></div>
        </div>
        <div class="action-buttons">
            <button class="action-btn" style="background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;" onclick="showLayer('historyLayer')">üìú Trade History</button>
            <button class="action-btn" style="background:linear-gradient(135deg,#8b5cf6,#7c3aed);color:#fff;" onclick="showLayer('withdrawalLayer')">üí∏ Withdraw</button>
            <button class="action-btn" style="background:linear-gradient(135deg,#ec4899,#db2777);color:#fff;" onclick="showLayer('referralLayer')">üéÅ Referrals</button>
            <button class="action-btn" style="background:linear-gradient(135deg,#06b6d4,#0891b2);color:#fff;" onclick="showLayer('profileLayer')">‚öôÔ∏è Profile</button>
        </div>
    </div>
    <div class="whatsapp-support">
        <a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:24px;">üí¨</span> Support</a>
    </div>
    <div class="mobile-bottom-nav">
        <div class="mobile-nav-item active" onclick="showLayer('dashboardLayer')"><div class="mobile-nav-icon">üè†</div><div class="mobile-nav-label">Home</div></div>
        <div class="mobile-nav-item" onclick="showLayer('tradingLayer')"><div class="mobile-nav-icon">üìä</div><div class="mobile-nav-label">Trade</div></div>
        <div class="mobile-nav-item" onclick="showLayer('depositLayer')"><div class="mobile-nav-icon">üí∞</div><div class="mobile-nav-label">Deposit</div></div>
        <div class="mobile-nav-item" onclick="showLayer('withdrawalLayer')"><div class="mobile-nav-icon">üí∏</div><div class="mobile-nav-label">Withdraw</div></div>
        <div class="mobile-nav-item" onclick="showLayer('profileLayer')"><div class="mobile-nav-icon">üë§</div><div class="mobile-nav-label">Profile</div></div>
    </div>
</div>

<!-- ===== DEPOSIT LAYER ===== -->
<div id="depositLayer" class="layer">
    <nav class="navbar">
        <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">‚Çø</div>CryptoPro</div>
        <div class="nav-links"><button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">‚Üê Dashboard</button></div>
    </nav>
    <div class="container">
        <div class="hero-section" style="padding:28px 32px;">
            <h1 style="font-size:38px;">üí∞ Deposit Funds</h1>
            <p style="margin-bottom:0;">Fund your account instantly. Auto-credited within 5 minutes after verification.</p>
        </div>
        <div class="bonus-countdown-bar">
            <div>
                <div class="bonus-countdown-text">üéâ 100% WELCOME BONUS ‚Äî First Deposit Doubled!</div>
                <div style="font-size:12px;color:var(--text-secondary);margin-top:3px;">This offer expires in:</div>
            </div>
            <div class="countdown-timer">
                <div class="countdown-unit"><span class="countdown-num" id="cdHours2">23</span><span class="countdown-label">Hrs</span></div>
                <span class="countdown-colon">:</span>
                <div class="countdown-unit"><span class="countdown-num" id="cdMins2">47</span><span class="countdown-label">Min</span></div>
                <span class="countdown-colon">:</span>
                <div class="countdown-unit"><span class="countdown-num" id="cdSecs2">00</span><span class="countdown-label">Sec</span></div>
            </div>
            <div class="viewing-count">üëÅ <span id="depositViewers">23</span> people depositing now</div>
        </div>
        <div class="progress-bar-container" id="depositProgressBar">
            <div class="progress-label" id="progressLabel">‚è≥ Verifying payment...</div>
            <div class="progress-bar-track"><div class="progress-bar-fill" id="progressFill"></div></div>
            <div class="progress-text" id="progressText">0% complete</div>
        </div>
        <div class="chart-section">
            <form id="depositForm" onsubmit="return processDeposit(event)">
                <div class="form-group">
                    <label>Deposit Amount (USD)</label>
                    <input type="number" id="depositAmount" min="10" step="0.01" placeholder="Minimum $10" required oninput="updateCurrencyConversion()">
                </div>
                <div id="currencyConverterContainer"></div>
                <div class="form-group">
                    <label>Select Payment Method</label>
                    <div class="payment-grid">
                        <button type="button" class="payment-btn" onclick="selectPaymentMethod('mpesa-phone',this)">üì± M-Pesa<br><small style="font-size:11px;opacity:0.7;">+254759401893</small></button>
                        <button type="button" class="payment-btn" onclick="selectPaymentMethod('mpesa-till',this)">üè™ M-Pesa Till<br><small style="font-size:11px;opacity:0.7;">7500448</small></button>
                        <button type="button" class="payment-btn" onclick="selectPaymentMethod('bank',this)">üè¶ Bank Transfer<br><small style="font-size:11px;opacity:0.7;">Equity Bank</small></button>
                        <button type="button" class="payment-btn" onclick="selectPaymentMethod('crypto',this)">ü™ô USDT Crypto<br><small style="font-size:11px;opacity:0.7;">TRC-20</small></button>
                    </div>
                </div>
                <div id="mpesa-phone" class="payment-details">
                    <div style="text-align:center;font-size:17px;font-weight:700;color:var(--accent-green);margin-bottom:14px;">üì± M-Pesa Phone Number</div>
                    <div style="font-size:12px;color:var(--text-secondary);margin-bottom:4px;">Send Money To:</div>
                    <div class="payment-value">+254759401893</div>
                    <button type="button" class="copy-btn" onclick="copyToClipboard('+254759401893')">üìã Copy Phone Number</button>
                    <div class="how-to-pay">
                        <div class="how-to-pay-title">How to Pay via M-Pesa:</div>
                        <ol>
                            <li>Open M-Pesa on your phone</li>
                            <li>Select <strong>"Send Money"</strong></li>
                            <li>Enter number: <strong>+254759401893</strong></li>
                            <li>Enter the amount in KES (see converter above)</li>
                            <li>Enter your M-Pesa PIN and confirm</li>
                            <li>Wait for confirmation SMS</li>
                            <li>Submit the screenshot or M-Pesa code below</li>
                        </ol>
                    </div>
                </div>
                <div id="mpesa-till" class="payment-details">
                    <div style="text-align:center;font-size:17px;font-weight:700;color:var(--accent-green);margin-bottom:14px;">üè™ M-Pesa Till Number</div>
                    <div style="font-size:12px;color:var(--text-secondary);margin-bottom:4px;">Buy Goods Till Number:</div>
                    <div class="payment-value">7500448</div>
                    <button type="button" class="copy-btn" onclick="copyToClipboard('7500448')">üìã Copy Till Number</button>
                    <div class="how-to-pay">
                        <div class="how-to-pay-title">How to Pay via Till:</div>
                        <ol>
                            <li>Open M-Pesa on your phone</li>
                            <li>Select <strong>"Lipa na M-Pesa"</strong></li>
                            <li>Select <strong>"Buy Goods and Services"</strong></li>
                            <li>Enter Till Number: <strong>7500448</strong></li>
                            <li>Enter amount in KES and confirm</li>
                            <li>Enter your M-Pesa PIN</li>
                            <li>Submit confirmation code below</li>
                        </ol>
                    </div>
                </div>
                <div id="bank" class="payment-details">
                    <div style="text-align:center;font-size:17px;font-weight:700;color:var(--accent-green);margin-bottom:14px;">üè¶ Equity Bank Transfer</div>
                    <div style="background:rgba(0,0,0,0.3);padding:16px;border-radius:10px;">
                        <div style="margin-bottom:12px;"><div style="font-size:11px;color:var(--text-secondary);margin-bottom:3px;text-transform:uppercase;letter-spacing:0.5px;">Bank Name</div><div style="font-size:16px;font-weight:700;">Equity Bank Kenya</div></div>
                        <div style="margin-bottom:12px;"><div style="font-size:11px;color:var(--text-secondary);margin-bottom:3px;text-transform:uppercase;letter-spacing:0.5px;">Account Name</div><div style="font-size:16px;font-weight:700;">Felix Kiprotich Koskei</div></div>
                        <div style="margin-bottom:12px;"><div style="font-size:11px;color:var(--text-secondary);margin-bottom:3px;text-transform:uppercase;letter-spacing:0.5px;">Account Number</div><div class="payment-value" style="margin:0;">0310184912409</div></div>
                        <div><div style="font-size:11px;color:var(--text-secondary);margin-bottom:3px;text-transform:uppercase;letter-spacing:0.5px;">Branch</div><div style="font-size:16px;font-weight:700;">Any Equity Bank Branch</div></div>
                    </div>
                    <button type="button" class="copy-btn" style="margin-top:12px;" onclick="copyToClipboard('0310184912409')">üìã Copy Account Number</button>
                </div>
                <div id="crypto" class="payment-details">
                    <div style="text-align:center;font-size:17px;font-weight:700;color:var(--accent-green);margin-bottom:14px;">ü™ô USDT ‚Äî TRC-20 Network</div>
                    <div style="font-size:12px;color:var(--accent-yellow);font-weight:700;margin-bottom:8px;">Network: TRC-20 (Tron) ‚ö†Ô∏è</div>
                    <div style="font-size:12px;color:var(--text-secondary);margin-bottom:6px;">Wallet Address:</div>
                    <div class="payment-value" style="font-size:13px;">TK4rUz6TUEd7zCWeuiX5R47pSNdPswJnAc</div>
                    <button type="button" class="copy-btn" onclick="copyToClipboard('TK4rUz6TUEd7zCWeuiX5R47pSNdPswJnAc')">üìã Copy Wallet Address</button>
                    <div style="background:var(--accent-red-dim);border:1px solid rgba(246,70,93,0.3);border-radius:10px;padding:14px;margin-top:14px;">
                        <div style="font-size:12px;font-weight:700;color:var(--accent-red);margin-bottom:6px;">‚ö†Ô∏è CRITICAL WARNING</div>
                        <div style="font-size:12px;color:var(--text-primary);line-height:1.7;">‚Ä¢ Only send <strong>USDT on TRC-20 network</strong><br>‚Ä¢ Sending on wrong network = <strong>permanent loss of funds</strong><br>‚Ä¢ Double-check address before sending<br>‚Ä¢ Minimum deposit: $10 USDT</div>
                    </div>
                </div>
                <div style="background:var(--accent-green-dim);border:1px solid rgba(14,203,129,0.25);border-radius:12px;padding:18px;margin:18px 0;text-align:center;">
                    <div style="font-size:16px;font-weight:700;color:var(--accent-green);margin-bottom:8px;">‚úÖ AUTOMATIC DEPOSIT PROCESS</div>
                    <div style="font-size:13px;color:var(--text-primary);line-height:1.8;">Submit your payment screenshot below.<br>Your deposit will be <strong>automatically credited within 5 minutes</strong> after verification.</div>
                </div>
                <div class="form-group">
                    <label>Payment Proof / Transaction Code</label>
                    <textarea id="depositProof" rows="4" placeholder="Paste your M-Pesa code, transaction ID, or describe your payment here." required style="min-height:100px;resize:vertical;"></textarea>
                    <div style="font-size:11px;color:var(--text-secondary);margin-top:6px;">üì∏ Required for automatic verification and account credit</div>
                </div>
                <button type="submit" class="btn-submit">‚úÖ Submit Deposit Request</button>
            </form>
        </div>
    </div>
    <div class="whatsapp-support">
        <a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:24px;">üí¨</span> Support</a>
    </div>
</div>

<!-- ===== TRADING LAYER ===== -->
<div id="tradingLayer" class="layer">
    <nav class="navbar">
        <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">‚Çø</div>CryptoPro</div>
        <div class="nav-links">
            <div class="status-badge"><span class="status-dot"></span> LIVE</div>
            <button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">‚Üê Dashboard</button>
        </div>
    </nav>
    <div class="container">
        <div class="hero-section" style="padding:22px 28px;">
            <h1 style="font-size:34px;">‚ö° Live Trading</h1>
            <p style="margin-bottom:0;font-size:15px;">Execute trades in real-time with advanced leverage and risk management</p>
        </div>
        <div class="pairs-selector">
            <button class="pair-btn active" onclick="selectTradePair(this,'BTCUSDT','BTC/USDT','Bitcoin / USDT')">BTC/USDT</button>
            <button class="pair-btn" onclick="selectTradePair(this,'ETHUSDT','ETH/USDT','Ethereum / USDT')">ETH/USDT</button>
            <button class="pair-btn" onclick="selectTradePair(this,'BNBUSDT','BNB/USDT','BNB / USDT')">BNB/USDT</button>
            <button class="pair-btn" onclick="selectTradePair(this,'SOLUSDT','SOL/USDT','Solana / USDT')">SOL/USDT</button>
            <button class="pair-btn" onclick="selectTradePair(this,'XRPUSDT','XRP/USDT','Ripple / USDT')">XRP/USDT</button>
        </div>
        <div class="price-info">
            <div>
                <div class="current-price" id="tradePrice">$98,245.50</div>
                <div style="font-size:12px;color:var(--text-secondary);margin-top:4px;" id="tradePairSub">Bitcoin / USDT</div>
            </div>
            <div class="price-change positive" id="tradePriceChange">+2.45%</div>
        </div>
        <div class="chart-section">
            <div class="chart-header">
                <div class="chart-title">üìà <span id="tradePairLabel">BTC/USDT</span></div>
                <div class="status-badge"><span class="status-dot"></span> LIVE</div>
            </div>
            <div class="tv-chart-container"><div id="tv_chart_trade" style="height:420px;"></div></div>
        </div>
        <div class="orderbook-grid">
            <div class="orderbook-side">
                <div class="orderbook-title" style="color:var(--accent-red);">üî¥ Asks ‚Äî Sell Orders</div>
                <div class="orderbook-header"><span>Price (USDT)</span><span>Amount</span><span>Total</span></div>
                <div id="asksContainer"></div>
            </div>
            <div class="orderbook-side">
                <div class="orderbook-title" style="color:var(--accent-green);">üü¢ Bids ‚Äî Buy Orders</div>
                <div class="orderbook-header"><span>Price (USDT)</span><span>Amount</span><span>Total</span></div>
                <div id="bidsContainer"></div>
            </div>
        </div>
        <div class="chart-section">
            <div class="section-title" style="margin-bottom:16px;">üìã Place Order</div>
            <form id="tradeForm" onsubmit="return executeTrade(event)">
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:18px;">
                    <button type="button" class="payment-btn active" id="buyBtn" onclick="selectTradeType('buy')" style="background:var(--accent-green-dim);border-color:var(--accent-green);color:var(--accent-green);font-size:15px;padding:16px;">üìà BUY / LONG</button>
                    <button type="button" class="payment-btn" id="sellBtn" onclick="selectTradeType('sell')" style="font-size:15px;padding:16px;">üìâ SELL / SHORT</button>
                </div>
                <div class="form-group">
                    <label>Trade Amount (USD)</label>
                    <input type="number" id="tradeAmount" min="10" step="0.01" placeholder="Enter amount to trade" required oninput="updatePositionSize()">
                    <div style="font-size:12px;color:var(--text-secondary);margin-top:6px;">Available Balance: <span id="tradeAvailableBalance" style="font-weight:700;color:var(--text-primary);font-family:'JetBrains Mono',monospace;">$0.00</span></div>
                </div>
                <div class="form-group">
                    <label>Leverage</label>
                    <select id="tradeLeverage" onchange="updatePositionSize()">
                        <option value="1">1x ‚Äî No Leverage (Safe)</option>
                        <option value="2">2x ‚Äî 2 Times</option>
                        <option value="5">5x ‚Äî 5 Times</option>
                        <option value="10" selected>10x ‚Äî 10 Times</option>
                        <option value="20">20x ‚Äî 20 Times</option>
                        <option value="50">50x ‚Äî 50 Times</option>
                        <option value="100">100x ‚Äî 100 Times (High Risk)</option>
                    </select>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:18px;">
                    <div class="form-group" style="margin:0;"><label>Take Profit (USD) ‚Äî Optional</label><input type="number" id="takeProfitPrice" placeholder="e.g. 99000" step="0.01"></div>
                    <div class="form-group" style="margin:0;"><label>Stop Loss (USD) ‚Äî Optional</label><input type="number" id="stopLossPrice" placeholder="e.g. 97000" step="0.01"></div>
                </div>
                <div style="background:var(--bg-card);border:1px solid var(--border-color);border-radius:12px;padding:16px;margin-bottom:18px;">
                    <div style="font-size:12px;font-weight:700;color:var(--text-secondary);text-transform:uppercase;letter-spacing:1px;margin-bottom:12px;">Order Summary</div>
                    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;">
                        <div><div style="font-size:10px;color:var(--text-secondary);margin-bottom:4px;">Entry Price</div><div style="font-size:14px;font-weight:700;font-family:'JetBrains Mono',monospace;" id="entryPriceDisplay">$98,245.50</div></div>
                        <div><div style="font-size:10px;color:var(--text-secondary);margin-bottom:4px;">Position Size</div><div style="font-size:14px;font-weight:700;color:var(--accent-green);font-family:'JetBrains Mono',monospace;" id="positionSizeDisplay">$0.00</div></div>
                        <div><div style="font-size:10px;color:var(--text-secondary);margin-bottom:4px;">Liquidation Price</div><div style="font-size:14px;font-weight:700;color:var(--accent-red);font-family:'JetBrains Mono',monospace;" id="liquidationDisplay">‚Äî</div></div>
                    </div>
                </div>
                <button type="submit" class="btn-submit" id="tradeSubmitBtn" style="background:linear-gradient(135deg,var(--accent-green),#08A566);">üöÄ Execute Trade</button>
            </form>
        </div>
    </div>
    <div class="whatsapp-support">
        <a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:24px;">üí¨</span> Support</a>
    </div>
</div>

<!-- ===== AI BOTS LAYER ===== -->
<div id="botsLayer" class="layer">
    <nav class="navbar">
        <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">‚Çø</div>CryptoPro</div>
        <div class="nav-links"><button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">‚Üê Dashboard</button></div>
    </nav>
    <div class="container">
        <div class="hero-section" style="padding:22px 28px;">
            <h1 style="font-size:34px;">ü§ñ AI Trading Bots</h1>
            <p style="margin-bottom:0;">Automate your trading 24/7 with AI-powered strategies. Set it and forget it!</p>
        </div>
        <div class="winners-grid" id="botsGrid"></div>
        <div class="chart-section" style="margin-top:8px;">
            <div class="section-title">‚ö° Active Bots ‚Äî Live Performance</div>
            <div id="activeBotsContainer"></div>
        </div>
        <div class="chart-section">
            <div class="section-title">üìä Bot Statistics ‚Äî Last 24 Hours</div>
            <div class="stats-grid" id="botStatsGrid"></div>
        </div>
    </div>
    <div class="whatsapp-support">
        <a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:24px;">üí¨</span> Support</a>
    </div>
</div>

<!-- ===== TRADE HISTORY LAYER ===== -->
<div id="historyLayer" class="layer">
    <nav class="navbar">
        <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">‚Çø</div>CryptoPro</div>
        <div class="nav-links"><button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">‚Üê Dashboard</button></div>
    </nav>
    <div class="container">
        <div class="hero-section" style="padding:22px 28px;">
            <h1 style="font-size:34px;">üìú Trade History</h1>
            <p style="margin-bottom:0;">Complete record of all your trading activity and performance</p>
        </div>
        <div class="stats-grid" id="historyStatsGrid"></div>
        <div class="chart-section">
            <div id="tradeHistoryContainer" style="max-height:650px;overflow-y:auto;"></div>
        </div>
    </div>
    <div class="whatsapp-support">
        <a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:24px;">üí¨</span> Support</a>
    </div>
</div>

<!-- ===== WITHDRAWAL LAYER ===== -->
<div id="withdrawalLayer" class="layer">
    <nav class="navbar">
        <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">‚Çø</div>CryptoPro</div>
        <div class="nav-links"><button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">‚Üê Dashboard</button></div>
    </nav>
    <div class="container">
        <div class="hero-section" style="padding:22px 28px;">
            <h1 style="font-size:34px;">üí∏ Withdraw Funds</h1>
            <p style="margin-bottom:0;">Fast and secure withdrawals processed within 5‚Äì30 minutes</p>
        </div>
        <div class="progress-bar-container" id="withdrawProgressBar">
            <div class="progress-label" id="withdrawProgressLabel">‚è≥ Processing withdrawal...</div>
            <div class="progress-bar-track"><div class="progress-bar-fill" id="withdrawProgressFill"></div></div>
            <div class="progress-text" id="withdrawProgressText">0% complete</div>
        </div>
        <div class="chart-section">
            <div style="background:var(--accent-green-dim);border:1px solid rgba(14,203,129,0.25);border-radius:12px;padding:20px;margin-bottom:20px;text-align:center;">
                <div style="font-size:12px;text-transform:uppercase;letter-spacing:2px;color:var(--text-secondary);margin-bottom:8px;font-weight:700;">Available for Withdrawal</div>
                <div style="font-size:44px;font-weight:900;color:var(--accent-green);font-family:'JetBrains Mono',monospace;letter-spacing:-2px;" id="withdrawAvailable">$0.00</div>
            </div>
            <form id="withdrawalForm" onsubmit="return processWithdrawal(event)">
                <div class="form-group">
                    <label>Withdrawal Amount (USD)</label>
                    <input type="number" id="withdrawAmount" min="50" step="0.01" placeholder="Minimum $50" required>
                    <div style="font-size:12px;color:var(--text-secondary);margin-top:6px;">Min: $50 &nbsp;|&nbsp; Max: <span id="maxWithdraw" style="font-weight:700;font-family:'JetBrains Mono',monospace;">$0.00</span> &nbsp;|&nbsp; Fee: 2%</div>
                </div>
                <div class="form-group">
                    <label>Withdrawal Method</label>
                    <div class="payment-grid" style="grid-template-columns:repeat(3,1fr);">
                        <button type="button" class="payment-btn" onclick="selectWithdrawMethod('mpesa',this)">üì± M-Pesa</button>
                        <button type="button" class="payment-btn" onclick="selectWithdrawMethod('bank',this)">üè¶ Bank</button>
                        <button type="button" class="payment-btn" onclick="selectWithdrawMethod('crypto',this)">ü™ô Crypto</button>
                    </div>
                </div>
                <div id="withdraw-mpesa" class="payment-details">
                    <div class="form-group"><label>M-Pesa Phone Number</label><input type="tel" id="withdrawMpesaPhone" placeholder="+254 712 345 678"></div>
                    <div class="form-group"><label>Full Name (as registered)</label><input type="text" id="withdrawMpesaName" placeholder="Your M-Pesa registered name"></div>
                </div>
                <div id="withdraw-bank" class="payment-details">
                    <div class="form-group"><label>Bank Name</label><input type="text" id="withdrawBankName" placeholder="e.g. Equity Bank, KCB, Co-op"></div>
                    <div class="form-group"><label>Account Number</label><input type="text" id="withdrawAccountNumber" placeholder="Your account number"></div>
                    <div class="form-group"><label>Account Holder Name</label><input type="text" id="withdrawAccountName" placeholder="Name as on bank account"></div>
                </div>
                <div id="withdraw-crypto" class="payment-details">
                    <div class="form-group"><label>USDT Wallet Address (TRC-20 Only)</label><input type="text" id="withdrawCryptoAddress" placeholder="Your TRC-20 USDT wallet address"></div>
                    <div style="background:var(--accent-red-dim);border:1px solid rgba(246,70,93,0.3);border-radius:10px;padding:12px;font-size:12px;color:var(--accent-red);line-height:1.7;">‚ö†Ô∏è <strong>Only provide TRC-20 network address.</strong><br>Wrong network address = permanent loss of funds.</div>
                </div>
                <div style="background:var(--accent-green-dim);border:1px solid rgba(14,203,129,0.25);border-radius:12px;padding:16px;margin:16px 0;font-size:13px;color:var(--text-primary);line-height:1.9;">
                    ‚ö° <strong>Processing Time:</strong> 5‚Äì30 minutes<br>
                    üí≥ <strong>Fee:</strong> 2% deducted from withdrawal amount<br>
                    üì± <strong>Confirmation:</strong> Sent via SMS and Email<br>
                    üîí <strong>Security:</strong> All withdrawals manually verified
                </div>
                <button type="submit" class="btn-submit" style="background:linear-gradient(135deg,#8b5cf6,#7c3aed);color:#fff;">üí∏ Request Withdrawal</button>
            </form>
        </div>
    </div>
    <div class="whatsapp-support">
        <a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:24px;">üí¨</span> Support</a>
    </div>
</div>

<!-- ===== REFERRAL LAYER ===== -->
<div id="referralLayer" class="layer">
    <nav class="navbar">
        <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">‚Çø</div>CryptoPro</div>
        <div class="nav-links"><button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">‚Üê Dashboard</button></div>
    </nav>
    <div class="container">
        <div class="hero-section" style="padding:22px 28px;">
            <h1 style="font-size:34px;">üéÅ Referral Program</h1>
            <p style="margin-bottom:0;">Earn 10% commission on every deposit your referrals make ‚Äî for life!</p>
        </div>
        <div class="stats-grid">
            <div class="stat-card"><div class="stat-icon">üë•</div><div class="stat-value" id="totalReferrals">0</div><div class="stat-label">Total Referrals</div></div>
            <div class="stat-card"><div class="stat-icon">üí∞</div><div class="stat-value" id="totalCommission">$0.00</div><div class="stat-label">Total Earned</div></div>
            <div class="stat-card"><div class="stat-icon">üìä</div><div class="stat-value" id="activeReferrals">0</div><div class="stat-label">Active Traders</div></div>
            <div class="stat-card"><div class="stat-icon">üì¢</div><div class="stat-value" id="totalShares">0</div><div class="stat-label">Total Shares</div></div>
        </div>
        <div class="share-rewards-card">
            <div style="text-align:center;margin-bottom:14px;">
                <div style="font-size:44px;margin-bottom:8px;">üí∞</div>
                <div style="font-size:22px;font-weight:900;color:var(--accent-yellow);margin-bottom:4px;">EARN $5 PER SHARE!</div>
                <div style="font-size:13px;color:var(--text-secondary);">Get paid every time you share your referral link</div>
            </div>
            <div class="share-stats-grid">
                <div class="share-stat"><div class="share-stat-label">Total Shares</div><div class="share-stat-value" style="color:var(--accent-yellow);" id="shareCountDisplay">0</div></div>
                <div class="share-stat"><div class="share-stat-label">Earnings from Shares</div><div class="share-stat-value" style="color:var(--accent-green);" id="shareEarningsDisplay">$0.00</div></div>
            </div>
            <div style="background:rgba(14,203,129,0.06);border-left:3px solid var(--accent-green);padding:14px 16px;border-radius:0 8px 8px 0;font-size:13px;color:var(--text-primary);line-height:1.8;">
                üí° <strong>How it works:</strong> Click any share button below ‚Üí Share on social media ‚Üí Earn $5 instantly credited to your account! No limit on shares!
            </div>
        </div>
        <div class="chart-section">
            <div style="margin-bottom:20px;">
                <div class="section-title">Your Referral Link</div>
                <div style="background:var(--accent-green-dim);border:1.5px solid rgba(14,203,129,0.25);border-radius:12px;padding:18px;">
                    <div class="payment-value" style="margin:0 0 12px 0;font-size:13px;" id="referralLink">https://cryptopro.vercel.app/ref/XXXXX</div>
                    <button class="copy-btn" onclick="copyReferralLink()">üìã Copy Referral Link</button>
                </div>
            </div>
            <div class="section-title">Share Via:</div>
            <div class="action-buttons">
                <button class="action-btn" style="background:linear-gradient(135deg,#25D366,#128C7E);color:#fff;" onclick="shareViaWhatsApp()">üí¨ WhatsApp (+$5)</button>
                <button class="action-btn" style="background:linear-gradient(135deg,#0088cc,#006699);color:#fff;" onclick="shareViaTelegram()">‚úàÔ∏è Telegram (+$5)</button>
                <button class="action-btn" style="background:linear-gradient(135deg,#1877f2,#0d5dbf);color:#fff;" onclick="shareViaFacebook()">üìò Facebook (+$5)</button>
                <button class="action-btn" style="background:linear-gradient(135deg,#1da1f2,#0c85d0);color:#fff;" onclick="shareViaTwitter()">üê¶ Twitter (+$5)</button>
            </div>
            <div style="background:rgba(252,213,53,0.08);border:1px solid rgba(252,213,53,0.25);border-radius:12px;padding:20px;margin-top:16px;">
                <div style="font-size:16px;font-weight:700;color:var(--accent-yellow);margin-bottom:14px;">üíé Referral Benefits</div>
                <div style="font-size:13px;color:var(--text-primary);line-height:2;">
                    ‚úÖ <strong>10% Commission</strong> on every deposit your referral makes<br>
                    ‚úÖ <strong>Lifetime Earnings</strong> ‚Äî earn as long as they trade<br>
                    ‚úÖ <strong>Instant Credits</strong> ‚Äî commission added immediately<br>
                    ‚úÖ <strong>No Limits</strong> ‚Äî refer unlimited people<br>
                    ‚úÖ <strong>$25 Bonus</strong> for each referral who signs up<br>
                    ‚úÖ <strong>$5 Per Share</strong> ‚Äî earn every time you share your link<br>
                    ‚úÖ <strong>Fully Withdrawable</strong> ‚Äî withdraw anytime, no minimum
                </div>
            </div>
        </div>
    </div>
    <div class="whatsapp-support">
        <a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:24px;">üí¨</span> Support</a>
    </div>
</div>

<!-- ===== REVIEWS LAYER ===== -->
<div id="reviewsLayer" class="layer">
    <nav class="navbar">
        <div class="logo" onclick="showLayer('welcomeLayer')"><div class="logo-icon">‚Çø</div>CryptoPro</div>
        <div class="nav-links"><button class="nav-btn btn-signup" onclick="showLayer('signupLayer')">Sign Up Free</button></div>
    </nav>
    <div class="container">
        <div class="hero-section" style="padding:22px 28px;">
            <h1 style="font-size:34px;">‚≠ê User Reviews</h1>
            <p style="margin-bottom:0;">Real feedback from our verified traders across Kenya and beyond</p>
        </div>
        <div style="background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:14px;padding:24px;margin-bottom:20px;text-align:center;">
            <div style="font-size:64px;font-weight:900;color:var(--accent-yellow);font-family:'JetBrains Mono',monospace;line-height:1;">4.9</div>
            <div style="font-size:28px;margin:8px 0;">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
            <div style="font-size:14px;color:var(--text-secondary);">Based on 2,847 verified reviews</div>
            <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:20px;">
                <div style="background:var(--bg-card);padding:14px;border-radius:10px;border:1px solid var(--border-color);"><div style="font-size:22px;font-weight:900;color:var(--accent-green);font-family:'JetBrains Mono',monospace;">98%</div><div style="font-size:11px;color:var(--text-secondary);margin-top:3px;">Would Recommend</div></div>
                <div style="background:var(--bg-card);padding:14px;border-radius:10px;border:1px solid var(--border-color);"><div style="font-size:22px;font-weight:900;color:var(--accent-green);font-family:'JetBrains Mono',monospace;">5min</div><div style="font-size:11px;color:var(--text-secondary);margin-top:3px;">Avg Withdrawal Time</div></div>
                <div style="background:var(--bg-card);padding:14px;border-radius:10px;border:1px solid var(--border-color);"><div style="font-size:22px;font-weight:900;color:var(--accent-green);font-family:'JetBrains Mono',monospace;">24/7</div><div style="font-size:11px;color:var(--text-secondary);margin-top:3px;">Customer Support</div></div>
            </div>
        </div>
        <div class="winners-grid" id="reviewsGrid"></div>
    </div>
    <div class="whatsapp-support">
        <a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:24px;">üí¨</span> Support</a>
    </div>
</div>

<!-- ===== PROFILE LAYER ===== -->
<div id="profileLayer" class="layer">
    <nav class="navbar">
        <div class="logo" onclick="showLayer('dashboardLayer')"><div class="logo-icon">‚Çø</div>CryptoPro</div>
        <div class="nav-links"><button class="nav-btn btn-login" onclick="showLayer('dashboardLayer')">‚Üê Dashboard</button></div>
    </nav>
    <div class="container">
        <div class="hero-section" style="padding:22px 28px;">
            <h1 style="font-size:34px;">‚öôÔ∏è Profile Settings</h1>
            <p style="margin-bottom:0;">Manage your account information and security settings</p>
        </div>
        <div class="chart-section">
            <form id="profileForm" onsubmit="return updateProfile(event)">
                <div class="form-group"><label>Full Name</label><input type="text" id="profileName" required></div>
                <div class="form-group"><label>Email Address</label><input type="email" id="profileEmail" required></div>
                <div class="form-group"><label>Phone Number</label><input type="tel" id="profilePhone" required></div>
                <div style="background:var(--bg-card);border:1px solid var(--border-color);border-radius:12px;padding:18px;margin-bottom:18px;">
                    <div style="font-size:13px;font-weight:700;color:var(--text-secondary);text-transform:uppercase;letter-spacing:1px;margin-bottom:14px;">üîí Change Password</div>
                    <div class="form-group" style="margin-bottom:12px;"><label>Current Password</label><input type="password" id="profileCurrentPassword" placeholder="Leave blank to keep unchanged"></div>
                    <div class="form-group" style="margin:0;"><label>New Password</label><input type="password" id="profileNewPassword" placeholder="Enter new password"></div>
                </div>
                <button type="submit" class="btn-submit">üíæ Save Profile Changes</button>
            </form>
            <div style="margin-top:28px;padding-top:24px;border-top:1px solid var(--border-color);">
                <div class="section-title">Account Information</div>
                <div class="profile-info-box">
                    <div class="profile-info-row"><div class="profile-info-label">Account ID</div><div class="profile-info-value" id="accountId" style="font-family:'JetBrains Mono',monospace;font-size:13px;">‚Äî</div></div>
                    <div class="profile-info-row"><div class="profile-info-label">Member Since</div><div class="profile-info-value" id="memberSince">‚Äî</div></div>
                    <div class="profile-info-row"><div class="profile-info-label">Verification Status</div><div class="verified-badge">‚úì Fully Verified</div></div>
                    <div class="profile-info-row"><div class="profile-info-label">Account Type</div><div class="profile-info-value">Standard Trader</div></div>
                    <div class="profile-info-row"><div class="profile-info-label">2FA Security</div><div style="display:inline-flex;align-items:center;gap:6px;padding:4px 12px;background:var(--accent-green-dim);border:1px solid rgba(14,203,129,0.3);border-radius:20px;font-size:12px;font-weight:700;color:var(--accent-green);">üîí Enabled</div></div>
                </div>
            </div>
        </div>
    </div>
    <div class="whatsapp-support">
        <a href="https://wa.me/254759401893" class="whatsapp-btn" target="_blank"><span style="font-size:24px;">üí¨</span> Support</a>
    </div>
</div>

<script>
let currentUser = null;
let currentAccount = 'demo';
let demoBalance = 25.00;
let realBalance = 0.00;
let demoProfit = 0.00;
let realProfit = 0.00;
let inTrades = 0.00;
let tradeHistory = [];
let activeBots = [];
let referralCount = 0;
let commissionEarned = 0;
let shareCount = 0;
let shareEarnings = 0;
let currentTradeType = 'buy';
let currentTradePair = 'BTCUSDT';
let currentChartPair = 'BTCUSDT';
let notifications = [];
let countdownSeconds = 86399;
let liveWinnerInterval, orderBookInterval, priceTickInterval, countdownInterval, statsInterval;

const cryptoPrices = {
    BTCUSDT: { price: 98245.50, change: 2.45, high: 99120, low: 96800, volume: '28.5B', open: 97850 },
    ETHUSDT: { price: 3842.20, change: -1.23, high: 3920, low: 3780, volume: '14.2B', open: 3890 },
    BNBUSDT: { price: 612.80, change: 0.87, high: 625, low: 602, volume: '2.1B', open: 607 },
    SOLUSDT: { price: 185.40, change: 4.12, high: 192, low: 178, volume: '5.8B', open: 178 },
    ADAUSDT: { price: 0.9823, change: -0.54, high: 1.02, low: 0.96, volume: '1.2B', open: 0.988 },
    XRPUSDT: { price: 2.3410, change: 3.21, high: 2.45, low: 2.21, volume: '4.7B', open: 2.269 }
};

const tickerData = [
    { sym: 'BTC', price: '$98,245', chg: '+2.45%', pos: true },
    { sym: 'ETH', price: '$3,842', chg: '-1.23%', pos: false },
    { sym: 'BNB', price: '$612', chg: '+0.87%', pos: true },
    { sym: 'SOL', price: '$185', chg: '+4.12%', pos: true },
    { sym: 'ADA', price: '$0.98', chg: '-0.54%', pos: false },
    { sym: 'XRP', price: '$2.34', chg: '+3.21%', pos: true },
    { sym: 'DOT', price: '$9.82', chg: '+1.45%', pos: true },
    { sym: 'MATIC', price: '$1.24', chg: '-0.89%', pos: false },
    { sym: 'LINK', price: '$18.75', chg: '+2.11%', pos: true },
    { sym: 'AVAX', price: '$42.30', chg: '+3.67%', pos: true },
    { sym: 'DOGE', price: '$0.182', chg: '-1.02%', pos: false },
    { sym: 'SHIB', price: '$0.000028', chg: '+5.44%', pos: true },
];

const traderNames = ['Alex K.','Brian M.','Cynthia O.','Daniel W.','Faith N.','George A.','Hannah L.','Isaac P.','Jane R.','Kevin S.','Lydia T.','Mark U.','Nancy V.','Oscar X.','Patricia Y.'];
const traderEmojis = ['üòé','üöÄ','üíé','üî•','‚ö°','ü§ë','üí∞','üìà','üèÜ','üí°'];
const tradePairs = ['BTC/USDT','ETH/USDT','SOL/USDT','BNB/USDT','XRP/USDT','ADA/USDT'];

function showLayer(layerId) {
    document.querySelectorAll('.layer').forEach(l => l.classList.remove('active'));
    document.getElementById(layerId).classList.add('active');
    window.scrollTo(0, 0);
    const aiBtn = document.getElementById('aiAssistantBtn');
    const loggedInLayers = ['dashboardLayer','tradingLayer','botsLayer','historyLayer','withdrawalLayer','referralLayer','profileLayer','depositLayer'];
    aiBtn.style.display = loggedInLayers.includes(layerId) ? 'block' : 'none';
    if (layerId === 'chartsLayer') initTVChart('tv_chart_main', currentChartPair);
    if (layerId === 'dashboardLayer') { updateDashboard(); initTVChart('tv_chart_dash', 'BTCUSDT'); }
    if (layerId === 'tradingLayer') { initTVChart('tv_chart_trade', currentTradePair); updateTradeAvailableBalance(); generateOrderBook(); }
    if (layerId === 'botsLayer') renderBots();
    if (layerId === 'historyLayer') renderHistory();
    if (layerId === 'withdrawalLayer') updateWithdrawalAvailable();
    if (layerId === 'referralLayer') updateReferralStats();
    if (layerId === 'profileLayer') populateProfile();
    if (layerId === 'reviewsLayer') renderReviews();
}

function initMarketTicker() {
    const track = document.getElementById('marketTickerTrack');
    const items = [...tickerData, ...tickerData];
    track.innerHTML = items.map(t => `<div class="ticker-item"><span class="ticker-symbol">${t.sym}/USDT</span><span class="ticker-price">${t.price}</span><span class="ticker-change ${t.pos ? 'pos' : 'neg'}">${t.chg}</span></div>`).join('');
}

function initLiveTradersTicker() {
    const container = document.getElementById('liveTradersTicker');
    const traders = Array.from({ length: 20 }, () => ({
        name: traderNames[Math.floor(Math.random() * traderNames.length)],
        emoji: traderEmojis[Math.floor(Math.random() * traderEmojis.length)],
        pair: tradePairs[Math.floor(Math.random() * tradePairs.length)],
        profit: (Math.random() * 890 + 50).toFixed(2),
    }));
    const doubled = [...traders, ...traders];
    container.innerHTML = doubled.map(t => `<div class="trader-card"><div class="trader-avatar">${t.emoji}</div><div><div class="trader-name">${t.name}</div><div style="font-size:11px;color:var(--text-secondary);">${t.pair}</div></div><div class="trader-profit">+$${t.profit}</div></div>`).join('');
}

const winnersData = [
    { emoji: 'ü¶Å', name: 'James Odhiambo', location: 'Nairobi, Kenya', joined: 'Member since Jan 2024', profit: '$14,820', trades: '284', winRate: '94%', rank: 1 },
    { emoji: 'üêØ', name: 'Grace Wanjiku', location: 'Mombasa, Kenya', joined: 'Member since Mar 2024', profit: '$11,450', trades: '196', winRate: '91%', rank: 2 },
    { emoji: 'ü¶ä', name: 'Peter Kamau', location: 'Kisumu, Kenya', joined: 'Member since Feb 2024', profit: '$9,230', trades: '167', winRate: '89%', rank: 3 },
    { emoji: 'üê∫', name: 'Sarah Achieng', location: 'Nakuru, Kenya', joined: 'Member since Apr 2024', profit: '$7,890', trades: '142', winRate: '87%', rank: 4 },
    { emoji: 'ü¶Ö', name: 'David Mutua', location: 'Eldoret, Kenya', joined: 'Member since May 2024', profit: '$6,540', trades: '128', winRate: '85%', rank: 5 },
    { emoji: 'üêª', name: 'Ann Chebet', location: 'Thika, Kenya', joined: 'Member since Jun 2024', profit: '$5,120', trades: '110', winRate: '83%', rank: 6 },
];

function renderTopWinners() {
    const grid = document.getElementById('topWinnersGrid');
    if (!grid) return;
    grid.innerHTML = winnersData.map(w => `<div class="winner-card"><div class="winner-rank">#${w.rank}</div><div class="winner-header"><div class="winner-avatar">${w.emoji}</div><div><div class="winner-name">${w.name}</div><div class="winner-location">üìç ${w.location}</div><div class="winner-join">${w.joined}</div></div></div><div class="winner-stats"><div class="winner-stat"><div class="winner-stat-label">Total Profit</div><div class="winner-stat-value">${w.profit}</div></div><div class="winner-stat"><div class="winner-stat-label">Win Rate</div><div class="winner-stat-value">${w.winRate}</div></div><div class="winner-stat"><div class="winner-stat-label">Trades</div><div class="winner-stat-value">${w.trades}</div></div><div class="winner-stat"><div class="winner-stat-label">Status</div><div class="winner-stat-value" style="color:var(--accent-green);font-size:13px;">Active</div></div></div></div>`).join('');
}

const reviewsData = [
    { emoji: 'üòä', name: 'Mary Njoroge', loc: 'Nairobi', rating: 5, date: '2 days ago', text: 'Absolutely amazing platform! I started with $50 and within 2 weeks I had $420 in profit. The AI bots are incredible and withdrawals are instant to M-Pesa!', profit: '+$370' },
    { emoji: 'ü§©', name: 'John Omondi', loc: 'Kisumu', rating: 5, date: '3 days ago', text: 'Best trading platform I have ever used. The signals are very accurate and customer support via WhatsApp is always available. Made $890 last month alone!', profit: '+$890' },
    { emoji: 'üí™', name: 'Esther Wanjiku', loc: 'Mombasa', rating: 5, date: '5 days ago', text: 'I was skeptical at first but after seeing my friend withdraw KES 15,000, I joined immediately. The bonus system is real and the withdrawals are fast!', profit: '+$580' },
    { emoji: 'üöÄ', name: 'Samuel Kipchoge', loc: 'Eldoret', rating: 5, date: '1 week ago', text: 'CryptoPro changed my life. I was earning KES 20,000/month from my job, now I make KES 80,000 per month trading here. The referral program is also amazing!', profit: '+$1,240' },
    { emoji: 'üåü', name: 'Beatrice Auma', loc: 'Nakuru', rating: 5, date: '1 week ago', text: 'The AI bots do all the work for me. I just deposit and let the system trade. Already withdrawn over $2,000 this quarter. Fully recommended!', profit: '+$2,100' },
    { emoji: 'üíé', name: 'Francis Mwangi', loc: 'Thika', rating: 5, date: '2 weeks ago', text: 'I have tried 5 other platforms and none comes close to CryptoPro. The transparency, the support team, and the consistent daily profits. 10/10!', profit: '+$750' },
];

function renderReviews() {
    const grid = document.getElementById('reviewsGrid');
    if (!grid) return;
    grid.innerHTML = reviewsData.map(r => `<div class="winner-card"><div class="winner-header"><div class="winner-avatar">${r.emoji}</div><div><div class="winner-name">${r.name}</div><div class="winner-location">üìç ${r.loc}</div><div class="winner-join">${r.date}</div></div><div style="margin-left:auto;text-align:right;"><div style="color:var(--accent-yellow);font-size:14px;">${'‚≠ê'.repeat(r.rating)}</div><div style="color:var(--accent-green);font-size:15px;font-weight:700;font-family:'JetBrains Mono',monospace;margin-top:4px;">${r.profit}</div></div></div><div style="font-size:13px;color:var(--text-primary);line-height:1.6;padding:14px;background:rgba(0,0,0,0.2);border-radius:8px;">"${r.text}"</div></div>`).join('');
}

function initTVChart(containerId, symbol) {
    const container = document.getElementById(containerId);
    if (!container || typeof TradingView === 'undefined') return;
    container.innerHTML = '';
    new TradingView.widget({
        autosize: true,
        symbol: `BINANCE:${symbol}`,
        interval: 'D',
        timezone: 'Africa/Nairobi',
        theme: 'dark',
        style: '1',
        locale: 'en',
        toolbar_bg: '#0D1421',
        enable_publishing: false,
        hide_top_toolbar: false,
        hide_side_toolbar: false,
        allow_symbol_change: true,
        save_image: false,
        container_id: containerId,
        backgroundColor: '#060B11',
        gridColor: 'rgba(30,45,66,0.5)',
    });
}

function selectChartPair(btn, symbol, label, sublabel) {
    document.querySelectorAll('#chartPairsSelector .pair-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    currentChartPair = symbol;
    document.getElementById('chartPairLabel').textContent = label;
    document.getElementById('currentPairSub').textContent = sublabel;
    const data = cryptoPrices[symbol];
    if (data) {
        document.getElementById('currentPrice').textContent = `$${data.price.toLocaleString()}`;
        const chgEl = document.getElementById('priceChange');
        chgEl.textContent = `${data.change > 0 ? '+' : ''}${data.change}%`;
        chgEl.className = `price-change ${data.change > 0 ? 'positive' : 'negative'}`;
        document.getElementById('chartHigh').textContent = `$${data.high.toLocaleString()}`;
        document.getElementById('chartLow').textContent = `$${data.low.toLocaleString()}`;
        document.getElementById('chartVolume').textContent = data.volume;
        document.getElementById('chartOpen').textContent = `$${data.open.toLocaleString()}`;
        document.getElementById('chartClose').textContent = `$${data.price.toLocaleString()}`;
        const c24 = document.getElementById('chart24h');
        c24.textContent = `${data.change > 0 ? '+' : ''}${data.change}%`;
        c24.style.color = data.change > 0 ? 'var(--accent-green)' : 'var(--accent-red)';
    }
    initTVChart('tv_chart_main', symbol);
}

function selectTradePair(btn, symbol, label, sublabel) {
    document.querySelectorAll('#tradingLayer .pair-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    currentTradePair = symbol;
    document.getElementById('tradePairLabel').textContent = label;
    document.getElementById('tradePairSub').textContent = sublabel;
    const data = cryptoPrices[symbol];
    if (data) {
        document.getElementById('tradePrice').textContent = `$${data.price.toLocaleString()}`;
        const chgEl = document.getElementById('tradePriceChange');
        chgEl.textContent = `${data.change > 0 ? '+' : ''}${data.change}%`;
        chgEl.className = `price-change ${data.change > 0 ? 'positive' : 'negative'}`;
        document.getElementById('entryPriceDisplay').textContent = `$${data.price.toLocaleString()}`;
    }
    initTVChart('tv_chart_trade', symbol);
    generateOrderBook();
}

function startPriceTicker() {
    priceTickInterval = setInterval(() => {
        Object.keys(cryptoPrices).forEach(sym => {
            const d = cryptoPrices[sym];
            const move = (Math.random() - 0.48) * d.price * 0.001;
            d.price = Math.max(d.price + move, 0.001);
        });
        const tradeData = cryptoPrices[currentTradePair];
        if (tradeData) {
            const el = document.getElementById('tradePrice');
            if (el) {
                const old = parseFloat(el.textContent.replace(/[$,]/g, ''));
                el.textContent = `$${tradeData.price.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                el.className = `current-price ${tradeData.price > old ? 'flash-up' : 'flash-down'}`;
                setTimeout(() => el.classList.remove('flash-up', 'flash-down'), 500);
            }
            const epEl = document.getElementById('entryPriceDisplay');
            if (epEl) epEl.textContent = `$${tradeData.price.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
        }
        const chartData = cryptoPrices[currentChartPair];
        if (chartData) {
            const el = document.getElementById('currentPrice');
            if (el) el.textContent = `$${chartData.price.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
        }
    }, 2000);
}

function generateOrderBook() {
    const data = cryptoPrices[currentTradePair];
    if (!data) return;
    const basePrice = data.price;
    const asksContainer = document.getElementById('asksContainer');
    const bidsContainer = document.getElementById('bidsContainer');
    if (!asksContainer || !bidsContainer) return;
    const asks = Array.from({ length: 10 }, (_, i) => {
        const price = basePrice * (1 + (i + 1) * 0.0003 + Math.random() * 0.0002);
        const amount = (Math.random() * 3 + 0.1).toFixed(4);
        const total = (price * parseFloat(amount)).toFixed(2);
        const width = Math.random() * 80 + 10;
        return { price: price.toFixed(2), amount, total, width };
    });
    const bids = Array.from({ length: 10 }, (_, i) => {
        const price = basePrice * (1 - (i + 1) * 0.0003 - Math.random() * 0.0002);
        const amount = (Math.random() * 3 + 0.1).toFixed(4);
        const total = (price * parseFloat(amount)).toFixed(2);
        const width = Math.random() * 80 + 10;
        return { price: price.toFixed(2), amount, total, width };
    });
    asksContainer.innerHTML = asks.reverse().map(a => `<div class="orderbook-row ask-row"><div class="orderbook-bar" style="width:${a.width}%"></div><span class="ask-price">${parseFloat(a.price).toLocaleString()}</span><span class="ob-amount">${a.amount}</span><span class="ob-total">${parseFloat(a.total).toLocaleString()}</span></div>`).join('');
    bidsContainer.innerHTML = bids.map(b => `<div class="orderbook-row bid-row"><div class="orderbook-bar" style="width:${b.width}%"></div><span class="bid-price">${parseFloat(b.price).toLocaleString()}</span><span class="ob-amount">${b.amount}</span><span class="ob-total">${parseFloat(b.total).toLocaleString()}</span></div>`).join('');
}

function startOrderBookUpdates() {
    orderBookInterval = setInterval(() => {
        if (document.getElementById('tradingLayer').classList.contains('active')) generateOrderBook();
    }, 3000);
}

function handleSignup(e) {
    e.preventDefault();
    const name = document.getElementById('signupName').value.trim();
    const email = document.getElementById('signupEmail').value.trim();
    const phone = document.getElementById('signupPhone').value.trim();
    const pass = document.getElementById('signupPassword').value;
    const confirm = document.getElementById('signupConfirm').value;
    const ref = document.getElementById('signupReferralCode').value.trim();
    const alertEl = document.getElementById('signupAlert');
    if (pass !== confirm) { showAlert(alertEl, 'error', '‚ùå Passwords do not match!'); return false; }
    if (pass.length < 6) { showAlert(alertEl, 'error', '‚ùå Password must be at least 6 characters!'); return false; }
    currentUser = { name, email, phone, id: 'CP' + Math.random().toString(36).substr(2, 8).toUpperCase(), joined: new Date().toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' }), referralCode: name.replace(/\s/g, '').toUpperCase().substr(0, 6) + Math.floor(Math.random() * 999), referredBy: ref || null, password: pass };
    demoBalance = 25.00; realBalance = 0.00; demoProfit = 0.00; realProfit = 0.00; tradeHistory = []; activeBots = []; referralCount = 0; commissionEarned = 0; shareCount = 0; shareEarnings = 0;
    notifications = [
        { title: 'üéÅ Welcome Bonus Credited!', desc: '$25 has been added to your demo account. Start trading now!', time: 'Just now' },
        { title: 'üîê Account Verified', desc: 'Your account has been fully verified and is ready to use.', time: '1 min ago' },
        { title: 'üìà Markets Are Live', desc: 'All crypto pairs are now active. Happy trading!', time: '2 min ago' },
    ];
    showLayer('dashboardLayer');
    setTimeout(() => showToast('üéâ Welcome to CryptoPro, ' + name + '!\n$25 bonus has been credited to your demo account.', 'success'), 600);
    launchConfetti();
    return false;
}

function handleLogin(e) {
    e.preventDefault();
    const email = document.getElementById('loginEmail').value.trim();
    const pass = document.getElementById('loginPassword').value;
    const alertEl = document.getElementById('loginAlert');
    if (!email || !pass) { showAlert(alertEl, 'error', '‚ùå Please enter email and password.'); return false; }
    currentUser = currentUser || { name: email.split('@')[0].replace(/[^a-zA-Z]/g, ' ').trim() || 'Trader', email, phone: '+254 700 000 000', id: 'CP' + Math.random().toString(36).substr(2, 8).toUpperCase(), joined: 'January 2024', referralCode: 'USER' + Math.floor(Math.random() * 9999), referredBy: null, password: pass };
    notifications = [
        { title: 'üîê Login Successful', desc: 'Welcome back! Your account is secure.', time: 'Just now' },
        { title: 'üìä Markets Update', desc: 'BTC is up 2.45% in the last 24 hours.', time: '5 min ago' },
        { title: 'üí∞ Pending Deposit', desc: 'Deposit more to unlock premium bots!', time: '10 min ago' },
    ];
    showLayer('dashboardLayer');
    setTimeout(() => showToast('‚úÖ Welcome back, ' + currentUser.name + '!', 'success'), 500);
    return false;
}

function handleLogout() {
    if (confirm('Are you sure you want to logout?')) { currentUser = null; demoBalance = 25.00; realBalance = 0.00; showLayer('welcomeLayer'); }
}

function updateDashboard() {
    if (!currentUser) return;
    document.getElementById('userName').textContent = currentUser.name;
    document.getElementById('userEmail').textContent = currentUser.email;
    const balance = currentAccount === 'demo' ? demoBalance : realBalance;
    const profit = currentAccount === 'demo' ? demoProfit : realProfit;
    document.getElementById('dashBalance').textContent = `$${balance.toFixed(2)}`;
    document.getElementById('dashAvailable').textContent = `$${Math.max(balance - inTrades, 0).toFixed(2)}`;
    document.getElementById('dashInTrades').textContent = `$${inTrades.toFixed(2)}`;
    document.getElementById('dashProfit').textContent = `$${profit.toFixed(2)}`;
    document.getElementById('accountTypeLabel').textContent = currentAccount.toUpperCase();
    updateNotifBadge();
    renderNotifications();
}

function switchAccount(type) {
    currentAccount = type;
    document.getElementById('switchToDemo').className = `switch-btn ${type === 'demo' ? 'active' : ''}`;
    document.getElementById('switchToReal').className = `switch-btn ${type === 'real' ? 'active' : ''}`;
    const indicator = document.getElementById('accountModeIndicator');
    if (type === 'real') {
        indicator.innerHTML = `<div style="background:rgba(14,203,129,0.08);border:1px solid rgba(14,203,129,0.3);border-radius:10px;padding:12px 16px;font-size:13px;font-weight:700;color:var(--accent-green);text-align:center;">üíé REAL ACCOUNT ‚Äî All profits are real and withdrawable!</div>`;
    } else {
        indicator.innerHTML = `<div style="background:rgba(0,184,255,0.08);border:1px solid rgba(0,184,255,0.3);border-radius:10px;padding:12px 16px;font-size:13px;font-weight:700;color:var(--accent-blue);text-align:center;">üìä DEMO ACCOUNT ‚Äî Practice trading with $25 virtual funds</div>`;
    }
    updateDashboard();
    showToast(`Switched to ${type.toUpperCase()} account`, 'success');
}

let selectedPaymentMethod = null;

function selectPaymentMethod(method, btn) {
    selectedPaymentMethod = method;
    document.querySelectorAll('#depositLayer .payment-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    document.querySelectorAll('.payment-details').forEach(d => d.classList.remove('active'));
    const details = document.getElementById(method);
    if (details) details.classList.add('active');
}

function updateCurrencyConversion() {
    const amount = parseFloat(document.getElementById('depositAmount').value) || 0;
    const kesRate = 130;
    const kes = (amount * kesRate).toFixed(0);
    const container = document.getElementById('currencyConverterContainer');
    if (amount > 0) {
        container.innerHTML = `<div style="background:rgba(0,184,255,0.08);border:1px solid rgba(0,184,255,0.2);border-radius:10px;padding:14px;margin-bottom:16px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;"><div style="font-size:13px;color:var(--text-secondary);">üí± Currency Converter</div><div style="font-family:'JetBrains Mono',monospace;font-size:16px;font-weight:700;"><span style="color:var(--accent-green);">$${amount.toFixed(2)} USD</span><span style="color:var(--text-secondary);margin:0 8px;">‚âà</span><span style="color:var(--accent-yellow);">KES ${parseInt(kes).toLocaleString()}</span></div><div style="font-size:11px;color:var(--text-muted);">Rate: 1 USD = ${kesRate} KES</div></div>`;
    } else {
        container.innerHTML = '';
    }
}

function selectWithdrawMethod(method, btn) {
    document.querySelectorAll('#withdrawalLayer .payment-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    ['withdraw-mpesa','withdraw-bank','withdraw-crypto'].forEach(id => { const el = document.getElementById(id); if (el) el.classList.remove('active'); });
    const details = document.getElementById(`withdraw-${method}`);
    if (details) details.classList.add('active');
}

function updateWithdrawalAvailable() {
    const balance = currentAccount === 'demo' ? demoBalance : realBalance;
    if (document.getElementById('withdrawAvailable')) document.getElementById('withdrawAvailable').textContent = `$${balance.toFixed(2)}`;
    if (document.getElementById('maxWithdraw')) document.getElementById('maxWithdraw').textContent = `$${balance.toFixed(2)}`;
}

function processDeposit(e) {
    e.preventDefault();
    const amount = parseFloat(document.getElementById('depositAmount').value);
    const proof = document.getElementById('depositProof').value.trim();
    if (!selectedPaymentMethod) { showToast('‚ùå Please select a payment method!', 'error'); return false; }
    if (!amount || amount < 10) { showToast('‚ùå Minimum deposit is $10!', 'error'); return false; }
    if (!proof) { showToast('‚ùå Please provide payment proof!', 'error'); return false; }
    const progressBar = document.getElementById('depositProgressBar');
    const progressFill = document.getElementById('progressFill');
    const progressText = document.getElementById('progressText');
    const progressLabel = document.getElementById('progressLabel');
    progressBar.classList.add('show');
    const steps = [
        { pct: 15, label: 'üîç Scanning payment details...', time: 600 },
        { pct: 35, label: '‚úÖ Payment proof received...', time: 1400 },
        { pct: 55, label: 'üîÑ Verifying transaction...', time: 2400 },
        { pct: 75, label: 'üí≥ Crediting your account...', time: 3400 },
        { pct: 90, label: 'üîê Finalizing security checks...', time: 4400 },
        { pct: 100, label: 'üéâ Deposit successful!', time: 5400 },
    ];
    steps.forEach(s => { setTimeout(() => { progressFill.style.width = `${s.pct}%`; progressText.textContent = `${s.pct}% complete`; progressLabel.textContent = s.label; }, s.time); });
    setTimeout(() => {
        const bonus = currentAccount === 'demo' || realBalance === 0 ? amount : 0;
        if (currentAccount === 'demo') demoBalance += amount + bonus;
        else realBalance += amount + bonus;
        notifications.unshift({ title: `üí∞ Deposit of $${amount.toFixed(2)} Received!`, desc: bonus > 0 ? `Your account has been credited $${amount.toFixed(2)} + $${bonus.toFixed(2)} welcome bonus!` : `Your account has been credited $${amount.toFixed(2)}.`, time: 'Just now' });
        progressBar.classList.remove('show');
        document.getElementById('depositForm').reset();
        document.getElementById('currencyConverterContainer').innerHTML = '';
        selectedPaymentMethod = null;
        document.querySelectorAll('.payment-details').forEach(d => d.classList.remove('active'));
        document.querySelectorAll('#depositLayer .payment-btn').forEach(b => b.classList.remove('active'));
        showToast(`üéâ Deposit of $${amount.toFixed(2)} successfully received!\n${bonus > 0 ? `+ $${bonus.toFixed(2)} bonus added!` : ''}\nYour balance has been updated.`, 'success');
        launchConfetti();
        updateDashboard();
    }, 6000);
    return false;
}

function processWithdrawal(e) {
    e.preventDefault();
    const amount = parseFloat(document.getElementById('withdrawAmount').value);
    const balance = currentAccount === 'demo' ? demoBalance : realBalance;
    if (!amount || amount < 50) { showToast('‚ùå Minimum withdrawal is $50!', 'error'); return false; }
    if (amount > balance) { showToast('‚ùå Insufficient balance!', 'error'); return false; }
    if (currentAccount === 'demo') { showToast('‚ùå Cannot withdraw from demo account!\nPlease switch to your REAL account and deposit real funds first.', 'error'); return false; }
    const fee = amount * 0.02;
    const net = amount - fee;
    const progressBar = document.getElementById('withdrawProgressBar');
    const progressFill = document.getElementById('withdrawProgressFill');
    const progressLabel = document.getElementById('withdrawProgressLabel');
    const progressText = document.getElementById('withdrawProgressText');
    progressBar.classList.add('show');
    const steps = [
        { pct: 20, label: 'üîê Verifying account security...', time: 800 },
        { pct: 45, label: 'üí≥ Processing withdrawal request...', time: 2000 },
        { pct: 70, label: 'üì§ Sending funds to your account...', time: 3500 },
        { pct: 90, label: 'üì± Sending confirmation...', time: 5000 },
        { pct: 100, label: '‚úÖ Withdrawal processed!', time: 6000 },
    ];
    steps.forEach(s => { setTimeout(() => { progressFill.style.width = `${s.pct}%`; progressText.textContent = `${s.pct}% complete`; progressLabel.textContent = s.label; }, s.time); });
    setTimeout(() => {
        realBalance -= amount;
        notifications.unshift({ title: `üí∏ Withdrawal of $${net.toFixed(2)} Processed!`, desc: `Amount: $${amount.toFixed(2)} | Fee: $${fee.toFixed(2)} | Net: $${net.toFixed(2)}`, time: 'Just now' });
        progressBar.classList.remove('show');
        document.getElementById('withdrawalForm').reset();
        document.querySelectorAll('.payment-details').forEach(d => d.classList.remove('active'));
        showToast(`‚úÖ Withdrawal of $${net.toFixed(2)} submitted!\nProcessing time: 5‚Äì30 minutes.\nYou will receive an SMS confirmation.`, 'success');
        updateDashboard();
        updateWithdrawalAvailable();
    }, 7000);
    return false;
}

function selectTradeType(type) {
    currentTradeType = type;
    const buyBtn = document.getElementById('buyBtn');
    const sellBtn = document.getElementById('sellBtn');
    const submitBtn = document.getElementById('tradeSubmitBtn');
    if (type === 'buy') {
        buyBtn.style.background = 'var(--accent-green-dim)'; buyBtn.style.borderColor = 'var(--accent-green)'; buyBtn.style.color = 'var(--accent-green)';
        sellBtn.style.background = ''; sellBtn.style.borderColor = ''; sellBtn.style.color = '';
        submitBtn.style.background = 'linear-gradient(135deg, var(--accent-green), #08A566)';
        submitBtn.textContent = 'üöÄ Execute BUY Trade';
    } else {
        sellBtn.style.background = 'var(--accent-red-dim)'; sellBtn.style.borderColor = 'var(--accent-red)'; sellBtn.style.color = 'var(--accent-red)';
        buyBtn.style.background = ''; buyBtn.style.borderColor = ''; buyBtn.style.color = '';
        submitBtn.style.background = 'linear-gradient(135deg, var(--accent-red), #c0392b)';
        submitBtn.textContent = 'üìâ Execute SELL Trade';
    }
}

function updateTradeAvailableBalance() {
    const balance = currentAccount === 'demo' ? demoBalance : realBalance;
    const el = document.getElementById('tradeAvailableBalance');
    if (el) el.textContent = `$${balance.toFixed(2)}`;
    updatePositionSize();
}

function updatePositionSize() {
    const amount = parseFloat(document.getElementById('tradeAmount')?.value) || 0;
    const leverage = parseFloat(document.getElementById('tradeLeverage')?.value) || 10;
    const position = amount * leverage;
    const entryPrice = cryptoPrices[currentTradePair]?.price || 0;
    const liqPct = 1 / leverage * 0.9;
    const liqPrice = currentTradeType === 'buy' ? entryPrice * (1 - liqPct) : entryPrice * (1 + liqPct);
    const posEl = document.getElementById('positionSizeDisplay');
    const liqEl = document.getElementById('liquidationDisplay');
    if (posEl) posEl.textContent = `$${position.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
    if (liqEl) liqEl.textContent = amount > 0 ? `$${liqPrice.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}` : '‚Äî';
}

function executeTrade(e) {
    e.preventDefault();
    const amount = parseFloat(document.getElementById('tradeAmount').value);
    const leverage = parseFloat(document.getElementById('tradeLeverage').value);
    const balance = currentAccount === 'demo' ? demoBalance : realBalance;
    if (!amount || amount < 10) { showToast('‚ùå Minimum trade amount is $10!', 'error'); return false; }
    if (amount > balance) { showToast('‚ùå Insufficient balance!\nPlease deposit funds to continue trading.', 'error'); return false; }
    const entryPrice = cryptoPrices[currentTradePair].price;
    const position = amount * leverage;
    if (currentAccount === 'demo') demoBalance -= amount;
    else realBalance -= amount;
    inTrades += amount;
    const trade = { id: 'TRD' + Math.random().toString(36).substr(2, 6).toUpperCase(), pair: currentTradePair, type: currentTradeType, amount, leverage, position, entryPrice, status: 'open', time: new Date().toLocaleString(), account: currentAccount };
    tradeHistory.unshift(trade);
    showToast(`‚úÖ ${currentTradeType.toUpperCase()} order executed!\nPair: ${currentTradePair.replace('USDT', '/USDT')}\nAmount: $${amount.toFixed(2)} @ ${leverage}x\nPosition: $${position.toFixed(2)}\nEntry: $${entryPrice.toLocaleString()}`, 'success');
    const resultDelay = 8000 + Math.random() * 12000;
    setTimeout(() => simulateTradeResult(trade), resultDelay);
    document.getElementById('tradeForm').reset();
    updatePositionSize();
    updateDashboard();
    return false;
}

function simulateTradeResult(trade) {
    const won = Math.random() < 0.72;
    const profitPct = won ? (Math.random() * 0.08 + 0.02) : -(Math.random() * 0.06 + 0.01);
    const profitAmount = trade.position * profitPct;
    const returnAmount = trade.amount + profitAmount;
    trade.status = won ? 'win' : 'loss';
    trade.profitAmount = profitAmount;
    inTrades -= trade.amount;
    const returnVal = Math.max(returnAmount, 0);
    if (trade.account === 'demo') { demoBalance += returnVal; if (won) demoProfit += profitAmount; }
    else { realBalance += returnVal; if (won) realProfit += profitAmount; }
    const emoji = won ? 'üéâ' : 'üìâ';
    notifications.unshift({ title: `${emoji} Trade ${won ? 'Won' : 'Lost'}! ${trade.pair.replace('USDT', '/USDT')}`, desc: `${won ? 'Profit' : 'Loss'}: $${Math.abs(profitAmount).toFixed(2)} (${(profitPct * 100).toFixed(2)}%)`, time: 'Just now' });
    showToast(`${emoji} Trade Closed!\nPair: ${trade.pair.replace('USDT', '/USDT')}\n${won ? 'Profit' : 'Loss'}: $${Math.abs(profitAmount).toFixed(2)}\nReturn: $${returnVal.toFixed(2)}`, won ? 'success' : 'error');
    if (won && profitAmount > 50) launchConfetti();
    updateDashboard();
}

const botData = [
    { id: 'bot1', name: 'Scalper Pro', emoji: '‚ö°', desc: 'High-frequency scalping bot. Makes 50‚Äì100 micro-trades per day with tight stop losses.', winRate: '91%', dailyReturn: '3‚Äì8%', minDeposit: '$50', risk: 'Medium', color: '#0ECB81' },
    { id: 'bot2', name: 'Trend Rider', emoji: 'üèÑ', desc: 'Follows major market trends. Best for bull/bear markets. Low risk, steady returns.', winRate: '87%', dailyReturn: '2‚Äì5%', minDeposit: '$100', risk: 'Low', color: '#00B8FF' },
    { id: 'bot3', name: 'Arbitrage AI', emoji: 'ü§ñ', desc: 'Exploits price differences between exchanges. Near-zero risk, consistent profits.', winRate: '96%', dailyReturn: '1‚Äì3%', minDeposit: '$200', risk: 'Very Low', color: '#A855F7' },
    { id: 'bot4', name: 'Swing Master', emoji: 'üìä', desc: 'Captures large swing moves. Holds positions for 4‚Äì24 hours for bigger gains.', winRate: '82%', dailyReturn: '5‚Äì15%', minDeposit: '$150', risk: 'Medium-High', color: '#FCD535' },
    { id: 'bot5', name: 'Grid Bot', emoji: 'üî≤', desc: 'Places buy/sell orders in a grid pattern. Profits in sideways/ranging markets.', winRate: '88%', dailyReturn: '2‚Äì6%', minDeposit: '$100', risk: 'Low', color: '#10b981' },
    { id: 'bot6', name: 'Degen Bot', emoji: 'üé∞', desc: 'High-risk, high-reward. Trades volatile altcoins with 50‚Äì100x leverage.', winRate: '68%', dailyReturn: '10‚Äì50%', minDeposit: '$500', risk: 'Very High', color: '#ef4444' },
];

function renderBots() {
    const grid = document.getElementById('botsGrid');
    if (!grid) return;
    grid.innerHTML = botData.map(b => {
        const isActive = activeBots.find(ab => ab.id === b.id);
        return `<div class="bot-card"><div style="display:flex;align-items:center;gap:12px;margin-bottom:14px;"><div style="font-size:40px;">${b.emoji}</div><div><div style="font-size:17px;font-weight:700;">${b.name}</div><div style="font-size:11px;color:var(--text-secondary);margin-top:2px;">Risk: <span style="color:${b.color};font-weight:700;">${b.risk}</span></div></div>${isActive ? '<div style="margin-left:auto;padding:4px 10px;background:var(--accent-green-dim);border:1px solid rgba(14,203,129,0.3);border-radius:20px;font-size:11px;font-weight:700;color:var(--accent-green);">üü¢ RUNNING</div>' : ''}</div><div style="font-size:13px;color:var(--text-secondary);margin-bottom:14px;line-height:1.5;">${b.desc}</div><div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:14px;"><div style="text-align:center;background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;"><div style="font-size:10px;color:var(--text-secondary);text-transform:uppercase;margin-bottom:3px;">Win Rate</div><div style="font-size:16px;font-weight:700;color:var(--accent-green);">${b.winRate}</div></div><div style="text-align:center;background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;"><div style="font-size:10px;color:var(--text-secondary);text-transform:uppercase;margin-bottom:3px;">Daily Return</div><div style="font-size:16px;font-weight:700;color:${b.color};">${b.dailyReturn}</div></div><div style="text-align:center;background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;"><div style="font-size:10px;color:var(--text-secondary);text-transform:uppercase;margin-bottom:3px;">Min Deposit</div><div style="font-size:16px;font-weight:700;color:var(--text-primary);">${b.minDeposit}</div></div></div><button class="btn-submit" style="${isActive ? 'background:linear-gradient(135deg,#ef4444,#b91c1c);' : ''}" onclick="${isActive ? `stopBot('${b.id}')` : `startBot('${b.id}')`}">${isActive ? '‚èπ Stop Bot' : '‚ñ∂Ô∏è Activate Bot'}</button></div>`;
    }).join('');
    renderActiveBots();
    renderBotStats();
}

function startBot(botId) {
    const balance = currentAccount === 'demo' ? demoBalance : realBalance;
    const bot = botData.find(b => b.id === botId);
    const minBal = parseFloat(bot.minDeposit.replace('$', ''));
    if (balance < minBal) { showToast(`‚ùå Insufficient balance!\n${bot.name} requires minimum ${bot.minDeposit} to activate.\nPlease deposit funds first.`, 'error'); return; }
    const allocation = Math.min(balance * 0.3, balance);
    activeBots.push({ id: botId, name: bot.name, emoji: bot.emoji, startTime: new Date(), allocation, profit: 0, trades: 0, winRate: bot.winRate, account: currentAccount });
    notifications.unshift({ title: `ü§ñ ${bot.name} Activated!`, desc: `Bot is now trading with $${allocation.toFixed(2)} allocation.`, time: 'Just now' });
    showToast(`‚úÖ ${bot.name} activated!\nAllocated: $${allocation.toFixed(2)}\nThe bot is now trading for you 24/7!`, 'success');
    renderBots();
    const botEarningInterval = setInterval(() => {
        const activeBot = activeBots.find(ab => ab.id === botId);
        if (!activeBot) { clearInterval(botEarningInterval); return; }
        const earn = allocation * (Math.random() * 0.012 + 0.002);
        activeBot.profit += earn;
        activeBot.trades += Math.floor(Math.random() * 3) + 1;
        if (activeBot.account === 'demo') demoProfit += earn;
        else realProfit += earn;
        updateDashboard();
    }, 8000);
}

function stopBot(botId) {
    const idx = activeBots.findIndex(ab => ab.id === botId);
    if (idx !== -1) { const bot = activeBots[idx]; showToast(`‚èπ ${bot.name} stopped!\nTotal profit: $${bot.profit.toFixed(2)}\nTotal trades: ${bot.trades}`, 'success'); activeBots.splice(idx, 1); }
    renderBots();
}

function renderActiveBots() {
    const container = document.getElementById('activeBotsContainer');
    if (!container) return;
    if (activeBots.length === 0) { container.innerHTML = `<div style="text-align:center;padding:30px;color:var(--text-secondary);">No active bots. Activate a bot above to start automated trading!</div>`; return; }
    container.innerHTML = activeBots.map(ab => {
        const runningTime = Math.floor((new Date() - ab.startTime) / 60000);
        return `<div class="active-bot-item running"><div class="active-bot-bar"><div style="display:flex;align-items:center;gap:10px;"><span style="font-size:28px;">${ab.emoji}</span><div><div style="font-weight:700;">${ab.name}</div><div style="font-size:11px;color:var(--text-secondary);">Running ${runningTime} min ‚Ä¢ ${ab.account.toUpperCase()} account</div></div></div><div style="display:flex;align-items:center;gap:6px;padding:5px 12px;background:var(--accent-green-dim);border:1px solid rgba(14,203,129,0.3);border-radius:20px;font-size:11px;font-weight:700;color:var(--accent-green);"><span style="width:6px;height:6px;background:var(--accent-green);border-radius:50%;animation:blink 1.5s infinite;display:block;"></span>TRADING</div></div><div class="active-bot-stats"><div class="active-bot-stat"><div class="active-bot-stat-label">Profit</div><div class="active-bot-stat-value" style="color:var(--accent-green);">+$${ab.profit.toFixed(2)}</div></div><div class="active-bot-stat"><div class="active-bot-stat-label">Trades</div><div class="active-bot-stat-value">${ab.trades}</div></div><div class="active-bot-stat"><div class="active-bot-stat-label">Allocated</div><div class="active-bot-stat-value">$${ab.allocation.toFixed(2)}</div></div></div></div>`;
    }).join('');
}

function renderBotStats() {
    const grid = document.getElementById('botStatsGrid');
    if (!grid) return;
    const totalBotProfit = activeBots.reduce((s, b) => s + b.profit, 0);
    const totalTrades = activeBots.reduce((s, b) => s + b.trades, 0);
    grid.innerHTML = `<div class="stat-card"><div class="stat-icon">ü§ñ</div><div class="stat-value">${activeBots.length}</div><div class="stat-label">Active Bots</div></div><div class="stat-card"><div class="stat-icon">üí∞</div><div class="stat-value">$${totalBotProfit.toFixed(2)}</div><div class="stat-label">Bot Earnings</div></div><div class="stat-card"><div class="stat-icon">üìä</div><div class="stat-value">${totalTrades}</div><div class="stat-label">Bot Trades</div></div><div class="stat-card"><div class="stat-icon">‚è±</div><div class="stat-value">24/7</div><div class="stat-label">Always Running</div></div>`;
}

function renderHistory() {
    const container = document.getElementById('tradeHistoryContainer');
    const statsGrid = document.getElementById('historyStatsGrid');
    if (!container) return;
    const totalWins = tradeHistory.filter(t => t.status === 'win').length;
    const totalLosses = tradeHistory.filter(t => t.status === 'loss').length;
    const totalProfit = tradeHistory.filter(t => t.status === 'win').reduce((s, t) => s + (t.profitAmount || 0), 0);
    const totalLoss = tradeHistory.filter(t => t.status === 'loss').reduce((s, t) => s + Math.abs(t.profitAmount || 0), 0);
    if (statsGrid) {
        statsGrid.innerHTML = `<div class="stat-card"><div class="stat-icon">üìä</div><div class="stat-value">${tradeHistory.length}</div><div class="stat-label">Total Trades</div></div><div class="stat-card"><div class="stat-icon">‚úÖ</div><div class="stat-value" style="color:var(--accent-green);">${totalWins}</div><div class="stat-label">Wins</div></div><div class="stat-card"><div class="stat-icon">‚ùå</div><div class="stat-value" style="color:var(--accent-red);">${totalLosses}</div><div class="stat-label">Losses</div></div><div class="stat-card"><div class="stat-icon">üí∞</div><div class="stat-value" style="color:var(--accent-green);">$${(totalProfit - totalLoss).toFixed(2)}</div><div class="stat-label">Net P&L</div></div>`;
    }
    if (tradeHistory.length === 0) { container.innerHTML = `<div style="text-align:center;padding:40px;color:var(--text-secondary);">No trades yet. Place your first trade to see history here!</div>`; return; }
    container.innerHTML = tradeHistory.map(t => `<div class="history-item"><div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:10px;"><div style="display:flex;align-items:center;gap:10px;"><div style="padding:5px 12px;border-radius:6px;font-size:12px;font-weight:700;background:${t.type === 'buy' ? 'var(--accent-green-dim)' : 'var(--accent-red-dim)'};color:${t.type === 'buy' ? 'var(--accent-green)' : 'var(--accent-red)'};">${t.type === 'buy' ? 'üìà BUY' : 'üìâ SELL'}</div><div style="font-weight:700;font-size:15px;">${t.pair.replace('USDT', '/USDT')}</div><div style="font-size:12px;color:var(--text-secondary);">${t.leverage}x</div></div><div style="padding:5px 12px;border-radius:6px;font-size:12px;font-weight:700;background:${t.status === 'win' ? 'var(--accent-green-dim)' : t.status === 'loss' ? 'var(--accent-red-dim)' : 'rgba(255,255,255,0.06)'};color:${t.status === 'win' ? 'var(--accent-green)' : t.status === 'loss' ? 'var(--accent-red)' : 'var(--text-secondary)'};">${t.status === 'win' ? '‚úÖ WON' : t.status === 'loss' ? '‚ùå LOST' : '‚è≥ OPEN'}</div></div><div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px;font-size:12px;"><div><div style="color:var(--text-secondary);margin-bottom:2px;">Amount</div><div style="font-weight:700;font-family:'JetBrains Mono',monospace;">$${t.amount.toFixed(2)}</div></div><div><div style="color:var(--text-secondary);margin-bottom:2px;">Entry</div><div style="font-weight:700;font-family:'JetBrains Mono',monospace;">$${t.entryPrice.toLocaleString(undefined,{maximumFractionDigits:2})}</div></div><div><div style="color:var(--text-secondary);margin-bottom:2px;">P&L</div><div style="font-weight:700;font-family:'JetBrains Mono',monospace;color:${t.profitAmount > 0 ? 'var(--accent-green)' : t.profitAmount < 0 ? 'var(--accent-red)' : 'var(--text-secondary)'};">${t.profitAmount !== undefined ? `${t.profitAmount > 0 ? '+' : ''}$${t.profitAmount.toFixed(2)}` : '‚Äî'}</div></div><div><div style="color:var(--text-secondary);margin-bottom:2px;">Time</div><div style="font-weight:600;font-size:11px;">${t.time}</div></div></div><div style="font-size:10px;color:var(--text-muted);margin-top:6px;">ID: ${t.id} ‚Ä¢ ${t.account.toUpperCase()} account</div></div>`).join('');
}

function updateReferralStats() {
    if (!currentUser) return;
    const link = `https://cryptopro.vercel.app/ref/${currentUser.referralCode}`;
    const el = document.getElementById('referralLink');
    if (el) el.textContent = link;
    if (document.getElementById('totalReferrals')) document.getElementById('totalReferrals').textContent = referralCount;
    if (document.getElementById('totalCommission')) document.getElementById('totalCommission').textContent = `$${commissionEarned.toFixed(2)}`;
    if (document.getElementById('activeReferrals')) document.getElementById('activeReferrals').textContent = Math.floor(referralCount * 0.6);
    if (document.getElementById('totalShares')) document.getElementById('totalShares').textContent = shareCount;
    if (document.getElementById('shareCountDisplay')) document.getElementById('shareCountDisplay').textContent = shareCount;
    if (document.getElementById('shareEarningsDisplay')) document.getElementById('shareEarningsDisplay').textContent = `$${shareEarnings.toFixed(2)}`;
}

function copyReferralLink() {
    if (!currentUser) return;
    const link = `https://cryptopro.vercel.app/ref/${currentUser.referralCode}`;
    navigator.clipboard.writeText(link).then(() => showToast('‚úÖ Referral link copied!', 'success')).catch(() => showToast('‚úÖ Referral link ready to share!', 'success'));
}

function addShareReward() {
    shareCount++; shareEarnings += 5; demoBalance += 5;
    notifications.unshift({ title: 'üéâ $5 Share Reward Earned!', desc: `You earned $5 for sharing your referral link. Total share earnings: $${shareEarnings.toFixed(2)}`, time: 'Just now' });
    updateReferralStats(); updateDashboard();
    showToast('üéâ +$5 Share Reward Added!\nKeep sharing to earn more!', 'success');
}

function shareViaWhatsApp() {
    if (!currentUser) return;
    const link = `https://cryptopro.vercel.app/ref/${currentUser.referralCode}`;
    const text = `üöÄ I'm making real money on CryptoPro! Join me and get a $25 FREE bonus!\n\n${link}\n\nüí∞ AI-powered crypto trading ‚Ä¢ Daily profits ‚Ä¢ Fast withdrawals!`;
    window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
    addShareReward();
}

function shareViaTelegram() {
    if (!currentUser) return;
    const link = `https://cryptopro.vercel.app/ref/${currentUser.referralCode}`;
    const text = `üöÄ Join CryptoPro and get $25 FREE bonus!\n${link}`;
    window.open(`https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent(text)}`, '_blank');
    addShareReward();
}

function shareViaFacebook() {
    if (!currentUser) return;
    const link = `https://cryptopro.vercel.app/ref/${currentUser.referralCode}`;
    window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(link)}`, '_blank');
    addShareReward();
}

function shareViaTwitter() {
    if (!currentUser) return;
    const link = `https://cryptopro.vercel.app/ref/${currentUser.referralCode}`;
    const text = `üöÄ Making daily profits with @CryptoPro AI trading! Get your $25 FREE bonus now:`;
    window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(link)}`, '_blank');
    addShareReward();
}

function populateProfile() {
    if (!currentUser) return;
    document.getElementById('profileName').value = currentUser.name;
    document.getElementById('profileEmail').value = currentUser.email;
    document.getElementById('profilePhone').value = currentUser.phone;
    document.getElementById('accountId').textContent = currentUser.id;
    document.getElementById('memberSince').textContent = currentUser.joined;
}

function updateProfile(e) {
    e.preventDefault();
    currentUser.name = document.getElementById('profileName').value.trim();
    currentUser.email = document.getElementById('profileEmail').value.trim();
    currentUser.phone = document.getElementById('profilePhone').value.trim();
    const newPass = document.getElementById('profileNewPassword').value;
    if (newPass && newPass.length >= 6) currentUser.password = newPass;
    document.getElementById('profileCurrentPassword').value = '';
    document.getElementById('profileNewPassword').value = '';
    updateDashboard();
    showToast('‚úÖ Profile updated successfully!', 'success');
    return false;
}

function toggleNotifications() {
    const dropdown = document.getElementById('notifDropdown');
    dropdown.classList.toggle('open');
    document.addEventListener('click', closeNotifOnOutside, { once: true });
}

function closeNotifOnOutside(e) {
    const wrapper = document.getElementById('notifBellWrapper');
    if (wrapper && !wrapper.contains(e.target)) document.getElementById('notifDropdown').classList.remove('open');
}

function clearNotifications() { notifications = []; updateNotifBadge(); renderNotifications(); }

function renderNotifications() {
    const list = document.getElementById('notifList');
    if (!list) return;
    if (notifications.length === 0) { list.innerHTML = `<div style="padding:20px;text-align:center;color:var(--text-secondary);font-size:13px;">No notifications</div>`; return; }
    list.innerHTML = notifications.slice(0, 8).map(n => `<div class="notif-item"><div class="notif-item-title">${n.title}</div><div class="notif-item-desc">${n.desc}</div><div class="notif-item-time">${n.time}</div></div>`).join('');
}

function updateNotifBadge() {
    const badge = document.getElementById('notifCount');
    if (badge) { badge.textContent = Math.min(notifications.length, 9); badge.style.display = notifications.length > 0 ? 'flex' : 'none'; }
}

const aiResponses = {
    'best bot': 'I recommend starting with **Trend Rider** üèÑ for beginners ‚Äî it has an 87% win rate with low risk. For higher returns, try **Scalper Pro** ‚ö° with 91% win rate! Activate any bot from the AI Bots section.',
    'deposit': 'To deposit: 1) Go to **Deposit** section 2) Enter amount (min $10) 3) Choose M-Pesa, Bank, or Crypto 4) Follow payment instructions 5) Submit payment proof. Your account is credited within 5 minutes! üí∞',
    'btc': 'Based on current market analysis, BTC is showing **bullish momentum** üìà. Key resistance at $100K. Our AI signals suggest a 73% probability of upward movement in the next 24h. Trade responsibly!',
    'withdraw': 'Withdrawals are processed in 5‚Äì30 minutes! ‚ö° Go to **Withdraw** section, enter amount (min $50), choose M-Pesa/Bank/Crypto, and submit. 2% fee applies. Only available on REAL account.',
    'referral': 'Our referral program is amazing! üéÅ You earn:\n‚Ä¢ **10% commission** on every deposit your referrals make\n‚Ä¢ **$5 per share** whenever you share your link\n‚Ä¢ **$25 bonus** for each signup\nNo limits ‚Äî refer as many as you want!',
    'default': 'Great question! ü§ñ I\'m ARIA, your AI trading assistant. I can help with:\n‚Ä¢ Market analysis & price predictions\n‚Ä¢ Bot recommendations\n‚Ä¢ Deposit & withdrawal guidance\n‚Ä¢ Trading strategies\n\nWhat specific help do you need?'
};

function toggleAIChat() { document.getElementById('aiChatPanel').classList.toggle('open'); }

function sendAIQuickReply(msg) { document.getElementById('aiInput').value = msg; sendAIMessage(); }

function sendAIMessage() {
    const input = document.getElementById('aiInput');
    const messages = document.getElementById('aiMessages');
    const msg = input.value.trim();
    if (!msg) return;
    messages.innerHTML += `<div class="ai-msg user">${msg}</div>`;
    input.value = '';
    const typingEl = document.createElement('div');
    typingEl.className = 'ai-typing';
    typingEl.innerHTML = '<span></span><span></span><span></span>';
    messages.appendChild(typingEl);
    messages.scrollTop = messages.scrollHeight;
    setTimeout(() => {
        typingEl.remove();
        const lower = msg.toLowerCase();
        let response = aiResponses.default;
        if (lower.includes('bot') || lower.includes('automat')) response = aiResponses['best bot'];
        if (lower.includes('deposit') || lower.includes('pay') || lower.includes('mpesa') || lower.includes('fund')) response = aiResponses['deposit'];
        if (lower.includes('btc') || lower.includes('bitcoin') || lower.includes('price') || lower.includes('predict')) response = aiResponses['btc'];
        if (lower.includes('withdraw') || lower.includes('cash') || lower.includes('money out')) response = aiResponses['withdraw'];
        if (lower.includes('referral') || lower.includes('refer') || lower.includes('commission') || lower.includes('share')) response = aiResponses['referral'];
        messages.innerHTML += `<div class="ai-msg bot">${response.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>').replace(/\n/g, '<br>')}</div>`;
        messages.scrollTop = messages.scrollHeight;
    }, 1200 + Math.random() * 800);
}

let toastTimeout;
function showToast(message, type = 'success') {
    const toast = document.getElementById('toastNotification');
    toast.textContent = message;
    toast.className = `toast-notification show ${type === 'error' ? 'error' : ''}`;
    toast.style.borderColor = type === 'error' ? 'var(--accent-red)' : 'var(--accent-green)';
    clearTimeout(toastTimeout);
    toastTimeout = setTimeout(() => { toast.className = 'toast-notification'; }, 5000);
}

function showAlert(el, type, message) { el.textContent = message; el.className = `alert show alert-${type}`; setTimeout(() => el.className = 'alert', 4000); }

function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => showToast('‚úÖ Copied: ' + text, 'success')).catch(() => showToast('‚úÖ Copy: ' + text, 'success'));
}

function launchConfetti() {
    const colors = ['#0ECB81', '#FCD535', '#00B8FF', '#A855F7', '#ef4444', '#f97316'];
    for (let i = 0; i < 60; i++) {
        setTimeout(() => {
            const piece = document.createElement('div');
            piece.className = 'confetti-piece';
            piece.style.cssText = `left:${Math.random() * 100}vw;top:-20px;width:${Math.random() * 10 + 6}px;height:${Math.random() * 10 + 6}px;background:${colors[Math.floor(Math.random() * colors.length)]};animation:confettiFall ${Math.random() * 2 + 2}s ease-in forwards;border-radius:${Math.random() > 0.5 ? '50%' : '2px'};`;
            document.body.appendChild(piece);
            setTimeout(() => piece.remove(), 4000);
        }, i * 40);
    }
}

const winnerToastData = [
    { emoji: 'üèÜ', name: 'James O.', action: 'just won trading BTC/USDT', amount: '+$284.50' },
    { emoji: 'üî•', name: 'Grace W.', action: 'just withdrew to M-Pesa', amount: '$1,200.00' },
    { emoji: 'üíé', name: 'Peter K.', action: 'activated Scalper Bot', amount: '+$89.20/hr' },
    { emoji: 'üöÄ', name: 'Sarah A.', action: 'just made a profit on ETH', amount: '+$156.80' },
    { emoji: '‚ö°', name: 'David M.', action: 'referred 3 friends today', amount: '+$75.00' },
    { emoji: 'ü§ë', name: 'Ann C.', action: 'withdrew to Equity Bank', amount: '$540.00' },
    { emoji: 'üìà', name: 'Brian N.', action: 'won 5 trades in a row', amount: '+$320.40' },
    { emoji: 'üí∞', name: 'Faith L.', action: 'just deposited & got bonus', amount: '$200 + $200' },
];

let winnerToastIdx = 0;
function showLiveWinnerToast() {
    const data = winnerToastData[winnerToastIdx % winnerToastData.length];
    winnerToastIdx++;
    const existing = document.querySelector('.live-winner-toast');
    if (existing) existing.remove();
    const toast = document.createElement('div');
    toast.className = 'live-winner-toast';
    toast.innerHTML = `<div class="winner-toast-avatar">${data.emoji}</div><div><div class="winner-toast-name">${data.name}</div><div class="winner-toast-action">${data.action}</div><div class="winner-toast-amount">${data.amount}</div></div>`;
    document.body.appendChild(toast);
    setTimeout(() => { toast.classList.add('hiding'); setTimeout(() => toast.remove(), 400); }, 4000);
}

function updateCountdown() {
    countdownSeconds--;
    if (countdownSeconds < 0) countdownSeconds = 86399;
    const h = Math.floor(countdownSeconds / 3600);
    const m = Math.floor((countdownSeconds % 3600) / 60);
    const s = countdownSeconds % 60;
    const pad = n => String(n).padStart(2, '0');
    ['cdHours','cdHours2'].forEach(id => { const el = document.getElementById(id); if (el) el.textContent = pad(h); });
    ['cdMins','cdMins2'].forEach(id => { const el = document.getElementById(id); if (el) el.textContent = pad(m); });
    ['cdSecs','cdSecs2'].forEach(id => { const el = document.getElementById(id); if (el) el.textContent = pad(s); });
}

function updateLiveStats() {
    const el = document.getElementById('statTraders');
    const el2 = document.getElementById('statTrades');
    const vc = document.getElementById('viewingCount');
    const dv = document.getElementById('depositViewers');
    if (el) el.textContent = (50247 + Math.floor(Math.random() * 10 - 3)).toLocaleString();
    if (el2) el2.textContent = (15892 + Math.floor(Math.random() * 20 - 5)).toLocaleString();
    if (vc) vc.textContent = 42 + Math.floor(Math.random() * 20);
    if (dv) dv.textContent = 18 + Math.floor(Math.random() * 12);
}

function checkReferralBanner() {
    const urlParams = new URLSearchParams(window.location.search);
    const ref = urlParams.get('ref');
    if (ref) {
        const banner = document.getElementById('referralSuccessBanner');
        const nameEl = document.getElementById('referrerName');
        if (nameEl) nameEl.textContent = ref + "'s friend";
        if (banner) banner.classList.add('show');
        const signupRef = document.getElementById('signupReferralCode');
        if (signupRef) signupRef.value = ref;
    }
}

function closeReferralBanner() { document.getElementById('referralSuccessBanner').classList.remove('show'); }

function init() {
    initMarketTicker();
    initLiveTradersTicker();
    renderTopWinners();
    startPriceTicker();
    startOrderBookUpdates();
    checkReferralBanner();
    countdownInterval = setInterval(updateCountdown, 1000);
    statsInterval = setInterval(updateLiveStats, 3000);
    liveWinnerInterval = setInterval(() => {
        const activeLayer = document.querySelector('.layer.active');
        if (activeLayer && activeLayer.id === 'welcomeLayer') showLiveWinnerToast();
    }, 7000);
    setTimeout(() => {
        if (document.getElementById('welcomeLayer').classList.contains('active')) showLiveWinnerToast();
    }, 4000);
    const script = document.createElement('script');
    script.src = 'https://s3.tradingview.com/tv.js';
    script.onload = () => {
        if (document.getElementById('chartsLayer').classList.contains('active')) initTVChart('tv_chart_main', 'BTCUSDT');
    };
    document.head.appendChild(script);
}

document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
